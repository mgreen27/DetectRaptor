rule ELASTIC_Windows_Trojan_Warmcookie_7D32Fa90 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Warmcookie (Windows.Trojan.WarmCookie)"
		author = "Elastic Security"
		id = "7d32fa90-c6e0-4a4b-bc21-51d82c57721e"
		date = "2024-04-29"
		modified = "2024-05-08"
		reference = "https://www.elastic.co/security-labs/dipping-into-danger"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_WarmCookie.yar#L1-L32"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ccde1ded028948f5cd3277d2d4af6b22fa33f53abde84ea2aa01f1872fad1d13"
		logic_hash = "ed3be6e5c6127ef87f9ef6fe35b17815b96706e8e73a393ee9b0a8e3b0cd8f66"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ae6c81fc7b0ba16567fefa714d043556afa44bfd698f6478c21d6e6428b14858"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$seq_checksum = { 45 8D 5D ?? 45 33 C0 41 83 E3 ?? 49 8D 4E ?? 44 03 DB 41 8D 53 ?? }
		$seq_string_decrypt = { 8B 69 04 48 8D 79 08 8B 31 89 6C 24 ?? 48 8D 4E ?? E8 }
		$seq_filesearch = { 48 81 EC 58 02 00 00 48 8B 05 82 0A 02 00 48 33 C4 48 89 84 24 40 02 00 00 45 33 C9 48 8D 44 24 30 45 33 C0 48 89 44 24 20 33 C9 41 8D 51 1A FF 15 83 4D 01 00 85 C0 78 22 48 8D 4C 24 30 E8 1D }
		$seq_registry = { 48 81 EC 80 02 00 00 48 8B 05 F7 09 02 00 48 33 C4 48 89 84 24 70 02 00 00 4C 89 B4 24 98 02 00 00 48 8D 0D 4D CA 01 00 45 33 F6 41 8B FE E8 02 4F 00 00 48 8B E8 41 B9 08 01 00 00 48 8D 44 24 }
		$plain_str1 = "release.dll" ascii fullword
		$plain_str2 = "\"Main Invoked.\"" ascii fullword
		$plain_str3 = "\"Main Returned.\"" ascii fullword
		$decrypt_str1 = "ERROR: Cannot write file" wide fullword
		$decrypt_str2 = "OK (No output data)" wide fullword
		$decrypt_str3 = "OK (See 'Files' tab)" wide fullword
		$decrypt_str4 = "cmd.exe /c %ls" wide fullword
		$decrypt_str5 = "Cookie:" wide fullword
		$decrypt_str6 = "%ls\\*.*" wide fullword

	condition:
		(3 of ($plain*)) or (2 of ($seq*)) or 4 of ($decrypt*)
}
rule ELASTIC_Windows_Trojan_Warmcookie_E8Cd480D : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Warmcookie (Windows.Trojan.WarmCookie)"
		author = "Elastic Security"
		id = "e8cd480d-a85e-4d5f-878c-287d02bfa67c"
		date = "2024-09-20"
		modified = "2024-09-30"
		reference = "https://www.elastic.co/security-labs/dipping-into-danger"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_WarmCookie.yar#L34-L57"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f4d2c9470b322af29b9188a3a590cbe85bacb9cc8fcd7c2e94d82271ded3f659"
		logic_hash = "addbc2e454771592a0ce6e92784ceec3f9c061f2798fe7450ac750cda5734d36"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "28954a5df5d4c331403ac393843b12bc434b28cff359305e9a1d88232277491d"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$seq1 = { 83 F8 0F 7D 14 E8 [4] 83 F8 05 7D 0A E8 }
		$seq2 = { 72 ?? E8 [4] 3D 00 0F 00 00 7? }
		$seq3 = { B9 E8 03 00 00 FF 15 }
		$seq4 = { 41 B9 04 00 00 00 4C 8D ?4 24 }
		$seq5 = { 48 C7 C1 02 00 00 80 FF 15 [4] 85 C0 0F 85 }

	condition:
		4 of them
}
rule ELASTIC_Windows_Trojan_Blackshades_9D095C44 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Blackshades (Windows.Trojan.BlackShades)"
		author = "Elastic Security"
		id = "9d095c44-5047-453e-8435-f30de94565e6"
		date = "2022-02-28"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_BlackShades.yar#L1-L26"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "e58e352edaa8ae7f95ab840c53fcaf7f14eb640df9223475304788533713c722"
		logic_hash = "2a2e6325d3de9289cc8bc26e1fe89a8fa81d9aae50b92ba2cf21c4cc6556ac9e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "be7d4c8200c293c3c8046d9f87b0d127ff051679ae1caeab12c533ea4309a1fc"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "*\\AD:\\Blackshades Project\\bs_net\\server\\server.vbp" wide fullword
		$a2 = "@*\\AD:\\Blackshades Project\\bs_net\\server\\server.vbp" wide fullword
		$a3 = "D:\\Blackshades Project\\bs_net\\loginserver\\msvbvm60.dll\\3" ascii fullword
		$b1 = "modSniff" ascii fullword
		$b2 = "UDPFlood" ascii fullword
		$b3 = "\\nir_cmd.bss speak text " wide fullword
		$b4 = "\\pws_chro.bss" wide fullword
		$b5 = "tmrLiveLogger" ascii fullword

	condition:
		1 of ($a*) or all of ($b*)
}
rule ELASTIC_Windows_Trojan_Blackshades_Be382Dac : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Blackshades (Windows.Trojan.BlackShades)"
		author = "Elastic Security"
		id = "be382dac-6a6f-43e4-86bb-c62f0db9b43a"
		date = "2022-02-28"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_BlackShades.yar#L28-L46"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "e58e352edaa8ae7f95ab840c53fcaf7f14eb640df9223475304788533713c722"
		logic_hash = "a13e37e7930d2d1ed1aa4fdeb282f11bfeb7fe008625589e2bfeab0beea43580"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e7031c42e51758358db32d8eba95f43be7dd5c4b57e6f9a76f0c3b925eae4e43"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 09 0E 4C 09 10 54 09 0E 4C 09 10 54 09 0E 4C 09 10 54 09 10 54 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Donutloader_F40E3759 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Donutloader (Windows.Trojan.Donutloader)"
		author = "Elastic Security"
		id = "f40e3759-2531-4e21-946a-fb55104814c0"
		date = "2021-09-15"
		modified = "2022-01-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Donutloader.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "541a4ca1da41f7cf54dff3fee917b219fadb60fd93a89b93b5efa3c1a57af81d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a6b9ccd69d871de081759feca580b034e3c5cec788dd5b3d3db033a5499735b5"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$x64 = { 06 B8 03 40 00 80 C3 4C 8B 49 10 49 8B 81 30 08 00 00 }
		$x86 = { 04 75 EE 89 31 F0 FF 46 04 33 C0 EB 08 83 21 00 B8 02 }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Donutloader_5C38878D : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Donutloader (Windows.Trojan.Donutloader)"
		author = "Elastic Security"
		id = "5c38878d-ca94-4fd9-a36e-1ae5fe713ca2"
		date = "2021-09-15"
		modified = "2021-01-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Donutloader.yar#L21-L38"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "897880d13318027ac5008fe8d008f09780d6fa807d6cc828b57975443358750c"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "3b55ec6c37891880b53633b936d10f94d2b806db1723875e4ac95f8a34d97150"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 24 48 03 C2 48 89 44 24 28 41 8A 00 84 C0 74 14 33 D2 FF C1 }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Donutloader_21E801E0 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Donutloader (Windows.Trojan.Donutloader)"
		author = "Elastic Security"
		id = "21e801e0-b016-48b2-81f5-930e7d3dd318"
		date = "2024-01-21"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Donutloader.yar#L40-L58"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c3bda62725bb1047d203575bbe033f0f95d4dd6402c05f9d0c69d24bd3224ca6"
		logic_hash = "19ef7bc8c7117024ca72956376954254c36eeb673f9379aa00475f763084a169"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "8b971734d471f281e7c48177096359e8f43578a12e42f6203f55d5e79d9ed09d"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 48 89 45 F0 48 8B 45 F0 48 81 C4 D0 00 00 00 5D C3 55 48 81 EC 60 02 00 00 48 8D AC 24 80 00 00 00 48 89 8D F0 01 00 00 48 89 95 F8 01 00 00 4C 89 85 00 02 00 00 4C 89 8D 08 02 00 00 48 C7 85 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Snakekeylogger_Af3Faa65 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Snakekeylogger (Windows.Trojan.SnakeKeylogger)"
		author = "Elastic Security"
		id = "af3faa65-b19d-4267-ac02-1a3b50cdc700"
		date = "2021-04-06"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_SnakeKeylogger.yar#L1-L32"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "54180a642d40b5366f1b400c347c25dc31397d662d6bb8af33c7d2319c97d3fb"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "15f4ef2a03c6f5c6284ea6a9013007e4ea7dc90a1ba9c81a53a1c7407d85890d"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "get_encryptedPassword" ascii fullword
		$a2 = "get_encryptedUsername" ascii fullword
		$a3 = "get_timePasswordChanged" ascii fullword
		$a4 = "get_passwordField" ascii fullword
		$a5 = "set_encryptedPassword" ascii fullword
		$a6 = "get_passwords" ascii fullword
		$a7 = "get_logins" ascii fullword
		$a8 = "GetOutlookPasswords" ascii fullword
		$a9 = "StartKeylogger" ascii fullword
		$a10 = "KeyLoggerEventArgs" ascii fullword
		$a11 = "KeyLoggerEventArgsEventHandler" ascii fullword
		$a12 = "GetDataPassword" ascii fullword
		$a13 = "_encryptedPassword" ascii fullword
		$b1 = "----------------S--------N--------A--------K--------E----------------"
		$c1 = "SNAKE-KEYLOGGER" ascii fullword

	condition:
		8 of ($a*) or #b1>5 or #c1>5
}
rule ELASTIC_Windows_Hacktool_Seatbelt_674Fd535 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Seatbelt (Windows.Hacktool.Seatbelt)"
		author = "Elastic Security"
		id = "674fd535-f188-4b20-8b5e-69a111bf08e5"
		date = "2022-10-20"
		modified = "2022-11-24"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_Seatbelt.yar#L1-L26"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a0e467aacd383727d46e766f1c45b424a6d46248118c155c22c538e8773b3ae7"
		logic_hash = "1bff820ec5cc9e56e7be4b290a48628115cc1ace5e41278fa76898bf39ef893e"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "cdbafa7507cb723f20ad0c7a288750a0d95792c8fe5ceb5e48c62fd45f2ffc0b"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$guid = "AEC32155-D589-4150-8FE7-2900DF4554C8" ascii wide nocase
		$str0 = "LogonId=\"(\\d+)" ascii wide
		$str1 = "Domain=\"(.*)\",Name=\"(.*)\"" ascii wide
		$str2 = "^\\W*([a-z]:\\\\.+?(\\.exe|\\.dll|\\.sys))\\W*" ascii wide
		$str3 = "KB\\d+" ascii wide
		$str4 = "(^https?://.+)|(^ftp://)" ascii wide
		$str5 = "[0-9A-Fa-f]{8}[-][0-9A-Fa-f]{4}[-][0-9A-Fa-f]{4}[-][0-9A-Fa-f]{4}[-][0-9A-Fa-f]{12}" ascii wide
		$str6 = "(http|ftp|https|file)://([\\w_-]+(?:(?:\\.[\\w_-]+)+))([\\w.,@?^=%&:/~+#-]*[\\w@?^=%&/~+#-])?" ascii wide

	condition:
		$guid or all of ($str*)
}
rule ELASTIC_Windows_Trojan_Darkcloud_9905Abce : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Darkcloud (Windows.Trojan.DarkCloud)"
		author = "Elastic Security"
		id = "9905abce-cbfc-4c92-aef6-38f2099eb5da"
		date = "2023-05-03"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_DarkCloud.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "500cb8459c19acd5a1144c4b509c14dbddec74ad623896bfe946fde1cd99a571"
		logic_hash = "27d3841d6acf87f5c9c03d643c7859d9eaf42e49ed0241b761f858c669c4e931"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "5aeb210b37f4b2b4032917f53f2fb0422132aa1f8cddf0f47bccf50ff68ce00c"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 8D 45 DC 57 57 6A 01 6A 11 50 6A 01 68 80 00 00 00 89 7D E8 89 }
		$a2 = { C8 33 FF 50 57 FF D6 8D 4D DC 51 57 FF D6 C3 8B 4D F0 8B 45 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Nanocore_D8C4E3C5 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Nanocore (Windows.Trojan.Nanocore)"
		author = "Elastic Security"
		id = "d8c4e3c5-8bcc-43d2-9104-fa3774282da5"
		date = "2021-06-13"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Nanocore.yar#L1-L29"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b2262126a955e306dc68487333394dc08c4fbd708a19afeb531f58916ddb1cfd"
		logic_hash = "fcc13e834cd8a1f86b453fe3c0333cd358e129d6838a339a824f1a095d85552d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e5c284f14c1c650ef8ddd7caf314f5318e46a811addc2af5e70890390c7307d4"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "NanoCore.ClientPluginHost" ascii fullword
		$a2 = "NanoCore.ClientPlugin" ascii fullword
		$b1 = "get_BuilderSettings" ascii fullword
		$b2 = "ClientLoaderForm.resources" ascii fullword
		$b3 = "PluginCommand" ascii fullword
		$b4 = "IClientAppHost" ascii fullword
		$b5 = "GetBlockHash" ascii fullword
		$b6 = "AddHostEntry" ascii fullword
		$b7 = "LogClientException" ascii fullword
		$b8 = "PipeExists" ascii fullword
		$b9 = "IClientLoggingHost" ascii fullword

	condition:
		1 of ($a*) or 6 of ($b*)
}
rule ELASTIC_Windows_Trojan_Deimos_F53Aee03 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Deimos (Windows.Trojan.Deimos)"
		author = "Elastic Security"
		id = "f53aee03-74c3-4b40-8ae4-4f1bf35f88c8"
		date = "2021-09-18"
		modified = "2022-01-13"
		reference = "https://www.elastic.co/security-labs/going-coast-to-coast-climbing-the-pyramid-with-the-deimos-implant"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Deimos.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "2c1941847f660a99bbc6de16b00e563f70d900f9dbc40c6734871993961d3d3e"
		logic_hash = "07675844a8790f8485b6545e7466cdef8ac4f92dec4cd8289aeaad2a0a448691"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "12a6d7f9e4f9a937bf1416443dd0d5ee556ac1f67d2b56ad35f9eac2ee6aac74"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "\\APPDATA\\ROAMING" wide fullword
		$a2 = "{\"action\":\"ping\",\"" wide fullword
		$a3 = "Deimos" ascii fullword

	condition:
		all of ($a*)
}
rule ELASTIC_Windows_Trojan_Deimos_C70677B4 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Deimos (Windows.Trojan.Deimos)"
		author = "Elastic Security"
		id = "c70677b4-f5ba-440b-ba31-31e80caee2fe"
		date = "2021-09-18"
		modified = "2022-01-13"
		reference = "https://www.elastic.co/security-labs/going-coast-to-coast-climbing-the-pyramid-with-the-deimos-implant"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Deimos.yar#L24-L44"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "2c1941847f660a99bbc6de16b00e563f70d900f9dbc40c6734871993961d3d3e"
		logic_hash = "c969221f025b114b9d5738d43b6021ab9481dbc6b35eb129ea4f806160b1adc3"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ffe0dec3585da9cbb9f8a0fac1bb6fd43d5d6e20a6175aaa889ae13ef2ed101f"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 00 57 00 58 00 59 00 5A 00 5F 00 00 17 75 00 73 00 65 00 72 00 }
		$a2 = { 0C 08 16 1F 68 9D 08 17 1F 77 9D 08 18 1F 69 9D 08 19 1F 64 9D }

	condition:
		1 of ($a*)
}
rule ELASTIC_Windows_Trojan_Servhelper_F4Dee200 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Servhelper (Windows.Trojan.ServHelper)"
		author = "Elastic Security"
		id = "f4dee200-5471-472b-a017-bfcc9c291cbe"
		date = "2022-03-22"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_ServHelper.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "05d183430a7afe16a3857fc4e87568fcc18518e108823c37eabf0514660aa17c"
		logic_hash = "abab541ebddf36c05e351d506d4f978a30d8a44ff09233a667d62a1692dabe15"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "24e49a0c72e665a03cea66614481665eea962a0c6b0a2f9d459866d8070ab456"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 48 8B 45 78 48 63 4D 44 48 8B 55 48 4C 63 45 44 48 0F B7 44 48 FE 66 42 33 44 42 FE 66 89 45 42 48 8D 4D 28 48 0F B7 55 42 E8 ?? ?? ?? ?? 48 8B 4D 70 48 8B 55 28 E8 ?? ?? ?? ?? 83 45 44 01 83 EB 01 85 DB 75 ?? }
		$b = { 39 5D ?? 0F 8F ?? ?? ?? ?? 2B D8 83 C3 01 48 8B 45 ?? 48 63 4D ?? 66 83 7C 48 ?? 20 72 ?? 48 8B 45 ?? 48 63 4D ?? 66 83 7C 48 ?? 7F 76 ?? 48 8B 45 ?? 48 63 4D ?? 48 0F B7 44 48 ?? 66 83 E8 08 66 83 F8 07 77 ?? B2 01 8B C8 80 E1 7F D3 E2 48 0F B6 05 ?? ?? ?? ?? 84 C2 0F 95 C0 EB ?? 33 C0 84 C0 74 ?? 83 45 ?? 01 }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Servhelper_370C5287 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Servhelper (Windows.Trojan.ServHelper)"
		author = "Elastic Security"
		id = "370c5287-0e2f-4113-95b6-53d31671fa46"
		date = "2022-03-24"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_ServHelper.yar#L22-L40"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "05d183430a7afe16a3857fc4e87568fcc18518e108823c37eabf0514660aa17c"
		logic_hash = "8a2934c28efef6a5fed26dc88d074aee15b0869370c66f6a4d6eaedf070eaa9e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a66134e9344cc5ba403fe0aad70e8a991c61582d6a5640c3b9e4a554374176a2"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 00 10 66 01 00 48 66 01 00 98 07 2B 00 50 66 01 00 95 66 01 }

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Thanos_C3522Fd0 : BETA FILE MEMORY {
    meta:
		description = "Identifies THANOS (Hakbit) ransomware"
		author = "Elastic Security"
		id = "c3522fd0-90e2-4dd9-82f1-4502689270dd"
		date = "2020-11-03"
		modified = "2021-08-23"
		reference = "https://labs.sentinelone.com/thanos-ransomware-riplace-bootlocker-and-more-added-to-feature-set/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Thanos.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "00d28aafd242308ad6561547ed8c80dad3086859dacab09ffdd43d436bf9ec52"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "6d9d6131fd0e3a8585900f4966cb2d1b32e7f5d71b9a65b7a47d80e94bd9f89a"
		threat_name = "Windows.Ransomware.Thanos"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$c1 = { 0C 89 45 F0 83 65 EC 00 EB 07 8B 45 EC 40 89 45 EC 83 7D EC 18 }
		$c2 = { E8 C1 E0 04 8B 4D FC C6 44 01 09 00 8B 45 E8 C1 E0 04 8B 4D FC 83 64 01 }
		$c3 = { 00 2F 00 18 46 00 54 00 50 00 20 00 55 00 73 00 65 00 72 00 4E 00 }

	condition:
		2 of ($c*)
}
rule ELASTIC_Windows_Ransomware_Thanos_A6C09942 : BETA FILE MEMORY {
    meta:
		description = "Identifies THANOS (Hakbit) ransomware"
		author = "Elastic Security"
		id = "a6c09942-0733-40d7-87b7-eb44dd472a35"
		date = "2020-11-03"
		modified = "2021-08-23"
		reference = "https://labs.sentinelone.com/thanos-ransomware-riplace-bootlocker-and-more-added-to-feature-set/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Thanos.yar#L24-L44"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "cecdeb21e041c90769b8fd8431fa87943461c1f7faa5ad15918524b91ba5c792"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "4abcf47243bebc281566ba4929b20950e3f1bfac8976ae5bc6b8ffda85468ec0"
		threat_name = "Windows.Ransomware.Thanos"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$b1 = { 00 57 00 78 00 73 00 49 00 48 00 6C 00 76 00 64 00 58 00 49 00 67 00 5A 00 6D 00 6C 00 73 00 5A 00 58 00 4D 00 67 00 64 00 32 00 56 00 79 00 5A 00 53 00 42 00 6C 00 62 00 6D 00 4E 00 79 00 65 00 58 00 42 00 30 00 5A 00 57 00 51 00 73 00 49 00 47 00 6C 00 6D 00 49 00 48 00 6C 00 76 00 64 00 53 00 42 00 33 00 59 00 57 00 35 00 30 00 49 00 48 00 52 00 76 00 49 00 47 00 64 00 6C 00 64 00 43 00 42 00 30 00 61 00 47 00 56 00 74 00 49 00 47 00 46 00 73 00 62 00 43 00 42 00 69 00 59 00 57 00 4E 00 72 00 4C 00 43 00 42 00 77 00 62 00 47 00 56 00 68 00 63 00 32 00 55 00 67 00 59 00 32 00 46 00 79 00 5A 00 57 00 5A 00 31 00 62 00 47 00 78 00 35 00 49 00 48 00 4A 00 6C 00 59 00 57 00 51 00 67 00 64 00 47 00 68 00 6C 00 49 00 48 00 52 00 6C 00 65 00 48 00 51 00 67 00 62 00 6D 00 39 00 30 00 5A 00 53 00 42 00 73 00 62 00 32 00 4E 00 68 00 64 00 47 00 56 00 6B 00 49 00 47 00 6C 00 75 00 49 00 48 00 6C 00 76 00 64 00 58 00 49 00 67 00 5A 00 47 00 56 00 7A 00 61 00 33 00 52 00 76 00 63 00 43 00 34 00 75 00 4C 00 67 00 3D 00 3D }
		$b2 = { 01 0E 0E 05 00 02 0E 0E 0E 04 00 01 01 0E 04 00 01 0E 0E 06 00 03 01 0E 0E 0E 80 90 55 00 30 00 39 00 47 00 56 00 46 00 64 00 42 00 55 00 6B 00 56 00 63 00 54 00 57 00 6C 00 6A 00 63 00 6D 00 39 00 7A 00 62 00 32 00 5A 00 30 00 58 00 46 00 64 00 70 00 62 00 6D 00 52 00 76 00 64 00 33 00 4D 00 67 00 54 00 6C 00 52 00 63 00 51 00 33 00 56 00 79 00 63 00 6D 00 56 00 75 00 64 00 46 00 5A 00 6C 00 63 00 6E 00 4E 00 70 00 62 00 32 00 35 00 63 00 56 00 32 00 6C 00 }

	condition:
		1 of ($b*)
}
rule ELASTIC_Windows_Ransomware_Thanos_E19Feca1 : BETA FILE MEMORY {
    meta:
		description = "Identifies THANOS (Hakbit) ransomware"
		author = "Elastic Security"
		id = "e19feca1-b131-4045-be0c-d69d55f9a83e"
		date = "2020-11-03"
		modified = "2021-08-23"
		reference = "https://labs.sentinelone.com/thanos-ransomware-riplace-bootlocker-and-more-added-to-feature-set/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Thanos.yar#L46-L77"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "1f5a69b6749e887a5576843abb83388d5364e47601cf11fcac594008ace8e973"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "d6654d0b3155d9c64fd4e599ba34d51f110d9dfda6fa1520b686602d9f608f92"
		threat_name = "Windows.Ransomware.Thanos"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "<GetIPInfo>b__"
		$a2 = "<Killproc>b__"
		$a3 = "<Crypt>b__"
		$a4 = "<Encrypt2>b__"
		$b1 = "Your files are encrypted."
		$b2 = "I will treat you good if you treat me good too."
		$b3 = "I don't want to loose your files too"
		$b4 = "/c rd /s /q %SYSTEMDRIVE%\\$Recycle.bin" wide fullword
		$b5 = "\\HOW_TO_DECYPHER_FILES.txt" wide fullword
		$b6 = "c3RvcCBTUUxURUxFTUVUUlkkRUNXREIyIC95" wide fullword
		$b7 = "c3RvcCBNQkFNU2VydmljZSAveQ==" wide fullword
		$b8 = "L0MgY2hvaWNlIC9DIFkgL04gL0QgWSAvVCAzICYgRGVsIA==" wide fullword
		$b9 = "c3RvcCBjY0V2dE1nciAveQ==" wide fullword

	condition:
		(4 of ($a*)) or (3 of ($b*))
}
rule ELASTIC_Windows_Hacktool_Godpotato_5F1Aad81 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Godpotato (Windows.Hacktool.GodPotato)"
		author = "Elastic Security"
		id = "5f1aad81-88d8-4561-a6f9-d7521b9ffdf5"
		date = "2024-06-24"
		modified = "2024-07-02"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_GodPotato.yar#L1-L28"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "00171bb6e9e4a9b8601e988a8c4ac6f5413e31e1b6d86d24b0b53520cd02184c"
		logic_hash = "3028c84a616d47b37b4ef2d41d35ccef5121c06aa042096bca8ea53b528a1eb9"
		score = 75
		quality = 25
		tags = "FILE, MEMORY"
		fingerprint = "3645a259f9b5d07bd5ad2ec823fd704eccd0412dd75c47bc82124db9a907da2a"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "GodPotato" wide fullword
		$a2 = "GodPotatoContext was not initialized" wide fullword
		$a3 = "GodPotatoStorageTrigger" ascii fullword
		$a4 = "[*] DCOM obj GUID: {0}" wide fullword
		$a5 = "[*] DispatchTable: 0x{0:x}" wide fullword
		$a6 = "[*] UseProtseqFunction: 0x{0:x}" wide fullword
		$a7 = "[*] process start with pid {0}" wide fullword
		$a8 = "[!] ImpersonateNamedPipeClient fail error:{0}" wide fullword
		$a9 = "[*] CoGetInstanceFromIStorage: 0x{0:x}" wide fullword
		$a10 = "[*] Trigger RPCS" wide

	condition:
		5 of them
}
rule ELASTIC_Windows_Trojan_Xworm_732E6C12 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Xworm (Windows.Trojan.XWorm)"
		author = "Elastic Security"
		id = "732e6c12-9ee0-4d04-a6e4-9eef874e2716"
		date = "2023-04-03"
		modified = "2024-10-15"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_XWorm.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "bf5ea8d5fd573abb86de0f27e64df194e7f9efbaadd5063dee8ff9c5c3baeaa2"
		logic_hash = "6aa72029eeeb2edd2472bf0db80b9c0ae4033d7d977cbee75ac94414d1cdff7a"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "afbef8e590105e16bbd87bd726f4a3391cd6a4489f7a4255ba78a3af761ad2f0"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$str1 = "startsp" ascii wide fullword
		$str2 = "injRun" ascii wide fullword
		$str3 = "getinfo" ascii wide fullword
		$str4 = "Xinfo" ascii wide fullword
		$str5 = "openhide" ascii wide fullword
		$str6 = "WScript.Shell" ascii wide fullword
		$str7 = "hidefolderfile" ascii wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Xworm_B7D6Eaa8 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Xworm (Windows.Trojan.XWorm)"
		author = "Elastic Security"
		id = "b7d6eaa8-f4e6-42e6-95b2-ce67f513d6c5"
		date = "2024-09-10"
		modified = "2024-10-15"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_XWorm.yar#L27-L50"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6fc4ff3f025545f7e092408b035066c1138253b972a2e9ef178e871d36f03acd"
		logic_hash = "6a9da68dd1475974e71043a0e5a51d70762473c385d6acef34945019c7016b02"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0c68cb5c8425cccc6af66c33a14e14e5f16d91835209bd38cddf38fad07a40fa"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$str1 = "XWorm V" wide
		$str2 = "XLogger" ascii fullword
		$str3 = "<Xwormmm>" wide fullword
		$str4 = "ActivatePong" ascii fullword
		$str5 = "ReportWindow" ascii fullword
		$str6 = "ConnectServer" ascii fullword

	condition:
		4 of them
}
rule ELASTIC_Windows_Trojan_Xworm_7078E1C8 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Xworm (Windows.Trojan.XWorm)"
		author = "Elastic Security"
		id = "7078e1c8-2f18-4116-8c55-e47b8e948ed7"
		date = "2024-10-10"
		modified = "2024-10-24"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_XWorm.yar#L52-L70"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "034c8a18c15521069af36595357d9c8413a33544af8d3ea5f0ac7d471841e0ec"
		logic_hash = "4c69648e4a68c8c46cf435f4dcac79176a023d8cd7209f9fa6a6b244797c66f3"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "23304deeddcf211b7b9abc1446d8975a3ef4713e60d0363a1e1d6d69a9e5b514"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 28 00 00 0A 72 5D 01 00 70 17 6F 29 00 00 0A 7E 21 00 00 04 28 2A 00 00 0A 09 6F 2B 00 00 0A 09 28 2C 00 00 0A 2C 0F 09 73 2D 00 00 0A 13 04 11 04 6F 2E 00 00 0A 20 E8 03 00 00 28 1F 00 00 0A }

	condition:
		all of them
}
rule ELASTIC_Windows_Backdoor_Teamviewer_Df8E7326 : FILE MEMORY {
    meta:
		description = "Detects Windows Backdoor Teamviewer (Windows.Backdoor.TeamViewer)"
		author = "Elastic Security"
		id = "df8e7326-5879-48d7-8a5f-1c9a2d8b7f8d"
		date = "2022-10-29"
		modified = "2022-12-20"
		reference = "https://vms.drweb.com/virus/?i=8172096"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Backdoor_TeamViewer.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "68d9ffb6e00c2694d0d827108d0410d5a66d4f8cf839afddd17c5887b0149350"
		logic_hash = "3d42c76626c76959e450a81001c73d8d47b52789cab324e0cc7af09303c1367d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0f2406e98fa1383e39672bd4ec32a111363f7d33f8bc33c2bd7ea36353faab45"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "m%c%c%c%c%c%c.com" ascii fullword
		$a2 = "client_id=%.8x&connected=%d&server_port=%d&debug=%d&os=%d.%d.%04d&dgt=%d&dti=%d" ascii fullword
		$a3 = "\\save.dat" ascii fullword
		$a4 = "auth_ip" ascii fullword
		$a5 = "updips" ascii fullword
		$b1 = { 55 8B EC 56 E8 BF 25 00 00 50 E8 7B 5B 00 00 8B F0 59 85 F6 75 2C 8B 75 08 56 E8 A9 25 00 00 50 }

	condition:
		5 of ($a*) or 1 of ($b*)
}
rule ELASTIC_Windows_Trojan_Quasarrat_E52Df647 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Quasarrat (Windows.Trojan.Quasarrat)"
		author = "Elastic Security"
		id = "e52df647-c197-4790-b051-8951fba80c3b"
		date = "2021-06-27"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Quasarrat.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a58efd253a25cc764d63476931da2ddb305a0328253a810515f6735a6690de1d"
		logic_hash = "41f32e0c9b3b43d10baef10060e064ad860558bcdeb4281a30d30c16615ed21d"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "c888f0856c6568b83ab60193f8144a61e758e6ff53f6ead8565282ae8b3a9815"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "GetKeyloggerLogsResponse" ascii fullword
		$a2 = "DoDownloadAndExecute" ascii fullword
		$a3 = "http://api.ipify.org/" wide fullword
		$a4 = "Domain: {1}{0}Cookie Name: {2}{0}Value: {3}{0}Path: {4}{0}Expired: {5}{0}HttpOnly: {6}{0}Secure: {7}" wide fullword
		$a5 = "\" /sc ONLOGON /tr \"" wide fullword

	condition:
		4 of them
}
rule ELASTIC_Windows_Trojan_Sourshark_F0247Cce : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Sourshark (Windows.Trojan.SourShark)"
		author = "Elastic Security"
		id = "f0247cce-b983-41a1-9118-fd4c23e3d099"
		date = "2024-06-04"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_SourShark.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "07eb88c69437ee6e3ea2fbab5f2fbd8e846125d18c1da7d72bb462e9d083c9fc"
		logic_hash = "0c5d802b5bfc771bdf5df541b18c7ab9de4f420fd3928bfd85b1a71cca2af1bc"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "174d6683890b855a06c672423b4a0b3aa291558d8a2af4771b931d186ce3cb63"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "%s\\svchost.%s"
		$a2 = "crypto_domain"
		$a3 = "postback_id"

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Sourshark_Adee8A17 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Sourshark (Windows.Trojan.SourShark)"
		author = "Elastic Security"
		id = "adee8a17-cc0c-40b8-9ee6-a01b41e9befd"
		date = "2024-06-04"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_SourShark.yar#L23-L41"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "07eb88c69437ee6e3ea2fbab5f2fbd8e846125d18c1da7d72bb462e9d083c9fc"
		logic_hash = "98a4d31849a1828c2154b5032a81580f5dcc8d4a65b96dea3a727e2a82a51666"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f35ebe8a220693ef6288efae0d325c3f40e70836c088599cb9b620c59fab09da"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 8B 45 08 8B 4C BE 08 8A 04 02 02 C3 02 C1 0F B6 D8 8B 44 9E 08 89 44 BE 08 8D 42 01 33 D2 89 4C 9E 08 47 83 F8 20 0F 4C D0 81 FF 00 01 00 00 7C CF 8B 16 33 FF 8B 5E 04 39 7D FC 7E 33 0F 1F 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Shellcode_Rdi_Edc62A10 : FILE MEMORY {
    meta:
		description = "Detects Windows Shellcode Rdi (Windows.Shellcode.Rdi)"
		author = "Elastic Security"
		id = "edc62a10-7cb1-4fda-a15c-86d40d510ffd"
		date = "2023-06-23"
		modified = "2023-07-10"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Shellcode_Rdi.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "64485ffc283e981c8b77db5a675c7ba2a04d3effaced522531185aa46eb6a36b"
		logic_hash = "986cb6c28d2d9767a2fd084fdd71edb7a1c36e78ddedf3c562076cf6f5b5afd1"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "1cee85457eb31be126a41d4e332735957cf4a928fdf4b5253380b6c97605d069"
		severity = 90
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { E8 00 00 00 00 59 49 89 C8 48 81 C1 23 0B 00 00 BA [10] 00 41 B9 04 00 00 00 56 48 89 E6 48 83 E4 F0 48 83 EC 30 C7 }

	condition:
		all of them
}
rule ELASTIC_Windows_Shellcode_Rdi_Eee75D2C : FILE MEMORY {
    meta:
		description = "Detects Windows Shellcode Rdi (Windows.Shellcode.Rdi)"
		author = "Elastic Security"
		id = "eee75d2c-78ef-460f-be96-4638443952fb"
		date = "2023-08-25"
		modified = "2023-11-02"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Shellcode_Rdi.yar#L21-L39"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "8c4de69e89dcc659d2fff52d695764f1efd7e64e0a80983ce6d0cb9eeddb806c"
		logic_hash = "18cd9be4af210686872610f832ac0ad58a48588a1226fc6093348ceb8371c6b4"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "2b8f840cecec00ce3112ea58e4e957e1b0754380e14a8fc8a39abc36feb077e9"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 81 EC 14 01 00 00 53 55 56 57 6A 6B 58 6A 65 66 89 84 24 CC 00 00 00 33 ED 58 6A 72 59 6A 6E 5B 6A 6C 5A 6A 33 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Dodgebox_095012D2 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Dodgebox (Windows.Trojan.DodgeBox)"
		author = "Elastic Security"
		id = "095012d2-2804-44f5-b4a1-f9d9c028daf1"
		date = "2024-07-11"
		modified = "2024-07-26"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_DodgeBox.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c6a3a1ea84251aed908702a1f2a565496d583239c5f467f5dcd0cfc5bfb1a6db"
		logic_hash = "f1fe9b05deaebaddd83dda0ad98602b49682f8ba767de8c0ffad761d344c5115"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0797dbe75dea90df77d35d2d4a259b4402c041bc10f9e52df2ef80b2a5804c9f"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 53 4F 46 54 57 41 52 45 5C 4D 69 63 72 6F 73 6F 66 74 5C 43 72 79 70 74 6F 67 72 61 70 68 79 00 4D 61 63 68 69 6E 65 47 75 69 64 00 2E 70 64 61 74 61 }
		$a2 = { 5C 00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 2E 00 4E 00 45 00 54 00 5C 00 61 00 73 00 73 00 65 00 6D 00 62 00 6C 00 79 00 5C 00 47 00 41 00 43 00 5F 00 4D 00 53 00 49 00 4C 00 5C 00 00 00 00 00 00 00 25 00 6C 00 6C 00 64 00 2E 00 6C 00 6F 00 67 }
		$a3 = { 48 83 EC 20 48 63 51 3C 48 8B D9 33 F6 48 8D 3C 11 8B 8F 90 00 00 00 85 C9 74 21 8B 87 94 00 00 00 85 C0 74 17 44 8B C0 48 03 CB 33 D2 ?? ?? ?? ?? ?? 48 89 B7 90 00 00 00 8B 53 3C 48 63 FA }
		$a4 = { 48 89 5C 24 08 48 89 74 24 10 57 48 83 EC 20 48 63 51 3C 48 8B D9 33 F6 48 8D 3C 11 8B 8F 90 00 }
		$a5 = { 48 89 5C 24 08 48 89 74 24 10 57 48 83 EC 20 48 63 59 3C 33 D2 4C 8B C3 48 8B F1 E8 }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Systembc_5E883723 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Systembc (Windows.Trojan.SystemBC)"
		author = "Elastic Security"
		id = "5e883723-7eaa-4992-91de-abb0ffbba54e"
		date = "2022-03-22"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_SystemBC.yar#L1-L24"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b432805eb6b2b58dd957481aa8a973be58915c26c04630ce395753c6a5196b14"
		logic_hash = "fde2e0b5debd4d26838fb245fdf8e5103ab5aab9feff900cbba00c1950adc61a"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "add95c1f4bb279c8b189c3d64a0c2602c73363ebfad56a4077119af148dd2d87"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "GET /tor/rendezvous2/%s HTTP/1.0" ascii fullword
		$a2 = "https://api.ipify.org/" ascii fullword
		$a3 = "KEY-----" ascii fullword
		$a4 = "Host: %s" ascii fullword
		$a5 = "BEGINDATA" ascii fullword
		$a6 = "-WindowStyle Hidden -ep bypass -file \"" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Systembc_C1B58C2F : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Systembc (Windows.Trojan.SystemBC)"
		author = "Elastic Security"
		id = "c1b58c2f-8bbf-4c03-9f53-13ab2fb081cc"
		date = "2024-05-02"
		modified = "2024-05-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_SystemBC.yar#L26-L49"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "016fc1db90d9d18fe25ed380606346ef12b886e1db0d80fe58c22da23f6d677d"
		logic_hash = "16ed14dac0c30500c5e91759b0a1b321f3bd53ae6aab1389a685582eba72c222"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "dfbf98554e7fb8660e4eebd6ad2fadc394fc2a4168050390370ec358f6af1c1d"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "GET %s HTTP/1.0" ascii fullword
		$a2 = "HOST1:"
		$a3 = "PORT1:"
		$a4 = "-WindowStyle Hidden -ep bypass -file \"" ascii fullword
		$a5 = "BEGINDATA" ascii fullword
		$a6 = "socks32.dll" ascii fullword

	condition:
		5 of them
}
rule ELASTIC_Windows_Infostealer_Strela_0Dc3E4A1 : MEMORY {
    meta:
		description = "Detects Windows Infostealer Strela (Windows.Infostealer.Strela)"
		author = "Elastic Security"
		id = "0dc3e4a1-13ac-4461-aac9-896f9e30d84b"
		date = "2024-03-25"
		modified = "2024-09-30"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Infostealer_Strela.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "e6991b12e86629b38e178fef129dfda1d454391ffbb236703f8c026d6d55b9a1"
		logic_hash = "ac1b53f2857fd13ba0e33aa94c65f0d5fa22b76d504fff347b3ff0a53f37ee26"
		score = 75
		quality = 75
		tags = "MEMORY"
		fingerprint = "76ba0b9c5e892afc335d101dfc30355b6d704f2d723a81ddbae1cf2026ea85a4"
		severity = 100
		arch_context = "x86"
		scan_context = "memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$s1 = "strela" fullword
		$s2 = "/server.php" fullword
		$s3 = "/out.php" fullword
		$s4 = "%s%s\\key4.db" fullword
		$s5 = "%s%s\\logins.json" fullword
		$s6 = "%s,%s,%s\n" fullword
		$old_pdb = "Projects\\StrelaDLLCompile\\Release\\StrelaDLLCompile.pdb" fullword

	condition:
		3 of ($s*) or $old_pdb
}
rule ELASTIC_Windows_Virus_Expiro_84E99Ff0 : FILE MEMORY {
    meta:
		description = "Detects Windows Virus Expiro (Windows.Virus.Expiro)"
		author = "Elastic Security"
		id = "84e99ff0-bff3-4a9c-93fb-504a32cbc44d"
		date = "2023-09-26"
		modified = "2023-11-02"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Virus_Expiro.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "47107836ead700bddbe9e8a0c016b5b1443c785442b2addbb50a70445779bad7"
		logic_hash = "ce4847bf5850c1f30dca9603bfbbfbb69339285f096ac469c6d2d4b04f5562b4"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "843182cbbf7ff65699001f074972d584c65bdb1e1d76210b44cf6ba06830253c"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 50 51 52 53 55 56 57 E8 00 00 00 00 5B 81 EB ?? ?? ?? 00 BA 00 00 00 00 53 81 }
		$a2 = { 81 C2 00 04 00 00 81 C3 00 04 00 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Virus_Neshta_2A5A14C8 : FILE MEMORY {
    meta:
		description = "Detects Windows Virus Neshta (Windows.Virus.Neshta)"
		author = "Elastic Security"
		id = "2a5a14c8-27d8-4658-8941-0bb221d54ad3"
		date = "2024-01-22"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Virus_Neshta.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f298214764ee9ab690cb4b376d8a7893edcd9c05a3c4e6f3a56010974a130bd7"
		logic_hash = "0b5d0603f4c20a2368f697dd84cfe1790a5d0e5904c76066601c9e3d1b5ed1e1"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "4ca7b0c908d08bf8b2041d7b41be8569efa54db99ebf04c7ff290c6bcad7dc02"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 44 65 6C 70 68 69 2D 74 68 65 20 62 65 73 74 2E 20 46 75 63 6B 20 6F 66 66 20 61 6C 6C 20 74 68 65 20 72 65 73 74 2E 20 4E 65 73 68 74 61 20 31 2E 30 20 4D 61 64 65 20 69 6E 20 42 65 6C 61 72 75 73 2E }
		$a2 = { 55 8B EC 81 C4 64 FF FF FF 53 56 57 33 D2 89 95 64 FF FF FF 8B F8 33 C0 55 68 FC 6D 40 00 64 FF 30 64 89 20 8D 85 69 FF FF FF 50 68 97 00 00 00 E8 1B D3 FF FF 33 DB EB 5C 8B F3 81 E6 FF 00 00 }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Powerseal_D63F5E54 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Powerseal (Windows.Trojan.PowerSeal)"
		author = "Elastic Security"
		id = "d63f5e54-6be1-453d-a96e-083a025deba2"
		date = "2023-03-16"
		modified = "2023-05-26"
		reference = "https://www.elastic.co/security-labs/elastic-charms-spectralviper"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_PowerSeal.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "523dcff68a51ea8fb022066b5f09394e8174d6c157222a08100de30669898057"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "bc63511a0b12edaf7a2ace02f79ab9a2dbea5a0879fd976cc91308f98bac1c52"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "PowerSeal.dll" wide fullword
		$a2 = "InvokePs" ascii fullword
		$a3 = "amsiInitFailed" wide fullword
		$a4 = "is64BitOperatingSystem" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Powerseal_2E50F393 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Powerseal (Windows.Trojan.PowerSeal)"
		author = "Elastic Security"
		id = "2e50f393-40c0-49f7-882e-33f914eff32d"
		date = "2023-05-10"
		modified = "2023-06-13"
		reference = "https://www.elastic.co/security-labs/elastic-charms-spectralviper"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_PowerSeal.yar#L24-L44"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "3ca1d4568fea7b2e4e9d30ba03662a2c28ee8623d887a0336e27989b5c98b55f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "9b7beb5af64bc57d78cfb8f5bf8134461d8f2fbe7c935a0fa2b44fb51160a28d"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "[+] Loading PowerSeal"
		$a2 = "[!] Failed to exec PowerSeal"
		$a3 = "AppDomain: unable to get the name!"

	condition:
		2 of them
}
rule ELASTIC_Windows_Trojan_Icedid_1Cd868A6 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Icedid (Windows.Trojan.IcedID)"
		author = "Elastic Security"
		id = "1cd868a6-d2ec-4c48-a69a-aaa6c7af876c"
		date = "2021-02-28"
		modified = "2021-08-23"
		reference = "https://www.fireeye.com/blog/threat-research/2021/02/melting-unc2198-icedid-to-ransomware-operations.html"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_IcedID.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "68dce9f214e7691db77a2f03af16a669a3cb655699f31a6c1f5aaede041468ff"
		logic_hash = "4765b2b1d463f09d7e21367c2832b3ad668aa67d8078798a14295b6e6c846c1c"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "3e76b3ac03c5268923cfd5d0938745d66cda273d436b83bee860250fdcca6327"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 24 2C B9 09 00 00 00 2A C2 2C 07 88 44 24 0F 0F B6 C3 6B C0 43 89 44 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Icedid_237E9Fb6 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Icedid (Windows.Trojan.IcedID)"
		author = "Elastic Security"
		id = "237e9fb6-b5fa-4747-af1f-533c76a5a639"
		date = "2021-02-28"
		modified = "2021-08-23"
		reference = "https://www.fireeye.com/blog/threat-research/2021/02/melting-unc2198-icedid-to-ransomware-operations.html"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_IcedID.yar#L23-L43"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b21f9afc6443548427bf83b5f93e7a54ac3af306d9d71b8348a6f146b2819457"
		logic_hash = "31479eae077b2d78cb1770eef3b37bec941f35c9ceb329e01dd65a32e785fa74"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e2ea6d1477ce4132f123b6c00101a063f7bba7acf38be97ee8dca22cc90ed511"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 60 8B 55 D4 3B D0 7E 45 83 F8 08 0F 4C 45 EC 3B D0 8D 3C 00 0F }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Icedid_F1Ce2F0A : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Icedid (Windows.Trojan.IcedID)"
		author = "Elastic Security"
		id = "f1ce2f0a-0d34-46a4-8e42-0906adf4dc1b"
		date = "2021-02-28"
		modified = "2021-08-23"
		reference = "https://www.fireeye.com/blog/threat-research/2021/02/melting-unc2198-icedid-to-ransomware-operations.html"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_IcedID.yar#L45-L65"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b21f9afc6443548427bf83b5f93e7a54ac3af306d9d71b8348a6f146b2819457"
		logic_hash = "a1f1824a7208201616dde40bea514dfc2cdf908bd8ed24b9f96c2bcad2c8107f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "1940c4bf5d8011dc7edb8dde718286554ed65f9e96fe61bfa90f6182a4b8ca9e"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 8B C8 8B C6 F7 E2 03 CA 8B 54 24 14 2B D0 8B 44 24 14 89 54 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Icedid_08530E24 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Icedid (Windows.Trojan.IcedID)"
		author = "Elastic Security"
		id = "08530e24-5b84-40a4-bc5c-ead74762faf8"
		date = "2021-03-21"
		modified = "2021-08-23"
		reference = "https://www.elastic.co/security-labs/thawing-the-permafrost-of-icedid-summary"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_IcedID.yar#L67-L99"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "31db92c7920e82e49a968220480e9f130dea9b386083b78a79985b554ecdc6e4"
		logic_hash = "a63511edde9d873e184ddb4720b4752b0e7df4bdb2114b05c16f2ca0594eb6b8"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "f2b5768b87eec7c1c9730cc99364cc90e87fd9201bf374418ad008fd70d321af"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "c:\\ProgramData\\" ascii fullword
		$a2 = "loader_dll_64.dll" ascii fullword
		$a3 = "aws.amazon.com" wide fullword
		$a4 = "Cookie: __gads=" wide fullword
		$b1 = "LookupAccountNameW" ascii fullword
		$b2 = "GetUserNameA" ascii fullword
		$b3 = "; _gat=" wide fullword
		$b4 = "; _ga=" wide fullword
		$b5 = "; _u=" wide fullword
		$b6 = "; __io=" wide fullword
		$b7 = "; _gid=" wide fullword
		$b8 = "%s%u" wide fullword
		$b9 = "i\\|9*" ascii fullword
		$b10 = "WinHttpSetStatusCallback" ascii fullword

	condition:
		all of ($a*) and 5 of ($b*)
}
rule ELASTIC_Windows_Trojan_Icedid_11D24D35 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Icedid (Windows.Trojan.IcedID)"
		author = "Elastic Security"
		id = "11d24d35-6bff-4fac-83d8-4d152aa0be57"
		date = "2022-02-16"
		modified = "2022-04-06"
		reference = "https://www.elastic.co/security-labs/thawing-the-permafrost-of-icedid-summary"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_IcedID.yar#L101-L121"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b8d794f6449669ff2d11bc635490d9efdd1f4e92fcb3be5cdb4b40e4470c0982"
		logic_hash = "4a5d0f37e3e80e370ae79fd45256dbd274ed8f8bcd021e8d6f95a0bc0bc5321f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "155e5df0f3f598cdc21e5c85bcf21c1574ae6788d5f7e0058be823c71d06c21e"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "C:\\Users\\user\\source\\repos\\anubis\\bin\\RELEASE\\loader_dll_64.pdb" ascii fullword
		$a2 = "loader_dll_64.dll" ascii fullword

	condition:
		1 of ($a*)
}
rule ELASTIC_Windows_Trojan_Icedid_0B62E783 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Icedid (Windows.Trojan.IcedID)"
		author = "Elastic Security"
		id = "0b62e783-5c1a-4377-8338-1c53194b8d01"
		date = "2022-04-06"
		modified = "2022-06-09"
		reference = "https://www.elastic.co/security-labs/thawing-the-permafrost-of-icedid-summary"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_IcedID.yar#L123-L142"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b9fb0a4c28613c556fb67a0b0e7c9d4c1236b60a161ad935e7387aec5911413a"
		logic_hash = "aca126529dfa8047ed7dfdc60d970759ab5307448d7d764f88e402cd8d2a016f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "2f473fbe6338d9663808f1a3615cf8f0f6f9780fbce8f4a3c24f0ddc5f43dd4a"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 89 44 95 E0 83 E0 07 8A C8 42 8B 44 85 E0 D3 C8 FF C0 42 89 44 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Icedid_91562D18 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Icedid (Windows.Trojan.IcedID)"
		author = "Elastic Security"
		id = "91562d18-28a1-4349-9e4b-92ad165510c9"
		date = "2022-04-06"
		modified = "2022-06-09"
		reference = "https://www.elastic.co/security-labs/thawing-the-permafrost-of-icedid-summary"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_IcedID.yar#L144-L163"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b9fb0a4c28613c556fb67a0b0e7c9d4c1236b60a161ad935e7387aec5911413a"
		logic_hash = "81c87d0d6726bc2dde42fe93c77af53cdd29bb6437fe3d47d1b4550140722c88"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "024bbd15da6bc759e321779881b466b500f6364a1d67bbfdc950aedccbfbc022"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 44 8B 4C 19 2C 4C 03 D6 74 1C 4D 85 C0 74 17 4D 85 C9 74 12 41 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Icedid_2086Aecb : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Icedid (Windows.Trojan.IcedID)"
		author = "Elastic Security"
		id = "2086aecb-161b-4102-89c7-580fb9ac3759"
		date = "2022-04-06"
		modified = "2022-03-02"
		reference = "https://www.elastic.co/security-labs/thawing-the-permafrost-of-icedid-summary"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_IcedID.yar#L165-L184"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b9fb0a4c28613c556fb67a0b0e7c9d4c1236b60a161ad935e7387aec5911413a"
		logic_hash = "561bf7eacfbbf1b4e0c111347f0d6ff4325bdbce8db73bee1ba836b610569c0d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a8b6cbb3140ff3e1105bb32a2da67831917caccc4985c485bbfdb0aa50016d86"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 4C 8D 05 [4] 42 8A 44 01 ?? 42 32 04 01 88 44 0D ?? 48 FF C1 48 83 F9 20 72 ?? }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Icedid_48029E37 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Icedid (Windows.Trojan.IcedID)"
		author = "Elastic Security"
		id = "48029e37-b392-4d53-b0de-2079f6a8a9d9"
		date = "2022-04-06"
		modified = "2022-06-09"
		reference = "https://www.elastic.co/security-labs/thawing-the-permafrost-of-icedid-summary"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_IcedID.yar#L186-L205"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b9fb0a4c28613c556fb67a0b0e7c9d4c1236b60a161ad935e7387aec5911413a"
		logic_hash = "1fe337d7a0607938aaf57cf25c1373aadf315b7a8cec133d6d30a38bd58e1027"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "375266b526fe14354550d000d3a10dde3f6a85e11f4ba5cab14d9e1f878de51e"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 48 C1 E3 10 0F 31 48 C1 E2 ?? 48 0B C2 0F B7 C8 48 0B D9 8B CB 83 E1 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Icedid_56459277 : FILE MEMORY {
    meta:
		description = "IcedID Gzip Variant Core"
		author = "Elastic Security"
		id = "56459277-432c-437c-9350-f5efaa60ffca"
		date = "2022-08-21"
		modified = "2023-03-02"
		reference = "https://www.elastic.co/security-labs/thawing-the-permafrost-of-icedid-summary"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_IcedID.yar#L207-L237"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "21b1a635db2723266af4b46539f67253171399830102167c607c6dbf83d6d41c"
		logic_hash = "a18557217c69a3bb8c3da7725d2e0ed849741f8e36341a4ea80eea09d47a5b45"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "503bfa6800e0f4ff1a0b56eb8a145e67fa0f387c84aee7bd2eca3cf7074be709"
		threat_name = "Windows.Trojan.IcedID"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$str1 = "cookie.tar" ascii fullword
		$str2 = "passff.tar" ascii fullword
		$str3 = "\\sqlite64.dll" ascii fullword
		$str4 = "Cookie: session=" ascii fullword
		$str5 = "{0ccac395-7d1d-4641-913a-7558812ddea2}" ascii fullword
		$str6 = "mail_vault" wide fullword
		$seq_decrypt_payload = { 42 0F B6 04 32 48 FF C2 03 C8 C1 C1 ?? 48 3B D7 72 ?? 44 33 F9 45 33 C9 44 89 3C 3B 48 85 FF 74 ?? 41 0F B6 D1 44 8D 42 01 83 E2 03 41 83 E0 03 }
		$seq_compute_hash = { 0F B6 4C 14 ?? 48 FF C2 8B C1 83 E1 ?? 48 C1 E8 ?? 41 0F B7 04 41 66 89 03 48 8D 5B ?? 41 0F B7 0C 49 66 89 4B ?? 48 83 FA ?? 72 ?? 66 44 89 03 B8 }
		$seq_format_string = { C1 E8 ?? 44 0B D8 41 0F B6 D0 8B C1 C1 E2 ?? C1 E1 ?? 25 [4] 0B C1 41 C1 E8 ?? 41 0F B6 CA 41 0B D0 44 8B 44 24 ?? C1 E0 ?? C1 E1 ?? 41 C1 EB ?? 44 0B D8 41 C1 EA ?? 0F B7 44 24 ?? 41 0B CA }
		$seq_custom_ror = { 41 8A C0 41 8A D0 02 C0 0F B6 C8 8A C1 44 8B C1 34 ?? 84 D2 0F B6 C8 44 0F 48 C1 49 83 EB }
		$seq_string_decrypt = { 0F B7 44 24 ?? 0F B7 4C 24 ?? 3B C1 7D ?? 8B 4C 24 ?? E8 [4] 89 44 24 ?? 0F B7 44 24 ?? 48 8B 4C 24 ?? 0F B6 04 01 0F B6 4C 24 ?? 33 C1 0F B7 4C 24 ?? 48 8B 54 24 ?? 88 04 0A EB }

	condition:
		5 of ($str*) or 2 of ($seq_*)
}
rule ELASTIC_Windows_Trojan_Icedid_7C1619E3 : FILE MEMORY {
    meta:
		description = "IcedID Injector Variant Loader "
		author = "Elastic Security"
		id = "7c1619e3-f94a-4a46-8a81-d5dd7a58c754"
		date = "2022-12-20"
		modified = "2023-02-01"
		reference = "https://www.elastic.co/security-labs/thawing-the-permafrost-of-icedid-summary"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_IcedID.yar#L239-L261"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "4f6de748628b8b06eeef3a5fabfe486bfd7aaa92f50dc5a8a8c70ec038cd33b1"
		logic_hash = "24ddaf474dabc5e91cce08734a035feced9048a3faac4ff236bc97e6caabd642"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ae21deaad74efaff5bec8c9010dc340118ac4c79e3bec190a7d3c3672a5a8583"
		threat_name = "Windows.Trojan.IcedID"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { C1 C9 0D 0F BE C0 03 C8 46 8A 06 84 C0 75 ?? 8B 74 24 ?? 81 F1 [4] 39 16 76 }
		$a2 = { D1 C8 F7 D0 D1 C8 2D 20 01 00 00 D1 C0 F7 D0 2D 01 91 00 00 }
		$a3 = { 8B 4E ?? FF 74 0B ?? 8B 44 0B ?? 03 C1 50 8B 44 0B ?? 03 46 ?? 50 E8 [4] 8B 46 ?? 8D 5B ?? 83 C4 0C 47 3B 78 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Icedid_D8B23Cd6 : FILE MEMORY {
    meta:
		description = "IcedID VNC server"
		author = "Elastic Security"
		id = "d8b23cd6-c20c-40c9-a8e9-80d68e709764"
		date = "2023-01-03"
		modified = "2023-01-03"
		reference = "https://www.elastic.co/security-labs/thawing-the-permafrost-of-icedid-summary"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_IcedID.yar#L263-L294"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "bd4da2f84c29437bc7efe9599a3a41f574105d449ac0d9b270faaca8795153ab"
		logic_hash = "47e427a4f088de523115f438cad9fc26233158b0518d87703c282df351110762"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "d47af2b50d0fb07858538fdb9f53fee008b49c9b1d015e4593199407673e0e21"
		threat_name = "Windows.Trojan.IcedID"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "User idle %u sec / Locked: %s / ScreenSaver: %s" wide
		$a2 = "No VNC HOOK" wide
		$a3 = "Webcam %u" wide
		$a4 = "rundll32.exe shell32.dll,#61"
		$a5 = "LAP WND"
		$a6 = "FG WND"
		$a7 = "CAP WND"
		$a8 = "HDESK Tmp" wide
		$a9 = "HDESK Bot" wide
		$a10 = "HDESK bot" wide
		$a11 = "CURSOR: %u, %u"
		$b1 = { 83 7C 24 ?? 00 75 ?? 83 7C 24 ?? 00 75 ?? [1] 8B 0D [4] 8B 44 24 }

	condition:
		6 of them
}
rule ELASTIC_Windows_Trojan_Icedid_A2Ca5F80 : FILE MEMORY {
    meta:
		description = "IcedID Injector Variant Core"
		author = "Elastic Security"
		id = "a2ca5f80-85b1-4502-8794-b8b4ea1be482"
		date = "2023-01-16"
		modified = "2023-04-23"
		reference = "https://www.elastic.co/security-labs/thawing-the-permafrost-of-icedid-summary"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_IcedID.yar#L296-L323"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "e36266cd66b9542f2eb9d38f9a01f7b480f2bcdbe61fe20944dca33e22bd3281"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "dfbacf63b91315e5acf168b57bf18283ba30f681f5b3d3835418d0d32d238854"
		threat_name = "Windows.Trojan.Icedid"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "EMPTY"
		$a2 = "CLEAR"
		$a3 = { 66 C7 06 6D 3D 83 C6 02 0F B6 05 [4] 50 68 34 73 00 10 56 FF D7 03 F0 66 C7 06 26 6A C6 46 ?? 3D 83 C6 03 }
		$a4 = { 8B 46 ?? 6A 00 FF 76 ?? F7 D8 FF 76 ?? 1B C0 FF 76 ?? 50 FF 76 ?? 53 FF 15 }
		$a5 = { 8D 44 24 ?? 89 7C 24 ?? 89 44 24 ?? 33 F6 B8 BB 01 00 00 46 55 66 89 44 24 ?? 89 74 24 ?? E8 [4] 89 44 24 ?? 85 C0 74 ?? 8B AC 24 }
		$a6 = { 8A 01 88 45 ?? 45 41 83 EE 01 75 ?? 8B B4 24 [4] 8B 7E }
		$a7 = { 53 E8 [4] 8B D8 30 1C 2F 45 59 3B EE 72 }
		$a8 = { 8B 1D [4] 33 D9 6A 00 53 52 E8 [4] 83 C4 0C 89 44 24 ?? 85 C0 0F 84 }
		$a9 = { C1 C9 0D 0F BE C0 03 C8 46 8A 06 }

	condition:
		4 of them
}
rule ELASTIC_Windows_Trojan_Icedid_B8C59889 : FILE MEMORY {
    meta:
		description = "IcedID fork init loader"
		author = "Elastic Security"
		id = "b8c59889-2cc6-49c6-a81a-4bc36f3b1f6f"
		date = "2023-05-05"
		modified = "2023-06-13"
		reference = "https://www.elastic.co/security-labs/thawing-the-permafrost-of-icedid-summary"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_IcedID.yar#L325-L349"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a63d08cd53053bfda17b8707ab3a94cf3d6021097335dc40d5d211fb9faed045"
		logic_hash = "08c6c604d1791c35a8494e5ec8a96e8c5dd2ca3d6c57971da20057ce8960fa1d"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "2f15ed0bc186b83a298eb51b43f10aa46ce6654ea9312a9529d36fc4cff05d4c"
		threat_name = "Windows.Trojan.IcedID"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "{%0.8X-%0.4X-%0.4X-%0.4X-%0.4X%0.8X}" wide fullword
		$a2 = "\\1.bin" wide fullword
		$a3 = "c:\\ProgramData" wide fullword
		$a4 = "Loader.dll" ascii fullword
		$seq_crypto = { 83 E1 03 83 E0 03 48 8D 14 8A 41 8B 0C 80 4D 8D 04 80 41 0F B6 00 83 E1 07 02 02 41 32 04 29 41 88 04 19 49 FF C1 8B 02 }

	condition:
		4 of ($a*) or 1 of ($seq*)
}
rule ELASTIC_Windows_Trojan_Icedid_81Eff9A3 : FILE MEMORY {
    meta:
		description = "IcedID fork core bot loader"
		author = "Elastic Security"
		id = "81eff9a3-4c75-48a5-8160-718c9a2d1e14"
		date = "2023-05-05"
		modified = "2023-06-13"
		reference = "https://www.elastic.co/security-labs/thawing-the-permafrost-of-icedid-summary"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_IcedID.yar#L351-L371"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "96dacdf50d1db495c8395d7cf454aa3a824801cf366ac368fe496f89b5f98fe7"
		logic_hash = "923dd8166cce0ec32b3b8b20cad192b3c15b7ce7c17fd44ddda739ad205a6c06"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f764c4b2a562eb92a7326a45b180da7f930ffcc4f0b88bbd640c2fe7b71f82b6"
		threat_name = "Windows.Trojan.IcedID"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = "E:\\source\\anubis\\int-bot\\x64\\Release\\int-bot.pdb" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Hellokitty_8859E8E8 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Hellokitty (Windows.Ransomware.Hellokitty)"
		author = "Elastic Security"
		id = "8859e8e8-f94c-4853-b296-1fc801486c57"
		date = "2021-05-03"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Hellokitty.yar#L1-L32"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "3ae7bedf236d4e53a33f3a3e1e80eae2d93e91b1988da2f7fcb8fde5dcc3a0e9"
		logic_hash = "72cc718724d9d9a391a9f7a0932ebf397c2ab79558437533bef6e380b06baff9"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f9791409d2a058dd68dc09df5e4b597c6c6a1f0da9801d7ab9e678577b621730"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "HelloKittyMutex" wide fullword
		$a2 = "%s\\read_me_lkd.txt" wide fullword
		$a3 = "Win32_ShadowCopy.ID='%s'" wide fullword
		$a4 = "Trying to decrypt or modify the files with programs other than our decryptor can lead to permanent loss of data!" wide fullword
		$a5 = "%s/secret/%S" wide fullword
		$a6 = "DECRYPT_NOTE.txt" wide fullword
		$a7 = "Some data has been stored in our servers and ready for publish." wide fullword
		$a9 = "To contact with us you have ONE week from the encryption time, after decryption keys and your personal contact link will be dele" wide
		$a10 = "In case of your disregard, we reserve the right to dispose of the dumped data at our discretion including publishing." wide fullword
		$a11 = "IMPORTANT: Don't modify encrypted files or you can damage them and decryption will be impossible!" wide fullword
		$b1 = "/f /im \"%s\"" wide fullword
		$b2 = "stop \"%s\"" wide fullword
		$b3 = "/f /im %s" wide fullword
		$b4 = "stop %s" wide fullword

	condition:
		(2 of ($a*) and 2 of ($b*)) or (5 of ($a*))
}
rule ELASTIC_Windows_Ransomware_Hellokitty_4B668121 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Hellokitty (Windows.Ransomware.Hellokitty)"
		author = "Elastic Security"
		id = "4b668121-cc21-4f0b-b0fc-c2b5b4cb53e8"
		date = "2021-05-03"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Hellokitty.yar#L34-L59"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9a7daafc56300bd94ceef23eac56a0735b63ec6b9a7a409fb5a9b63efe1aa0b0"
		logic_hash = "00c7a492c304f12b9909e35cf069618a1103311a69e3e8951ca196c3c663b12a"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "834316ce0f3225b1654b3c4bccb673c9ad815e422276f61e929d5440ca51a9fa"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "(%d) [%d] %s: STOP DOUBLE PROCESS RUN" ascii fullword
		$a2 = "(%d) [%d] %s: Looking for folder from cmd: %S" ascii fullword
		$a3 = "(%d) [%d] %s: ERROR: Failed to encrypt AES block" ascii fullword
		$a4 = "gHelloKittyMutex" wide fullword
		$a5 = "/C ping 127.0.0.1 & del %s" wide fullword
		$a6 = "Trying to decrypt or modify the files with programs other than our decryptor can lead to permanent loss of data!"
		$a7 = "read_me_lkdtt.txt" wide fullword
		$a8 = "If you want to get it, you must pay us some money and we will help you." wide fullword

	condition:
		5 of them
}
rule ELASTIC_Windows_Ransomware_Hellokitty_D9391A1A : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Hellokitty (Windows.Ransomware.Hellokitty)"
		author = "Elastic Security"
		id = "d9391a1a-78d3-4ae6-8e45-630ceec8bade"
		date = "2021-05-03"
		modified = "2023-01-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Hellokitty.yar#L61-L80"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "10887d13dba1f83ef34e047455a04416d25a83079a7f3798ce3483e0526e3768"
		logic_hash = "074ca47c0526d9828f3c07c7d6dbdd1cec609670d70340b022ae2c712ad80305"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "8779a926a237af0a966534931b60acd54f5d6d65063c070a3621ec604e280ff8"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 C4 04 85 DB 75 12 0F 10 45 D4 83 C7 10 0F 11 06 83 C6 10 83 }
		$a2 = { 89 45 F8 3B 5D F4 75 25 3B C6 75 21 6A FF FF 75 14 8B D1 83 }

	condition:
		any of them
}
rule ELASTIC_Windows_Ransomware_Cuba_E64A16B1 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Cuba (Windows.Ransomware.Cuba)"
		author = "Elastic Security"
		id = "e64a16b1-262c-4835-bd95-4dde89dd75f4"
		date = "2021-08-04"
		modified = "2021-10-04"
		reference = "https://www.elastic.co/security-labs/cuba-ransomware-campaign-analysis"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Cuba.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "33352a38454cfc247bc7465bf177f5f97d7fd0bd220103d4422c8ec45b4d3d0e"
		logic_hash = "915425ad49f1b9ebde114f92155d5969ec707304403f46d891d014b399165a4d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "840f2ebe2664db9a0918acf7d408ca8060ee0d3c330ad08b36e5be7f7e2cf069"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 45 EC 8B F9 8B 45 14 89 45 F0 8D 45 E4 50 8D 45 F8 66 0F 13 }
		$HeaderCheck = { 8B 06 81 38 46 49 44 45 75 ?? 81 78 04 4C 2E 43 41 74 }

	condition:
		any of them
}
rule ELASTIC_Windows_Ransomware_Cuba_95A98E69 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Cuba (Windows.Ransomware.Cuba)"
		author = "Elastic Security"
		id = "95a98e69-ce6c-40c6-a05b-2366c663ad6e"
		date = "2021-08-04"
		modified = "2021-10-04"
		reference = "https://www.elastic.co/security-labs/cuba-ransomware-campaign-analysis"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Cuba.yar#L23-L44"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "00f18713f860dc8394fb23a1a2b6280d1eb2f20a487c175433a7b495a1ba408d"
		logic_hash = "d17ef93943e826613be4c21ad1e41d1daa33db9da0fa6106bb8ba6334ebe1d08"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "05cfd7803692149a55d9ced84828422b66e8b301c8c2aae9ca33c6b68e29bcf8"
		severity = 90
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "We also inform that your databases, ftp server and file server were downloaded by us to our servers." ascii fullword
		$a2 = "Good day. All your files are encrypted. For decryption contact us." ascii fullword
		$a3 = ".cuba" wide fullword

	condition:
		all of them
}
rule ELASTIC_Multi_Hacktool_Rakshasa_D5D3Ef21 : FILE MEMORY {
    meta:
		description = "Detects Multi Hacktool Rakshasa (Multi.Hacktool.Rakshasa)"
		author = "Elastic Security"
		id = "d5d3ef21-e004-4cb4-8f9f-541e831c8e08"
		date = "2024-01-24"
		modified = "2024-01-29"
		reference = "https://www.elastic.co/security-labs/unmasking-financial-services-intrusion-ref0657"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Hacktool_Rakshasa.yar#L1-L24"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ccfa30a40445d5237aaee1e015ecfcd9bdbe7665a6dc2736b28e5ebf07ec4597"
		logic_hash = "123cbea0ce02012a9b22a4a241d11aa9acbb58b50a1bd9228da7cadbf0fa1b4e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "bd25f85a419679d2278e2e3951531950296785ac888bc69b513bab0a9936eacf"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$a1 = { 35 B8 00 00 00 48 89 74 24 38 48 89 5C 24 40 48 89 4C 24 48 48 89 54 }
		$a2 = "rakshasa/server.init.4.func2" ascii fullword
		$a3 = "type..eq.rakshasa/server.Conn" ascii fullword
		$a4 = "rakshasa_lite/aes.Str2bytes" ascii fullword
		$a5 = "rakshasa_lite/server.doShellcode" ascii fullword

	condition:
		2 of them
}
rule ELASTIC_Windows_Trojan_Sythe_02B2811A : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Sythe (Windows.Trojan.Sythe)"
		author = "Elastic Security"
		id = "02b2811a-2ced-42b6-a9f1-6d983d1dc986"
		date = "2023-05-10"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Sythe.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "2d54a8ba40cc9a1c74db7a889bc75a38f16ae2d025268aa07851c1948daa1b4d"
		logic_hash = "ba472b35f583dd4cf125df575129d07de289d6d7dc12ecdcc518ce1eb9f18def"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "4dd9764e285985fbea5361e5edfa04e75fb8e3e7945cbbf712ea0183471e67ae"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "loadmodule"
		$a2 = "--privileges"
		$a3 = "--shutdown"
		$a4 = "SetClientThreadID"

	condition:
		all of them
}
rule ELASTIC_Windows_Hacktool_Executeassembly_F41F4Df6 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Executeassembly (Windows.Hacktool.ExecuteAssembly)"
		author = "Elastic Security"
		id = "f41f4df6-03de-4a03-9dfa-4f9d0f51c2de"
		date = "2023-03-28"
		modified = "2023-04-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_ExecuteAssembly.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a468ba2ba77aafa2a572c8947d414e74604a7c1c6e68a0b87fbfce4f8854dd61"
		logic_hash = "ab72dec636a96338e16fd57f2db4bb52e38fe61315b42c2ffe9c4566fc0326d3"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "4875f516551517ec9423f04a9636b65fc717b9e2c9c40379b027ab126e593d23"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$bytes0 = { 33 D8 8B C3 C1 E8 05 03 D8 8B C3 C1 E0 04 33 D8 8B C3 C1 E8 11 03 D8 8B C3 C1 E0 19 33 D8 8B C3 C1 E8 06 03 C3 }
		$bytes1 = { 81 F9 8E 4E 0E EC 74 10 81 F9 AA FC 0D 7C 74 08 81 F9 54 CA AF 91 75 43 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Modpipe_12Bc2604 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Modpipe (Windows.Trojan.ModPipe)"
		author = "Elastic Security"
		id = "12bc2604-d3fe-40d6-8a7c-5bd53e403453"
		date = "2023-07-27"
		modified = "2023-09-20"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_ModPipe.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "0a26de1b2fb48d65cde61b60c0eba478da73a3eeaeb785d1b2d6095eccbe34e2"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "30ff9f28cec84496ae7c809ec0401bc10573c690d93f3fb3865b5a913508795e"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/4.0)" fullword
		$a2 = "/robots.txt" fullword
		$a3 = "www.yahoo.com/?"
		$a4 = "www.google.com/?"

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Makop_3Ac2C13C : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Makop (Windows.Ransomware.Makop)"
		author = "Elastic Security"
		id = "3ac2c13c-45f0-4108-81fb-e57c3cc0e622"
		date = "2021-08-05"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Makop.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "854226fc4f5388d40cd9e7312797dd63739444d69a67e4126ef60817fa6972ad"
		logic_hash = "3fa7c506010a87ac97f415db32c21af091dff26fd912a8f9f5bb5e8d43a8da9e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "4658a5b34ecb2a7432b7ab48041cc064d917b88a4673f21aa6c3c44b115c9b8c"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 20 00 75 15 8B 44 24 10 8B 4C 24 08 8B 54 24 0C 89 46 20 89 }

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Makop_3E388338 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Makop (Windows.Ransomware.Makop)"
		author = "Elastic Security"
		id = "3e388338-83c7-453c-b865-13f3bd059515"
		date = "2021-08-05"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Makop.yar#L21-L44"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "854226fc4f5388d40cd9e7312797dd63739444d69a67e4126ef60817fa6972ad"
		logic_hash = "5a6e5fd725f3d042c0c95b42ad00c93965a49aa6bda6ec5383a239f18d74742e"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "7920469120a69fed191c5068739ed922dcf67aa26d68e44708a1d63dc0931bc3"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "MPR.dll" ascii fullword
		$a2 = "\"%s\" n%u" wide fullword
		$a3 = "\\\\.\\%c:" wide fullword
		$a4 = "%s\\%s\\%s" wide fullword
		$a5 = "%s\\%s" wide fullword
		$a6 = "Start folder" wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Darkgate_Fa1F1338 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Darkgate (Windows.Trojan.DarkGate)"
		author = "Elastic Security"
		id = "fa1f1338-c920-4db9-a7ec-cd11d7e1558b"
		date = "2023-12-14"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_DarkGate.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1fce9ee9254dd0641387cc3b6ea5f6a60f4753132c20ca03ce4eed2aa1042876"
		logic_hash = "d5447a57fc57af52c263b84522346a3e94a464a698de8be77eab3b56156164f2"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "182481e23eb10f0a8b7d0d536e2d8d36ab5e51fd798caebff4d38d55b5549244"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$str0 = "DarkGate has recovered from a Critical error"
		$str1 = "Executing DarkGate inside the new desktop..."
		$str2 = "Restart Darkgate "

	condition:
		2 of them
}
rule ELASTIC_Windows_Trojan_Darkgate_07Ef6F14 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Darkgate (Windows.Trojan.DarkGate)"
		author = "Elastic Security"
		id = "07ef6f14-4eb5-4c15-94af-117c68106104"
		date = "2023-12-14"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_DarkGate.yar#L23-L42"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1fce9ee9254dd0641387cc3b6ea5f6a60f4753132c20ca03ce4eed2aa1042876"
		logic_hash = "2820286b362b107fc7fc3ec8f1a004a7d7926a84318f2943f58239f1f7e8f1f0"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "fd0aab53bddd3872147aa064a571d118cc00a6643d72c017fe26f6e0d19288e1"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$binary0 = { 8B 04 24 0F B6 44 18 FF 33 F8 43 4E }
		$binary1 = { 8B D7 32 54 1D FF F6 D2 88 54 18 FF 43 4E }

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Magniber_Ea0140A1 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Magniber (Windows.Ransomware.Magniber)"
		author = "Elastic Security"
		id = "ea0140a1-b745-47f1-871f-5b703174a049"
		date = "2021-08-03"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Magniber.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a2448b93d7c50801056052fb429d04bcf94a478a0a012191d60e595fed63eec4"
		logic_hash = "e2c05e2c92444d7bcb2bf68e97f809072d2ccdc8a171214d2e7a498b20d08f90"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b3c17024097af846f800a843da404dccb6d33eebb90a8524f2f2ec8a5c5df776"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 58 C0 FF 24 4C 8B F0 48 89 45 18 E8 E2 F5 FF FF B9 A1 BD D1 CF 48 89 45 B8 E8 D4 F5 FF FF B9 52 C6 D7 0E 48 89 45 F8 E8 C6 F5 FF FF B9 43 AC 95 0E 48 89 45 B0 E8 B8 F5 FF FF B9 78 D4 33 27 4C 8B F8 48 89 45 D0 E8 A7 F5 FF FF B9 FE 36 04 DE 48 89 44 24 50 E8 98 F5 FF FF B9 51 23 2E F2 48 89 45 10 E8 8A F5 FF FF B9 DA F6 8A 50 48 89 45 08 E8 7C F5 FF FF B9 AD 9E 5F BB 48 89 45 20 E8 6E F5 FF FF B9 2D 57 AE 5B 48 89 45 A0 E8 60 F5 FF FF B9 C6 96 87 52 48 89 45 C8 E8 52 F5 FF FF B9 F6 76 0F 52 48 89 45 A8 E8 44 F5 FF FF B9 A3 FC 62 AA 48 8B F0 48 89 45 98 E8 33 F5 }

	condition:
		any of them
}
rule ELASTIC_Windows_Ransomware_Magniber_97D7575B : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Magniber (Windows.Ransomware.Magniber)"
		author = "Elastic Security"
		id = "97d7575b-8fc7-4c6b-8371-b62842d90613"
		date = "2021-08-03"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Magniber.yar#L21-L39"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a2448b93d7c50801056052fb429d04bcf94a478a0a012191d60e595fed63eec4"
		logic_hash = "9c85f98aaae28e9e90a94d6ce18389467013ea6b569f46f6acaf26a6c7e027fc"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "78253be69d9715892ec725918c3c856040323b83aeab8b84c4aac47355876207"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 00 4C 00 4C 00 20 00 59 00 4F 00 55 00 52 00 20 00 44 00 4F 00 43 00 55 00 4D 00 45 00 4E 00 54 00 53 00 20 00 50 00 48 00 4F 00 54 00 4F 00 53 00 20 00 44 00 41 00 54 00 41 00 42 00 41 00 53 00 45 00 53 00 20 00 41 00 4E 00 44 00 20 00 4F 00 54 00 48 00 45 00 52 00 20 00 49 00 4D 00 50 00 4F 00 52 00 54 00 41 00 4E 00 54 00 20 00 46 00 49 00 4C 00 45 00 53 00 20 00 48 00 41 00 56 00 45 00 20 00 42 00 45 00 45 00 4E 00 20 00 45 00 4E 00 43 00 52 00 59 00 50 00 54 00 45 00 44 00 21 00 0D }

	condition:
		any of them
}
rule ELASTIC_Windows_Ransomware_Pandora_Bca8Ce23 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Pandora (Windows.Ransomware.Pandora)"
		author = "Elastic Security"
		id = "bca8ce23-6722-4cda-b5fa-623eda4fca1b"
		date = "2022-03-14"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Pandora.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "2c940a35025dd3847f7c954a282f65e9c2312d2ada28686f9d1dc73d1c500224"
		logic_hash = "52203c1af994667ba6833defe547e886dd02167e4d76c57711080e3be0473bfc"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0da732f6bdf24f35dee3c1bf85435650a5ce9b5c6a93f01176659943c01ad711"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "/c vssadmin.exe delete shadows /all /quiet" wide fullword
		$a2 = "\\Restore_My_Files.txt" wide fullword
		$a3 = ".pandora" wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Haron_A1C12E7E : FILE MEMORY {
    meta:
		description = "Direct overlap with Thanos/Avaddon"
		author = "Elastic Security"
		id = "a1c12e7e-a740-4d26-a0ed-310a2b03fe50"
		date = "2021-08-03"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Haron.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6e6b78a1df17d6718daa857827a2a364b7627d9bfd6672406ad72b276014209c"
		logic_hash = "84df5a13495acee5dc2007cf1d6e1828a832d46fcbad2ca8676643fd47756248"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "c6abe96bd2848bb489f856373356dbad3fca273e9d71394ec22960070557ad11"
		threat_name = "Windows.Ransomware.Haron"
		severity = 90
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 00 04 28 0E 00 00 0A 06 FE 06 2A 00 00 06 73 0F 00 00 0A 28 }

	condition:
		any of them
}
rule ELASTIC_Windows_Ransomware_Haron_23B76Cb7 : FILE MEMORY {
    meta:
		description = "Direct overlap with Thanos/Avaddon"
		author = "Elastic Security"
		id = "23b76cb7-6f96-4012-ad66-2e4e4ae744a9"
		date = "2021-08-03"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Haron.yar#L22-L41"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6e6b78a1df17d6718daa857827a2a364b7627d9bfd6672406ad72b276014209c"
		logic_hash = "e53c92be617444da0057680ee1ac45cbc1f707194281644bececa44e4ebe3580"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "9dc91a56ef17873f3e833d85fa947facde741d80a574ae911261e553a40a2731"
		threat_name = "Windows.Ransomware.Haron"
		severity = 90
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 0A 28 06 00 00 06 26 DE 0A 08 2C 06 08 6F 48 00 00 0A DC DE }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Oskistealer_A158B1E3 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Oskistealer (Windows.Trojan.OskiStealer)"
		author = "Elastic Security"
		id = "a158b1e3-21b7-4009-9646-6bee9bde98ad"
		date = "2022-03-21"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_OskiStealer.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "568cd515c9a3bce7ef21520761b02cbfc95d8884d5b2dc38fc352af92356c694"
		logic_hash = "0ddbe0b234ed60f5a3fc537cdaebf39f639ee24fd66143c9036a9f4786d4c51b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "3996a89d37494b118654f3713393f415c662850a5a76afa00e83f9611aee3221"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "\"os_crypt\":{\"encrypted_key\":\"" ascii fullword
		$a2 = "%s / %s" ascii fullword
		$a3 = "outlook.txt" ascii fullword
		$a4 = "GLoX6gmCFw==" ascii fullword
		$a5 = "KaoQpEzKSjGm8Q==" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Doppelpaymer_6660D29F : BETA FILE MEMORY {
    meta:
		description = "Identifies DOPPELPAYMER ransomware"
		author = "Elastic Security"
		id = "6660d29f-aca9-4156-90a0-ce64fded281a"
		date = "2020-06-28"
		modified = "2021-08-23"
		reference = "https://www.crowdstrike.com/blog/doppelpaymer-ransomware-and-dridex-2/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Doppelpaymer.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "4c12eaa44f82c6f729e51242c9c1836eb1856959c682e2d2e21b975104c197b6"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "8bf4d098b8ce9da99a2ca13fa0759a7185ade1b3ab3b281cd15749d68546d130"
		threat_name = "Windows.Ransomware.Doppelpaymer"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Setup run" wide fullword
		$a2 = "RtlComputeCrc32" ascii fullword

	condition:
		2 of ($a*)
}
rule ELASTIC_Windows_Ransomware_Doppelpaymer_6Ab188Da : BETA FILE MEMORY {
    meta:
		description = "Identifies DOPPELPAYMER ransomware"
		author = "Elastic Security"
		id = "6ab188da-4e73-4669-816c-554b2f04ee65"
		date = "2020-06-28"
		modified = "2021-08-23"
		reference = "https://www.crowdstrike.com/blog/doppelpaymer-ransomware-and-dridex-2/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Doppelpaymer.yar#L23-L42"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "429c87d293b7f517a594e8be020cbe7f8302a8b6eb8337f090ca18973aafbde4"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "6c33e09e66b337064a1feae5c162f72dc5f6caecaa9829e4ad9fffb10ef3e576"
		threat_name = "Windows.Ransomware.Doppelpaymer"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$d1 = { 56 55 55 55 F7 EF B8 56 55 55 55 8B EA F7 E9 8B C2 8B D1 C1 FA 1F 2B C2 C1 FF 1F 2B EF 8D 14 40 B8 F3 1A CA 6B 2B CA 03 E9 F7 ED 8B CD C1 FA 05 C1 F9 1F 2B D1 6B CA B4 03 CD 74 1C 81 E1 03 00 00 80 7D 07 83 E9 01 83 C9 FC 41 8B C1 F7 D8 85 C9 8D 7C 05 04 0F 45 EF 8D 44 55 02 5D 5F C3 }

	condition:
		1 of ($d*)
}
rule ELASTIC_Windows_Ransomware_Doppelpaymer_4Fb1A155 : BETA FILE MEMORY {
    meta:
		description = "Identifies DOPPELPAYMER ransomware"
		author = "Elastic Security"
		id = "4fb1a155-6448-41e9-829a-e765b7c2570e"
		date = "2020-06-28"
		modified = "2021-08-23"
		reference = "https://www.crowdstrike.com/blog/doppelpaymer-ransomware-and-dridex-2/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Doppelpaymer.yar#L44-L63"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "eb041a836b2bc73312a2f87523d817d5274f3d43d3e5fe6aacfad1399c61a9de"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "f7c1bb3e9d1ad02e7c4edf8accf326330331f92a0f1184bbc19c5bde7505e545"
		threat_name = "Windows.Ransomware.Doppelpaymer"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$c1 = { 83 EC 64 8B E9 8B 44 24 ?? 8B 00 0F B7 10 83 FA 5C 75 }

	condition:
		1 of ($c*)
}
rule ELASTIC_Windows_Trojan_Limerat_24269A79 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Limerat (Windows.Trojan.Limerat)"
		author = "Elastic Security"
		id = "24269a79-0172-4da5-9b4d-f61327072bf0"
		date = "2021-08-17"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Limerat.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ec781a714d6bc6fac48d59890d9ae594ffd4dbc95710f2da1f1aa3d5b87b9e01"
		logic_hash = "053a6abe589db23c4b9baed24729c8bcdd9019535fd0d9efc60ab4035c9779f3"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "cb714cd787519216d25edaad9f89a9c0ce1b8fbbbcdf90bda4c79f5d85fdf381"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "schtasks /create /f /sc ONLOGON /RL HIGHEST /tn LimeRAT-Admin /tr \"'" wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Egregor_F24023F3 : BETA FILE MEMORY {
    meta:
		description = "Identifies EGREGOR (Sekhemt) ransomware"
		author = "Elastic Security"
		id = "f24023f3-c887-42fc-8927-cdbd04b5f84f"
		date = "2020-10-15"
		modified = "2021-08-23"
		reference = "https://www.bankinfosecurity.com/egregor-ransomware-adds-to-data-leak-trend-a-15110"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Egregor.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "5695b44f6ce018a91a99b6c94feae740ff4ac187e232bc9044e51d62d1f42bfa"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "3a82a548658e0823678ec9d633774018ddc6588f5e2fbce74826a46ce9c43c40"
		threat_name = "Windows.Ransomware.Egregor"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "M:\\sc\\p\\testbuild.pdb" ascii fullword
		$a2 = "C:\\Logmein\\{888-8888-9999}\\Logmein.log" wide fullword
		$a3 = "nIcG`]/h3kpJ0QEAC5OJC|<eT}}\\5K|h\\\\v<=lKfHKO~01=Lo0C03icERjo0J|/+|=P0<UeN|e2F@GpTe]|wpMP`AG+IFVCVbAErvTeBRgUN1vQHNp5FVtc1WVi/G"
		$a4 = "pVrGRgJui@6ejnOu@4KgacOarSh|firCToW1LoF]7BtmQ@2j|hup2owUHQ6W}\\U3gwV6OwSPTMQVq2|G=GKrHpjOqk~`Ba<qu\\2]r0RKkf/HGngsK7LhtvtJiR}+4J"
		$a5 = "Your network was ATTACKED, your computers and servers were LOCKED," ascii wide
		$a6 = "Do not redact this special technical block, we need this to authorize you." ascii wide

	condition:
		2 of ($a*)
}
rule ELASTIC_Windows_Ransomware_Egregor_4Ec2B90C : BETA FILE MEMORY {
    meta:
		description = "Identifies EGREGOR (Sekhemt) ransomware"
		author = "Elastic Security"
		id = "4ec2b90c-b2de-463d-a9c6-478c255c2352"
		date = "2020-10-15"
		modified = "2021-08-23"
		reference = "https://www.bankinfosecurity.com/egregor-ransomware-adds-to-data-leak-trend-a-15110"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Egregor.yar#L27-L48"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "8342d92e1486b1289645828e5ee5f1f6f21a0e645dd7cc4eca908ed59c2f1c4c"
		score = 75
		quality = 73
		tags = "BETA, FILE, MEMORY"
		fingerprint = "6ae13632f50af11626250c30f570370da23deb265ff6c1fefd2e294c8c170998"
		threat_name = "Windows.Ransomware.Egregor"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$b1 = { 18 F5 46 E0 5C 94 28 B3 5C 94 28 B3 5C 94 28 B3 E8 08 D9 B3 55 94 28 B3 E8 08 DB B3 29 94 28 B3 E8 08 DA B3 44 94 28 B3 67 CA 2B B2 4D 94 28 B3 67 CA 2D B2 47 94 28 B3 67 CA 2C B2 4C 94 28 B3 81 6B E3 B3 5F 94 28 B3 5C 94 29 B3 02 94 28 B3 5C 94 28 B3 5F 94 28 B3 CE CA 28 B2 5D 94 28 B3 CE CA 2A B2 5D 94 28 B3 }
		$b2 = { 34 4F 51 46 33 5C 45 6A 75 5E 7E 4E 37 53 49 7C 49 50 4B 32 73 43 47 5E 68 43 42 4E 7C 42 30 48 62 4C 34 6D 3C 2F 36 76 3D 43 5D 6B 4F 30 32 6E 60 35 68 40 33 60 4B 47 6F 33 55 36 71 56 4A 3D 40 5C 6A 69 4B 4A 60 5C 35 2B 6B 40 33 31 5C 63 7D 4A 47 42 51 5D 70 54 68 7D 62 32 4B 72 6A 57 3C 71 }
		$b3 = { BB 05 10 D4 BB 05 10 E0 BB 05 10 EC BB 05 10 F8 BB 05 10 04 BC 05 10 10 BC 05 10 1C BC 05 10 2C BC 05 10 3C BC 05 10 50 BC 05 10 68 BC 05 10 80 BC 05 10 90 BC 05 10 A8 BC 05 10 B4 BC 05 10 C0 }

	condition:
		1 of ($b*)
}
rule ELASTIC_Windows_Trojan_Metastealer_F94E2464 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Metastealer (Windows.Trojan.MetaStealer)"
		author = "Elastic Security"
		id = "f94e2464-b41a-46fd-89c1-335aa8c14425"
		date = "2024-03-27"
		modified = "2024-05-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_MetaStealer.yar#L1-L34"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "14ca15c0751207103c38f1a2f8fdc73e5dd3d58772f6e5641e54e0c790ecd132"
		logic_hash = "bf374bda2ca7c7bcec1ff092bbc9c3fd95c33faa78a6ea105a7b12b8e80a2e23"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "fb35feaf8e2d0994d022da1c8e872dc8b05b04e25ab6fed2ed1997267edfccd9"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$string1 = "AvailableLanguages" fullword
		$string2 = "GetGraphicCards" fullword
		$string3 = "GetVs" fullword
		$string4 = "GetSerialNumber" fullword
		$string5 = "net.tcp://" wide
		$string6 = "AntivirusProduct|AntiSpyWareProduct|FirewallProduct" wide
		$string7 = "wallet.dat" wide
		$string8 = "[A-Za-z\\d]{24}\\.[\\w-]{6}\\.[\\w-]{27}" wide
		$string9 = "Software\\Valve\\Steam" wide
		$string10 = "{0}\\FileZilla\\recentservers.xml" wide
		$string11 = "{0}\\FileZilla\\sitemanager.xml" wide
		$string12 = "([a-zA-Z0-9]{1000,1500})" wide
		$string13 = "\\qemu-ga.exe" wide
		$string14 = "metaData" wide
		$string15 = "%DSK_23%" wide
		$string16 = "CollectMemory" fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Metastealer_A07E395C : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Metastealer (Windows.Trojan.MetaStealer)"
		author = "Elastic Security"
		id = "a07e395c-121d-46fe-ab65-d28eb9b83e9d"
		date = "2024-10-23"
		modified = "2024-10-29"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_MetaStealer.yar#L36-L56"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "973a9056040af402d6f92f436a287ea164fae09c263f80aba0b8d5366ed9957a"
		logic_hash = "2464cf1dc5747c93598354329371ea6111c3cbf34a6db83076c9465b867a0e47"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "0ac013d500d3c72be3ec22bf05929ad583f3148634188a2d583bdc1a841c03e1"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$b = "SeImpersonatePrivilege" wide fullword
		$d = { 34 36 33 41 42 45 43 46 2D 34 31 30 44 2D 34 30 37 46 2D 38 41 46 35 2D 30 44 46 33 35 41 30 30 35 43 43 38 }
		$e = { 25 1F 0F 5F 0C 1A 63 1F 0F 5F 0D 09 1F 09 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Bc6Ae28D : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "bc6ae28d-050b-43d9-ba57-82fb37a2bc91"
		date = "2023-12-01"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ce00873eb423c0259c18157a07bf7fd9b07333e528a5b9d48be79194310c9d97"
		logic_hash = "0ca5ec945858a5238eac048520dea4597f706ad2c96be322d341c84c4ddbce33"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "40a45e5b109a9b48cecd95899ff6350af5d28deb1c6f3aa4f0363ed3abf62bf7"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 24 83 79 08 00 75 19 DD 01 8D 45 DC 50 51 51 DD 1C 24 E8 DB FC FF FF 85 C0 74 05 8B 45 F0 C9 C3 83 C8 FF C9 C3 55 8B EC 83 EC 24 83 79 08 00 75 19 DD 01 8D 45 DC 50 51 51 DD 1C }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Ce98C4Bc : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "ce98c4bc-22bb-4c2b-bced-8fc36bd3a2f0"
		date = "2023-12-17"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L21-L40"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "950e8a29f516ef3cf1a81501e97fbbbedb289ad9fb93352edb563f749378da35"
		logic_hash = "74914f41c03cb2dcb1dc3175cc76574a0d40b66a1a3854af8f50c9858704b66b"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "d0849208c71c1845a6319052474549dba8514ecf7efe6185c1af22ad151bdce7"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 4D 65 73 73 61 67 65 50 61 63 6B 4C 69 62 2E 4D 65 73 73 61 67 65 50 61 63 6B }
		$a2 = { 43 6C 69 65 6E 74 2E 41 6C 67 6F 72 69 74 68 6D }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_0Cc1481E : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "0cc1481e-d666-4443-852c-679ef59e4ee4"
		date = "2023-12-17"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L42-L60"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6ec7781e472a6827c1406a53ed4699407659bd57c33dd4ab51cabfe8ece6f23f"
		logic_hash = "1a094cf337cb85aa4b7d1d2025571ab0661a7be1fd03d53d8c7370a90385f38c"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "3dac71f8cbe7cb12066e91ffb6da6524891654fda249fa5934946fd5a2120360"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 C4 A8 53 56 57 8B FA 8B D8 8B 43 28 3B 78 10 0F 84 B4 00 00 00 8B F0 85 FF 75 15 83 7E 04 01 75 0F 8B 46 10 E8 03 A7 FF FF 33 C0 89 46 10 EB 7C 8B C3 E8 B5 F3 FF FF 8B C3 E8 BE F3 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_2507C37C : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "2507c37c-a0ef-47e0-a02a-3e28f4655715"
		date = "2023-12-18"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L62-L80"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "04296258f054a958f0fd013b3c6a3435280b28e9a27541463e6fc9afe30363cc"
		logic_hash = "8c5ea1290260993ea5140baa4645f3fd0ebb4d43fce0e9a25f8e8948e683aec1"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b20b76f19d21730b6e32d1468f0e14ee9d6f9f07b9692fb6dec76605d9b967e2"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 8B 45 14 56 57 33 FF 3B C7 74 47 39 7D 08 75 1B E8 B2 2B 00 00 6A 16 5E 89 30 57 57 57 57 57 E8 3B 2B 00 00 83 C4 14 8B C6 EB 29 39 7D 10 74 E0 39 45 0C 73 0E E8 8D 2B 00 00 6A 22 59 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_E052D248 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "e052d248-32f2-4d51-b42d-468a09e06daa"
		date = "2023-12-18"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L82-L100"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ed2bbc0d120665044aacb089d8c99d7c946b54d1b08a078aebbb3b91f593da6e"
		logic_hash = "1a16ce6d1c6707560425156e625ad19a82315564b3f03adafbcc3e65b0e98a6d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ccfbcb9271b1ce99b814cf9e3a4776e9501035166824beaf39d4b8cd03446ef3"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 64 A1 00 00 00 00 6A FF 68 4F 5A 54 00 50 64 89 25 00 00 00 00 6A 02 68 24 D0 58 00 E8 FF 65 10 00 C7 45 FC FF FF FF FF 68 10 52 55 00 E8 F7 72 10 00 8B 4D F4 83 C4 0C 64 89 0D 00 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_2Bb7Fbe3 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "2bb7fbe3-2add-4ae9-adbf-5f043475d879"
		date = "2023-12-18"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L102-L120"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "65cc8704c0e431589d196eadb0ac8a19151631c8d4ab7375d7cb18f7b763ba7b"
		logic_hash = "36e1ab766e09e8d06b9179f67a1cb842ba257f140610964a941fb462ed3e803c"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e20c20c61768bd936cc18df56d7ec12d92745b6534ac8149bf367d6ad62fa8bd"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 EC 14 68 B6 32 40 00 64 A1 00 00 00 00 50 64 89 25 00 00 00 00 83 EC 30 53 56 57 89 65 EC C7 45 F0 C0 15 40 00 33 F6 89 75 F4 89 75 F8 89 75 E0 89 75 DC 89 75 D8 6A 01 FF 15 AC 10 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_994F2330 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "994f2330-ce61-4c23-b100-7df3feaeb078"
		date = "2023-12-18"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L122-L140"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0a30cb09c480a2659b6f989ac9fe1bfba1802ae3aad98fa5db7cdd146fee3916"
		logic_hash = "ace99deae7f5faa22f273ec4fe45ef07f03acd1ae4d9c0f18687ef6cf5b560c2"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "4749717da2870a3942d7a3aa7e2809c4b9dc783a484bfcd2ce7416ae67164a26"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 EC 0C 8B 55 08 85 D2 0F 84 C7 00 00 00 8B 42 3C 83 7C 10 74 10 8D 44 10 18 0F 82 B5 00 00 00 83 78 64 00 0F 84 AB 00 00 00 8B 4D 0C 8B 40 60 C1 E9 10 03 C2 66 85 C9 75 14 0F B7 4D }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Bf7Aae24 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "bf7aae24-f89a-4cc6-9a15-fc29aa80af98"
		date = "2023-12-18"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L142-L160"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6dfc63894f15fc137e27516f2d2a56514c51f25b41b00583123142cf50645e4e"
		logic_hash = "b6dfa6f4c46bddd643f2f89f6275404c19fd4ed1bbae561029fffa884e99e167"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "9304e9069424d43613ef9a5484214d0e3620245ef9ae64bae7d825f5f69d90c0"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 48 33 F6 44 8B EE 48 89 74 24 20 8B EE 48 89 B4 24 A8 00 00 00 44 8B F6 48 89 74 24 28 44 8B E6 E8 BF FF FF FF 4C 8B F8 8D 5E 01 B8 4D 5A 00 00 66 41 39 07 75 1B 49 63 57 3C 48 8D 4A }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_D542E5A5 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "d542e5a5-0648-40de-8b70-9f78f9bd1443"
		date = "2023-12-18"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L162-L180"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "3fc4ae7115e0bfa3fc6b75dcff867e7bf9ade9c7f558f31916359d37d001901b"
		logic_hash = "3c16c02d4fc6e019f0ab0ff4daad61f59275afd8fb3ee263b1b59876233a686e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "62d3edc282cedd5a6464b92725a3916e3bdc75e8eb39db457d783cb27afa3aec"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 56 FF 75 08 8B F1 E8 B6 FF FF FF C7 06 AC 67 41 00 8B C6 5E 5D C2 04 00 8B FF 55 8B EC 56 FF 75 08 8B F1 E8 99 FF FF FF C7 06 B8 67 41 00 8B C6 5E 5D C2 04 00 B8 EF 5B 40 00 A3 E8 5A }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_8D10790B : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "8d10790b-6f26-46bf-826e-1371565763f0"
		date = "2023-12-18"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L182-L200"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "911535923a5451c10239e20e7130d371e8ee37172e0f14fc8cf224d41f7f4c0f"
		logic_hash = "84c017abbce1c8702efbe8657e5a857ae222721b0db2260dc814652f4528df26"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "7cc33c6684318373e45f5e7440f0a416dd5833a56bc31eb8198a3c36b15dd25e"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 81 EC 04 00 00 00 8B 5D 08 8B 1B 83 C3 04 89 5D FC 8B 45 0C 8B 5D FC 89 03 8B E5 5D C2 08 00 55 8B EC 81 EC 0C 00 00 00 C7 45 FC 00 00 00 00 68 00 00 00 00 BB C4 02 00 00 E8 0D 05 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_347F9F54 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "347f9f54-b9a6-4d40-9627-d3cef78f13eb"
		date = "2023-12-18"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L202-L220"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "45a051651ce1edddd33ecef09bb0fbb978adec9044e64f786b13ed81cabf6a3f"
		logic_hash = "63df388393a45ffec68ba01ae6d7707b6d5277e0162ded6e631c1f76ad76b711"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "860f951db43fa3389c5057f7329b5d13d9347b6e04e1363dd0a8060d5a131991"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 EC 10 FF 75 0C 80 65 FC 00 8D 45 F0 C6 45 F0 43 50 C6 45 F1 6F FF 75 08 C6 45 F2 6E C6 45 F3 6E C6 45 F4 65 C6 45 F5 63 C6 45 F6 74 C6 45 F7 47 C6 45 F8 72 C6 45 F9 6F C6 45 FA 75 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_20469956 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "20469956-1be6-48e8-b3c4-5706f9630971"
		date = "2023-12-18"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L222-L240"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a1f2923f68f5963499a64bfd0affe0a729f5e7bd6bcccfb9bed1d62831a93c47"
		logic_hash = "da351bec0039a32bb9de1d8623ab3dc26eb752d30a64e613de96f70e1b1c2463"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "67cec754102e3675b4e72ff4826c40614e4856b9cbf12489de3406318990fc85"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 E4 F8 83 EC 5C 53 56 33 C0 C7 44 24 18 6B 00 6C 00 57 8D 4C 24 1C C7 44 24 20 69 00 66 00 C7 44 24 24 2E 00 73 00 C7 44 24 28 79 00 73 00 66 89 44 24 2C C7 44 24 0C 6B 00 6C 00 C7 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_742E8A70 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "742e8a70-c150-4903-a551-9123587dd473"
		date = "2023-12-18"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L242-L260"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "94f7678be47651aa457256375f3e4d362ae681a9524388c97dc9ed34ba881090"
		logic_hash = "2925eb8da80ef791b5cf7800a9bf9462203ab6aa743bc69f4fd2343e97eaab7c"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "733b3563275da0a1b4781b9c0aa07e6e968133ae099eddef9cad3793334b9aa5"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC E8 96 FF FF FF E8 85 0D 00 00 83 7D 08 00 A3 A4 E9 43 00 74 05 E8 0C 0D 00 00 DB E2 5D C3 8B FF 55 8B EC 83 3D B0 E9 43 00 02 74 05 E8 BA 12 00 00 FF 75 08 E8 07 11 00 00 68 FF 00 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_79174B5C : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "79174b5c-bc1d-40b2-b2e9-f3ddd3ba226c"
		date = "2023-12-18"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L262-L280"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c15118230059e85e7a6b65fe1c0ceee8997a3d4e9f1966c8340017a41e0c254c"
		logic_hash = "06a2f0613719f1273a6b3f62f248c22b1cab2fe6054904619e3720f3f6c55e2e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "1e709e5cb8302ea19f9ee93e88f7f910f4271cf1ea2a6c92946fa26f68c63f4d"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 EC 48 56 57 6A 0F 33 C0 59 8D 7D B9 F3 AB 8B 75 0C 6A 38 66 AB 8B 4E 14 AA 8B 46 10 89 4D FC 89 45 F8 59 C1 E8 03 83 E0 3F C6 45 B8 80 3B C1 72 03 6A 78 59 2B C8 8D 45 B8 51 50 56 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_232B71A9 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "232b71a9-add2-492d-8b9a-ad2881826ecf"
		date = "2023-12-20"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L282-L300"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1e8b34da2d675af96b34041d4e493e34139fc8779f806dbcf62a6c9c4d9980fe"
		logic_hash = "c3bef1509c0d0172dbbc7e0e2b5c69e5ec47dc22365d98a914002b53b0f7d918"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "908e2a968e544dfb08a6667f78c92df656c7f2c5cf329dbba6cfdb5ea7b51a57"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 61 61 62 63 64 65 65 66 67 68 69 69 6A 6B 6C 6D 6E 6F 6F 70 71 72 73 74 75 75 76 77 78 79 7A 61 55 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_D331D190 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "d331d190-2b66-499e-be08-fed81e5bb5f1"
		date = "2023-12-20"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L302-L320"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6d869d320d977f83aa3f0e7719967c7e54c1bdae9ae3729668d755ee3397a96f"
		logic_hash = "901601c892d709fa596c44df1fbe7772a9f20576c71666570713bf96727a809b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "504c204dd82689bacf3875b9fd56a6a865426f3dc76de1d6d6e40c275b069d66"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 28 83 FA 03 74 04 85 D2 75 05 E8 EE 08 00 00 B8 01 00 00 00 48 83 C4 28 C3 CC CC CC CC 56 57 48 83 EC 38 48 89 CE 8B 01 FF C8 83 F8 05 77 12 48 98 48 8D 0D D1 49 00 00 48 63 3C 81 48 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_24191082 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "24191082-58a7-4d1e-88d2-b4935ba5a868"
		date = "2023-12-20"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L322-L340"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "4d20878c16d2b401e76d8e7c288cf8ef5aa3c8d4865f440ee6b44d9f3d0cbf33"
		logic_hash = "a5ea76032a9c189f923d91cd03deb44bd61868e5ad6081afe63249156cbd8927"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "6bf991b391b79e897fe7964499e7e86b7b8fe4f40cf17abba85cb861e840e082"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 8B 45 0C 48 F7 D0 23 45 08 5D C3 55 8B EC 51 8B 45 0C 48 23 45 08 74 15 FF 75 0C FF 75 08 E8 DA FF FF FF 59 59 03 45 0C 89 45 FC EB 06 8B 45 08 89 45 FC 8B 45 FC 8B E5 5D C3 55 8B EC }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Efdb9E81 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "efdb9e81-9004-426e-b599-331560b7f0ff"
		date = "2024-01-01"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L342-L361"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1c3302b14324c9f4e07829f41cd767ec654db18ff330933c6544c46bd19e89dd"
		logic_hash = "eae78b07f6c31e3a30ae041a27c67553bb8ea915bc7724583d78832475021955"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "ce1499c8adaad552c127ae80dad90a39eb15e1e461afe3266e8cd6961d3fde79"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 4D 61 78 69 6D 75 6D 43 68 65 63 6B 42 6F 78 53 69 7A 65 }
		$a2 = { 56 69 73 75 61 6C 50 6C 75 73 2E 4E 61 74 69 76 65 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_34622A35 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "34622a35-9ddf-4091-8b0c-c9430ecea57c"
		date = "2024-01-01"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L363-L381"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c021c6adca0ddf38563a13066a652e4d97726175983854674b8dae2f6e59c83f"
		logic_hash = "2b49bd5d3a18307a46f44d9dfeea858ddaa6084f86f96b83b874cee7603e1c11"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "427762237cd1040bad58e9d9f7ad36c09134d899c5105e977f94933827c5d5e0"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 81 EC 88 00 00 00 C7 45 FC 00 00 00 00 C7 45 F8 00 00 00 00 68 4C 00 00 00 E8 A3 42 00 00 83 C4 04 89 45 F4 8B D8 8B F8 33 C0 B9 13 00 00 00 F3 AB 83 C3 38 53 68 10 00 00 00 E8 82 42 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_0Ff403Df : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "0ff403df-cf94-43f3-b8b0-b94068f333f1"
		date = "2024-01-01"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L383-L401"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b3119dc4cea05bef51d1f373b87d69bcff514f6575d4c92da4b1c557f8d8db8f"
		logic_hash = "38bdd9b6f61ab4bb13abc7af94e92151928df95ade061756611218104e7245fd"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "3e16fe70b069579a146682d2bbeeeead63c432166b269a6d3464463ccd2bd2f8"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 81 EC 00 02 00 00 56 8B F1 57 C6 85 00 FF 63 C7 06 0C 22 41 00 0C 66 69 B6 66 01 7C 06 02 77 03 96 66 69 B6 7B 14 04 F2 05 6B 06 69 96 66 69 6F 07 C5 08 30 66 69 96 66 09 01 0A 67 0B }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_B1F6F662 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "b1f6f662-ea77-4049-a58a-ed8a97d7738e"
		date = "2024-01-01"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L403-L423"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1b7eaef3cf1bb8021a00df092c829932cccac333990db1c5dac6558a5d906400"
		logic_hash = "e52ff1eaee00334e1a07367bf88f3907bb0b13035717683d9d98371b92bc45c0"
		score = 75
		quality = 69
		tags = "FILE, MEMORY"
		fingerprint = "f2cd22e34b4694f707ee9042805f5498ce66d35743950096271aaa170f44a2ee"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 67 65 74 5F 4D 53 56 61 6C 75 65 31 30 }
		$a2 = { 73 65 74 5F 4D 53 56 61 6C 75 65 31 30 }
		$a3 = { 67 65 74 5F 4D 53 56 61 6C 75 65 31 31 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_2C80562D : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "2c80562d-2377-43b2-864f-0f122530b85d"
		date = "2024-01-01"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L425-L445"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ee8decf1e8e5a927e3a6c10e88093bb4b7708c3fd542d98d43f1a882c6b0198e"
		logic_hash = "07487ae646ac81b94f940c8d3493dbee023bce687297465fe09375f40dff0fb2"
		score = 75
		quality = 69
		tags = "FILE, MEMORY"
		fingerprint = "30965c0d6ac30cfb10674b2600e5a1e7b14380072738dd7993bd3eb57c825f24"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 50 6F 6C 79 6D 6F 64 58 54 2E 65 78 65 }
		$a2 = { 50 6F 6C 79 6D 6F 64 58 54 20 76 31 2E 33 }
		$a3 = { 50 6F 6C 79 6D 6F 64 20 49 6E 63 2E }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_E96F9E97 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "e96f9e97-cb44-42e5-a06b-98775cbb1f2f"
		date = "2024-01-01"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L447-L465"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "bfbab69e9fc517bc46ae88afd0603a498a4c77409e83466d05db2797234ea7fc"
		logic_hash = "1dcf81b8982425ff74107b899e85e2432f0464554e923f85a7555cda65293b54"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "2277fb0b58f923d394f5d4049b6049e66f99aff4ac874849bdc1877b9c6a0d3e"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 7A 47 4D 5E 5A 4D 5D 4B 7D 6D 4A 41 57 4B 54 49 5F 4C 67 6D 54 52 5B 51 46 43 6F 71 40 46 45 53 67 7C 5D 6F }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_005Fd471 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "005fd471-d968-4ece-a61d-91beac4c1e34"
		date = "2024-01-01"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L467-L487"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "502814ed565a923da15626d46fde8cc7fd422790e32b3cad973ed8ec8602b228"
		logic_hash = "10493253a6b2ce3141ee980e0607bdbba72580bb4a076f2f4636e9665ffc6db8"
		score = 75
		quality = 69
		tags = "FILE, MEMORY"
		fingerprint = "30afbb04c257c20ccd2cff15f893715187b7e7b66a9c9f09d076d21466e25a57"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 5F 3F 44 4B 4B 66 25 37 2A 5E 70 42 70 }
		$a2 = { 71 5A 3E 7D 6F 5D 6E 2D 74 48 5E 55 55 22 3C }
		$a3 = { 3E 2D 21 47 45 6A 3C 33 23 47 5B 51 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_54B0Ec47 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "54b0ec47-79f3-4187-8253-805e7ad102ce"
		date = "2024-01-03"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L489-L508"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9c14203069ff6003e7f408bed71e75394de7a6c1451266c59c5639360bf5718c"
		logic_hash = "e3d74162a8874fe05042fec98d25b8db50e7f537566fd9f4e40f92bfe868259a"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "2c3890010aad3c2b54cba08a62b5af6a678849a6b823627bf9e26c8693a89c60"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 2D 2D 2D 2D 3D 5F 25 73 5F 25 2E 33 75 5F 25 2E 34 75 5F 25 2E 38 58 2E 25 2E 38 58 }
		$a2 = { 25 73 2C 20 25 75 20 25 73 20 25 75 20 25 2E 32 75 3A 25 2E 32 75 3A 25 2E 32 75 20 25 63 25 2E 32 75 25 2E 32 75 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Acf6222B : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "acf6222b-5859-4b18-a770-04f8fc7f48fd"
		date = "2024-01-03"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L510-L528"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ce0def96be08193ab96817ce1279e8406746a76cfcf4bf44e394920d7acbcaa6"
		logic_hash = "a284b6c163dbc022bd36f19fbc1d7ff70143bee566328ad23e7b8b79abd39e91"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "1046de07f9594a6352a33d892da1b4dc227fdf52a8caf38e8f1532076232c7fc"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 7D 10 00 75 04 33 C0 5D C3 8B 4D 08 8B 55 0C FF 4D 10 74 0E 8A 01 84 C0 74 08 3A 02 75 04 41 42 EB ED 0F B6 01 0F B6 0A 2B C1 5D C3 55 8B EC 83 EC 24 56 57 8B 7D 08 33 F6 89 75 F8 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_5E718A0C : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "5e718a0c-3c46-46f7-adfd-b0c3c75b865f"
		date = "2024-01-03"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L530-L548"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "430b9369b779208bd3976bd2adc3e63d3f71e5edfea30490e6e93040c1b3bac6"
		logic_hash = "45068afeda7abae0fe922a21f8f768b6c74a6e0f8e9e8b1f68c3ddf92940bf9a"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "b6f9b85f4438c3097b430495dee6ceef1a88bd5cece823656d9dd325e8d9d4a1"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 44 3A 28 41 3B 3B 30 78 30 30 31 46 30 30 30 33 3B 3B 3B 42 41 29 28 41 3B 3B 30 78 30 30 31 30 30 30 30 33 3B 3B 3B 41 55 29 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Fac6D993 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "fac6d993-a9c5-4218-829d-d0f3a3b9a5a0"
		date = "2024-01-03"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L550-L568"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f3e7c88e72cf0c1f4cbee588972fc1434065f7cc9bd95d52379bade1b8520278"
		logic_hash = "3486793324dbe43c908432e1956bbbdb870beb4641da46b3786581fd3e78811a"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "7502d32cf94496b73e476c7521b84a40426676b335a86bdf1bce7146934efcee"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 E4 F8 81 EC 4C 04 00 00 53 8B D9 8B 4D 2C 33 C0 89 01 8B 4D 30 56 0F B6 B3 85 00 00 00 89 01 8B 4D 34 57 0F B6 BB 84 00 00 00 89 01 8B 4D 38 89 54 24 10 89 01 8D 44 24 48 50 FF 15 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_E7Eaa4Ca : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "e7eaa4ca-45ee-42ea-9604-d9d569eed0aa"
		date = "2024-01-04"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L570-L587"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "600da0c88dc0606e05f60ecd3b9a90469eef8ac7a702ef800c833f7fd17eb13e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ede23e801a67bc43178eea87a83eb0ef32a74d48476a8273a25a7732af6f22a6"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { C8 F7 C6 A8 13 F7 01 E9 2C 99 08 00 4C 03 D1 E9 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_97703189 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "97703189-bcac-4b6c-b0d4-9167f5e8085d"
		date = "2024-01-04"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L589-L607"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "968ba3112c54f3437b9abb6137f633d919d75137d790af074df40a346891cfb5"
		logic_hash = "318bc82d49e9a3467ec0e0086aaf1092d2aa7c589b5f16ce6fbb3778eda7ef0b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "9126c3aeaa4ed136424c20aa8e7a487131adc1ae22eb8ab4f514b4687855816f"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 5D E9 2A 1C 00 00 8B FF 55 8B EC 8B 45 08 56 8B F1 C6 46 0C 00 85 C0 75 63 E8 6F 29 00 00 89 46 08 8B 48 6C 89 0E 8B 48 68 89 4E 04 8B 0E 3B 0D 98 06 49 00 74 12 8B 0D B4 05 49 00 85 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Ca0686E1 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "ca0686e1-001f-44d2-ae2f-51c473769723"
		date = "2024-01-05"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L609-L627"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "15c7ce1bc55549efc86dea74a90f42fb4665fe15b14f760037897c772159a5b5"
		logic_hash = "12b2ff66d1be6e2d27f24489b389b5c84660921e8de41653b2b425077cc87669"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "4663eefedb6f3f502adfb4f64278d1c535ba3a719d007a280e9943914121cd81"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 51 53 8B 5D 08 56 57 8B F9 8B 77 10 8B C6 2B C3 89 75 FC 3B 45 0C 72 03 8B 45 0C 83 7F 14 10 72 02 8B 0F 8D 14 19 2B F0 8B CE 03 C2 2B CB 41 51 50 52 E8 62 1A 00 00 83 C4 0C 8B CF 56 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_97C1A260 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "97c1a260-9b43-458e-a9ac-2391aee1bcb8"
		date = "2024-01-07"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L629-L647"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "2cc85ebb1ef07948b1ddf1a793809b76ee61d78c07b8bf6e702c9b17346a20f1"
		logic_hash = "5bd84cbdd4ba699c9e9d87e684071342b23138538bd83ffea8c524fcee26a59b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "9cd93a8def2d2fac61a5b37d82b97c18ce8bf3410aa6ec7531ec28378f5c98cc"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 51 53 56 57 E8 14 31 00 00 8B F0 85 F6 0F 84 39 01 00 00 8B 16 33 DB 8B CA 8D 82 90 00 00 00 3B D0 74 0E 8B 7D 08 39 39 74 09 83 C1 0C 3B C8 75 F5 8B CB 85 C9 0F 84 11 01 00 00 8B 79 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_A440F624 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "a440f624-c7ec-4f26-bfb5-982bae5f6887"
		date = "2024-01-07"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L649-L668"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "3564fec3d47dfafc7e9c662654865aed74aedeac7371af8a77e573ea92cbd072"
		logic_hash = "23c759a0db5698b28a69232077a6b714f71e8eaa069d2f02a7d3efc48b178a2b"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "0f538f8f4eb2e71fb74d8305a179fc2ad880ab5a4cfd37bd35b5da2629ed892c"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 2E 20 49 50 20 3D 20 25 73 2C 20 50 6F 72 74 20 3D 20 25 64 2C 20 73 6B 20 3D 20 25 64 }
		$a2 = { 2E 20 49 50 20 3D 20 25 73 2C 20 50 6F 72 74 20 3D 20 25 64 2C 20 4C 65 6E 20 3D 20 25 64 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_B577C086 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "b577c086-37bd-4227-8cde-f15e2ce0d0ae"
		date = "2024-01-07"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L670-L688"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "27dd61d4d9997738e63e813f8b8ea9d5cf1291eb02d20d1a2ad75ac8aa99459c"
		logic_hash = "a7684340171415ee01e855706192cdffcccd6c82362707229b2c1d096f87dfa8"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0de3cab973de067f2c10252bf761ced353de57c03c4b2e95db05ee3ca30259ea"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 EC 24 83 7D 08 00 75 0A B8 9A FF FF FF E9 65 02 00 00 8B 45 08 89 45 FC 8B 4D FC 83 79 18 00 75 0A B8 9A FF FF FF E9 4C 02 00 00 8B 55 FC 83 7A 7C 00 74 0C 8B 45 08 50 E8 5F 06 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_62E1F5Fc : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "62e1f5fc-325b-46e0-8c03-1a73e873ab16"
		date = "2024-01-07"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L690-L710"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "4a692e244a389af0339de8c2d429b541d6d763afb0a2b1bb20bee879330f2f42"
		logic_hash = "76e21746ee396f13073b3db1e876246f01cef547d312691dff3dc895ea3a2b82"
		score = 75
		quality = 69
		tags = "FILE, MEMORY"
		fingerprint = "64839df90109a0c706c0a3626ba6c4c2eaa5dcd564f0e9889ab9ad4f12e150fe"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 43 6C 69 65 6E 74 2E 48 61 6E 64 6C 65 5F 50 61 63 6B 65 74 }
		$a2 = { 67 65 74 5F 73 45 78 70 59 65 61 72 }
		$a3 = { 73 65 74 5F 73 45 78 70 59 65 61 72 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_55D6A1Ab : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "55d6a1ab-2041-44a5-ae0e-23671fa2b001"
		date = "2024-01-07"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L712-L731"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1ca6ed610479b5aaaf193a2afed8f2ca1e32c0c5550a195d88f689caab60c6fb"
		logic_hash = "4f3a0b2e45ae4e6a00f137798b700a0925fa6eb19ea6b871d7eeb565548888ba"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "cd81b61929b18d59630814718443c4b158f9dcc89c7d03a46a531ffc5843f585"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 51 51 31 33 37 32 33 39 32 34 38 20 }
		$a2 = { 74 65 6E 63 65 6E 74 3A 2F 2F 6D 65 73 73 61 67 65 2F 3F 75 69 6E 3D 31 33 37 32 33 39 32 34 38 26 53 69 74 65 3D 63 66 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_F7D3Cdfd : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "f7d3cdfd-72eb-4298-b3ff-432f5c4347c9"
		date = "2024-01-07"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L733-L751"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f9df83d0b0e06884cdb4a02cd2091ee1fadeabb2ea16ca34cbfef4129ede251f"
		logic_hash = "23e1008f222eb94a4bd34372834924377e813dc76efa8544b0dcbe7d3e3addde"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "db703a2ddcec989a81b99a67e61f4be34a2b0e55285c2bdec91cd2f7fc7e52f3"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 51 51 56 57 E8 A3 D0 FF FF 83 78 68 00 74 21 FF 75 24 FF 75 20 FF 75 18 FF 75 14 FF 75 10 FF 75 0C FF 75 08 E8 E5 8C FF FF 83 C4 1C 85 C0 75 73 8B 7D 1C 8D 45 F8 50 8D 45 FC 50 57 FF }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_0350Ed31 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "0350ed31-ed07-4e9a-8488-3765c990f25c"
		date = "2024-01-07"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L753-L771"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "008f9352765d1b3360726363e3e179b527a566bc59acecea06bd16eb16b66c5d"
		logic_hash = "149dd26466f47b2e7f514bdcc9822470334490da2898840f35fe6b537ce104f6"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "aac41abf60a16c02c6250c0468c6f707f9771b48da9e78633de7141d09ca23c8"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 35 6A 6A 29 59 7A 6A 29 59 7A 6A 29 59 7A 6A 29 59 7A 6A 29 59 7A 6A 29 59 7A 6A 29 59 7A 6A 29 59 7A 6A 29 59 7A 6A 29 59 7A 6A 29 59 7A 6A 29 59 7A 6A 29 59 7A 6A 29 59 7A 3F }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_A1Cef0Cd : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "a1cef0cd-a811-4d7b-b24e-7935c0418c7a"
		date = "2024-01-08"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L773-L791"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "71f519c6bd598e17e1298d247a4ad37b78685ca6fd423d560d397d34d16b7db8"
		logic_hash = "2772906e3a8a088e7c6ea1370af5e5bbe2cbae4f49de9b939524e317be8ddde4"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "9285f0ea8ed0ceded2f3876ef197b67e8087f7de82a72e0cd9899b05015eee79"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 51 53 8B DA 89 45 FC 8B 45 FC E8 76 00 00 00 33 C0 55 68 F0 A0 41 00 64 FF 30 64 89 20 8B 45 FC 80 78 20 01 74 10 8B 45 FC 8B 40 04 8B D3 E8 CE FC FF FF 40 75 0F 8B 45 FC 8B 40 04 8B }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_E5F4703F : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "e5f4703f-e834-4904-9036-a8c5996058c8"
		date = "2024-01-09"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L793-L811"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "362bda1fad3fefce7d173617909d3c1a0a8e234e22caf3215ee7c6cef6b2743b"
		logic_hash = "f81476d5e5a9bcb42b32d6ec3d4b620165f2878c50691ecf59ef6f34b6ad9d1b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "3072ea028b0716e88820782a2658d1f424d57bd988ccfcc1581991649cf52b19"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 E4 F8 83 EC 08 83 79 14 08 56 57 8B F1 72 02 8B 31 8B 41 10 8B CE 8D 3C 46 8B D7 E8 AC FA FF FF 8B 75 08 2B F8 D1 FF 0F 57 C0 57 50 0F 11 06 8B CE C7 46 10 00 00 00 00 C7 46 14 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_8B790Aba : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "8b790aba-02b4-4c71-a51e-3a56ea5728ec"
		date = "2024-01-09"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L813-L832"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ec98bfff01d384bdff6bbbc5e17620b31fa57c662516157fd476ef587b8d239e"
		logic_hash = "8a0b2af3d0c95466ca138dfcc3d6f6a702ec92f5cd4f791b1200c79ffd973840"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "8581397f15b9985bafa5248f0e7f044bf80c82e441d2216dc0976c806f658d2e"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 7A 66 62 50 4A 64 73 72 78 77 7B 7B 79 55 36 46 42 50 4A 3F 20 2E 6E 3E 36 65 73 7A }
		$a2 = { 50 36 7B 77 64 71 79 64 46 4A 73 64 79 62 45 7A 77 63 62 64 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_76A7579F : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "76a7579f-4a9b-4dae-935c-14d829d3c416"
		date = "2024-01-09"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L834-L852"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "76c73934bcff7e4ee08b068d1e02b8f5c22161262d127de2b4ac2e81d09d84f6"
		logic_hash = "08ed2d318e7154195911aaf3705626307b48a54aa195eaa054ec53766d3e198d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ba5bfc0e012a22172f138c498560a606e6754efa0fa145799f00725e130ad90f"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 8B 55 10 8B 45 08 8B C8 85 D2 74 09 C6 01 00 41 83 EA 01 75 F7 5D C3 55 8B EC 64 A1 30 00 00 00 83 EC 18 8B 40 0C 53 56 57 8B 78 0C E9 A7 00 00 00 8B 47 30 33 F6 8B 5F 2C 8B 3F 89 45 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_3F060B9C : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "3f060b9c-8c35-4f0f-9dfd-10be6355bea9"
		date = "2024-01-10"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L854-L872"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "32e7a40b13ddbf9fc73bd12c234336b1ae11e2f39476de99ebacd7bbfd22fba0"
		logic_hash = "193583f63f22452f96c8372fdc9ef04e2a684f847564a7fe75145ea30d426901"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "5bc1d19faa8fc07ef669f6f63baceee5fe452c0e2d54d6154bcc01e11606ae6f"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 51 51 53 56 8B F1 E8 4B BE FF FF 8D 45 FC 8B CE 50 FF 75 10 FF 75 0C E8 69 FE FF FF 8B D8 8B CE 53 E8 4B FD FF FF 85 C0 0F 84 C6 00 00 00 8B 46 40 83 F8 02 0F 84 B3 00 00 00 83 F8 05 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Dbae6542 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "dbae6542-b343-4320-884c-c0ce97a431f1"
		date = "2024-01-10"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L874-L892"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c73f533f96ed894b9ff717da195083a594673e218ee9a269e360353b9c9a0283"
		logic_hash = "673c6b4e6aaa127d45b21d0283437000fbc507a84ecd7a326448869d63759aee"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "880aafd423494eccab31342bdfec392fdf4a7b4d98614a0c3b5302d62bcf5ba8"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 28 00 00 0A 20 B8 0B 00 00 20 10 27 00 00 6F 29 00 00 0A 28 1F 00 00 0A 7E 0F 00 00 04 2D 0A 28 27 00 00 06 28 19 00 00 06 7E 15 00 00 04 6F 2A 00 00 0A 26 17 2D C8 2A EE 16 80 0F 00 00 04 14 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_808F680E : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "808f680e-db35-488f-b942-79213890b336"
		date = "2024-01-10"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L894-L912"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "df6955522532e365239b94e9d834ff5eeeb354eec3e3672c48be88725849ac1c"
		logic_hash = "22d91a87c01b401d4a203fbabb93a9b45fd6d8819125c56d9c427449b06d2f84"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "4b4b3b244d0168b11a8df4805f9043c6e4039ced332a7ba9c9d0d962ad6f6a0e"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 28 00 00 0A 20 00 00 00 00 FE 01 2A 13 30 02 00 6C 00 00 00 01 00 00 11 20 00 00 00 00 FE 0E 00 00 38 54 00 00 00 00 FE 0C 00 00 20 01 00 00 00 FE 01 39 12 00 00 00 FE 09 01 00 FE 09 02 00 51 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_073909Cf : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "073909cf-7e0d-48fa-a631-e1b641040570"
		date = "2024-01-10"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L914-L932"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "89a6dc518c119b39252889632bd18d9dfdae687f7621310fb14b684d2f85dad8"
		logic_hash = "5b42a74010549c884ff85a67b9add6b82a8109a953473cc1439581976f8f545e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "717da3b409c002ff6c6428690faf6e6018daedfaf9ec95b6fb9884cacc27dc20"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 C4 F0 53 56 89 55 FC 8B F0 8B 45 FC E8 CF E5 FF FF 33 C0 55 68 F2 39 40 00 64 FF 30 64 89 20 33 DB 68 04 3A 40 00 68 0C 3A 40 00 E8 70 FC FF FF 50 E8 82 FC FF FF 89 45 F8 68 18 3A }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_820Fe9C9 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "820fe9c9-2abc-4dd5-84e2-a74fbded4dc6"
		date = "2024-01-11"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L934-L952"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1102a499b8a863bdbfd978a1d17270990e6b7fe60ce54b9dd17492234aad2f8c"
		logic_hash = "81a1359bd5781e1eefb6ae06c6b2ad9e94cc6318c1f81f84c06f0b236b6e84d1"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "e43f4fee9e23233bf8597decac79bda4790b5682f5e0fe86e3a13cb18724ea3e"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 2E 2A 73 74 72 75 63 74 20 7B 20 46 20 75 69 6E 74 70 74 72 3B 20 58 30 20 63 68 61 6E 20 73 74 72 69 6E 67 3B 20 58 31 20 62 6F 6F 6C 20 7D }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_89Efd1B4 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "89efd1b4-9a4b-4749-8b34-630883d2d45b"
		date = "2024-01-11"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L954-L972"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "937c8bc3c89bb9c05b2cb859c4bf0f47020917a309bbadca36236434c8cdc8b9"
		logic_hash = "49a7875fd9c31c5c9b593aed75a28fadb586294422b75c7a8eeba2e8ff254753"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "659bdc9af01212de3d2492e0805e801b0a00630bd699360be15d3fe5b221f6b3"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 48 81 EC E0 01 00 00 48 89 9C 24 F8 01 00 00 48 83 F9 42 0F 85 03 01 00 00 48 89 84 24 F0 01 00 00 48 89 9C 24 F8 01 00 00 44 0F 11 BC 24 88 01 00 00 44 0F 11 BC 24 90 01 00 00 44 0F 11 BC 24 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_61315534 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "61315534-9d80-428b-bc56-ff4836ab0c4a"
		date = "2024-01-11"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L974-L992"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "819447ca71080f083b1061ed6e333bd9ef816abd5b0dd0b5e6a58511ab1ce8b9"
		logic_hash = "0fdfe3bb6ebdaac4324a45dac8680f00684d0030419f26f3f72ed002bf5a2a34"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e5cff64bc04b271237015154ddeb275453536ffa8cbce60389b6ed37e6478788"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 51 51 8A 4D 08 F6 C1 01 74 0A DB 2D B0 D7 41 00 DB 5D 08 9B F6 C1 08 74 10 9B DF E0 DB 2D B0 D7 41 00 DD 5D F8 9B 9B DF E0 F6 C1 10 74 0A DB 2D BC D7 41 00 DD 5D F8 9B F6 C1 04 74 09 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Eab96Cf2 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "eab96cf2-f25a-4149-9328-3f7af50b2ad8"
		date = "2024-01-11"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L994-L1012"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "2be8a2c524f1fb2acb2af92bc56eb9377c4e16923a06f5ac2373811041ea7982"
		logic_hash = "cc1dfc2c9c5e1fbc6282342dfbf3a6c834fa56fb6fc46569a24fa78535c5845f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a07bbc803aa7ae54d0c0b2b15edf8378646f06906151998ac3d5491245813dd9"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 20 41 52 FF E0 58 41 59 5A 48 8B 12 E9 4B FF FF FF 5D 48 31 DB 53 49 BE 77 69 6E 68 74 74 70 00 41 56 48 89 E1 49 C7 C2 4C 77 26 07 FF D5 53 53 48 89 E1 53 5A 4D 31 C0 4D 31 C9 53 53 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_11A56097 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "11a56097-c019-43dc-b401-c3bd5e88ce17"
		date = "2024-01-12"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1014-L1033"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "98d538c8f074d831b7a91e549e78f6549db5d2c53a10dbe82209d15d1c2e9b56"
		logic_hash = "42f955c079752c787ac70682bc41fa31f3196d30051d7032276a0d4279d59d58"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "37fda03cc0d50dc8bf6adfb83369649047e73fe33929f6579bf806b343eb092c"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 6E 6F 69 74 70 65 63 78 45 74 61 6D 72 6F 46 65 67 61 6D 49 64 61 42 }
		$a2 = { 65 74 75 62 69 72 74 74 41 65 74 65 6C 6F 73 62 4F }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_F3Bef434 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "f3bef434-0688-4672-a02f-40615cc429b1"
		date = "2024-01-12"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1035-L1053"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "98d538c8f074d831b7a91e549e78f6549db5d2c53a10dbe82209d15d1c2e9b56"
		logic_hash = "efba0e1fbe6562a9aeaac23b851c31350e4ac6551e505be4986bddade92ca303"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a05dfdf2f8f15335acb2772074ad42f306a4b33ab6a19bdac99a0215820a6f7b"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 6F 70 00 06 EB 72 06 26 0A 00 01 45 6F 04 00 00 8F 7B 02 06 26 0A 00 01 44 6F 70 00 06 D5 72 00 00 00 B8 38 1D 2C EB 2C 1A 00 00 00 B8 38 14 04 00 00 8F 7B 00 00 00 BD 38 32 2C 00 00 00 BE 38 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_C6F131C5 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "c6f131c5-8737-4f48-a0fe-a94e9565481e"
		date = "2024-01-12"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1055-L1073"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "247314baaaa993b8db9de7ef0e2998030f13b99d6fd0e17ffd59e31a8d17747a"
		logic_hash = "5702a77fee0cd564916abdbfedf76d069bb7a5b6de0c4623150991d52dc02e42"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "c4349bd78cdc64430d15caf7efd663ff88d79d69ecf9f8118122b9a85543057d"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 20 48 8B 59 08 8B 13 44 8B 43 04 48 83 C3 08 89 D0 44 09 C0 74 07 E8 B6 FF FF FF EB E8 48 83 C4 20 5B C3 53 45 31 DB BB 0D 00 00 00 48 8B 41 10 45 89 DA 49 C1 E2 04 4A 83 3C 10 00 74 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_B2A054F8 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "b2a054f8-160f-4932-b5fe-c7d78a1f9b74"
		date = "2024-01-12"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1075-L1095"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "63d2478a5db820731a48a7ad5a20d7a4deca35c6b865a17de86248bef7a64da7"
		logic_hash = "f64b1666f78646322a4c37dc887d8fcfdb275b0bca812e360579cefd9e323c02"
		score = 75
		quality = 69
		tags = "FILE, MEMORY"
		fingerprint = "09f1724963bfdde810b61d80049def388c89f6a21195e90a869bb22d19d074de"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 7E 38 7E 40 7E 44 48 4C 2A 7E 7E 58 5D 5C }
		$a2 = { 39 7B 34 74 26 39 3A 62 3A 66 25 6A }
		$a3 = { 5B 50 44 7E 66 7E 71 7E 77 7E 7C 7E }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Fcab7E76 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "fcab7e76-5edd-4485-9983-bcc5e9cb0a08"
		date = "2024-01-12"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1097-L1115"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "67d7e016e401bd5d435eecaa9e8ead341aed2f373a1179069f53b64bda3f1f56"
		logic_hash = "90f50d1227b8e462eaa393690dc2b25601444bf80f2108445a0413bff6bedae8"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "8a01a3a398cfaa00c1b194b2abc5a0c79d21010abf27dffe5eb8fdc602db7ad1"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 28 FA 00 2B CD 65 50 7C FF CF 34 00 80 41 BF 1E 12 1A F9 20 0F 56 EE 9F BA C0 22 7E 97 FC CB 03 C7 67 9A AE 8A 60 C0 B3 6C 0D 00 2B 2C 78 83 B5 88 03 17 3A 51 4A 1F 30 D2 C0 53 DC 09 7A BF 2D }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_90E4F085 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "90e4f085-2f53-4e5e-bcb6-c24823539241"
		date = "2024-01-12"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1117-L1137"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1a6a290d98f5957d00756fc55187c78030de7031544a981fd2bb4cfeae732168"
		logic_hash = "2afeae6de965ae155914dcedbfe375327a9fca3b42733c23360dd4fddfcc8a3d"
		score = 75
		quality = 69
		tags = "FILE, MEMORY"
		fingerprint = "1d40eef44166b3cc89b1f2ba9c667032fa44cba271db8b82cc2fed738225712a"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 39 39 21 3A 37 3B 45 3C 50 3D 5B 3E 66 3F }
		$a2 = { 66 32 33 39 20 3A 4E 3D 72 68 74 76 48 }
		$a3 = { 32 78 37 7A 42 5A 4C 22 2A 66 49 7A 75 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_04A9C177 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "04a9c177-cacf-4509-b8dc-f30a628b7699"
		date = "2024-01-12"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1139-L1157"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0cccdde4dcc8916fb6399c181722eb0da2775d86146ce3cb3fc7f8cf6cd67c29"
		logic_hash = "ca7cf71228b1e13ec05c62cd9924ea5089fdf903d8ea4a5151866996ea81e01e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b36da73631711de0213658d30d3079f45449c303d8eb87b8342d1bd20120c7bb"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 6F 81 00 06 FE 3C A3 C3 D6 37 16 00 C2 87 21 EA 80 33 09 E5 00 2C 0F 24 BD 70 BC CB FB 00 94 5E 1B F8 14 F6 E6 95 07 01 CD 02 B0 D7 30 25 65 99 74 01 D6 A4 47 B3 20 AF 27 D8 11 7F 03 57 F6 37 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_45D1E986 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "45d1e986-78fb-4a83-97f6-2b40c657e709"
		date = "2024-01-12"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1159-L1177"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "fd159cf2f9bd48b0f6f5958eef8af8feede2bcbbea035a7e56ce1ff72d3f47eb"
		logic_hash = "d53a4d189b9a49f9b6477e12bce0d41e62827306d1df79e6494ab67669d84f35"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "facb67b78cc4d6cf5d141fd7153d331209e5ce46f29c0078c7e5683165c37057"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 28 45 00 06 00 00 00 08 28 45 00 09 00 00 00 14 28 45 00 09 00 00 00 20 28 45 00 07 00 00 00 28 28 45 00 0A 00 00 00 34 28 45 00 0B 00 00 00 40 28 45 00 09 00 00 00 5B 81 45 00 00 00 00 00 4C }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_83C38E63 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "83c38e63-6a18-4def-abf2-35e36210e4cf"
		date = "2024-01-12"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1179-L1198"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "2121a0e5debcfeedf200d7473030062bc9f5fbd5edfdcd464dfedde272ff1ae7"
		logic_hash = "89d4036290a29b372918205bba85698d6343109503766cbb13999b5177fc3152"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "9cc8ee8dfa6080a18575a494e0b424154caecedcc8c8fd07dd3c91956c146d1e"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 32 65 65 64 36 35 36 64 64 35 38 65 39 35 30 35 62 34 33 39 35 34 32 30 31 39 36 66 62 33 35 36 }
		$a2 = { 34 2A 34 4A 34 52 34 60 34 6F 34 7C 34 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Bd24Be68 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "bd24be68-3d72-44fd-92f2-39f592d47d0e"
		date = "2024-01-12"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1200-L1218"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "fd159cf2f9bd48b0f6f5958eef8af8feede2bcbbea035a7e56ce1ff72d3f47eb"
		logic_hash = "8536593696930d03f1e62586886f0df5438d13fb796b4605df7ad67d9633d5f9"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "35ff6c9b338ef95585d8d0059966857f6e5a426fa5f357acb844d264d239c70d"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 8B 4D 0C 56 8B 75 08 89 0E E8 AB 17 00 00 8B 48 24 89 4E 04 E8 A0 17 00 00 89 70 24 8B C6 5E 5D C3 55 8B EC 56 E8 8F 17 00 00 8B 75 08 3B 70 24 75 0E 8B 76 04 E8 7F 17 00 00 89 70 24 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_A0C7B402 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "a0c7b402-cee5-4da6-9a32-72b1a0ae0f8d"
		date = "2024-01-16"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1220-L1238"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "5814d7712304800d92487b8e1108d20ad7b44f48910b1fb0a99e9b36baa4333a"
		logic_hash = "d0aa75debbefb301b9fc46ceca4944ae8c4b009118214a9589440b59089b853e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0ca7d91a97c12f4640dd367d19d8645dd1da713cfa62289c40f8c34202ddf256"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 89 E5 57 56 83 E4 F8 83 EC 20 8B 75 10 8B 7D 0C 89 E0 8D 4C 24 18 6A 05 6A 18 50 51 FF 75 08 68 BC 52 4D 90 E8 26 00 00 00 83 C4 18 85 FF 74 06 8B 4C 24 08 89 0F 85 F6 74 08 80 7C 24 15 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_42B3E0D7 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "42b3e0d7-ec42-4940-b5f3-e9782997dccf"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1240-L1258"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "99ad416b155970fda383a63fe61de2e4d0254e9c9e09564e17938e8e2b49b5b7"
		logic_hash = "58b4c667b6d796f4525afeb706394f593d03393e3a48e2a0b7664f121e6a78fe"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "7d3974400d05bc7bbcd63c99e8257d0676b38335de74a4bcfde9e86553f50f08"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 C4 F8 53 33 DB 6A 00 8D 45 F8 50 8B 45 0C 50 8B 45 10 50 6A 00 6A 00 33 C9 33 D2 8B 45 08 E8 B1 F7 FF FF 85 C0 75 05 BB 01 00 00 00 8B C3 5B 59 59 5D C2 0C 00 8D 40 00 53 BB E0 E1 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_66142106 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "66142106-d602-4b1b-a79b-64d692c613ca"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1260-L1278"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "cd164a65fb2a496ad7b54c782f25fbfca0540d46d2c0d6b098d7be516c4ce021"
		logic_hash = "bf5d8db3ed6d2abc3158b04e904351250bf17a6d766e31769b3c5a6e534165b0"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b5816297691fefc46ab11cb175a4e20d40c5095c20417e80590ceb05bd1ec974"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 EC 10 6A 00 8D 4D F0 E8 6B FF FF FF 8B 45 F4 BA E9 FD 00 00 39 50 08 74 0C E8 29 48 00 00 33 D2 85 C0 75 01 42 80 7D FC 00 74 0A 8B 4D F0 83 A1 50 03 00 00 FD 8B C2 C9 C3 8B FF 56 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_51A1D82B : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "51a1d82b-2ae0-45c9-b51d-9b54454dfcee"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1280-L1298"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1a7adde856991fa25fac79048461102fba58cda9492d4f5203b817d767a81018"
		logic_hash = "2d6b0560e1980deb6aad8e0902d065eeda406506b70bb8bb27c7fa58be9842f8"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "fddf98cdb00734e50908161d6715e807b1c4437789af524d6f0a17df55572261"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 EC 04 53 56 57 89 4D FC 8B 45 FC 50 FF 15 D0 63 41 00 5F 5E 5B C9 C3 CC CC CC CC CC 66 8B 01 56 66 8B 32 57 66 3B F0 72 44 75 0A 66 8B 79 02 66 39 7A 02 72 38 66 3B F0 75 14 66 8B }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Dee3B4Bf : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "dee3b4bf-f09e-46a7-b177-6b1445db88ad"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1300-L1318"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c7f4b63fa5c7386d6444c0d0428a8fe328446efcef5fda93821f05e86efd2fba"
		logic_hash = "cfd7f9250ab44ffe12b62f84ae753032642d9aa2524d88a6d4d989a2afa043a3"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "6f6cf93e5ac640d1e71f9554752a846c3cc051d95c232e2f4d8fa383d5a3b5af"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 4A 75 73 74 20 63 6F 70 79 20 74 68 65 20 70 61 74 63 68 20 74 6F 20 74 68 65 20 70 72 6F 67 72 61 6D 20 64 69 72 65 63 74 6F 72 79 20 61 6E 64 20 61 70 70 6C 79 2E }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Fdbcd3F2 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "fdbcd3f2-17e6-49d4-997b-91e6a85e4226"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1320-L1338"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9258e4fe077be21ad7ae348868f1ac6226f6e9d404c664025006ab4b64222369"
		logic_hash = "ca9136ca44a61795cca44ac9bb0494fdc34c08d6578603ba3be3582956f4a98f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "2a69deed3fe05b64cb37881ce50cae8972e7a610fd32c4b7f9155409bc5b297c"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 C4 FC 60 8B 75 0C 8D A4 24 00 00 00 00 8D A4 24 00 00 00 00 90 56 E8 22 00 00 00 0B C0 75 05 89 45 FC EB 11 89 35 84 42 40 00 46 8B 5D 08 38 18 75 E3 89 45 FC 61 8B 45 FC C9 C2 08 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_B7852Ccf : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "b7852ccf-ba11-44e2-95b9-eb92d6976e15"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1340-L1360"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "5ac70fa959be4ee37c0c56f0dd04061a5fed78fcbde21b8449fc93e44a8c133a"
		logic_hash = "4d5c29cceaacfda0c41bcd13cf95e90397b1b6c0c6beeb19b9184f435c8669b9"
		score = 75
		quality = 69
		tags = "FILE, MEMORY"
		fingerprint = "f33ef7996bcb0422227b9481d85b3663fb0f13f1be01837b42ac0c5f0bcff781"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 45 2B 34 2C 3D 43 4A 32 3A 24 40 2F 22 3E 3F 3C 24 44 }
		$a2 = { 67 6F 72 67 65 6F 75 73 68 6F 72 6E 79 }
		$a3 = { 62 6C 61 63 6B 20 68 61 69 72 75 6E 73 68 61 76 65 64 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_C3C8F21A : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "c3c8f21a-4722-4b6f-85e1-023d45487aeb"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1362-L1380"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9a102873dd37d08f53dcf6b5dad2555598a954d18fb3090bbf842655c5fded35"
		logic_hash = "b4d2b28fb2c9d46884b0b34f7821151b88891a8d881885c704e0e192cf7fca70"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "5bae56d41d4582aed0a6fd54eab53ce6d47f0d70711cc17e77f8e85019d2ac7e"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 89 E5 83 EC 14 53 56 57 8D 7D F7 BE 1E CA 40 00 B9 02 00 00 00 F3 A5 A4 68 62 CA 40 00 68 64 CA 40 00 E8 A8 25 00 00 83 C4 08 89 C3 8D 45 EC 50 E8 CA 24 00 00 59 8D 45 EC 50 E8 80 26 00 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_A3D51E0C : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "a3d51e0c-9d49-48e5-abdb-ceeb10780cfa"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1382-L1400"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "18bd25df1025cd04b0642e507b0170bc1a2afba71b2dc4bd5e83cc487860db0d"
		logic_hash = "f128f6a037abb4af2c11605b182852146780be6451b3062a2914bedb5c286843"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "069a218c752b5aac5b26b19b36b641b3dd31f09d7fcaae735efb52082a3495cc"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 53 56 8B 75 08 33 DB 39 5D 14 57 75 10 3B F3 75 10 39 5D 0C 75 12 33 C0 5F 5E 5B 5D C3 3B F3 74 07 8B 7D 0C 3B FB 77 1B E8 05 F8 FF FF 6A 16 5E 89 30 53 53 53 53 53 E8 97 F7 FF FF 83 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_54Ccad4D : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "54ccad4d-3b8d-4abb-88eb-d428d661169d"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1402-L1422"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "fe4aad002722d2173dd661b7b34cdb0e3d4d8cd600e4165975c48bf1b135763f"
		logic_hash = "b9fb525be22dd2f235c3ac68688ced5298da45194ad032423689f5a085df6e31"
		score = 75
		quality = 69
		tags = "FILE, MEMORY"
		fingerprint = "4fe13c4ca3569912978a0c2231ec53a715a314e1158e09bc0c61f18151cfffa3"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 4D 55 73 65 72 4E 61 74 69 66 65 72 63 }
		$a2 = { 4D 79 52 65 67 53 61 76 65 52 65 63 6F 72 64 }
		$a3 = { 53 74 65 61 6C 65 72 54 69 6D 65 4F 75 74 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_6Ee18020 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "6ee18020-71e2-4003-99ef-963663e94740"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1424-L1442"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "d58d8f5a7efcb02adac92362d8c608e6d056824641283497b2e1c1f0e2d19b0a"
		logic_hash = "8a08973ae2ddde275e007686fc6eca831c1fb398b7221d5022da10f90da0e44d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b8b18dcec6556bc7fb9b9f257a6485bcd6dfde96fc5c7e8145664de55d0c6803"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 53 8B 5D 0C 8B 45 08 50 E8 9C 19 02 00 59 89 03 89 53 04 83 7B 04 00 75 07 83 3B 00 76 10 EB 02 7E 0C C6 43 28 01 33 C0 5B 5D C3 5B 5D C3 B8 01 00 00 00 5B 5D C3 90 90 90 55 8B EC 53 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_8Eb547Db : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "8eb547db-81e4-4c64-9bab-b7944af32345"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1444-L1462"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "3fc821b63dfa653b86b11201073997fa4dc273124d050c2a7c267ac789d8a447"
		logic_hash = "73cabad0656c6b347def017b07138fdbdd5b41da5ccf7d701fea764669058f39"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "2de0d43a4c1c4b3ecef7272d3f224bd5203c130365ff49a02a9200b3f53fe6ba"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 28 00 00 0A 20 B8 0B 00 00 20 10 27 00 00 6F 29 00 00 0A 28 1F 00 00 0A 7E 0D 00 00 04 2D 0A 28 23 00 00 06 28 19 00 00 06 7E 14 00 00 04 6F 2A 00 00 0A 26 17 2D C8 2A 13 30 01 00 41 00 00 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_803Feff4 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "803feff4-e4c2-4d8c-b736-47bb10fd5ce8"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1464-L1482"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "8f150dfb13e4a2ff36231f873e4c0677b5db4aa235d8f0aeb41e02f7e31c1e05"
		logic_hash = "e22b8b208ff104e2843d897c425467f2f0ec0c586c4db578da90aeaef0209e1d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "3bbb00aa18086ac804f6ddf99a50821744a420f46b6361841b8bcd2872e597f1"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 6F 01 00 06 6F 25 00 00 0A 02 7B 03 00 00 04 73 8D 01 00 06 6F 25 00 00 0A 02 7B 03 00 00 04 73 92 01 00 06 6F 25 00 00 0A 02 7B 03 00 00 04 73 9A 01 00 06 6F 25 00 00 0A 02 7B 03 00 00 04 73 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_9C7D2333 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "9c7d2333-f2c4-4d90-95ce-d817da5cb2a3"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1484-L1502"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "85219f1402c88ab1e69aa99fe4bed75b2ad1918f4e95c448cdc6a4b9d2f9a5d4"
		logic_hash = "561290ebf3ca2a01914f514d63121be930e7a8c06cfc90ff4b8f0c7cef3408fe"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "3f003cc34b797887b5bbfeb729441d7fdb537d4516f13b215e1f6eceb5a8afaf"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 81 EC 64 09 00 00 57 C6 85 00 F8 FF FF 00 B9 FF 00 00 00 33 C0 8D BD 01 F8 FF FF F3 AB 66 AB AA C6 85 00 FC FF FF 00 B9 FF 00 00 00 33 C0 8D BD 01 FC FF FF F3 AB 66 AB AA C7 85 AC F6 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_747B58Af : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "747b58af-6edb-42f2-8a1b-e462399ef61e"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1504-L1524"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ee28e93412c59d63155fd79bc99979a5664c48dcb3c77e121d17fa985fcb0ebe"
		logic_hash = "fd6b36ca50c1017035474b491f716bfb0d53b181fce4b5478a57a1d1a6ddc3e7"
		score = 75
		quality = 69
		tags = "FILE, MEMORY"
		fingerprint = "79faab4fda6609b2c95d24de92a3a417d2f5e58f3f83c856fa9f32e80bed6f37"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 5C 43 3D 5D 78 48 73 66 40 22 33 2D 34 }
		$a2 = { 79 5A 4E 51 61 4A 21 43 43 56 31 37 74 6B }
		$a3 = { 66 72 7A 64 48 49 2D 4E 3A 4D 23 43 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_C3C4E847 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "c3c4e847-ef6f-430d-9778-d48326fb4eb0"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1526-L1544"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "86b37f0b2d9d7a810b5739776b4104f1ded3a1228c4ec2d104d26d8eb26aa7ba"
		logic_hash = "fa147abf7aa872f409e7684c4c60485fc58f57543062573526e56ff9866f8dfe"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "017a8ec014fed493018cff128b973bb648dbb9a0d1bede313d237651d3f6531a"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 2E 3F 41 56 3F 24 5F 52 65 66 5F 63 6F 75 6E 74 40 55 41 70 69 44 61 74 61 40 40 40 73 74 64 40 40 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_6542Ebda : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "6542ebda-c91e-449e-88c4-244fba69a4b2"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1546-L1564"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "2073e51c7db7040c6046e36585873a0addc2bcddeb6e944b46f96c607dd83595"
		logic_hash = "30263341bf51a001503dfda9be5771d401bc5b5423682c29a6d4ebc457415d3e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a4ceaf0bf2e8dc3efbc6e41e608816385f40c04984659b0ec15f109b7a6bf20a"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 53 56 57 8B F9 85 D2 74 18 0F B7 02 8D 5A 02 0F B7 72 02 8B 4A 04 3B C7 74 0E 83 C2 08 03 D1 75 E8 33 C0 5F 5E 5B 5D C3 B8 78 03 00 00 66 3B F0 74 EF 8B 45 08 89 18 8D 41 06 EB E7 8D }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_1417511B : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "1417511b-2b31-47a8-8465-b6a174174863"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1566-L1584"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "2fc9bd91753ff3334ef7f9861dc1ae79cf5915d79fa50f7104cbb3262b7037da"
		logic_hash = "e6b53082fa447ac3cf56784771aca742696922e6f740a24d014e04250dc5020c"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "4be19360fccf794ca2e53c4f47cd1becf476becf9eafeab430bdb3c64581613c"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 EC 20 8B 45 08 89 45 F4 8B 4D F4 8B 55 08 03 51 3C 89 55 F0 B8 08 00 00 00 6B C8 00 8B 55 F0 8B 45 08 03 44 0A 78 89 45 F8 8B 4D F8 8B 55 08 03 51 20 89 55 EC 8B 45 F8 8B 4D 08 03 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_7526F106 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "7526f106-018f-41b9-a1bf-15f7d9f2188e"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1586-L1605"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "5a297c446c27a8d851c444b6b32a346a7f9f5b5e783564742d39e90cd583e0f0"
		logic_hash = "a0f9eb760be05196f0c5c3e3bf250929b48341a58a11c24722978fa19c4a9f57"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "5f5fc4152aae94b9c3bc0380dbcb093289c840a29b629b1d76a09c672daa9586"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 50 72 6F 6A 65 63 74 31 2E 75 45 78 57 61 74 63 68 }
		$a2 = { 6C 49 45 4F 62 6A 65 63 74 5F 44 6F 63 75 6D 65 6E 74 43 6F 6D 70 6C 65 74 65 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Cbe3313A : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "cbe3313a-ab8f-4bf1-8f62-b5494c6e7034"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1607-L1625"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1ca2a28c851070b9bfe1f7dd655f2ea10ececef49276c998a1d2a1b48f84cef3"
		logic_hash = "41a731cefe0c8ee95f1db598b68a8860ef7ff06137ce94d0dd0b5c60c4240e85"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "dc92cec72728b1df78d79dc5a34ea56ee0b8c8199652c1039288c46859799376"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 EC 08 68 E6 25 40 00 64 A1 00 00 00 00 50 64 89 25 00 00 00 00 83 EC 2C 53 56 57 89 65 F8 C7 45 FC D0 25 40 00 A1 94 B1 41 00 33 F6 3B C6 89 75 EC 89 75 E8 89 75 E4 0F 8E E7 00 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_779Cf969 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "779cf969-d1a0-4280-94cb-c7f62d33482c"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1627-L1645"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ef281230c248442c804f1930caba48f0ae6cef110665020139f826ab99bbf274"
		logic_hash = "ad0f2d78386abf4c6dc6b5a4a88b4dcf8e5bf8086b08bac91e5e00be9936e908"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "7e089462cc02e2c9861018df71bf5dda6a3a982d3d98b252d44387c937526be4"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 3E 43 6F 70 79 72 69 67 68 74 20 28 63 29 20 50 79 74 68 6F 6E 20 53 6F 66 74 77 61 72 65 20 46 6F 75 6E 64 61 74 69 6F 6E 2E 20 41 6C 6C 20 72 69 67 68 74 73 20 72 65 73 65 72 76 65 64 2E }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_D568682A : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "d568682a-94d2-41e7-88db-f6d6499cbdb2"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1647-L1665"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0d98bc52259e0625ec2f24078cf4ae3233e5be0ade8f97a80ca590a0f1418582"
		logic_hash = "97e172502037c7a5d66327fcc4a237e5548694fc7d73a535838ad56367f15d76"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "2195cf67cdedfe7531591f65127ef800062d88157126393d0a767837a9023632"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 28 00 00 0A 28 22 00 00 0A 80 19 00 00 04 28 53 00 00 06 28 2D 00 00 0A 28 5D 00 00 06 16 80 1D 00 00 04 7E 13 00 00 04 7E 15 00 00 04 16 7E 15 00 00 04 8E B7 16 14 FE 06 5B 00 00 06 73 79 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Ccb6A7A2 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "ccb6a7a2-6003-4ba0-aefc-3605d085486d"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1667-L1686"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "60503212db3f27a4d68bbfc94048ffede04ad37c78a19c4fe428b50f27af7a0d"
		logic_hash = "312265bbc4330a463bbe7478c70233f5df3353bda3c450562f2414f3675ba91e"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "a73b0e067fce2e87c08359b4bb2ba947cc276ff0a07ff9e04cabde529e264192"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 40 52 61 6E 67 65 3A 62 79 74 65 73 3D 30 2D }
		$a2 = { 46 49 77 41 36 4B 58 49 75 4E 66 4B 71 49 70 4B 30 4D 57 4D 74 49 38 4B 67 4D 68 49 39 4B 30 4D 53 49 6A 4B 66 4D 73 49 76 4B 75 4D 64 49 70 4B 30 4D 73 49 66 4B 68 4D 6F 49 69 43 6F 4D 6C 49 71 4B }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_D62F1D01 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "d62f1d01-4e24-4a93-85ad-3a3886d5de2f"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1688-L1706"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "380892397b86f47ec5e6ed1845317bf3fd9c00d01f516cedfe032c0549eef239"
		logic_hash = "fd65eb56f3a48c37f83d3544c039d29c231cac1e2f8f07d176d709432a75a4c3"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f7736c8920092452ca795583a258ad8b1ffd79116bddde3cff5d06b3ddab31b6"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 51 53 56 8B 75 08 33 C0 57 8B FE AB AB AB 8B 7D 0C 8B 45 10 03 C7 89 45 FC 3B F8 73 3F 0F B7 1F 53 E8 01 46 00 00 59 66 3B C3 75 28 83 46 04 02 83 FB 0A 75 15 6A 0D 5B 53 E8 E9 45 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_2Bb6F41D : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "2bb6f41d-41bb-4257-84ef-9026fcc0ebec"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1708-L1728"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "afa060352346dda4807dffbcac75bf07e8800d87ff72971b65e9805fabef39c0"
		logic_hash = "7c4e62b69880eb8a901d7e94b7539786e8ac58808df07cb1cbe9ff45efce518e"
		score = 75
		quality = 69
		tags = "FILE, MEMORY"
		fingerprint = "d9062e792a0b8f92a03c0fdadd4dd651a0072faa3dd439bb31399a0c75a78c21"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 67 65 74 5F 73 45 78 70 59 65 61 72 }
		$a2 = { 73 65 74 5F 73 45 78 70 59 65 61 72 }
		$a3 = { 42 72 6F 77 73 65 72 50 61 74 68 54 6F 41 70 70 4E 61 6D 65 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_C54Ed0Ed : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "c54ed0ed-9c63-437c-a016-d960bbb83c40"
		date = "2024-01-21"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1730-L1747"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "f0f4878cb003371522ed1419984f15fd5049f1adeb8e051b8b51b31b0d620e96"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "1e08706e235d6cf23d9c772e1b67463b3e6261a5155d88762472d892079df0d4"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 81 FA 00 10 00 00 72 1C 48 83 C2 27 4C 8B 41 F8 49 2B C8 48 8D 41 F8 48 83 F8 1F 0F 87 92 00 00 00 49 8B C8 ?? ?? ?? ?? ?? 48 83 63 10 00 33 C0 EB 58 4D 8B CC 4D 8B C7 49 8B D6 48 8B CE FF D0 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Dbe41439 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "dbe41439-982d-4897-9007-9ad0f206dc75"
		date = "2024-01-21"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1749-L1767"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "64afd2bc6cec17402473a29b94325ae2e26989caf5a8b916dc21952149d71b00"
		logic_hash = "288cdc285d024f2b69847e0d49bd4dc1c86a2a6a24a7b4fb248071855ba39a38"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f7c94f5bc3897c4741899e4f6d2731cd07f61e593500efdd33b5d84693465dd3"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 E4 F8 83 EC 2C 53 56 8B F1 57 89 74 24 10 8B 46 1C 8B 08 85 C9 74 23 8B 56 2C 8B 3A 8D 04 0F 3B C8 73 17 8D 47 FF 89 02 8B 4E 1C 8B 11 8D 42 01 89 01 0F B6 02 E9 F1 00 00 00 33 DB }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_51A52B44 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "51a52b44-025b-4068-89eb-01cdf66efb4e"
		date = "2024-01-21"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1769-L1787"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "303aafcc660baa803344bed6a3a7a5b150668f88a222c28182db588fc1e744e0"
		logic_hash = "aad1c350f43cf2e0512e085e1a04db6099c568e375423afb9518b1fb89801c21"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "b10f3a3ceab827482139a9cadbd4507767e4d941191a7f19af517575435a5f70"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 40 6A 67 72 72 6C 6E 68 6D 67 65 77 77 68 74 69 63 6F 74 6D 6C 77 6E 74 6A 6A 71 68 72 68 62 74 75 64 72 78 7A 63 72 67 65 78 65 70 71 73 7A 73 75 78 6B 68 6E 79 63 74 72 63 63 7A 6D 63 63 69 63 61 61 68 70 66 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_5C18A7F9 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "5c18a7f9-01af-468b-9a63-cfecbeb739d7"
		date = "2024-01-21"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1789-L1807"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "fd272678098eae8f5ec8428cf25d2f1d8b65566c59e363d42c7ce9ffab90faaa"
		logic_hash = "05cea396567ed3e23907dec4e6e3a6629cd1044d9123cde0575a04b73bae6c20"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "68c9114ac342d527cf6f0cea96b63dfeb8e5d80060572fad2bbc7d287c752d4a"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 5D E9 CD 1A 00 00 8B FF 55 8B EC 51 FF 75 08 C7 45 FC 00 00 00 00 8B 45 FC E8 03 1B 00 00 59 C9 C3 8B FF 55 8B EC 51 56 57 E8 6B 18 00 00 8B F0 85 F6 74 1C 8B 16 8B CA 8D 82 90 00 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Ab01Ba9E : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "ab01ba9e-01e6-405b-8aaf-ae06a8fe2454"
		date = "2024-01-21"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1809-L1829"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "2b237716d0c0c9877f54b3fa03823068728dfe0710c5b05e9808eab365a1408e"
		logic_hash = "cc8d79950e21270938d2ea7e501c7c8fdbebe92767b48b46bb03c08c377e095b"
		score = 75
		quality = 69
		tags = "FILE, MEMORY"
		fingerprint = "dd9feb5d5756b3d3551ae21982b5e6eb189576298697b7d7d4bd042e4fc4c74f"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 53 3C 3B 54 24 38 74 23 45 3B 6C 24 2C }
		$a2 = { 3A 3D 3B 47 3B 55 3B 63 3B 6A 3B 7A 3B }
		$a3 = { 56 30 61 30 6B 30 77 30 7C 30 24 39 32 39 37 39 41 39 4F 39 5D 39 64 39 75 39 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_917D7645 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "917d7645-f13e-4d66-ab9e-447a19923ab7"
		date = "2024-01-21"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1831-L1849"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "19b54a20cfa74cbb0f4724155244b52ca854054a205be6d148f826fa008d6c55"
		logic_hash = "65748ff2e4448f305b9541ea9864cc6bda054d37be5ed34110a2f64c8fef30c7"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "557b459c07dc7d7e32cac389673d5ab487d1730de20a9ec74ae9432325d40cd2"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 E4 E0 56 57 53 81 EC D4 0A 00 00 8B D9 8B F2 BA 1D 00 00 00 FF 73 1C 8D 8C 24 BC 0A 00 00 E8 19 A1 02 00 6A 00 FF B4 24 BC 0A 00 00 8D 8C 24 A8 0A 00 00 E8 D4 06 03 00 8D 8C 24 B8 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_7A09E97D : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "7a09e97d-ccab-48d7-80d3-d76253a4d7e2"
		date = "2024-01-21"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1851-L1869"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c0c1e333e60547a90ec9d9dac3fc6698b088769bc0f5ec25883b2c4d1fd680a9"
		logic_hash = "b65b2d12901953c137687a7b466c78e0537a2830c37a4cb13dd0eda457bba937"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "3302bbee32c9968d3131277f4256c5673bec6cc64c1d820a32e66a7313387415"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 28 00 00 06 2A 3A FE 09 00 00 FE 09 01 00 6F 8D 00 00 0A 2A 00 4A FE 09 00 00 FE 09 01 00 FE 09 02 00 6F 8E 00 00 0A 2A 00 1E 00 28 43 00 00 06 2A 5A FE 09 00 00 FE 09 01 00 FE 09 02 00 FE 09 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Dc4Ede3B : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "dc4ede3b-d0c7-4993-8629-88753d65a7ad"
		date = "2024-01-21"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1871-L1889"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c49f20c5b42c6d813e6364b1fcb68c1b63a2f7def85a3ddfc4e664c4e90f8798"
		logic_hash = "c402d5f16f2be32912d7a054b51ab6dafc6173bb5a267a7846b3ac9df1c4c19f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "8be5afdf2a5fe5cb1d4b50d10e8e2e8e588a72d6c644aa1013dd293c484da33b"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 89 E5 83 EC 28 C7 45 FC 00 00 00 00 C7 44 24 18 00 00 00 00 C7 44 24 14 00 00 00 00 C7 44 24 10 03 00 00 00 C7 44 24 0C 00 00 00 00 C7 44 24 08 00 00 00 00 C7 44 24 04 00 00 00 80 8B 45 08 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Bb480769 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "bb480769-57fb-4c93-8330-450f563fd4c6"
		date = "2024-01-21"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1891-L1909"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "010e3aeb26533d418bb7d2fdcfb5ec21b36603b6abb63511be25a37f99635bce"
		logic_hash = "1087e0befceac2606ce5dc5f2b42b45ebad888e7d3e451c3fb89de7e932a31f5"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "9c58c2e028f99737574d49e47feb829058f6082414b58d6c9e569a50904591e7"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 89 E5 C6 45 03 B8 C7 45 08 BA EF BE AD C7 45 0C DE 89 10 BA C7 45 10 EF BE AD DE C7 45 14 89 50 04 B8 C7 45 18 EF BE AD DE C7 45 1C 6A 00 6A 01 C7 45 20 6A 00 FF D0 C7 45 24 B8 EF BE AD C7 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_5Fbf5680 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "5fbf5680-05c3-4a77-95d7-fa3cae7b4dbe"
		date = "2024-01-21"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1911-L1929"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1b0553a9873d4cda213f5464b5e98904163e347a49282db679394f70d4571e77"
		logic_hash = "ec5399f6fb29125cb4c096851b9194fa35fb1e5ddd1f4d4f07b155471ae5c619"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "7cbd8d973f31505e078781bed8067ae8dce72db076c670817e1a77e48dc790fe"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 EC 3C 56 57 8B 45 08 50 E8 51 AF 00 00 83 C4 04 89 45 FC 8B 45 FC 83 C0 58 99 8B C8 8B F2 8B 45 08 99 2B C8 1B F2 89 4D F8 66 0F 57 C0 66 0F 13 45 EC C7 45 DC FF FF FF FF C7 45 E0 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Aa30A738 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "aa30a738-616b-408c-960f-c0ea897145d0"
		date = "2024-01-21"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1931-L1949"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "7726a691bd6c1ee51a9682e0087403a2c5a798ad172c1402acf2209c34092d18"
		logic_hash = "64967fbc0e74435452752731a8b9385345cc771d27ee33cd018cccdeb26bb75e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "d2a4e1d4451d28afcef981f689de3212ff5d9c4ee8840864656082ef272f7501"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 8B 55 0C 85 D2 75 04 33 C0 5D C3 8B 45 08 53 56 8B 75 10 83 FE 08 57 F7 D0 B9 FF 00 00 00 0F 8C D1 00 00 00 8B FE C1 EF 03 8B DF F7 DB 8D 34 DE 89 75 10 0F B6 1A 8B F0 23 F1 33 F3 8B }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_9A8Dc290 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "9a8dc290-d9ec-4d52-a4e8-db4ac6ceb164"
		date = "2024-01-21"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1951-L1969"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "d951562a841f3706005d7696052d45397e3b4296d4cd96bf187920175fbb1676"
		logic_hash = "0097a13187b953ebe97809dda2be818cfcd94991c03e75f344e34a3d2c4fe902"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e9f42a0fdd778b8619633cce87c9d6a3d26243702cdd8a56e524bf48cf759094"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 6F 01 00 06 FE 0E 0B 00 FE 0C 0B 00 FE 0C 09 00 6F 78 01 00 06 FE 0C 0B 00 FE 0C 08 00 28 F2 00 00 06 6F 74 01 00 06 FE 0C 0B 00 FE 0C 07 00 28 F2 00 00 06 6F 76 01 00 06 FE 0C 0B 00 FE 09 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Bbf2A354 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "bbf2a354-64e5-4115-aaf7-2705194445da"
		date = "2024-01-22"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1971-L1989"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b4e6c748ad88070e39b53a9373946e9e404623326f710814bed439e5ea61fc3e"
		logic_hash = "6be2fae41199daea6b9d0394c9af7713543333a50620ef417bb8439d5a07f336"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "8fb9fcf8b9c661e4966b37a107d493e620719660295b200cfc67fc5533489dee"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 54 68 61 74 20 70 72 6F 67 72 61 6D 20 6D 75 73 74 20 62 65 20 72 75 6E 20 75 6E 64 65 72 20 57 69 6E 33 32 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Da0F3Cbb : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "da0f3cbb-e894-48a3-9169-b011e7ab278d"
		date = "2024-01-22"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L1991-L2009"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b2c456d0051ffe1ca7e9de1e944692b10ed466eabb38242ea88e663a23157c58"
		logic_hash = "262d0bbb69adde8c4c8645813b048f3aaa2dbcc83996606e7ca21c3edea2b5d8"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f50116e1f153d2a0e1e2dad879ba8bd6ac9855a563f6cbcbe6b6a06a96e86299"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 8B 45 0C 53 56 83 F8 FF 57 8B F1 74 03 89 46 10 8B 7D 08 33 DB 3B FB 75 17 FF 76 04 E8 C6 09 00 00 59 89 5E 04 89 5E 0C 89 5E 08 E9 D9 00 00 00 8B 4E 04 3B CB 75 23 8D 1C 3F 53 E8 7E }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_7D555B55 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "7d555b55-20fb-42d4-b337-c267a34fd459"
		date = "2024-01-22"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2011-L2029"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "7efa5c8fd55a20fbc3a270cf2329d4a38f10ca372f3428bee4c42279fbe6f9c3"
		logic_hash = "dc3a3622abbc7d0a02d8d9ed4446d0a72a603ecfd6594ecfa615e5418a9c9970"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "eedf850c3576425fb37291f954dfa39db758cdad0a38f85581d2bcaedcb54769"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 EC 40 53 56 57 6A 0F 59 BE 84 77 40 00 8D 7D C0 8B 5D 0C F3 A5 66 A5 8B CB 33 C0 A4 8B 7D 08 8B D1 C1 E9 02 F3 AB 8B CA 83 E1 03 F3 AA 33 C0 8D 7D 0E 50 66 AB FF 15 BC 60 40 00 50 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_0A38C7D0 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "0a38c7d0-8f5e-4dcf-9aaf-5fcf96451d3c"
		date = "2024-01-22"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2031-L2049"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "69ea7d2ea3ed6826ddcefb3c1daa63d8ab53dc6e66c59cf5c2506a8af1c62ef4"
		logic_hash = "e3fde76825772683c57f830759168fc9a3b3f3387f091828fd971e9ebba06d8a"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "43998ceb361ecf98d923c0388c00023f19d249a5ac0011dee0924fdff92af42b"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 8B 4D 08 85 C9 74 37 8B 45 0C 3D E0 10 00 00 7C 05 B8 E0 10 00 00 85 C0 7E 24 8D 50 FF B8 AB AA AA AA F7 E2 D1 EA 83 C1 02 42 53 8B FF 8A 41 FE 8A 19 88 59 FE 88 01 83 C1 03 4A 75 F0 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_98527D90 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "98527d90-90fb-4428-ab3f-6bbf23139a6e"
		date = "2024-01-24"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2051-L2069"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "fa24e7c6777e89928afa2a0afb2fab4db854ed3887056b5a76aef42ae38c3c82"
		logic_hash = "5a93f0a372f3a51233c6b2334539017df922f35a0d5f7d1749e0dd79268cb836"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "dac4d9e370992cb4a064d64660801fa165a7e0a1f4a52e9bc3dc286395dcbc91"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 20 FF D5 48 8D 87 0F 02 00 00 80 20 7F 80 60 28 7F 4C 8D 4C 24 20 4D 8B 01 48 89 DA 48 89 F9 FF D5 48 83 C4 28 5D 5F 5E 5B 48 8D 44 24 80 6A 00 48 39 C4 75 F9 48 83 EC 80 E9 8D 70 FC }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Baba80Fb : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "baba80fb-1d8a-424c-98e2-904c8f2e4f09"
		date = "2024-01-24"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2071-L2089"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "dd22cb2318d66fa30702368a7f06e445fba4b69daf9c45f8e83562d2c170a073"
		logic_hash = "ba0da35bc00b776ae9b427e3a4b312b1b75bdc9b972fb52f26a5df6737f1ddc9"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "71d9345d0288bfbbf7305962e5e316801d4a5cba332c5f4167f8e4f39cff6f61"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 EC 0C 8B 4D 0C 53 56 57 8B 59 20 8D 71 20 8B F9 89 75 FC 85 DB 89 7D 0C 75 05 8B 59 24 EB 0C 8D 41 24 89 45 F8 8B 00 85 C0 75 30 8B 51 28 8B 41 2C 85 DB 74 03 89 53 28 85 D2 74 15 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_9F4A80B2 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "9f4a80b2-e1ee-4825-a5e5-79175213da7d"
		date = "2024-01-24"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2091-L2109"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "47d57d00e2de43f33cd56ff653adb59b804e4dbe37304a5fa6a202ee20b50c24"
		logic_hash = "1df3b8245bc0e995443d598feb5fe2605e05df64b863d4f47c17ecbe8d28c3ea"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "86946aea009f8debf5451ae7894529dbcf79ec104a51590d542c0d64a06f2669"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 28 00 00 0A 2A 20 02 00 00 00 FE 0E 08 00 00 FE 0C 08 00 20 00 00 00 00 FE 01 39 0A 00 00 00 00 20 01 00 00 00 FE 0E 08 00 00 FE 0C 08 00 20 02 00 00 00 FE 01 39 05 00 00 00 38 05 00 00 00 38 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_39E1Eb4C : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "39e1eb4c-32ba-4c78-9997-1c75b41dcba6"
		date = "2024-01-24"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2111-L2129"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a733258bf04ffa058db95c8c908a79650400ebd92600b96dd28ceecac311f94a"
		logic_hash = "d7791ae7513bc5645bcfa93a2d7bf9f7ef47a6727ea2ba5eb85f3c8528761429"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "63d21d89b4ceea1fbc44a1dfd2dbb9ac3eb945884726a9809133624b10168c7a"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 E4 F8 83 EC 6C 53 56 8B 75 08 57 8B C6 8D 4C 24 58 E8 26 80 00 00 8B C6 8D 4C 24 38 E8 1B 80 00 00 80 7C 24 54 00 8B 7E 0C 8B 5E 08 89 7C 24 1C 74 09 8B 74 24 50 E8 61 80 00 00 83 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_D51Dd31B : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "d51dd31b-1735-4fd7-9906-b07406a9d20c"
		date = "2024-01-24"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2131-L2150"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "2a61c0305d82b6b4180c3d817c28286ab8ee56de44e171522bd07a60a1d8492d"
		logic_hash = "85fc7aa81489b304c348ead2d7042bb5518ff4579b1d3e837290032c4b144e47"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "f313354a52ba8058c36aea696fde5548c7eb9211cac3b6caa511671445efe2a7"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 7E 7D 7C 7B 7A 79 78 78 76 77 74 73 72 }
		$a2 = { 6D 6C 6B 6A 69 68 67 66 65 64 63 62 61 60 60 5E 66 60 5B 5A }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_3A321F0A : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "3a321f0a-2775-455f-b8c2-30591ebfe4ac"
		date = "2024-01-29"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2152-L2170"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "91056e8c53dc1e97c7feafab31f0943f150d89a0b0026bcfb3664d2e93ccfe2b"
		logic_hash = "83834dd7d4df5de4b6a032f1896f52c1ebdf16ca8ad9766e8872243f1a6da67e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "230c3bbc70ec93888f5cd68598dcc004844db67f17d1048a51f6c6408bc4a956"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 EC 44 8D 45 14 8B 4D 10 85 C9 89 5D F8 89 7D FC 0F 8E 3D 01 00 00 49 8D 55 17 83 E2 FC 89 4D 10 85 C9 8D 42 08 8B 58 F8 8B 78 FC 89 5D D4 89 7D D8 0F 8E 31 01 00 00 83 C2 0B 49 83 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_A82F45A8 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "a82f45a8-8e47-4966-9d48-9af61a21ac42"
		date = "2024-01-29"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2172-L2190"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ad07428104d3aa7abec2fd86562eaa8600d3e4b0f8d78ba1446f340d10008b53"
		logic_hash = "70ebab6b03af38ef8c81664cf49ab07066a9672666599d99c91291a9d2e3af0b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e3a1faabc15e2767eb065f4e2a7c6f75590cba1368db1aab1af972a5aeca4031"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 51 89 4D FC 8B 4D 08 51 8B 4D FC 83 C0 04 E8 66 7D F6 FF 59 5D C2 08 00 90 55 8B EC 51 89 4D FC 8B 4D 08 51 41 51 8B 4D FC E8 CF FF FF FF 59 5D C2 04 00 8B C0 55 8B EC 83 C4 F8 53 56 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_D6625Ad7 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "d6625ad7-7f2c-4445-a5f2-a9444425f3a4"
		date = "2024-01-29"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2192-L2210"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "878c9745320593573597d62c8f3adb3bef0b554cd51b18216f6d9f5d1a32a931"
		logic_hash = "e90aff7c35f60cc3446f9eeb2131edb7125bfa04eb8f90c5671d06e9ff269755"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "0e1bb99e22b53e6bb6350f95caaac592ddcad7695e72e298c7ab1d29d1dd4c1f"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 2E 3F 41 56 3C 6C 61 6D 62 64 61 5F 31 3E 40 3F 4C 40 3F 3F 6F 6E 5F 65 76 65 6E 74 5F 61 64 64 40 43 6F 6D 70 6F 6E 65 6E 74 5F 4B 65 79 6C 6F 67 65 72 40 40 45 41 45 58 49 40 5A 40 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_61Bbb571 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "61bbb571-8544-4874-9811-bd74a5e9f712"
		date = "2024-01-29"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2212-L2230"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "41e2a6cecb1735e8f09b1ba5dccff3c08afe395b6214396e545347927d1815a8"
		logic_hash = "6b1ec666f3689638b9db9f041b0a89660b27c32590b747c5da3f4a02f01c7112"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "be0b1be30cab0789a5df29153187cf812e53cd35dbe31f9527eca2396d7503b5"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 EC 14 8B 45 08 53 56 57 8B F9 BE 49 92 24 09 6A 1C 59 89 7D F8 2B 07 99 F7 F9 89 45 FC 8B 47 04 2B 07 99 F7 F9 89 45 F0 3B C6 0F 84 E5 00 00 00 8D 58 01 8B 47 08 2B 07 99 F7 F9 8B }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_4A605E93 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "4a605e93-971d-4257-b382-065159840a4c"
		date = "2024-01-29"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2232-L2250"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1a84e25505a54e8e308714b53123396df74df1bde223bb306c0dc6220c1f0bbb"
		logic_hash = "6ad7afa5bd03916917e2bbf4d736331f4319b20bfde296d7e62315584813699f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "58185f9fdf5bbc57cd708d8c963a37824e377a045549f2eb78d5fa501082b687"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 20 48 8B 19 45 33 C0 48 85 DB 74 65 4C 89 01 48 83 FA FF 75 17 41 8B C0 44 38 03 74 2D 48 8B CB 48 FF C1 FF C0 44 38 01 75 F6 EB 1E 48 83 FA FE 75 1B 41 8B C0 66 44 39 03 74 0F 48 8B }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_B509Dfc8 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "b509dfc8-6ec3-4315-a1ec-61e6b65793e7"
		date = "2024-01-29"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2252-L2270"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9b5124e5e1be30d3f2ad1020bbdb93e2ceeada4c4d36f71b2abbd728bd5292b8"
		logic_hash = "90b00caf612f56a898b24c28ae6febda3fd11f382ab1deba522bdd2e2ba254b4"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "bb1e607fe0d84f25c9bd09d31614310e204dce17c4050be6ce7dc6ed9dfd8f92"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 28 00 00 0A 6F 29 00 00 0A 6F 2A 00 00 0A 13 04 11 04 28 22 00 00 0A 28 2B 00 00 0A 2D 0D 11 04 28 22 00 00 0A 28 2C 00 00 0A 26 06 28 2D 00 00 0A 2C 0F 06 73 28 00 00 0A 13 05 11 05 6F 2E 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_7A49053E : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "7a49053e-5ae4-4141-9471-4a92e0ee226e"
		date = "2024-01-29"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2272-L2292"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "29fb2b18cfd72a2966640ff59e67c89f93f83fc17afad2dfcacf9f53e9ea3446"
		logic_hash = "6db95f20a2bcdfd7cb37cb33dae6351dd19f51a8c3cae54b1bb034af17378094"
		score = 75
		quality = 69
		tags = "FILE, MEMORY"
		fingerprint = "49c41c5372da04b770d903013ee7f71193a4650340fd4245d6d5bceff674d637"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 5D 76 3F 3F 32 40 59 41 50 41 58 49 40 5A 66 }
		$a2 = { 41 75 74 68 6F 72 69 7A 61 26 42 61 73 69 63 48 24 }
		$a3 = { 4A 7E 4C 65 61 76 65 47 65 74 51 75 65 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Fca7F863 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "fca7f863-8d5b-4b94-8f60-a72c76782d1d"
		date = "2024-01-29"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2294-L2312"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9d0e786dd8f1dc05eae910c6bcf15b5d05b4b6b0543618ca0c2ff3c4bb657af3"
		logic_hash = "ad45fe6e8257d012824b36aaee1beccb82c1b78031de86c1f1dd26d5be88aa6f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "4b391399465f18b01d7cbdf222dd7249f4fff0a5b4b931e568d92f47cc283a27"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 89 E5 8D 64 24 F4 53 89 C3 6A 0C 8D 45 F4 50 6A 00 FF 53 10 50 FF 53 0C 50 FF 53 24 8B 45 F4 89 43 2C 03 40 3C 8B 40 50 89 43 34 6A 40 68 00 30 00 00 FF 73 34 6A 00 FF 13 89 43 30 8B 4B 34 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Cafbd6A3 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "cafbd6a3-c367-467d-b305-fb262e4d6d07"
		date = "2024-01-29"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2314-L2333"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "97081a51aa016d0e6c9ecadc09ff858bf43364265a006db9d7cc133f8429bc46"
		logic_hash = "28813fc8a49b6ec3fe7675409fde923f0f30851429a526c142e0a228b4e0efa6"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "d3237c30fb6eef10b89dc9138572f781cc7d9dad1524e2e27eee82c50f863fbb"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 6C 6B 73 6A 66 68 67 6C 6B 6A 66 73 64 67 31 33 31 }
		$a2 = { 72 65 67 20 44 65 6C 65 74 65 20 22 48 4B 4C 4D 5C 53 4F 46 54 57 41 52 45 5C 4D 69 63 72 6F 73 6F 66 74 5C 57 69 6E 64 6F 77 73 20 4E 54 5C 43 75 72 72 65 6E 74 56 65 72 73 69 6F 6E 5C 52 75 6E 4F 6E 63 65 22 20 2F 66 20 3E 20 6E 75 6C }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_D8F834A9 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "d8f834a9-41b7-4fc9-8100-87b9b07c0bc7"
		date = "2024-01-29"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2335-L2353"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c118c2064a5839ebd57a67a7be731fffe89669a8f17c1fe678432d4ff85e7929"
		logic_hash = "9fa1a65f3290867e4c59f14242f7261741e792b8be48c053ac320a315f2c1beb"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "fcf7fc680c762ffd9293a84c9ac2ba34b18dc928417ebdabd6dfa998f96ed1f6"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 C4 F4 53 56 57 8B F9 8B F2 8B D8 33 D2 8A 55 08 0F AF 53 30 D1 FA 79 03 83 D2 00 03 53 30 8B 43 34 E8 62 48 04 00 89 45 FC 68 20 00 CC 00 8B 45 20 50 57 56 8B 45 FC 8B 10 FF 52 20 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_De3F91C6 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "de3f91c6-bca8-4ed6-8ba3-a53903556903"
		date = "2024-01-31"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2355-L2373"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "e2cd4a8ccbf4a3a93c1387c66d94e9506b5981357004929ce5a41fcedfffb20f"
		logic_hash = "032ac2adb11782d823f50bfedf4e4decb731dbe7d3abbb3b05ccff598ba7edb8"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "bd994a85b967e56628a3fcd784e4d73cf6bd9f34a222d1bb52b1e87b775fdd06"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 56 8B 75 08 80 7E 04 00 74 08 FF 36 E8 0B 41 00 00 59 83 26 00 C6 46 04 00 5E 5D C3 55 8B EC 8B 45 08 8B 4D 0C 3B C1 75 04 33 C0 5D C3 83 C1 05 83 C0 05 8A 10 3A 11 75 18 84 D2 74 EC }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_F0516E98 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "f0516e98-57e1-4e88-b49d-afeff21f6915"
		date = "2024-01-31"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2375-L2394"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "21d01bd53f43aa54f22786d7776c7bc90320ec6f7a6501b168790be46ff69632"
		logic_hash = "28f5b1a05d90745f432aee6bb9da3855d70b18d556153059794c5e53bbd5117c"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "c43698c42411080f4df41f0f92948bc5d545f46a060169ee059bb47efefa978c"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 69 66 20 65 78 69 73 74 20 25 73 20 67 6F 74 6F 20 3A 72 65 70 65 61 74 }
		$a2 = { 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 61 62 63 64 65 66 67 68 69 6A 6B 6C 6D 6F 70 71 72 73 74 75 76 77 78 79 7A 30 31 32 33 34 35 36 37 38 39 5F }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_3C4D9Cbe : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "3c4d9cbe-700f-4f3e-8e66-d931d5c90d3e"
		date = "2024-01-31"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2396-L2414"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "21d01bd53f43aa54f22786d7776c7bc90320ec6f7a6501b168790be46ff69632"
		logic_hash = "b32f9a3b86c60d4d69c59250ac59e93aee70ede890b059b13be999adbe043d2c"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "15be51c438b7b2a167e61e35821445404a38c2f8c3e037061a1eba4bf0ded2b5"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 53 56 57 8B 55 08 8B DA 8B 7A 3C 03 FA 66 81 3F 50 45 75 54 03 5F 78 8B 4B 18 8B 73 20 8B 7B 24 03 F2 03 FA FC 55 8B 6D 0C AD 03 C2 96 87 FD 51 33 C9 80 C1 0F F3 A6 72 0C 96 59 87 FD }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Deb82E8C : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "deb82e8c-57dc-47ea-a786-b4e1ae41a40f"
		date = "2024-01-31"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2416-L2435"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0f5791588a9898a3db29326785d31b52b524c3097370f6aa28564473d353cd38"
		logic_hash = "c24baecab39c72f6bb30713022297cb9fb41ef5339a353702f3f780a630d5b27"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "3429ecf8f509c6833b790156e61f0d1a6e0dc259d4891d6150a99b5cb3f0f26e"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 50 6F 76 65 72 74 79 20 69 73 20 74 68 65 20 70 61 72 65 6E 74 20 6F 66 20 63 72 69 6D 65 2E }
		$a2 = { 2D 20 53 79 73 74 65 6D 4C 61 79 6F 75 74 20 25 64 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_278C589E : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "278c589e-fca0-4228-8ffa-6b5e4627b1b1"
		date = "2024-01-31"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2437-L2455"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "cccc6c1bf15a7d5725981de950475e272c277bc3b9d266c5debf0fc698770355"
		logic_hash = "59bbbecd73541750f7221b12895ccf51e1a6863ceca62e23f541df904ad23587"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "573b6c5400400b167edd94e12332d421a32dc52138a2a933f2fa85f8409c8e4a"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 49 6E 73 74 61 6C 6C 65 72 20 77 69 6C 6C 20 6E 6F 77 20 64 6F 77 6E 6C 6F 61 64 20 66 69 6C 65 73 20 72 65 71 75 69 72 65 64 20 66 6F 72 20 69 6E 73 74 61 6C 6C 61 74 69 6F 6E 2E }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_6B621667 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "6b621667-8ed2-4a6e-9fad-fc7a01012859"
		date = "2024-01-31"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2457-L2475"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b50b39e460ecd7633a42f0856359088de20512c932fc35af6531ff48c9fa638a"
		logic_hash = "3574b7ef24c4387a9919ed9831af7657047b26d8922ab78788619bbd3d0edd56"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "77d3637fea6d1ddca7b6943671f2d776fa939b063d60d8b659a0fc63acfdc869"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 51 64 A1 30 00 00 00 56 33 F6 89 75 FC 8B 40 10 39 70 08 7C 0F 8D 45 FC 50 E8 8F 0D 00 00 83 7D FC 01 74 03 33 F6 46 8B C6 5E C9 C3 8B FF 55 8B EC 51 51 53 56 6A 38 6A 40 E8 32 EB FF }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_7693D7Fd : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "7693d7fd-4161-4afb-8a8d-d487f2a7de5e"
		date = "2024-02-13"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2477-L2495"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "fc40cc5d0bd3722126302f74ace414e6934eca3a8a5c63a11feada2130b34b89"
		logic_hash = "886ad084f33faf8baae8a650a88095757c2cff9e18c8f5c50ff36120b43ec082"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "92489c8eb4f8a9da5e7bd858a47e20b342d70df1ba3a4769df06c434dc83d138"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 51 51 8B 45 08 83 65 FC 00 8B 00 0F B7 48 14 66 83 78 06 00 8D 4C 01 18 0F 86 9A 00 00 00 53 56 57 8D 59 24 8B 13 8B CA 8B F2 C1 E9 1D C1 EE 1E 8B FA 83 E1 01 83 E6 01 C1 EF 1F F7 C2 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Df5De012 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "df5de012-52b6-4558-a00b-2dbf052e34d3"
		date = "2024-02-14"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2497-L2515"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "13c06d7b030a46c6bb6351f40184af9fafaf4c67b6a2627a45925dd17501d659"
		logic_hash = "1a1ce3644c33a4591ab6582525366d47e07bdc2350aa6066ec5b5fedc605b037"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "ee293cda37e0f1c76f89a7d1e074c9591950299b2ae87cca11c6cf7fbfee1fc4"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 20 2C 3F 2C 2F 2C 37 2C 27 2C 3B 2C 2B 2C 33 2C 23 2C 3D 2C 2D 2C 35 2C 25 2C 39 2C 29 2C 31 2C 21 2C 3E 2C 2E 2C 36 2C 26 2C 3A 2C 2A 2C 32 2C 22 2C 3C 2C 2C 2C 34 2C 24 2C 38 2C 28 2C 30 2C 20 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_0E8530F5 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "0e8530f5-32ce-48a2-9413-5a8f4596ba12"
		date = "2024-02-14"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2517-L2536"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9f44d9acf79ed4450195223a9da185c0b0e8a8ea661d365a3ddea38f2732e2b8"
		logic_hash = "f4a010366625c059151d3e704f6ece1808f367401729feaf6cc423cf4d5c5c60"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "33007c3793c74aaac45434cbd0b524973073a7223d68fae8da5cbd7296120739"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 63 6D 64 20 2F 63 20 73 74 61 72 74 20 22 22 20 22 25 53 25 53 22 20 25 53 }
		$a2 = { 76 68 61 50 20 71 20 65 71 30 75 61 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Ba807E3E : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "ba807e3e-13d8-49e0-ad99-32994d490e8b"
		date = "2024-02-14"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2538-L2556"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "cabd0633b37e6465ece334195ff4cc5c3f44cfe46211165efc07f4073aed1049"
		logic_hash = "896eedb949eec6dff3e867ae3179b741382dd25ba06c6db452ac1ae5bc6bc757"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "e6ea7577f8f21e778d21b4651bf55e66ec53fb6d80d68f2ab344261be50d03cc"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 7D 4A 36 35 2B 7E 2E 2C 2F 37 2C 3D 31 7E 3B 3D 30 30 2F 2A 7E 3C 39 7E 2C 29 30 7E 35 30 7E 5A 4F 4B 7E 31 2F 3A 39 70 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_4578Ee8C : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "4578ee8c-9dfc-4fb2-b5dc-8f55b6ee26d0"
		date = "2024-02-14"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2558-L2576"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "699fecdb0bf27994d67492dc480f4ba1320acdd75e5881afbc5f73c982453fed"
		logic_hash = "1a519bb84aae29057536ea09e53ff97cfe34a70c84ac6fa7d1ec173de3754f03"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "3a40e6e8f35c5c114b1b0175723d9403c357bba7170c4350194d40d4a2c94c61"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 73 65 72 2D 41 67 65 6E 74 3A 4D 6F 7A 69 6C 6C 61 2F 34 2E 30 20 28 63 6F 6D 70 61 74 69 62 6C 65 3B 20 4D 53 49 45 20 25 64 2E 30 3B 20 57 69 6E 64 6F 77 73 20 4E 54 20 25 64 2E 31 3B 20 53 56 31 29 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Ebf62328 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "ebf62328-f069-43f2-b943-6ddf64f04fb2"
		date = "2024-02-14"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2578-L2598"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "dfce19aa2e1a3e983c3bfb2e4bbd7617b96d57602d7a6da6fee7b282e354c9e1"
		logic_hash = "e99b56dde761c5efad14f935befa4d1dbb31cd305b5d6af05a90d44dc3cd0098"
		score = 75
		quality = 69
		tags = "FILE, MEMORY"
		fingerprint = "44cce86a986cbb051f1b94c2d5b54830cbe7de1f3387e207bd6b267a5166bbe7"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 74 52 75 50 5B 5D 5F 5E 41 5C 41 5D 41 5E }
		$a2 = { 5F 5E 41 5C 41 5E 41 5F 74 7A 75 78 }
		$a3 = { 44 64 71 52 71 77 7C 61 69 41 66 6E 68 73 6F 72 48 60 6C 65 49 46 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Dcc622A4 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "dcc622a4-5c10-463b-a950-fc728f990bca"
		date = "2024-02-14"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2600-L2618"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "94a3f10396c07783586070119becf0924de9a7caf449d6e07065837d54e6222d"
		logic_hash = "9254226918f39389ccc347de1c5064552a8500ccef1884b8e27b6e98c651f45b"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "b47bd4baa68dc56948f29882cf5762b0af2d9f2a837349add4f5d0a8d4152cb2"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 5B 21 5D 20 45 72 72 6F 72 20 77 72 69 74 69 6E 67 20 73 68 65 6C 6C 63 6F 64 65 20 74 6F 20 74 68 65 20 74 61 72 67 65 74 20 64 72 69 76 65 72 2C 20 61 62 6F 72 74 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_046Aa1Ec : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "046aa1ec-5134-4a03-85c2-048b5d363484"
		date = "2024-02-20"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2620-L2638"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c74cf499fb9298d43a6e64930addb1f8a8d8336c796b9bc02ffc260684ec60a2"
		logic_hash = "da6552da3db4851806f5a0ce3c324a79acf4ee4b2690cb02cc8d8c88a2ba28f8"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "46591671500f83b6627a17368a0bbe43650da1dd58ba1a136a47818fe685bc68"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 C4 F4 D9 7D FE 66 8B 45 FE 80 CC 0C 66 89 45 FC D9 6D FC DF 7D F4 D9 6D FE 8B 45 F4 8B 55 F8 8B E5 5D C3 55 8B EC 51 33 D2 8D 5D 08 8B 03 83 C3 04 85 C0 74 03 03 50 04 49 75 F1 85 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_85C73807 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "85c73807-4181-4d4a-ba51-6ed923121486"
		date = "2024-02-20"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2640-L2658"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "7f560a22c1f7511518656ac30350229f7a6847d26e1b3857e283f7dcee2604a0"
		logic_hash = "90aa64f17b91ccdf367e1976cd1f5e89e15c7369a58b2d19187143e70939d756"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "8b63723aa1b89149c360048900a18e25a0a615f50cec1aaadca2578684f5bcb2"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 51 53 56 57 89 4D FC 8B DA 8B F0 8B 7D 08 C6 86 18 01 00 00 00 8B C3 E8 15 01 00 00 84 C0 75 0E 8B 55 FC 8B C6 8B CF E8 45 F8 FF FF EB 0F 56 57 8B FE 8B F3 B9 47 00 00 00 F3 A5 5F 5E }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_642Df623 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "642df623-00ae-48a9-8d61-aaa688606807"
		date = "2024-02-20"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2660-L2678"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "e5ba85d1a6a54df38b5fa655703c3457783f4a4f71e178f83d8aac878d4847da"
		logic_hash = "555eb66f117312fa4ff3a49c0c40f89caddec3eb4b93d11bda2cce40529d46a0"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "fb2c74f7e3e7f4e25173c375fe863e643183da4f5d718d61fdd0271fcc581deb"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 50 B8 04 00 00 00 81 C4 04 F0 FF FF 50 48 75 F6 8B 45 FC 81 C4 3C FE FF FF 53 56 57 64 8B 05 30 00 00 00 8B 40 0C 8B 40 0C 8B 00 8B 00 8B 40 18 89 45 FC 33 C9 8B 45 FC 89 45 DC 8B 45 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_27A2994F : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "27a2994f-18e4-4608-bda6-ee76b6afd357"
		date = "2024-02-20"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2680-L2698"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "e534914e06d90e119ce87f5abb446c57ec3473a29a7a9e7dc066fdc00dc68adc"
		logic_hash = "66f34ba3052e2369528aeaf076f10d58f8f3dca420666246e02191fecb057f8c"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "33d3f5b2c5fed68b19e14d6a35ee8db4ba3d6d566c87e24fc7a9223235cbd0ee"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 51 53 56 57 83 7D 08 00 75 05 E9 88 00 00 00 6A 09 E8 D7 FD FF FF 83 C4 04 8B 45 08 83 E8 20 89 45 FC 8B 4D FC 8B 51 14 81 E2 FF FF 00 00 83 FA 04 74 41 8B 45 FC 83 78 14 01 74 38 8B }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Dbceec58 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "dbceec58-0b98-470c-8439-23aa26b4064f"
		date = "2024-02-20"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2700-L2718"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "fbec30528e6f261aebf0d41f3cd6d35fcc937f1e20e1070f99b1b327f02b91e0"
		logic_hash = "2a99fb7b342b43e3a4f0136d7d618625ca5708ae32e6fcabb11420bd8c89915b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "5f470a7367ebbffebae8384aa552b3e9b1bda6bf4a3241bda047970341ee7c4c"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 EC 14 83 7D 08 00 74 0C 83 7D 0C 00 74 06 83 7D 10 00 75 08 8B 45 08 E9 87 00 00 00 8B 45 08 89 45 FC 8B 45 0C 89 45 F8 8B 45 10 C1 E8 02 89 45 EC 83 65 F4 00 EB 07 8B 45 F4 40 89 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_7407Eb79 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "7407eb79-69fd-4f5c-b883-ceb74fbdc9d5"
		date = "2024-02-20"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2720-L2738"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9ae0f053c8e2c4f4381eac8265170b79301d4a22ec1fdb86e5eb212c51a75d14"
		logic_hash = "a60c3e54493f9dab71584ba301c41c43f30d554df8c0b05674995faaf407ee48"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f1dbb42fdd80020fa2b30beb50ded6b8b3fe4b023935cef9bd32b3cb0a095654"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 EC 18 8B 45 08 8B 40 08 89 45 E8 8B 45 08 8B 40 0C 89 45 EC 8B 45 EC 83 C0 0C 89 45 F0 8B 45 F0 8B 00 89 45 F8 83 65 F4 00 E8 00 00 00 00 58 89 45 F4 8B 45 F8 3B 45 F0 74 31 8B 45 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_3613Fa12 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "3613fa12-b559-4c3f-8049-11bacd5ffd0c"
		date = "2024-02-20"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2740-L2758"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1403ec99f262c964e3de133a10815e34d2f104b113b0197ab43c6b7b40b536c0"
		logic_hash = "77b23aaf384de138214e64342e170f3dce667ee41c3063c999286da9af6fff42"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "c66b5dad2e9b19be0bc67a652761d8f79ce85efde055cc412575c2d7c5583795"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 51 89 4D FC 8D 45 08 50 8B 4D FC E8 4D 03 00 00 8B 45 FC 8B E5 5D C2 04 00 CC CC CC CC 55 8B EC 51 89 4D FC 8B 45 FC 8B E5 5D C3 CC CC 55 8B EC 51 89 4D FC 8B 45 08 50 8B 4D FC E8 FD }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_B125Fff2 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "b125fff2-7b36-431f-8ed3-ccb6d4ff9483"
		date = "2024-02-20"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2760-L2778"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9c641c0c8c2fd8831ee4e3b29a2a65f070b54775e64821c50b8ccd387e602097"
		logic_hash = "054f3f36c688e1f5c3116e7a926df12df90f79dc1d42bee2616b5251f6ad2c24"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e2562c480b3ab0f0e6c5d396bc5d0584481348c1dd8edaac4484d9cb5d4a2b2e"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 6F 00 00 0A 6F 70 00 00 0A 00 28 24 00 00 06 0A 06 2C 24 00 28 1B 00 00 06 0B 07 2C 19 00 28 CE 04 00 06 16 FE 01 0C 08 2C 0B 7E 03 00 00 04 6F D3 04 00 06 00 00 00 28 1A 00 00 06 00 28 18 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_D7E5Ec2D : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "d7e5ec2d-bcd1-41a3-80de-12808b9034c9"
		date = "2024-02-20"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2780-L2798"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "fe711664a565566cbc710d5e678a9a30063a2db151ebec226e2abcd24c0a7e68"
		logic_hash = "4edb8cc1da81e0b9b3a8facc9a9a7d1e27dff0d2db7851d06a209beec3ccb463"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e679e6917c5055384c0492e4a8a7538b41e5239b78e2167b04fffa3693f036bb"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 C4 F8 89 45 FC 8B 45 FC E8 17 FE FF FF 83 FA 00 75 03 83 F8 FF 77 16 8B 45 FC E8 F1 FE FF FF 83 FA 00 75 03 83 F8 FF 77 04 33 C0 EB 02 B0 01 88 45 FB 8A 45 FB 59 59 5D C3 8D 40 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_1636C2Bf : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "1636c2bf-5506-4651-9c4c-cd6454386301"
		date = "2024-03-04"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2800-L2818"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6e43916db43d8217214bbe4eb32ed3d82d0ac423cffc91d053a317a3dbe6dafb"
		logic_hash = "c8b198cd5f9277ff3808ee2a313ab979d544b9e609d6623876d2e3c3c5668e38"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b0cd9f484d4191d42091300be33c72a29c073c297b4e46811555fc6d1ab0f482"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 28 00 00 0A 28 22 00 00 0A 80 19 00 00 04 28 3B 00 00 06 28 2D 00 00 0A 28 45 00 00 06 16 80 1D 00 00 04 7E 13 00 00 04 7E 15 00 00 04 16 7E 15 00 00 04 8E B7 16 14 FE 06 43 00 00 06 73 63 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_0A640296 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "0a640296-0813-4cd3-b55b-01b3689e73d9"
		date = "2024-03-04"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2820-L2838"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "3682eff62caaf2c90adef447d3ff48a3f9c34c571046f379d2eaf121976f1d07"
		logic_hash = "743c47c7a58e7d65261818b4b444aaf8015b9b55d3e54526b1d63a8770a6c5aa"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "3fa8712dbf0cdb0581fc312bcfa2e9ea50e04cccba6dc93f377c1b64e96784aa"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 28 00 00 0A 02 7B 0F 00 00 04 6F 29 00 00 0A 7D 10 00 00 04 02 7B 10 00 00 04 28 2A 00 00 0A 00 02 7B 08 00 00 04 7B 03 00 00 04 02 7B 10 00 00 04 6F 2B 00 00 0A 16 FE 01 0D 09 39 29 01 00 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_B1Ef4828 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "b1ef4828-10bd-41f8-84b5-041bf3147c0b"
		date = "2024-03-04"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2840-L2859"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "29b20ff8ebad05e4a33c925251d08824ca155f5d9fa72d6f9e359e6ec6c61279"
		logic_hash = "d5d63f38308c6f8e5ca54567c7c8b93fcde69601fbcc28d56d5231edd28163cf"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "e867d9a0a489d95898f85578c71d7411eac3142539fcc88df51d1cf048d351a9"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 70 36 72 20 74 24 76 28 78 2C 7A 30 7C 34 7E 38 7E 3C 7E 40 7E 54 7E 74 7E 7C 5D }
		$a2 = { 7E 30 7E 34 7E 43 7E 4F 7E 5A 7E 6E 7E 79 7E }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_48Cbdc20 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "48cbdc20-386a-491e-8407-f7c4c348f2e9"
		date = "2024-03-04"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2861-L2880"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "7a7704c64e64d3a1f76fc718d5b5a5e3d46beeeb62f0493f22e50865ddf66594"
		logic_hash = "687d0f3dc85a7e4b23019deec59ee77c211101d40ed6622a952e69ebc4151483"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "98db38ebd05e99171489828491e6acfc7c4322283b325ed99429f366b0ee01a6"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 5E 69 69 69 4E 42 42 42 3E 2E 2E 2E 25 }
		$a2 = { 24 2E 2E 2E 2F 41 41 41 3A 51 51 51 47 5D 5D 5D 54 69 69 69 62 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_420E1Cdc : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "420e1cdc-2d47-437a-986d-ff22d2fac978"
		date = "2024-03-04"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2882-L2900"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b20254e03f7f1e79fec51d614ee0cfe0cb87432f3a53cf98cf8c047c13e2d774"
		logic_hash = "6bd8a7bd4392e04d64f2e0b93d80978f59f9af634a0c971ca61cb9cb593743e0"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "33f35c5c73656fc5987c39fabefa1225fef1734f4217518a1b6e7a78669c90c5"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 51 56 8B 75 08 85 F6 74 5A ?? ?? ?? ?? ?? 83 F8 03 75 16 56 E8 ED 01 00 00 59 85 C0 56 74 36 50 E8 0C 02 00 00 59 59 EB 3A 83 F8 02 75 26 8D 45 08 50 8D 45 FC 50 56 E8 25 0F 00 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_4C37E16E : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "4c37e16e-b7ca-449a-a09f-836706b2f66a"
		date = "2024-03-04"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2902-L2921"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "d83a8ed5e192b3fe9d74f3a9966fa094d23676c7e6586c9240d97c252b8e4e74"
		logic_hash = "dabac8aa6a3f4d4bd726161fc6573ca9de4088e7d818c3cf33cafc91f680e7aa"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "9fbd2883fb0140de50df755f7099a0dc3cf377ee350710108fef96c912f43460"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 2E 3F 41 56 43 44 72 6F 70 41 70 69 40 40 }
		$a2 = { 2D 2D 77 77 6A 61 75 67 68 61 6C 76 6E 63 6A 77 69 61 6A 73 2D 2D }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_5Be3A474 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "5be3a474-d12f-489f-a2a7-87d29687e2e6"
		date = "2024-03-04"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2923-L2941"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b902954d634307260d5bd8fb6248271f933c1cbc649aa2073bf05e79c1aedb66"
		logic_hash = "0f0f46e3bdebb47a4f43ccb64d65ab1e15d68d38c117cb25e5723ec16e7e0758"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "8b220ea86ad3bbdcf6e2f976dc0bb84c1eb8cb1f3ad46ab5c9d19289952c912b"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 51 53 56 57 8B F9 33 F6 8D 5F 02 66 8B 07 83 C7 02 66 3B C6 75 F5 8A 01 2B FB D1 FF 8D 5F FF 85 DB 7E 23 0F B6 F8 83 C1 02 66 8B 01 8D 49 02 66 2B C7 C7 45 FC 00 08 00 00 66 2B 45 FC }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_B191061E : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "b191061e-7b83-4161-a1d4-05ab70ffe2be"
		date = "2024-03-04"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2943-L2961"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "bd4ef6fae7f29def8e5894bf05057653248f009422de85c1e425d04a0b2df258"
		logic_hash = "cbee10eab984249ceb9f8a82dc06aa014d6a249321f3d4f0d1e5657aab205ec8"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "5733de0357a6b5f6a3fe885786084c23707266b48e67b19dcddc48ed97e94207"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 EC 2C 64 A1 30 00 00 00 33 D2 53 56 57 8B 40 0C 8B F2 89 4D E8 89 55 F4 89 75 F8 8B 58 0C 8B 7B 18 89 7D F0 85 FF 0F 84 34 01 00 00 C7 45 E0 60 00 00 00 8B 43 30 89 55 FC 89 55 EC }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_05F52E4D : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "05f52e4d-d131-491a-a037-069b450e3b3e"
		date = "2024-03-04"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2963-L2981"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "e578b795f8ed77c1057d8e6b827f7426fd4881f02949bfc83bcad11fa7eb2403"
		logic_hash = "79898b59b6d3564aad85d823a1450600faff5b1d2dbfbe0cee4cc59971e4f542"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f3d5f6dc1f9b51ce1700605c8a018000124d66a260771de0da1a321dc97872dd"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 28 00 00 06 73 45 00 00 0A 73 46 00 00 0A 6F 47 00 00 0A 14 FE 06 29 00 00 06 73 45 00 00 0A 73 46 00 00 0A 0B 14 FE 06 2A 00 00 06 73 45 00 00 0A 73 46 00 00 0A 0C 07 6F 47 00 00 0A 08 6F 47 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_C34E19E9 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "c34e19e9-c666-4fc5-bbb3-75f64d247899"
		date = "2024-03-04"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L2983-L3001"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f9048348a59d9f824b45b16b1fdba9bfeda513aa9fbe671442f84b81679232db"
		logic_hash = "87999b6f2cf359b6436ee7e57691ac73fc41f3947bf8fef3f6b98148e17f180d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "148ffb1f73a3f337d188c78de638880ea595a812dfa7a0ada6dc66805637aeb3"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 28 00 00 0A 73 18 00 00 0A 7E 02 00 00 04 17 8D 3A 00 00 01 25 16 1F 2C 9D 6F 28 00 00 0A 8E 69 6F 29 00 00 0A 9A 0A 7E 01 00 00 04 17 8D 3A 00 00 01 25 16 1F 2C 9D 6F 28 00 00 0A 73 18 00 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_E691Eaa1 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "e691eaa1-06fa-478e-8c4c-95a7df3fd077"
		date = "2024-03-04"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3003-L3021"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "afa5f36860e69b9134b93e9ad32fed0a5923772e701437e1054ea98e76f28a77"
		logic_hash = "0ac310e3f7cf99b77c2dcfea582752e2f1414caf43965c25d2f3f03cf27586cc"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b940eb10e338f6d703a75cd77b4b455503ae0583f5a36b8115e659d05990fc3c"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 51 8B C2 53 89 45 FC 8B D9 56 99 33 F6 2B C2 57 8B F8 D1 FF 85 FF 7E 2B 8B 55 FC 4A 03 D3 0F B6 02 8D 52 FF 8A 0C 1E ?? ?? ?? ?? ?? ?? ?? 88 04 1E 46 0F B6 C1 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_5E33Bb4B : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "5e33bb4b-830e-4814-b6cf-d5e5b4da7ada"
		date = "2024-03-04"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3023-L3041"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "13c06d7b030a46c6bb6351f40184af9fafaf4c67b6a2627a45925dd17501d659"
		logic_hash = "7e2002c3917ccab7d9f56a7aa20ea75be71aa7fdc64b7c3f87edb68be38e74b2"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "a08b9db015f1b6f62252d456b1b0cd0fdec1e19cdd2bc1400fe2bf76150ea07b"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 43 3A 5C 55 73 65 72 73 5C 61 64 6D 69 6E 5C 44 65 73 6B 74 6F 70 5C 57 6F 72 6B 5C 46 69 6C 65 49 6E 73 74 61 6C 6C 65 72 5C 52 65 6C 65 61 73 65 5C 46 69 6C 65 49 6E 73 74 61 6C 6C 65 72 2E 70 64 62 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Be64Ba10 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "be64ba10-ea9d-45df-8c9b-2facc825b652"
		date = "2024-03-04"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3043-L3062"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "24bb4fc117aa57fd170e878263973a392d094c94d3a5f651fad7528d5d73b58a"
		logic_hash = "c6acce53610baf119a0e2d55fc698a976463bbd21b739d4ac39a75383fa5fed2"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "9496099988cf4f854bf7f70bae158c6e17025a7537245c5f1d92a90f6b9bca67"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 22 65 6E 63 72 79 70 74 65 64 5F 6B 65 79 22 3A 22 28 2E 2B 3F 29 22 }
		$a2 = { 2E 3F 41 56 3C 6C 61 6D 62 64 61 5F 37 65 66 38 63 66 32 36 39 61 32 32 38 62 36 30 34 64 36 35 34 33 32 65 37 65 63 33 37 30 31 34 3E 40 40 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_7Bb75582 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "7bb75582-ffcd-4a91-8816-811a3f9bdec8"
		date = "2024-03-04"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3064-L3082"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "35f9698e9b9f611b3dd92466f18f97f4a8b4506ed6f10d4ac84303177f43522d"
		logic_hash = "d959f755d28782b332248085034950a8d4cad3cde13b22254c90ca3952919e1b"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "326a08e467cbedb01c640232ad2f4da729894f09ccf5faba93926e1efded9b59"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 48 4B 45 59 5F 43 55 52 52 45 4E 54 5F 55 53 45 52 5C 53 6F 66 74 77 61 72 65 5C 4D 69 63 72 6F 73 6F 66 74 5C 57 69 6E 64 6F 77 73 5C 43 75 72 72 65 6E 74 56 65 72 73 69 6F 6E 5C 49 6E 74 65 72 6E 65 74 20 53 65 74 74 69 6E 67 73 5C 43 6F 6E 6E 65 63 74 69 6F 6E 73 20 5B 31 20 37 20 31 37 5D }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_59698796 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "59698796-0022-486a-a743-6931745f38a0"
		date = "2024-03-04"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3084-L3102"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "35f9698e9b9f611b3dd92466f18f97f4a8b4506ed6f10d4ac84303177f43522d"
		logic_hash = "59569049dbb09b7e15110fb8de1a146eb7fd606f116b4dd6c75ca973fb62296e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "9260d02c3e6b163fd376445bd2a9c084ed85a5dbaf0509e15fff4e9c3d147f19"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 81 EC B8 04 00 00 ?? ?? ?? ?? ?? 33 C5 89 45 FC 56 68 00 04 00 00 0F 57 C0 C7 45 F8 00 00 00 00 8D 85 58 FB FF FF C7 85 54 FB FF FF 24 00 00 00 6A 00 50 8B F1 0F 11 45 D8 0F 11 45 E8 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_2Ae9B09E : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "2ae9b09e-b810-4bd2-9cb8-18b1d504eede"
		date = "2024-03-05"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3104-L3122"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "dc8f4784c368676cd411b7d618407c416d9e56d116dd3cd17c3f750e6cb60c40"
		logic_hash = "183249214e5f8143eb91caf20778b870d17d7a52b6d71ad603827e8716e7e447"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "13ab32abf52bca58dfac79c09882ec4cb80b606693db19813d84e625bda93549"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 51 51 8B 45 08 89 45 FC 8B 45 0C 89 45 F8 8B 45 0C 48 89 45 0C 83 7D F8 00 76 0F 8B 45 FC C6 00 00 8B 45 FC 40 89 45 FC EB DE 8B 45 08 C9 C3 6A 41 5A 0F B7 C1 66 3B D1 77 0C 66 83 F9 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_604A8763 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "604a8763-7ec1-4474-b238-2ebbaf24afa2"
		date = "2024-03-05"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3124-L3142"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "2a51fb11032ec011448184a4f2837d05638a7673d16dcf5dcf4005de3f87883a"
		logic_hash = "cf88c0d102680fc7c16d49b6e8dc49c16b27d5940edf078e667a45e70ebe3883"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "c74c1dc7588d01112c3995b17e9772af15fb1634ebfb417b8c0069ac1f334e74"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 51 8B 45 0C 48 89 45 FC EB 07 8B 45 FC 48 89 45 FC 83 7D FC 00 7C 0B 8B 45 08 03 45 FC C6 00 00 EB E8 C9 C3 55 8B EC 83 EC 0C 8B 45 0C 89 45 FC 8B 45 08 3B 45 10 76 2F 8B 45 FC 89 45 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_F45B3F09 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "f45b3f09-4203-41f7-870e-d8ef5126c391"
		date = "2024-03-05"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3144-L3162"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "577f1dbd76030c7e44ed28c748551691d446e268189af94e1fa1545f06395178"
		logic_hash = "9b01ad1271cc5052a793e5a885aa7289cbaea4a928f60d64194477c3036496ed"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "dfa72e0780e895ab5aa2369a425c64144e9bd435e55d8a0fefbe08121ae31df5"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 28 33 ED 44 8B ED 48 89 6C 24 78 44 8B FD 48 89 AC 24 88 00 00 00 44 8B F5 44 8B E5 E8 43 04 00 00 48 8B F8 8D 75 01 ?? ?? ?? ?? ?? 66 39 07 75 1A 48 63 47 3C 48 8D 48 C0 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_3F390999 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "3f390999-601f-464e-8982-09553adee303"
		date = "2024-03-05"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3164-L3182"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1b6fc4eaef3515058f85551e7e5dffb68b9a0550cd7f9ebcbac158dac9ababf1"
		logic_hash = "462a7a38ebbb39515ac2c0a10353660d0cadcfb99360adcd200edc1db5a716ba"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ccfd5fb305ea48d66f299311c5332587355258bdeeb25cb90c450e8e96df3052"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 10 48 89 D9 48 8B 59 10 FF 61 08 0F 1F 40 00 49 89 CB C3 49 89 CA 41 8B 43 08 41 FF 23 C3 90 48 C1 E1 04 31 C0 81 E1 F0 0F 00 00 49 01 C8 4C 8D 0C 02 4E 8D 14 00 31 C9 45 8A 1C 0A 48 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Abd1C09D : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "abd1c09d-ec66-45ee-b435-302c736cc1f9"
		date = "2024-03-05"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3184-L3202"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "3ff09d2352c2163465d8c86f94baa25ba85c35698a5e3fbc52bc95afc06b7e85"
		logic_hash = "80e6f317e5cd91cb3819e9251efc8c96218071bec577a38c8784826dd4a657cb"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "2f75d8fa11f67f983e40ada50a07e8a6f1b6dfc663524e35a6526381e939d39f"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 EC 0C 8B D1 53 56 57 8B 7D 0C 83 FF 08 77 1A 85 FF 74 16 8B 5D 08 8B 4A 14 8B 72 10 2B CE 8D 04 3B 3B C1 72 11 C6 42 44 00 33 C0 33 D2 5F 5E 5B 8B E5 5D C2 08 00 0F 57 C0 66 0F 13 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_B7870213 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "b7870213-e235-4b2d-83c1-e3c7c486ee8d"
		date = "2024-03-05"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3204-L3222"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "04cb0d5eecea673acc575e54439398cc00e78cc54d8f43c4b9bc353e4fc4430d"
		logic_hash = "79b8385543def42259cd9c09d4d7059ff6bb02a9e87cff1bc0a8861e3b333c5f"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "c087f84c8572dba64da62c9f317969cbce46e78656e0a75489788add787c2781"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 75 28 6B 6E 4E 30 30 30 31 30 32 30 33 30 34 30 35 30 36 30 37 30 38 30 39 31 30 31 31 31 32 31 33 31 34 31 35 31 36 31 37 31 38 31 39 32 30 32 31 32 32 32 33 32 34 32 35 32 36 32 37 32 38 32 39 33 30 33 31 33 32 33 33 33 34 33 35 33 36 33 37 33 38 33 39 34 30 34 31 34 32 34 33 34 34 34 35 34 36 34 37 34 38 34 39 35 30 35 31 35 32 35 33 35 34 35 35 35 36 35 37 35 38 35 39 36 30 36 31 36 32 36 33 36 34 36 35 36 36 36 37 36 38 36 39 37 30 37 31 37 32 37 33 37 34 37 35 37 36 37 37 37 38 37 39 38 30 38 31 38 32 38 33 38 34 38 35 38 36 38 37 38 38 38 39 39 30 39 31 39 32 39 33 39 34 39 35 39 36 39 37 39 38 39 39 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_2Bba6Bae : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "2bba6bae-7c6a-4b89-83d8-0656d7863820"
		date = "2024-03-05"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3224-L3242"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "d9955c716371422750b77d64256dade6fbd028c8d965db05c0d889d953480373"
		logic_hash = "59e4b173c21b0ab161adf8d89f253f21403bca706b6bf40b3da00697f87dd509"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "85dc02cb74c481b5ecb144280827add9665138f0b5d479db5468a94b41e662a3"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 36 35 20 37 39 20 34 31 20 36 39 20 36 34 20 34 38 20 36 43 20 37 37 20 34 39 20 36 41 20 36 46 20 36 37 20 34 39 20 36 42 20 37 30 20 35 38 20 35 36 20 34 33 20 34 39 20 37 33 20 34 39 20 34 33 20 34 41 20 36 38 20 36 32 20 34 37 20 36 33 20 36 39 20 34 46 20 36 39 20 34 31 20 36 39 20 35 32 20 35 37 20 35 32 20 34 35 20 35 35 20 33 30 20 34 35 20 36 39 20 34 39 20 34 38 20 33 30 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_4Db75701 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "4db75701-e7d6-4231-ba00-e127da90bfce"
		date = "2024-03-05"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3244-L3262"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "fa7847d21d5a350cf96d7ecbcf13dce63e6a0937971cfb479700c5b31850bba9"
		logic_hash = "65f7d15ed551e069b30ce6c0a5f15d01d24b8b29727950269c9956fcf6dc799d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "d8637b329a212bf37367ba3cc3acf65c9b511d1f06d689d792c519324459530d"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 48 81 EC D0 02 00 00 80 79 20 08 41 8B F1 45 8B F0 4C 8B FA 48 8B F9 0F 84 3A 01 00 00 48 89 58 10 48 89 68 18 43 8D 04 40 48 63 C8 ?? ?? ?? ?? ?? 48 8D 8C 24 20 02 00 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_54A914C9 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "54a914c9-1b00-4cea-9b82-f7ed1df1305f"
		date = "2024-03-25"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3264-L3282"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c418c5ad8030985bb5067cda61caba3b7a0d24cb8d3f93fc09d452fbdf4174ec"
		logic_hash = "0cc3797564b4c722423f915493e07b0e0fec3085e7a535f9914f82d73c797bed"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "d3f4083c96130031ce9656ea31bf0914080c88f09c05f8b1168c60487af80c9b"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 20 48 89 CB 48 8B 43 08 4C 8B 48 30 4D 85 C9 74 16 48 8D 4B 10 0F B6 D2 48 83 C4 20 5B 5E 5F 5D 41 5C 49 FF E1 66 90 44 0F B6 40 10 41 80 F8 16 0F 84 81 00 00 00 41 80 F8 18 74 0B 48 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_38A88967 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "38a88967-db0e-4d68-9295-9108cbc98fb9"
		date = "2024-03-25"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3284-L3302"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6e425eb1a27c4337f05d12992e33fe0047e30259380002797639d51ef9509739"
		logic_hash = "ddbdb1c39a07141d83173504214c889aff75487570d906413ebc6f262fedf9ae"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "1fef2c4c2899bbf9f45732d23654f6437658de2c4dc78dc3d1ff5440b5c2cbcf"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 60 E8 00 00 00 00 5B ?? ?? ?? ?? ?? ?? 8B 75 08 8B 7D 0C AD 50 53 89 C1 29 DB 29 C0 AC C1 E3 04 01 C3 AA 89 D8 ?? ?? ?? ?? ?? 85 C0 74 07 89 C2 C1 EA 18 31 D3 F7 D0 21 C3 E2 DF 87 DA }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_E8Abb835 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "e8abb835-f0c1-4e27-a0ca-3a3cae3362df"
		date = "2024-03-26"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3304-L3322"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "e42262671325bec300afa722cefb584e477c3f2782c8d4c6402d6863df348cac"
		logic_hash = "0ad56b8c741a79a600a0d5588c4e8760a6d19fef72ff7814a00cfb84a90f23aa"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ca8c2f4b16ebe1bb48c91a536d8aca98bed5592675eff9311e77d7e06dfe3c5b"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 48 81 EC 28 05 00 00 66 44 0F 7F 84 24 10 05 00 00 66 0F 7F BC 24 00 05 00 00 0F 29 B4 24 F0 04 00 00 44 89 44 24 74 48 89 94 24 C8 00 00 00 48 89 CB 48 C7 44 24 78 00 00 00 00 0F 57 F6 0F 29 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_492D7223 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "492d7223-4e03-4a77-83e5-ed85e052f846"
		date = "2024-03-26"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3324-L3342"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c0d9c9297836aceb4400bcb0877d1df90ca387f18f735de195852a909c67b7ef"
		logic_hash = "9fb2a00def86ed8476d906514a0bc630e28093ac37d757541d8801d2c8e0efc3"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "71a1bce450522a0a6ff38d2f84ab91e2e9db360736c2f7233124a0b0dc4d0431"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 89 E5 53 57 56 83 EC 24 ?? ?? ?? ?? ?? 31 C9 85 C0 0F 94 C1 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 01 C8 40 FF E0 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Ea296356 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "ea296356-6533-4364-8ad1-3bbb538e3d61"
		date = "2024-05-22"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3344-L3362"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "4c48a0fe90f3da7bfdd32961da7771a0124b77e1ac1910168020babe8143e959"
		logic_hash = "73ffd16f0047cd57311853aa9083fc21427f2eb21646c6edc7b8def86da90f90"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a17ca2f95473517428867b4f68b8275ae84ef1ee39421e76887077e206b1ed51"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 83 EC 0C 53 56 8B 75 08 8B C6 89 55 FC 99 2B C2 89 4D F8 8B D8 8B 45 FC 57 D1 FB 33 FF 8D 14 30 89 55 08 85 DB 7E 36 4A 0F 1F 44 00 00 8A 0C 38 8D 52 FF 0F B6 42 01 8B 75 FC 0F B6 80 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_Aeaeb5Cf : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "aeaeb5cf-2683-4a88-b736-4b8873d92fc5"
		date = "2024-05-22"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3364-L3382"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f57d955d485904f0c729acff9db1de9cb42f32af993393d58538f07fa273b431"
		logic_hash = "640966296bad70234e0fe7b6f87b92fcf4fc111189d307d44f32e926785f76cb"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f6d32006747b083632f551c8ca182b6b4d67a8f130a118e61b0dd2f35d7d8477"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 8B 4D 08 33 C0 66 39 01 74 0B 8D 49 00 40 66 83 3C 41 00 75 F8 8D 04 45 02 00 00 00 50 FF 75 0C 51 ?? ?? ?? ?? ?? 83 C4 0C 5D C3 CC CC 55 8B EC 6A 00 FF 75 08 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_C8424507 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "c8424507-34e1-4649-a4e4-3e0a0f62dfb0"
		date = "2024-05-22"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3384-L3403"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "d556b02733385b823cfe4db7e562e90aa520e2e6fb00fceb76cc0a6a1ff47692"
		logic_hash = "78d56257cb6e1d67f9343ee30b844fe20138e27ca3b6312a07112e5dbb797851"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "8dfb14903b32c118492ae7e0aab9cf634c58ea93fcbc7759615209f61b3b3d6b"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 78 75 73 65 68 6F 62 69 6D 6F 7A 61 63 6F 67 6F 6A 69 68 6F 67 69 76 6F }
		$a2 = { 62 65 6D 69 74 69 76 65 67 69 77 6F 6D 65 7A 75 76 65 62 61 67 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_9Af87Ddb : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "9af87ddb-c3ed-44a5-b1a1-984b6f8a6065"
		date = "2024-05-23"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3405-L3423"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b1fbc11744e21dc08599412887a3a966572614ce25ccd3c8c98f04bcbdda3898"
		logic_hash = "99174c5740324d7704a5c6ae924254f9b5f241c97901dfdb771fc176a76e4a30"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "1505b6299961c729077ffd90a4c7ed3180f55329952841fe7045056ea2919de8"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 28 00 00 0A 28 2C 00 00 06 11 06 17 D6 13 06 11 06 11 07 8E B7 32 98 06 17 D6 0A 20 E8 03 00 00 28 21 00 00 0A 7E 0F 00 00 04 3A 74 FF FF FF 2A 00 1B 30 04 00 96 00 00 00 1F 00 00 11 03 39 88 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_D7B57912 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "d7b57912-02b4-421a-8f93-9e8371314e68"
		date = "2024-05-23"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3425-L3443"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0906599be152dd598c7f540498c44cc38efe9ea976731da05137ee6520288fe4"
		logic_hash = "a774e3030d81e29805a9784cfbbc0b69c4fedebe0daa25e403777e1f46f9094f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "36a3fecc918cd891d9c779f7ff54019908ba190853739c8059adb84233643a1c"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 83 C4 B8 53 56 8B DA 89 45 FC 8D 45 FC ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 64 FF 30 64 89 20 8B C3 ?? ?? ?? ?? ?? 6A 00 6A 00 8D 45 F0 50 8B 45 FC }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_23D33B48 : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "23d33b48-00f6-487f-a3e5-f41603fc982e"
		date = "2024-06-05"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3445-L3463"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "acbc22df07888498ae6f52f5458e3fb8e0682e443a8c2bc97177a0320b4e2098"
		logic_hash = "c9fb93bb74e4d45197d0da5b641860738a42a583b15cc098e86ea79bb8690bf7"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "7a25301a1297337810240e8880febe525726c9b79a4a4bd81b1f856865097995"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 51 83 7A 14 10 8B C2 53 56 57 8B F1 72 02 8B 02 83 7E 14 10 72 02 8B 0E 8B 5A 10 8D 56 10 8B 3A 53 50 89 55 FC 8B D7 51 ?? ?? ?? ?? ?? 8B D0 83 C4 0C 83 FA FF 74 30 3B FA 72 33 8B C7 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_4B0B73Ce : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "4b0b73ce-960d-40ce-ae85-5cf38d949f45"
		date = "2024-06-05"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3465-L3483"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "236fc00cd7c75f70904239935ab90f51b03ff347798f56cec1bdd73a286b24c1"
		logic_hash = "d53923df612dd7fe0b1b2c94c1c5d747b08723df129089326ec27c5049769cef"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "11c544f9f3a51ffcd361d6558754a64a8a38f3ce9385038880ab58c99769db88"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 51 53 56 57 8B 7D 08 83 7F 18 00 C6 45 FF C9 74 54 ?? ?? ?? ?? ?? ?? 8D 9B 00 00 00 00 33 F6 83 7F 18 00 74 40 6A 0A FF D3 46 81 FE E8 03 00 00 7C ED 8B 07 8B 50 08 6A 01 8D 4D FF 51 }

	condition:
		all of them
}
rule ELASTIC_Windows_Generic_Threat_1F2E969C : FILE MEMORY {
    meta:
		description = "Detects Windows Generic Threat (Windows.Generic.Threat)"
		author = "Elastic Security"
		id = "1f2e969c-5d90-4bab-a06a-9cccb1946251"
		date = "2024-06-05"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Generic_Threat.yar#L3485-L3503"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "7def75df729ed66511fbe91eadf15bc69a03618e78c48e27c35497db2a6a97ae"
		logic_hash = "7d984a902f9bf40c9b49da89aba9249f80b41b24ca1cdb6189f541b40ef41742"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e7c872f2422fe54367900d69c9bb94d86db2bf001cbbe00ba6c801fb3d1e610e"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 51 53 8B 5A 10 56 8B F1 57 6A 78 89 75 FC C7 46 10 00 00 00 00 C7 46 14 0F 00 00 00 53 89 75 FC C6 06 00 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 33 C9 33 C0 89 7D FC 85 DB 7E 39 0F 1F 40 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Xtremerat_Cd5B60Be : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Xtremerat (Windows.Trojan.XtremeRAT)"
		author = "Elastic Security"
		id = "cd5b60be-4685-425a-8fe1-8366c0e5b84a"
		date = "2022-03-15"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_XtremeRAT.yar#L1-L28"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "735f7bf255bdc5ce8e69259c8e24164e5364aeac3ee78782b7b5275c1d793da8"
		logic_hash = "a6997ae4842bd45c440925ef2a5848b57c58e2373c0971ce6b328ea297ee97b4"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "2ee35d7c34374e9f5cffceb36fe1912932288ea4e8211a8b77430b98a9d41fb2"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$s01 = "SOFTWARE\\XtremeRAT" wide fullword
		$s02 = "XTREME" wide fullword
		$s03 = "STARTSERVERBUFFER" wide fullword
		$s04 = "ENDSERVERBUFFER" wide fullword
		$s05 = "ServerKeyloggerU" ascii fullword
		$s06 = "TServerKeylogger" ascii fullword
		$s07 = "XtremeKeylogger" wide fullword
		$s08 = "XTREMEBINDER" wide fullword
		$s09 = "UnitInjectServer" ascii fullword
		$s10 = "shellexecute=" wide fullword

	condition:
		7 of ($s*)
}
rule ELASTIC_Windows_Trojan_Bughatch_21269Be4 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bughatch (Windows.Trojan.Bughatch)"
		author = "Elastic Security"
		id = "21269be4-cff1-42b9-be6b-f6a6bde40bff"
		date = "2022-05-09"
		modified = "2022-06-09"
		reference = "https://www.elastic.co/security-labs/bughatch-malware-analysis"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Bughatch.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b495456a2239f3ba48e43ef295d6c00066473d6a7991051e1705a48746e8051f"
		logic_hash = "a8a2cae51a31e48ffe729df61ec96e3257f9c997ad5234075f85ed55de96f11d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "1ff55288554133690d96161c05a047ffba47778ff27d32ff656b3a194d6c26e0"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 8B 45 ?? 33 D2 B9 A7 00 00 00 F7 F1 85 D2 75 ?? B8 01 00 00 00 EB 33 C0 }
		$a2 = { 8B 45 ?? 0F B7 48 04 81 F9 64 86 00 00 75 3B 8B 55 ?? 0F B7 42 16 25 00 20 00 00 ?? ?? B8 06 00 00 00 EB ?? }
		$b1 = { 69 4D 10 FD 43 03 00 81 C1 C3 9E 26 00 89 4D 10 8B 55 FC 8B 45 F8 0F B7 0C 50 8B 55 10 C1 EA 10 81 E2 FF FF 00 00 33 CA 8B 45 FC 8B 55 F8 66 89 0C 42 }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Bughatch_98F3C0Be : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bughatch (Windows.Trojan.Bughatch)"
		author = "Elastic Security"
		id = "98f3c0be-1327-4ba2-9320-c1a9ce90b4a4"
		date = "2022-05-09"
		modified = "2022-06-09"
		reference = "https://www.elastic.co/security-labs/bughatch-malware-analysis"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Bughatch.yar#L24-L51"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b495456a2239f3ba48e43ef295d6c00066473d6a7991051e1705a48746e8051f"
		logic_hash = "d578515fece7bd464bb09cc5ddb5caf70f4022e8b10388db689e67e662d57f66"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "1ac6b1285e1925349e4e578de0b2f1cf8a008cddbb1a20eb8768b1fcc4b0c8d3"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "-windowstyle hidden -executionpolicy bypass -file"
		$a2 = "C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe"
		$a3 = "ReflectiveLoader"
		$a4 = "\\Sysnative\\"
		$a5 = "TEMP%u.CMD"
		$a6 = "TEMP%u.PS1"
		$a7 = "\\TEMP%d.%s"
		$a8 = "NtSetContextThread"
		$a9 = "NtResumeThread"

	condition:
		6 of them
}
rule ELASTIC_Windows_Hacktool_Sharpup_E5C87C9A : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Sharpup (Windows.Hacktool.SharpUp)"
		author = "Elastic Security"
		id = "e5c87c9a-6b4d-49af-85d1-6bb60123c057"
		date = "2022-10-20"
		modified = "2022-11-24"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_SharpUp.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "45e92b991b3633b446473115f97366d9f35acd446d00cd4a05981a056660ad27"
		logic_hash = "62e9aafd308aacbc7a124c707e230c5a9ffde4f6929a5feada5497e3eae7668c"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "4c6e70b7ce3eb3fc05966af6c3847f4b7282059e05c089c20f39f226efb9bf87"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$guid = "FDD654F5-5C54-4D93-BF8E-FAF11B00E3E9" ascii wide nocase
		$str0 = "^\\W*([a-z]:\\\\.+?(\\.exe|\\.bat|\\.ps1|\\.vbs))\\W*" ascii wide
		$str1 = "^\\W*([a-z]:\\\\.+?(\\.exe|\\.dll|\\.sys))\\W*" ascii wide
		$str2 = "SELECT * FROM win32_service WHERE Name LIKE '{0}'" ascii wide
		$print_str1 = "[!] Modifialbe scheduled tasks were not evaluated due to permissions." ascii wide
		$print_str2 = "[+] Potenatially Hijackable DLL: {0}" ascii wide
		$print_str3 = "Registry AutoLogon Found" ascii wide

	condition:
		$guid or ( all of ($str*) and 1 of ($print_str*))
}
rule ELASTIC_Windows_Hacktool_Coffloader_81Ba13B8 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Coffloader (Windows.Hacktool.COFFLoader)"
		author = "Elastic Security"
		id = "81ba13b8-8994-4fe9-98e5-44514c554e8b"
		date = "2024-04-22"
		modified = "2024-05-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_COFFLoader.yar#L1-L43"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c2e03659eb1594dc958e01344cfa9ba126d66736b089db5e3dd1b1c3e3e7d2f7"
		logic_hash = "d4f061af200a0ae9f3276fd6dfcb09ecdf662f29b7c43ea47c69a53d9fe66793"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "ef9f11d9cd6c3b46f7d13ea039dcad6fa24515495466b1102ec8c1c8bed8853e"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "BeaconDataParse" ascii fullword
		$a2 = "BeaconDataInt" ascii fullword
		$a3 = "BeaconDataShort" ascii fullword
		$a4 = "BeaconDataLength" ascii fullword
		$a5 = "BeaconDataExtract" ascii fullword
		$a6 = "BeaconFormatAlloc" ascii fullword
		$a7 = "BeaconFormatReset" ascii fullword
		$a8 = "BeaconFormatFree" ascii fullword
		$a9 = "BeaconFormatAppend" ascii fullword
		$a10 = "BeaconFormatPrintf" ascii fullword
		$a11 = "BeaconFormatToString" ascii fullword
		$a12 = "BeaconFormatInt" ascii fullword
		$a13 = "BeaconPrintf" ascii fullword
		$a14 = "BeaconOutput" ascii fullword
		$a15 = "BeaconUseToken" ascii fullword
		$a16 = "BeaconRevertToken" ascii fullword
		$a17 = "BeaconDataParse" ascii fullword
		$a18 = "BeaconIsAdmin" ascii fullword
		$a19 = "BeaconGetSpawnTo" ascii fullword
		$a20 = "BeaconSpawnTemporaryProcess" ascii fullword
		$a21 = "BeaconInjectProcess" ascii fullword
		$a22 = "BeaconInjectTemporaryProcess" ascii fullword
		$a23 = "BeaconCleanupProcess" ascii fullword
		$b1 = "COFFLoader.x64.dll"
		$b2 = "COFFLoader.x86.dll"

	condition:
		5 of ($a*) or 1 of ($b*)
}
rule ELASTIC_Windows_Trojan_Nimplant_44Ff3211 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Nimplant (Windows.Trojan.Nimplant)"
		author = "Elastic Security"
		id = "44ff3211-1ba6-4c46-a990-b2419d88367e"
		date = "2023-06-23"
		modified = "2023-07-10"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Nimplant.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b56e20384f98e1d2417bb7dcdbfb375987dd075911b74ea7ead082494836b8f4"
		logic_hash = "ee519d8d722404ed440b385d283a41921bc34ee11f0e7273cdc074b377494c39"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "cb7f823b1621e49ffac42e8a3f90ca7f8bac7ae108ca20b9a0884548681d1f87"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "@NimPlant v"
		$a2 = ".Env_NimPlant."
		$a3 = "NimPlant.dll"

	condition:
		2 of them
}
rule ELASTIC_Windows_Trojan_Latrodectus_841Ff697 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Latrodectus (Windows.Trojan.Latrodectus)"
		author = "Elastic Security"
		id = "841ff697-f389-497a-b813-3b9e19cba26e"
		date = "2024-03-13"
		modified = "2024-05-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Latrodectus.yar#L1-L26"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "aee22a35cbdac3f16c3ed742c0b1bfe9739a13469cf43b36fb2c63565111028c"
		logic_hash = "aa1a4813a18b4eb4f07e805ff9c87523ad74f59c0ed538212918335eaeee29d7"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "8f095e7909860471e2702b247f4cefa694b698c236e67844ef0b0b7714518a18"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$Str1 = { 48 83 EC 38 C6 44 24 20 73 C6 44 24 21 63 C6 44 24 22 75 C6 44 24 23 62 C6 44 24 24 }
		$crc32_loadlibrary = { 48 89 44 24 40 EB 02 EB 90 48 8B 4C 24 20 E8 ?? ?? FF FF 48 8B 44 24 40 48 81 C4 E8 02 00 00 C3 }
		$delete_self = { 44 24 68 BA 03 00 00 00 48 8B 4C 24 48 FF 15 ED D1 00 00 85 C0 75 14 48 8B 4C 24 50 E8 ?? ?? 00 00 B8 FF FF FF FF E9 A6 00 }
		$Str4 = { 89 44 24 44 EB 1F C7 44 24 20 00 00 00 00 45 33 C9 45 33 C0 33 D2 48 8B 4C 24 48 FF 15 7E BB 00 00 89 44 24 44 83 7C 24 44 00 75 02 EB 11 48 8B 44 24 48 EB 0C 33 C0 85 C0 0F 85 10 FE FF FF 33 }
		$handler_check = { 83 BC 24 D8 01 00 00 12 74 36 83 BC 24 D8 01 00 00 0E 74 2C 83 BC 24 D8 01 00 00 0C 74 22 83 BC 24 D8 01 00 00 0D 74 18 83 BC 24 D8 01 00 00 0F 74 0E 83 BC 24 D8 01 00 00 04 0F 85 44 02 00 00 }
		$hwid_calc = { 48 89 4C 24 08 48 8B 44 24 08 69 00 0D 66 19 00 48 8B 4C 24 08 89 01 48 8B 44 24 08 8B 00 C3 }
		$string_decrypt = { 89 44 24 ?? 48 8B 44 24 ?? 0F B7 40 ?? 8B 4C 24 ?? 33 C8 8B C1 66 89 44 24 ?? 48 8B 44 24 ?? 48 83 C0 ?? 48 89 44 24 ?? 33 C0 66 89 44 24 ?? EB ?? }
		$campaign_fnv = { 48 03 C8 48 8B C1 48 39 44 24 08 73 1E 48 8B 44 24 08 0F BE 00 8B 0C 24 33 C8 8B C1 89 04 24 69 04 24 93 01 00 01 89 04 24 EB BE }

	condition:
		2 of them
}
rule ELASTIC_Windows_Ransomware_Gandcrab_8D0Ca31D : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Gandcrab (Windows.Ransomware.GandCrab)"
		author = "Elastic Security"
		id = "8d0ca31d-82e6-426a-a5fc-8a7fe626aab7"
		date = "2024-08-27"
		modified = "2024-09-30"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_GandCrab.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "29eee4f8b088ec1cdac03a04ca834479fce9a0fdf696224c6f19d573f4e2a703"
		logic_hash = "0ee46c41031a7e7fbdae0b80bd8c53bfd1a0b9d255072971e74470988e492430"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "cb010fd6254fd4383d5a815cfe5ebdd74a67720de09de336d16e38871f0a57eb"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$ = "%s\\KRAB-DECRYPT.txt" wide fullword
		$ = { 6A 6E 58 6A 74 66 89 44 24 34 8B F2 58 6A 64 89 4C 24 18 59 6A 6C 5A 66 89 44 24 32 6A 2E 58 66 89 44 24 3A 33 C0 66 89 4C 24 34 66 89 4C 24 3C 8D 4C 24 30 66 89 54 24 36 66 89 54 24 38 66 89 54 24 3E 66 89 54 24 40 89 44 24 42 E8 }
		$ = { 6A 2D 58 66 89 45 90 6A 2D 58 66 89 45 92 6A 2D 58 66 89 45 94 6A 42 58 66 89 45 96 6A 45 58 66 89 45 98 6A 47 58 66 89 45 9A 6A 49 58 66 89 45 9C 6A 4E 58 66 89 45 9E 6A 20 58 66 89 45 A0 6A 50 58 66 89 45 A2 6A 43 58 66 89 45 A4 6A 20 58 66 89 45 A6 6A 44 58 66 89 45 A8 6A 41 58 66 89 45 AA 6A 54 58 66 89 45 AC 6A 41 58 66 89 45 AE 6A 2D 58 66 89 45 B0 6A 2D 58 66 89 45 B2 6A 2D 58 66 89 45 B4 33 C0 66 89 45 B6 }

	condition:
		2 of them
}
rule ELASTIC_Windows_Trojan_Remcos_B296E965 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Remcos (Windows.Trojan.Remcos)"
		author = "Elastic Security"
		id = "b296e965-a99e-4446-b969-ba233a2a8af4"
		date = "2021-06-10"
		modified = "2021-08-23"
		reference = "https://www.elastic.co/security-labs/exploring-the-ref2731-intrusion-set"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Remcos.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0ebeffa44bd1c3603e30688ace84ea638fbcf485ca55ddcfd6fbe90609d4f3ed"
		logic_hash = "069072abd1182eee50cb9937503d47845e7315d8e3cd6b63576adc8f21820c82"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a5267bc2dee28a3ef58beeb7e4a151699e3e561c16ce0ab9eb27de33c122664d"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Remcos restarted by watchdog!" ascii fullword
		$a2 = "Mutex_RemWatchdog" ascii fullword
		$a3 = "%02i:%02i:%02i:%03i"
		$a4 = "* Remcos v" ascii fullword

	condition:
		2 of them
}
rule ELASTIC_Windows_Trojan_Remcos_7591E9F1 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Remcos (Windows.Trojan.Remcos)"
		author = "Elastic Security"
		id = "7591e9f1-452d-4731-9bec-545fb0272c80"
		date = "2023-06-23"
		modified = "2023-07-10"
		reference = "https://www.elastic.co/security-labs/exploring-the-ref2731-intrusion-set"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Remcos.yar#L25-L49"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "4e6e5ecd1cf9c88d536c894d74320c77967fe08c75066098082bf237283842fa"
		logic_hash = "96acf1ba7740a8d34d929ed4a4fa446c984c3a8f64a603d428e782b6997e4d20"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "9436c314f89a09900a9b3c2fd9bab4a0423912427cf47b71edce5eba31132449"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "ServRem" ascii fullword
		$a2 = "Screenshots" ascii fullword
		$a3 = "MicRecords" ascii fullword
		$a4 = "remcos.exe" wide nocase fullword
		$a5 = "Remcos" wide fullword
		$a6 = "logs.dat" wide fullword

	condition:
		3 of them
}
rule ELASTIC_Windows_Trojan_Zeus_E51C60D7 : FILE MEMORY {
    meta:
		description = "Detects strings used in Zeus web injects. Many other malware families are built on Zeus and may hit on this signature."
		author = "Elastic Security"
		id = "e51c60d7-3afa-4cf5-91d8-7782e5026e46"
		date = "2021-02-07"
		modified = "2021-10-04"
		reference = "https://www.virusbulletin.com/virusbulletin/2014/10/paper-evolution-webinjects"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Zeus.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "d7e9cb60674e0a05ad17eb96f8796d9f23844a33f83aba5e207b81979d0f2bf3"
		logic_hash = "cde738f95dbad1fbad59e20528b2f577e5e3ee5fcb37c68a45d53c689d2af525"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "813e2ee2447fcffdde6519dc6c52369a5d06c668b76c63bb8b65809805ecefba"
		threat_name = "Windows.Trojan.Zeus"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "name=%s&port=%u" ascii fullword
		$a2 = "data_inject" ascii wide fullword
		$a3 = "keylog.txt" ascii fullword
		$a4 = "User-agent: %s]]]" ascii fullword
		$a5 = "%s\\%02d.bmp" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Hacktool_Phant0M_2D6F9B57 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Phant0M (Windows.Hacktool.Phant0m)"
		author = "Elastic Security"
		id = "2d6f9b57-bde0-4570-8e38-187dbf05e6d3"
		date = "2024-02-28"
		modified = "2024-03-21"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_Phant0m.yar#L1-L24"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "30978aadd7d7bc86e735facb5046942792ad1beab6919754e6765e0ccbcf89d6"
		logic_hash = "a66f8779f77b216f7831617a34c008e4202f36e74f2866c9792cee34b804408d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "d4a92775e76bbb00e677a289942f9b3f8101a1dc2f55b30cfa32e4c7feae6c8a"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$api = "NtQueryInformationThread"
		$s1 = "Suspending EventLog thread %d with start address %p"
		$s2 = "Found the EventLog Module (wevtsvc.dll) at %p"
		$s3 = "Event Log service PID detected as %d."
		$s4 = "Thread %d is detected and successfully killed."
		$s5 = "Windows EventLog module %S at %p"

	condition:
		$api and 2 of ($s*)
}
rule ELASTIC_Windows_Trojan_Pandastealer_8B333E76 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Pandastealer (Windows.Trojan.Pandastealer)"
		author = "Elastic Security"
		id = "8b333e76-f723-4093-ad72-2f5d42aaa9c9"
		date = "2021-09-02"
		modified = "2022-01-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Pandastealer.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ec346bd56be375b695b4bc76720959fa07d1357ffc3783eb61de9b8d91b3d935"
		logic_hash = "5878799338fc18bac0f946faeadd59c921dee32c9391fc12d22c72c0cd6733a8"
		score = 75
		quality = 25
		tags = "FILE, MEMORY"
		fingerprint = "873af8643b7f08b159867c3556654a5719801aa82e1a1f6402029afad8c01487"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "] - [user: " ascii fullword
		$a2 = "[-] data unpacked failed" ascii fullword
		$a3 = "[+] data unpacked" ascii fullword
		$a4 = "\\history\\" ascii fullword
		$a5 = "PlayerName" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Suddenicon_99487621 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Suddenicon (Windows.Trojan.SuddenIcon)"
		author = "Elastic Security"
		id = "99487621-88c4-40f6-918a-f1276cc2d2a7"
		date = "2023-03-29"
		modified = "2023-03-30"
		reference = "https://www.elastic.co/security-labs/elastic-users-protected-from-suddenicon-supply-chain-attack"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_SuddenIcon.yar#L1-L26"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "aa4e398b3bd8645016d8090ffc77d15f926a8e69258642191deb4e68688ff973"
		logic_hash = "9a441c47e8b95d8aaec6f495d6ddfec2ed6b0762637ea48e64c9ea01b0945019"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b16f7de530ed27c42bffec4bcfc1232bad34cdaf4e7a9803fce0564e12701ef1"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$str1 = "https://raw.githubusercontent.com/IconStorages/images/main/icon%d.ico" wide fullword
		$str2 = "__tutma" ascii fullword
		$str3 = "__tutmc" ascii fullword
		$str4 = "%s: %s" ascii fullword
		$str5 = "%s=%s" ascii fullword
		$seq_obf = { C1 E1 ?? 33 C1 45 8B CA 8B C8 C1 E9 ?? 33 C1 81 C2 ?? ?? ?? ?? 8B C8 C1 E1 ?? 33 C1 41 8B C8 }
		$seq_virtualprotect = { FF 15 ?? ?? ?? ?? 85 C0 74 ?? FF D5 48 85 C0 74 ?? 81 7B ?? CA 7D 0F 00 75 ?? 48 8D 54 24 ?? 48 8D 4C 24 ?? FF D0 8B F8 44 8B 44 24 ?? 4C 8D 4C 24 ?? BA 00 10 00 00 48 8B CD FF 15 ?? ?? ?? ?? }

	condition:
		5 of ($str*) or 2 of ($seq*)
}
rule ELASTIC_Windows_Trojan_Suddenicon_8B07C275 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Suddenicon (Windows.Trojan.SuddenIcon)"
		author = "Elastic Security"
		id = "8b07c275-f389-4e55-bcec-4b1344cad33d"
		date = "2023-03-29"
		modified = "2023-03-30"
		reference = "https://www.elastic.co/security-labs/elastic-users-protected-from-suddenicon-supply-chain-attack"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_SuddenIcon.yar#L28-L48"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "aa4e398b3bd8645016d8090ffc77d15f926a8e69258642191deb4e68688ff973"
		logic_hash = "64e8bd8929c9fb8cae16f772e3266b02b4ddec770ff8d5379a93a483eb8ff660"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "482f1e668ab63be44a249274e0eaa167e1418c42a8f0e9e85b26e4e23ff57a0d"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$str1 = { 33 C9 E8 ?? ?? ?? ?? 48 8B D8 E8 ?? ?? ?? ?? 44 8B C0 B8 ?? ?? ?? ?? 41 F7 E8 8D 83 ?? ?? ?? ?? C1 FA ?? 8B CA C1 E9 ?? 03 D1 69 CA ?? ?? ?? ?? 48 8D 55 ?? 44 2B C1 48 8D 4C 24 ?? 41 03 C0 }
		$str2 = { B8 ?? ?? ?? ?? 41 BA ?? ?? ?? ?? 0F 11 84 24 ?? ?? ?? ?? 44 8B 06 8B DD BF ?? ?? ?? ?? }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Suddenicon_Ac021Ae0 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Suddenicon (Windows.Trojan.SuddenIcon)"
		author = "Elastic Security"
		id = "ac021ae0-67c6-45cf-a467-eb3c2b84b3e4"
		date = "2023-03-30"
		modified = "2023-03-30"
		reference = "https://www.elastic.co/security-labs/elastic-users-protected-from-suddenicon-supply-chain-attack"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_SuddenIcon.yar#L50-L76"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "033eabdd8ce8ecc4e1a657161c1f298c7dfe536ee2dbf9375cfda894638a7bee"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "115d4fc78bae7b5189a94b82ffd6547dfe89cfb66bf59d0e1d77c10fb937d2f7"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$str1 = "%s\\%s\\%s\\%s" wide fullword
		$str2 = "%s.old" wide fullword
		$str3 = "\n******************************** %s ******************************\n\n" wide fullword
		$str4 = "HostName: %s\\r\\nDomainName: %s\\r\\nOsVersion: %d.%d.%d\\r\\n\\r\\n" wide fullword
		$str5 = "%s\\r\\nDomainName: %s\\r\\nOsVersion: %d.%d.%d\\r\\n\\r\\n" wide fullword
		$str6 = "AppData\\Local\\Google\\Chrome\\User Data" wide fullword
		$str7 = "SELECT url, title FROM urls ORDER BY id DESC LIMIT 500" wide fullword
		$str8 = "SELECT url, title FROM moz_places ORDER BY id DESC LIMIT 500" wide fullword
		$b1 = "\\3CXDesktopApp\\config.json" wide fullword

	condition:
		6 of ($str*) or 1 of ($b*)
}
rule ELASTIC_Windows_Shellcode_Generic_8C487E57 : FILE MEMORY {
    meta:
		description = "Detects Windows Shellcode Generic (Windows.Shellcode.Generic)"
		author = "Elastic Security"
		id = "8c487e57-4b8c-488e-a1d9-786ff935fd2c"
		date = "2022-05-23"
		modified = "2022-07-18"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Shellcode_Generic.yar#L1-L18"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "a86ea8e15248e83ce7322c10e308a5a24096b1d7c67f5673687563dec8229dfe"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "834caf96192a513aa93ac48fb8d2f3326bf9f08acaf7a27659f688b26e3e57e4"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { FC E8 89 00 00 00 60 89 E5 31 D2 64 8B 52 30 8B 52 0C 8B 52 14 8B 72 28 0F B7 4A 26 31 FF 31 C0 }

	condition:
		all of them
}
rule ELASTIC_Windows_Shellcode_Generic_F27D7Beb : FILE MEMORY {
    meta:
		description = "Detects Windows Shellcode Generic (Windows.Shellcode.Generic)"
		author = "Elastic Security"
		id = "f27d7beb-5ce0-4831-b1ad-320b346612c3"
		date = "2022-06-08"
		modified = "2022-09-29"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Shellcode_Generic.yar#L20-L37"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "8530a74a002d0286711cd86545aff0bf853de6b6684473b6211d678797c3639f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "3f8dd6733091ec229e1bebe9e4cd370ad47ab2e3678be4c2d9c450df731a6e5c"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 53 48 89 E3 66 83 E4 00 48 B9 [8] BA 01 00 00 00 41 B8 00 00 00 00 48 B8 [8] FF D0 48 89 DC 5B C3 }

	condition:
		all of them
}
rule ELASTIC_Windows_Shellcode_Generic_29Dcbf7A : FILE MEMORY {
    meta:
		description = "Detects Windows Shellcode Generic (Windows.Shellcode.Generic)"
		author = "Elastic Security"
		id = "29dcbf7a-2d3b-4e05-a2be-15623bf62d06"
		date = "2023-05-09"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Shellcode_Generic.yar#L39-L56"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "c2a81cc27e696a2e488df7d2f96784bbaed83df5783efab312fc5ccbfd524b43"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e4664ec7bf7dab3fff873fe4b059e97d2defe3b50e540b96dd98481638dcdcd8"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { FC 48 83 E4 F0 41 57 41 56 41 55 41 54 55 53 56 57 48 83 EC 40 48 83 EC 40 48 83 EC 40 48 89 E3 }

	condition:
		all of them
}
rule ELASTIC_Windows_Hacktool_Sharpshares_88Cdcd52 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Sharpshares (Windows.Hacktool.SharpShares)"
		author = "Elastic Security"
		id = "88cdcd52-9f5b-4ab6-8f20-137c8569d112"
		date = "2022-10-20"
		modified = "2022-11-24"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_SharpShares.yar#L1-L30"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "bbdd3620a67aedec4b9a68b2c9cc880b6631215e129816aea19902a6f4bc6f41"
		logic_hash = "85c59b939da6158f931e779c2884cea77b80fab54ee5e157d86afa19f0253db3"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "ae0cf8bbdfecfebf69d718dc0ccc8402ed7f2f949e2b6bab606bbf69aa6c2518"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$guid = "BCBC884D-2D47-4138-B68F-7D425C9291F9" ascii wide nocase
		$print_str0 = "all enabled computers with \"primary\" group \"Domain Computers\"" ascii wide
		$print_str1 = "all enabled Domain Controllers (not read-only DCs)" ascii wide
		$print_str2 = "all enabled servers excluding Domain Controllers or read-only DCs" ascii wide
		$str0 = "(&(objectCategory=computer)(!(userAccountControl:1.2.840.113556.1.4.803:=2)))" ascii wide
		$str1 = "(&(objectCategory=computer)(!(userAccountControl:1.2.840.113556.1.4.803:=2))(userAccountControl:1.2.840.113556.1.4.803:=8192))" ascii wide
		$str2 = "(&(objectCategory=computer)(!(userAccountControl:1.2.840.113556.1.4.803:=2))(!(userAccountControl:1.2.840.113556.1.4.803:=8192))(!(userAccountControl:1.2.840.113556.1.4.803:=67100867)))" ascii wide
		$str3 = "(&(objectCategory=computer)(!(userAccountControl:1.2.840.113556.1.4.803:=2))(operatingSystem=*server*)(!(userAccountControl:1.2.840.113556.1.4.803:=8192))(!(userAccountControl:1.2.840.113556.1.4.803:=67100867)))" ascii wide
		$str4 = "servers-exclude-dc" ascii wide
		$str5 = "all enabled servers" ascii wide
		$str6 = "[w] \\\\{0}\\{1}" ascii wide
		$str7 = "[-] \\\\{0}\\{1}" ascii wide

	condition:
		$guid or all of ($print_str*) or 4 of ($str*)
}
rule ELASTIC_Windows_Trojan_Mylobot_A895174A : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Mylobot (Windows.Trojan.MyloBot)"
		author = "Elastic Security"
		id = "a895174a-0395-4ccb-b681-e8111a817a5c"
		date = "2024-05-15"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_MyloBot.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "33831d9ad64d0f52f507f08ef81607aafa6ced58a189969af6cf57c659c982d2"
		logic_hash = "16f2d8eeb6c85944030a33bd250e4e8b98985a6c877a0ec3ad5a6037e7c00159"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "dfa1e47260c0e07fea3b2b61157de71f412807b9eec19b14082da7d6a95d6099"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "%s\\%s.lnk" wide fullword
		$a2 = "%s\\%s.exe" wide fullword
		$a3 = "%s\\%s\\%s.exe" wide fullword
		$a4 = "HTTP/1.0 502" ascii fullword
		$a5 = "/c \"%ws '%ws%s'\"" ascii fullword
		$a6 = ">> %ws %ws %ws" ascii fullword
		$a7 = "%s\\DefaultIcon" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Cybergate_517Aac7D : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Cybergate (Windows.Trojan.CyberGate)"
		author = "Elastic Security"
		id = "517aac7d-2737-4917-9aa1-c0bd1c3e9801"
		date = "2022-02-28"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CyberGate.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "07b8f25e7b536f5b6f686c12d04edc37e11347c8acd5c53f98a174723078c365"
		logic_hash = "50e061d0c358655c03b95ccbe2d05e252501c3e6afd21dd20513019cd67e6147"
		score = 75
		quality = 48
		tags = "FILE, MEMORY"
		fingerprint = "3d998bda8e56de6fd6267abdacffece8bcf1c62c2e06540a54244dc6ea816825"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "IELOGIN.abc" ascii fullword
		$a2 = "xxxyyyzzz.dat" ascii fullword
		$a3 = "_x_X_PASSWORDLIST_X_x_" ascii fullword
		$a4 = "L$_RasDefaultCredentials#0" ascii fullword
		$a5 = "\\signons1.txt" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Cybergate_9996D800 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Cybergate (Windows.Trojan.CyberGate)"
		author = "Elastic Security"
		id = "9996d800-a833-4535-972b-3ee320215bb6"
		date = "2022-02-28"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CyberGate.yar#L25-L43"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "07b8f25e7b536f5b6f686c12d04edc37e11347c8acd5c53f98a174723078c365"
		logic_hash = "efefc171b6390c9792145973708358f62b18b8d0180feacaf5b9267563c3f7cc"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "eb39d2ff211230aedcf1b5ec0d1dfea108473cc7cba68f5dc1a88479734c02b0"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 24 08 8B 44 24 08 83 C4 14 5D 5F 5E 5B C3 55 8B EC 83 C4 F0 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Cybergate_C219A2F3 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Cybergate (Windows.Trojan.CyberGate)"
		author = "Elastic Security"
		id = "c219a2f3-5ae2-4cdf-97d7-2778954ee826"
		date = "2023-05-04"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CyberGate.yar#L45-L64"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b7204f8caf6ace6ae1aed267de0ad6b39660d0e636d8ee0ecf88135f8a58dc42"
		logic_hash = "8075892728c610c1ceacd0df54615d2a3e833d728d631a9bf81311e8c6485f6e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "8a79d1eba89dd08d2e8bdedee834c88dbeabf5f2f249b1e5accdb827671c22c2"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 00 00 55 8B EC 83 C4 EC 56 57 8B 45 08 8B F0 8D 7D EC A5 A5 }
		$a2 = { 49 80 39 C3 75 F5 8B C2 C3 55 8B EC 6A 00 6A 00 6A 00 53 56 57 }

	condition:
		all of them
}
rule ELASTIC_Multi_Hacktool_Gsocket_761D3A0F : FILE MEMORY {
    meta:
		description = "Detects Multi Hacktool Gsocket (Multi.Hacktool.Gsocket)"
		author = "Elastic Security"
		id = "761d3a0f-e2e8-4a8a-99f6-7356555a517d"
		date = "2024-09-20"
		modified = "2024-11-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Hacktool_Gsocket.yar#L1-L32"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "193efd61ae10f286d06390968537fa85e4df40995fd424d1afe426c089d172ab"
		logic_hash = "6f60b63f406b42ac2a43cbe3afbbc98789504d7c6036d50f852a5bc4a6c46cef"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e4426c5faa5775bcfdfbe01c3d6a2b4042aa9bf942883b104c241d0734b272c9"
		severity = 100
		arch_context = "x86, arm64"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$str1 = "gsocket: gs_funcs not found"
		$str2 = "/share/gsocket/gs_funcs"
		$str3 = "$GSOCKET_ARGS"
		$str4 = "GSOCKET_SECRET"
		$str5 = "GS_HIJACK_PORTS"
		$str6 = "sftp -D gs-netcat"
		$str7 = "GS_NETCAT_BIN"
		$str8 = "GSOCKET_NO_GREETINGS"
		$str9 = "GS-NETCAT(1)"
		$str10 = "GSOCKET_SOCKS_IP"
		$str11 = "GSOCKET_SOCKS_PORT"
		$str12 = "gsocket(1)"
		$str13 = "gs-sftp(1)"
		$str14 = "gs-mount(1)"

	condition:
		3 of them
}
rule ELASTIC_Windows_Trojan_Eagerbee_7029Ba21 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Eagerbee (Windows.Trojan.EagerBee)"
		author = "Elastic Security"
		id = "7029ba21-12ea-4120-911b-a36c4002409e"
		date = "2023-05-09"
		modified = "2023-06-13"
		reference = "https://www.elastic.co/security-labs/introducing-the-ref5961-intrusion-set"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_EagerBee.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "09005775fc587ac7bf150c05352e59dc01008b7bf8c1d870d1cea87561aa0b06"
		logic_hash = "874959361b14ba74e13e6e674da75c9bdb6b9475d8b286572825c940b41f679f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "26d0d10f7c503e284e2b24a9e273f880d2e152348dfdd44fb3fc8cb10aa57e2a"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { C2 EB D6 0F B7 C2 48 8D 0C 80 41 8B 44 CB 14 41 2B 44 CB 0C 41 }
		$a2 = { C8 75 04 33 C0 EB 7C 48 63 41 3C 8B 94 08 88 00 00 00 48 03 D1 8B }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Eagerbee_A64B323B : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Eagerbee (Windows.Trojan.EagerBee)"
		author = "Elastic Security"
		id = "a64b323b-60b6-49b9-99d2-82a336fe304e"
		date = "2023-09-04"
		modified = "2023-09-20"
		reference = "https://www.elastic.co/security-labs/introducing-the-ref5961-intrusion-set"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_EagerBee.yar#L23-L45"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "339e4fdbccb65b0b06a1421c719300a8da844789a2016d58e8ce4227cb5dc91b"
		logic_hash = "e1c25cf8ce0ff434727c9104c6b79110ff5cfa84eb3e939119fd05cf676727c6"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "5109ec213a2ac1a1d920f3a9753bed97d038b226775996002511df5dc0b6de9c"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$dexor_config_file = { 48 FF C0 8D 51 FF 44 30 00 49 03 C4 49 2B D4 ?? ?? 48 8D 4F 01 48 }
		$parse_config = { 80 7C 14 20 3A ?? ?? ?? ?? ?? ?? 45 03 C4 49 03 D4 49 63 C0 48 3B C1 }
		$parse_proxy1 = { 44 88 7C 24 31 44 88 7C 24 32 48 F7 D1 C6 44 24 33 70 C6 44 24 34 3D 88 5C 24 35 48 83 F9 01 }
		$parse_proxy2 = { 33 C0 48 8D BC 24 F0 00 00 00 49 8B CE F2 AE 8B D3 48 F7 D1 48 83 E9 01 48 8B F9 }

	condition:
		2 of them
}
rule ELASTIC_Windows_Trojan_Bitrat_34Bd6C83 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bitrat (Windows.Trojan.Bitrat)"
		author = "Elastic Security"
		id = "34bd6c83-9a71-43d5-b0b1-1646a8fb66e8"
		date = "2021-06-13"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Bitrat.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "37f70ae0e4e671c739d402c00f708761e98b155a1eefbedff1236637c4b7690a"
		logic_hash = "d386fc2a4b6a98638328d1aa05a8d8dbb7a1bbcd72943457b1a5a27b056744ef"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "bc4a5fad1810ad971277a455030eed3377901a33068bb994e235346cfe5a524f"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "crd_logins_report" ascii fullword
		$a2 = "drives_get" ascii fullword
		$a3 = "files_get" ascii fullword
		$a4 = "shell_stop" ascii fullword
		$a5 = "hvnc_start_ie" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Bitrat_54916275 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bitrat (Windows.Trojan.Bitrat)"
		author = "Elastic Security"
		id = "54916275-2a0f-4966-956d-7122a4aea9c8"
		date = "2022-08-29"
		modified = "2022-09-29"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Bitrat.yar#L25-L43"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "d3b2c410b431c006c59f14b33e95c0e44e6221b1118340c745911712296f659f"
		logic_hash = "4c66f79f4bf6bde49bfb9208e6dc1d3b5d041927565e7302381838b0f32da6f4"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "8758b1a839ff801170f6d4ae9186a69af6370f8081defdd25b62e50a3ddcffef"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 6A 10 68 50 73 78 00 E8 5F 4D 02 00 8B 7D 08 85 FF 75 0D FF 15 1C 00 6E 00 50 FF 15 68 03 6E 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Hacktool_Sharpstay_Eac706C5 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Sharpstay (Windows.Hacktool.SharpStay)"
		author = "Elastic Security"
		id = "eac706c5-975e-43f2-b106-149f884a2e9a"
		date = "2022-11-20"
		modified = "2023-01-11"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_SharpStay.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "498d201f65b57a007a79259ce7015eb7eb1bba660d44deafea716e36316a9caa"
		logic_hash = "b85679018658e33e81cd2589e9f99cf9ed16ac25b27d93bece26cb5ccc2e379a"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "346e6cf9d85c737b171914b331bb1837f90696301dbe144cbf8996b8a8cb3adb"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$guid = "2963C954-7B1E-47F5-B4FA-2FC1F0D56AEA" ascii wide nocase
		$print_str0 = "[+] Registry key HKCU:SOFTWARE\\Classes\\CLSID\\{0}\\InProcServer32 created" ascii wide fullword
		$print_str1 = "Sharpstay.exe action=ElevatedRegistryKey" ascii wide fullword
		$print_str2 = "[+] WMI Subscription {0} has been created to run at {1}" ascii wide fullword
		$print_str3 = "[+] Cleaned up %APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\Indexing.{0}" ascii wide fullword

	condition:
		$guid or all of ($print_str*)
}
rule ELASTIC_Windows_Trojan_Pipedance_01C18057 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Pipedance (Windows.Trojan.PipeDance)"
		author = "Elastic Security"
		id = "01c18057-258d-4242-928c-26972a2f1e76"
		date = "2023-02-02"
		modified = "2023-02-22"
		reference = "https://www.elastic.co/security-labs/twice-around-the-dance-floor-with-pipedance"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_PipeDance.yar#L1-L27"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9d3f739e35182992f1e3ade48b8999fb3a5049f48c14db20e38ee63eddc5a1e7"
		logic_hash = "0c03a725ae930eb829d6a6a9f681489d61aa7f69e72b6b298776f75a98115398"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "01b8c127974ec8e3db0fc68db8d11cd4f4247c0128a8630f64c7bd20726220af"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$str1 = "%-5d %-30s %-4s %-7d %s" wide fullword
		$str2 = "PID   Name   Arch Session User" wide fullword
		$str3 = "%s %7.2f B" wide fullword
		$str4 = "\\\\.\\pipe\\%s.%d" ascii fullword
		$seq_rc4 = { 8D 46 ?? 0F B6 F0 8A 14 3E 0F B6 C2 03 C1 0F B6 C8 89 4D ?? 8A 04 0F 88 04 3E 88 14 0F 0F B6 0C 3E 0F B6 C2 03 C8 0F B6 C1 8B 4D ?? 8A 04 38 30 04 0B 43 8B 4D ?? 3B 5D ?? 72 ?? }
		$seq_srv_resp = { 8B CE 50 6A 04 5A E8 ?? ?? ?? ?? B8 00 04 00 00 8D 4E ?? 50 53 8B D0 E8 ?? ?? ?? ?? B8 08 02 00 00 8D 8E ?? ?? ?? ?? 50 57 8B D0 E8 ?? ?? ?? ?? }
		$seq_cmd_dispatch = { 83 FE 29 0F 87 ?? ?? ?? ?? 0F 84 ?? ?? ?? ?? 83 FE 06 0F 87 ?? ?? ?? ?? 0F 84 ?? ?? ?? ?? 8B C6 33 D2 2B C2 0F 84 ?? ?? ?? ?? 83 E8 01 }
		$seq_icmp = { 59 6A 61 5E 89 45 ?? 8B D0 89 5D ?? 2B F0 8D 04 16 8D 4B ?? 88 0A 83 F8 77 7E ?? 80 E9 17 88 0A 43 42 83 FB 20 }

	condition:
		4 of ($str*) or 2 of ($seq*)
}
rule ELASTIC_Multi_Generic_Threat_19854Dc2 : FILE MEMORY {
    meta:
		description = "Detects Multi Generic Threat (Multi.Generic.Threat)"
		author = "Elastic Security"
		id = "19854dc2-a568-4f6c-bd47-bcae9976c66f"
		date = "2024-02-21"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Generic_Threat.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "be216fa9cbf0b64d769d1e8ecddcfc3319c7ca8e610e438dcdfefc491730d208"
		logic_hash = "beed6d6cd7b7b6eb3f4ab6a45fd19f2ebfb661e470d468691b68634994e2eef7"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "64d3803490fa71f720678ca2989cc698ea9b1a398d02d6d671fa01e0ff42f8b5"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$a1 = { 26 2A 73 74 72 75 63 74 20 7B 20 45 6E 74 72 79 53 61 6C 74 20 5B 5D 75 69 6E 74 38 3B 20 4C 65 6E 20 69 6E 74 20 7D }

	condition:
		all of them
}
rule ELASTIC_Multi_Trojan_Sliver_42298C4A : FILE MEMORY {
    meta:
		description = "Detects Multi Trojan Sliver (Multi.Trojan.Sliver)"
		author = "Elastic Security"
		id = "42298c4a-fcea-4c5a-b213-32db00e4eb5a"
		date = "2021-10-20"
		modified = "2022-01-14"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Trojan_Sliver.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "3b45aae401ac64c055982b5f3782a3c4c892bdb9f9a5531657d50c27497c8007"
		logic_hash = "a84bdb51fcdeb4629365bdb727b53087604ee0eb112c8d6c3ecf315598ec678a"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0734b090ea10abedef4d9ed48d45c834dd5cf8e424886a5be98e484f69c5e12a"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$a1 = ").RequestResend"
		$a2 = ").GetPrivInfo"
		$a3 = ").GetReconnectIntervalSeconds"
		$a4 = ").GetPivotID"
		$a5 = "name=PrivInfo"
		$a6 = "name=ReconnectIntervalSeconds"
		$a7 = "name=PivotID"

	condition:
		2 of them
}
rule ELASTIC_Multi_Trojan_Sliver_3Bde542D : FILE MEMORY {
    meta:
		description = "Detects Multi Trojan Sliver (Multi.Trojan.Sliver)"
		author = "Elastic Security"
		id = "3bde542d-df52-4f05-84ff-de67e90592a9"
		date = "2022-08-31"
		modified = "2022-09-29"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Trojan_Sliver.yar#L27-L50"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "05461e1c2a2e581a7c30e14d04bd3d09670e281f9f7c60f4169e9614d22ce1b3"
		logic_hash = "23a0e28c1423f577a147efdf927f2dc71871760e38d4d7494ead2920b90ef05e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e52e39644274e3077769da4d04488963c85a0b691dc9973ad12d51eb34ba388b"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$a1 = "B/Z-github.com/bishopfox/sliver/protobuf/sliverpbb" ascii fullword
		$b1 = "InvokeSpawnDllReq" ascii fullword
		$b2 = "NetstatReq" ascii fullword
		$b3 = "HTTPSessionInit" ascii fullword
		$b4 = "ScreenshotReq" ascii fullword
		$b5 = "RegistryReadReq" ascii fullword

	condition:
		1 of ($a*) or all of ($b*)
}
rule ELASTIC_Multi_Trojan_Sliver_3D6B7Cd3 : FILE MEMORY {
    meta:
		description = "Detects Multi Trojan Sliver (Multi.Trojan.Sliver)"
		author = "Elastic Security"
		id = "3d6b7cd3-f702-470c-819c-8750ec040083"
		date = "2022-12-01"
		modified = "2023-09-20"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Trojan_Sliver.yar#L52-L88"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9846124cfd124eed466465d187eeacb4d405c558dd84ba8e575d8a7b3290403e"
		logic_hash = "3cbd3358b7d59d6a2912069f4cb8de005b6fafd61e44111d1f6cf0418eb2d1fc"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "46d5388bd1fe767a4852c9e35420985d5011368dac6545fd57fbb256de9a94e9"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$session_start_x86_1 = { 89 4C 24 ?? 89 44 24 ?? 8D 4C 24 ?? 89 4C 24 ?? C6 44 24 ?? ?? 89 04 24 E8 ?? ?? ?? ?? 8B 44 24 ?? 89 44 24 ?? C7 44 24 ?? ?? ?? ?? ?? }
		$session_start_x86_2 = { FF 05 ?? ?? ?? ?? 8D 05 ?? ?? ?? ?? 89 04 24 C7 44 24 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B 44 24 ?? 8B 4C 24 ?? 85 C9 74 ?? B8 ?? ?? ?? ?? }
		$session_start_x86_3 = { E8 ?? ?? ?? ?? 8B 44 24 ?? 85 C0 74 ?? FF 05 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B 04 24 39 05 ?? ?? ?? ?? 7E ?? C6 44 24 ?? ?? 8B 54 24 ?? 8B 02 FF D0 83 C4 ?? }
		$session_start_x64_1 = { 44 0F 11 7C 24 ?? 48 8D 0D ?? ?? ?? ?? 48 89 4C 24 ?? 48 89 44 24 ?? 48 8D 4C 24 ?? 48 89 4C 24 ?? C6 44 24 ?? ?? 0F 1F 00 E8 ?? ?? ?? ?? 48 89 44 24 ?? 48 C7 44 24 ?? ?? ?? ?? ?? EB ?? E8 ?? ?? ?? ?? E8 ?? ?? ?? ?? }
		$session_start_x64_2 = { E8 ?? ?? ?? ?? 48 85 C0 74 ?? 48 FF 05 ?? ?? ?? ?? 48 8D 05 ?? ?? ?? ?? BB ?? ?? ?? ?? E8 ?? ?? ?? ?? 48 85 DB B9 ?? ?? ?? ?? 48 0F 45 C1 48 39 05 ?? ?? ?? ?? 7E ?? C6 44 24 ?? ?? 48 8B 54 24 ?? 48 8B 02 FF D0 }
		$session_start_x64_3 = { 48 89 6C 24 ?? 48 8D 6C 24 ?? 49 C7 C5 ?? ?? ?? ?? 4C 89 6C 24 ?? C6 44 24 ?? ?? 48 8D 05 ?? ?? ?? ?? 31 DB E8 ?? ?? ?? ?? 44 0F 11 7C 24 ?? 48 8D 0D ?? ?? ?? ?? 48 89 4C 24 ?? 48 89 44 24 ?? 48 8D 4C 24 ?? 48 89 4C 24 ?? C6 44 24 ?? ?? 0F 1F 00 }
		$register_x64_1 = { 48 81 EC ?? ?? ?? ?? 48 89 AC 24 ?? ?? ?? ?? 48 8D AC 24 ?? ?? ?? ?? 90 E8 ?? ?? ?? ?? 48 89 44 24 ?? 48 89 5C 24 ?? 48 89 4C 24 ?? 0F 1F 44 00 ?? E8 ?? ?? ?? ?? 48 8B 4C 24 ?? 48 85 C9 48 8B 4C 24 ?? BA ?? ?? ?? ?? 48 0F 45 CA 48 89 4C 24 ?? 48 8B 54 24 ?? BE ?? ?? ?? ?? 48 0F 45 D6 48 89 54 24 ?? }
		$register_x64_2 = { 48 8D 1D ?? ?? ?? ?? 48 89 9C 24 ?? ?? ?? ?? 48 C7 84 24 ?? ?? ?? ?? ?? ?? ?? ?? 48 89 9C 24 ?? ?? ?? ?? 48 C7 84 24 ?? ?? ?? ?? ?? ?? ?? ?? 48 89 9C 24 ?? ?? ?? ?? 48 C7 84 24 ?? ?? ?? ?? ?? ?? ?? ?? 48 8D 84 24 ?? ?? ?? ?? }
		$register_x64_3 = { E8 ?? ?? ?? ?? 48 89 84 24 ?? ?? ?? ?? 48 89 5C 24 ?? 48 89 4C 24 ?? 66 90 E8 ?? ?? ?? ?? 48 8B 4C 24 ?? 48 85 C9 48 8B 8C 24 ?? ?? ?? ?? BA ?? ?? ?? ?? 48 0F 45 CA 48 8B 54 24 ?? BE ?? ?? ?? ?? 48 0F 45 D6 48 85 DB 74 ?? 48 8D BC 24 ?? ?? ?? ?? 48 8D 7F ?? 0F 1F 00 48 89 6C 24 ?? 48 8D 6C 24 ?? }
		$register_x64_4 = { 48 89 84 24 ?? ?? ?? ?? 48 89 9C 24 ?? ?? ?? ?? 48 89 8C 24 ?? ?? ?? ?? E8 ?? ?? ?? ?? 48 8B 8C 24 ?? ?? ?? ?? 48 85 C9 48 8B 8C 24 ?? ?? ?? ?? BA ?? ?? ?? ?? 48 0F 45 CA 48 89 8C 24 ?? ?? ?? ?? 48 8B B4 24 ?? ?? ?? ?? BF ?? ?? ?? ?? 48 0F 45 F7 48 89 B4 24 ?? ?? ?? ?? }
		$register_x64_5 = { 48 89 84 24 ?? ?? ?? ?? 48 89 5C 24 ?? 48 89 4C 24 ?? E8 ?? ?? ?? ?? 48 8B 4C 24 ?? 48 85 C9 48 8B 8C 24 ?? ?? ?? ?? BA ?? ?? ?? ?? 48 0F 45 CA 48 89 8C 24 ?? ?? ?? ?? 48 8B 54 24 ?? BE ?? ?? ?? ?? 48 0F 45 D6 48 89 54 24 ?? }
		$register_x64_6 = { E8 ?? ?? ?? ?? 48 8B 6D ?? 48 8B 94 24 ?? ?? ?? ?? 48 89 94 24 ?? ?? ?? ?? 48 8B 94 24 ?? ?? ?? ?? 48 89 94 24 ?? ?? ?? ?? 48 8B 94 24 ?? ?? ?? ?? 48 89 94 24 ?? ?? ?? ?? 48 8B 54 24 ?? 48 89 94 24 ?? ?? ?? ?? 48 89 84 24 ?? ?? ?? ?? 48 89 9C 24 ?? ?? ?? ?? 48 8D 84 24 ?? ?? ?? ?? }
		$register_x64_7 = { E8 ?? ?? ?? ?? C7 40 ?? ?? ?? ?? ?? 48 8B 4C 24 ?? 48 89 48 ?? 48 8B 4C 24 ?? 48 89 48 ?? 83 3D ?? ?? ?? ?? ?? 75 ?? }
		$register_x64_8 = { 48 8D 7F ?? 0F 1F 00 48 89 6C 24 ?? 48 8D 6C 24 ?? E8 ?? ?? ?? ?? 48 8B 6D ?? 4C 8D 15 ?? ?? ?? ?? 4C 89 94 24 ?? ?? ?? ?? 48 C7 84 24 ?? ?? ?? ?? ?? ?? ?? ?? 4C 89 94 24 ?? ?? ?? ?? 48 C7 84 24 ?? ?? ?? ?? ?? ?? ?? ?? 4C 89 94 24 ?? ?? ?? ?? 48 C7 84 24 ?? ?? ?? ?? ?? ?? ?? ?? 48 8D 84 24 ?? ?? ?? ?? }
		$register_x86_1 = { E8 ?? ?? ?? ?? 8B 44 24 ?? 8B 0C 24 8B 54 24 ?? 85 C0 74 ?? 31 C9 31 D2 89 54 24 ?? 89 4C 24 ?? E8 ?? ?? ?? ?? 8B 04 24 8B 4C 24 ?? 85 C9 74 ?? 8D 7C 24 ?? }
		$register_x86_2 = { 8D 0D ?? ?? ?? ?? 89 4C 24 ?? C7 44 24 ?? ?? ?? ?? ?? 89 4C 24 ?? C7 44 24 ?? ?? ?? ?? ?? 89 4C 24 ?? C7 44 24 ?? ?? ?? ?? ?? 8D 44 24 ?? }
		$register_x86_3 = { C7 40 ?? ?? ?? ?? ?? 8D 0D ?? ?? ?? ?? 89 48 ?? 8B 4C 24 ?? 89 48 ?? 8B 4C 24 ?? 89 48 ?? 8B 0D ?? ?? ?? ?? 85 C9 75 ?? }
		$register_x86_4 = { E8 ?? ?? ?? ?? 8B 44 24 ?? 8B 0C 24 8B 54 24 ?? 85 C0 74 ?? 31 C9 31 D2 89 54 24 ?? 89 ?? 24 }
		$register_x86_5 = { 8B 04 24 89 84 24 ?? ?? ?? ?? 8B 4C 24 ?? 89 4C 24 ?? E8 ?? ?? ?? ?? 8B 04 24 8B 4C 24 ?? 8B 54 24 ?? 85 D2 74 ?? 31 C0 31 C9 89 4C 24 ?? 89 84 24 ?? ?? ?? ?? 8D 15 ?? ?? ?? ?? 89 14 24 E8 ?? ?? ?? ?? }

	condition:
		1 of ($session_start_*) and 1 of ($register_*)
}
rule ELASTIC_Windows_PUP_Mediaarena_A9E3B4A1 : FILE MEMORY {
    meta:
		description = "Detects Windows Pup Mediaarena (Windows.PUP.MediaArena)"
		author = "Elastic Security"
		id = "a9e3b4a1-fd87-4f8f-a9d4-d93f9c018270"
		date = "2023-06-02"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_PUP_MediaArena.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c071e0b67e4c105c87b876183900f97a4e8bc1a7c18e61c028dee59ce690b1ac"
		logic_hash = "8e52b29f2848498aae2fd7ad35494362d6c07f0e752b628840a256923aca32c7"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0535228889b1d2a7c317a7ce939621d3d20e2a454ec6d31915c25884931d62b9"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Going to change default browser to be MS Edge ..." wide
		$a2 = "https://www.searcharchiver.com/eula" wide
		$a3 = "Current default browser is unchanged!" wide
		$a4 = "You can terminate your use of the Search Technology and Search Technology services"
		$a5 = "The software may also offer to change your current web navigation access points"
		$a6 = "{{BRAND_NAME}} may have various version compatible with different platform,"
		$a7 = "{{BRAND_NAME}} is a powerful search tool" wide

	condition:
		2 of them
}
rule ELASTIC_Multi_EICAR_Ac8F42D6 : FILE MEMORY {
    meta:
		description = "Detects Multi Eicar Not A Virus (Multi.EICAR.Not-a-virus)"
		author = "Elastic Security"
		id = "ac8f42d6-52da-46ec-8db1-5a5f69222a38"
		date = "2021-01-21"
		modified = "2022-01-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_EICAR.yar#L1-L18"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "05c92058aab1229dfa31e006276c2c83fa484e813bdfe66edf387763797d9d57"
		score = 75
		quality = 25
		tags = "FILE, MEMORY"
		fingerprint = "bb0e0bdf70ec65d98f652e2428e3567013d5413f2725a2905b372fd18da8b9dd"
		severity = 1
		arch_context = "x86, arm64"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$a = "X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Clickfraud_Luckyslots_A82433B6 : FILE MEMORY {
    meta:
		description = "Detects Windows Clickfraud Luckyslots (Windows.Clickfraud.LuckySlots)"
		author = "Elastic Security"
		id = "a82433b6-42eb-4dda-a81e-5121352ea67c"
		date = "2024-08-21"
		modified = "2024-09-30"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Clickfraud_LuckySlots.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6503770b34c53025793f1674af87d80a8f6ed44b5780490796012a2b771b8f84"
		logic_hash = "342dafb67ae8557de66ac810482e2747ae88c76f07c244f1a465351fcc72cab9"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "e30064f9410d8a150eb608cb11349209fca2ca672e28c03f5747edeea8f494a9"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "lwxatisme" ascii fullword
		$a2 = "/{flag}/" ascii fullword
		$a3 = "\"KEYWORDS\"" ascii fullword
		$a4 = "WebKitFormBoundaryBHNkQBGxcQrf7zY1" ascii fullword
		$a5 = "baidu|sogou|360|yisou|bing|google|coccoc|byte" ascii fullword
		$a6 = "Video|xoso|dabong|nohu|bet|app|games|ios|Casino" ascii fullword
		$a7 = "baidu.com|so.com|sogou.com|sm.cn|bing.com|google|coccoc|toutiao" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Asyncrat_11A11Ba1 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Asyncrat (Windows.Trojan.Asyncrat)"
		author = "Elastic Security"
		id = "11a11ba1-c178-4415-9c09-45030b500f50"
		date = "2021-08-05"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Asyncrat.yar#L1-L24"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "fe09cd1d13b87c5e970d3cbc1ebc02b1523c0a939f961fc02c1395707af1c6d1"
		logic_hash = "c6c4ce9ccf01c280be6c25c0c82c34b601626bc200b84d3e77b08be473335d3d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "715ede969076cd413cebdfcf0cdda44e3a6feb5343558f18e656f740883b41b8"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "/c schtasks /create /f /sc onlogon /rl highest /tn \"" wide fullword
		$a2 = "Stub.exe" wide fullword
		$a3 = "get_ActivatePong" ascii fullword
		$a4 = "vmware" wide fullword
		$a5 = "\\nuR\\noisreVtnerruC\\swodniW\\tfosorciM\\erawtfoS" wide fullword
		$a6 = "get_SslClient" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_M0Yv_92F66467 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan M0Yv (Windows.Trojan.M0yv)"
		author = "Elastic Security"
		id = "92f66467-89fd-4501-b045-3c6aed6c82f9"
		date = "2023-05-03"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_M0yv.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0004d22dd18c0239b722c085101c0a32b967159e2066a0b7b9104bb43f5cdea0"
		logic_hash = "a47b20679aee9559213de22783cfbc55c6091785e4dc288349963e863b78cf41"
		score = 75
		quality = 69
		tags = "FILE, MEMORY"
		fingerprint = "2afebc9478fbad18b74748794773cae9be3a4eac599d657bab5a7f8de331ba41"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 54 65 7D 41 69 6E 63 5D 6A 68 6D }
		$a2 = { 4E 73 4D 62 62 77 61 6E 66 77 58 72 61 72 64 6C 7D }
		$a3 = { 40 65 7D 41 69 6E 63 48 77 71 7A 69 66 74 75 67 7A 55 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Whispergate_9192618B : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Whispergate (Windows.Trojan.WhisperGate)"
		author = "Elastic Security"
		id = "9192618b-4f3e-4503-a97f-3c4420fb79e0"
		date = "2022-01-17"
		modified = "2022-01-17"
		reference = "https://www.elastic.co/security-labs/operation-bleeding-bear"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_WhisperGate.yar#L1-L24"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "dcbbae5a1c61dbbbb7dcd6dc5dd1eb1169f5329958d38b58c3fd9384081c9b78"
		logic_hash = "28bb08d61d99d2bfc49ba18cdbabc34c31a715ae6439ab25bbce8cc6958ed381"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "21f2a5b730a86567e68491a0d997fc52ba37f28b2164747240a74c225be3c661"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "https://cdn.discordapp.com/attachments/" wide
		$a2 = "DxownxloxadDxatxxax" wide fullword
		$a3 = "powershell" wide fullword
		$a4 = "-enc UwB0AGEAcgB0AC" wide fullword
		$a5 = "Ylfwdwgmpilzyaph" wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Rudebird_3Cbf7Bc6 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Rudebird (Windows.Trojan.RudeBird)"
		author = "Elastic Security"
		id = "3cbf7bc6-71c5-4c7c-a846-7a95c3d28917"
		date = "2023-05-09"
		modified = "2023-06-13"
		reference = "https://www.elastic.co/security-labs/introducing-the-ref5961-intrusion-set"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_RudeBird.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "2095c3b6bde779b5661c7796b5e33bb0c43facf791b272a603b786f889a06a95"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f70bd86d877d9371601c7f65cf50a5bb9b76ba45acbf591bd8e4c1117a0cac1d"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 40 53 48 83 EC 20 48 8B D9 B9 D8 00 00 00 E8 FD C1 FF FF 48 8B C8 33 C0 48 85 C9 74 05 E8 3A F2 }

	condition:
		all of them
}
rule ELASTIC_Windows_Hacktool_Darkloadlibrary_C25Ee4Eb : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Darkloadlibrary (Windows.Hacktool.DarkLoadLibrary)"
		author = "Elastic Security"
		id = "c25ee4eb-8ea6-40e2-a1a3-ec60491ced03"
		date = "2022-12-02"
		modified = "2023-01-11"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_DarkLoadLibrary.yar#L1-L29"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "5546194a71bc449789c3697f9c106860ac0a21e1ccf2b1196120b3f92f4b5306"
		logic_hash = "c585abbe72834e9ba2e5f1c8070a43b0f10c2b574c72ffe1def4bfd431096415"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "a73ca4c615d3567c48cc9ec3eedb0497de67960e9610fd1d0ad136075005d10b"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$guid = "3DDD52BB-803A-40E7-90E4-A879A873DD8B" ascii wide nocase
		$print_str0 = "LocalLdrGetProcedureAddress: failed to resolve address of: %s" ascii fullword
		$print_str1 = "Not implemented yet, sorry" wide
		$print_str2 = "Failed to link module to PEB: %s" ascii wide fullword
		$print_str3 = "Failed to resolve imports: %s" ascii wide fullword
		$print_str4 = "Failed to map sections: %s" ascii wide fullword
		$print_str5 = "Failed to open local DLL file" wide fullword
		$print_str6 = "Failed to get DLL file size" wide fullword
		$print_str7 = "Failed to allocate memory for DLL data" wide fullword
		$print_str8 = "Failed to read data from DLL file" wide fullword
		$print_str9 = "Failed to close handle on DLL file" wide

	condition:
		$guid or 4 of ($print_str*)
}
rule ELASTIC_Windows_Ransomware_Akira_C8C298Ba : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Akira (Windows.Ransomware.Akira)"
		author = "Elastic Security"
		id = "c8c298ba-2760-4880-a54a-3d916049d0ab"
		date = "2024-05-02"
		modified = "2024-05-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Akira.yar#L1-L24"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a2df5477cf924bd41241a3326060cc2f913aff2379858b148ddec455e4da67bc"
		logic_hash = "9058c83693e93f6daee8894453e56e0d9a4867d551ec3a6b66d7a517f65d8b07"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "81c6dfa172ce7f4254e3cc74fcb71786336d39438d6e9379f7611495f54227c9"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "akira_readme.txt" ascii fullword
		$a2 = "Number of threads to encrypt = " ascii fullword
		$a3 = "write_encrypt_info error:" ascii fullword
		$a4 = "Log-%d-%m-%Y-%H-%M-%S" ascii fullword
		$a5 = "--encryption_path" wide fullword
		$a6 = "--encryption_percent" wide fullword

	condition:
		3 of them
}
rule ELASTIC_Windows_Ransomware_Snake_550E0265 : BETA FILE MEMORY {
    meta:
		description = "Identifies SNAKE ransomware"
		author = "Elastic Security"
		id = "550e0265-fca9-46df-9d5a-cf3ef7efc7ff"
		date = "2020-06-30"
		modified = "2021-08-23"
		reference = "https://labs.sentinelone.com/new-snake-ransomware-adds-itself-to-the-increasing-collection-of-golang-crimeware/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Snake.yar#L1-L24"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "d9c2f6961a4ef560743060ed176bdc606561ca1b8270b8826cb0dbadaf4e5dbc"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "f2796560ddc85ad98a5ef4f0d7323948d57116813c8a26ab902fdfde849704e0"
		threat_name = "Windows.Ransomware.Snake"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Go build ID: \"X6lNEpDhc_qgQl56x4du/fgVJOqLlPCCIekQhFnHL/rkxe6tXCg56Ez88otHrz/Y-lXW-OhiIbzg3-ioGRz\"" ascii fullword
		$a2 = "We breached your corporate network and encrypted the data on your computers."
		$a3 = "c:\\users\\public\\desktop\\Fix-Your-Files.txt" nocase
		$a4 = "%System Root%\\Fix-Your-Files.txt" nocase
		$a5 = "%Desktop%\\Fix-Your-Files.txt" nocase

	condition:
		1 of ($a*)
}
rule ELASTIC_Windows_Ransomware_Snake_119F9C83 : BETA FILE MEMORY {
    meta:
		description = "Identifies SNAKE ransomware"
		author = "Elastic Security"
		id = "119f9c83-4b55-47ce-8c0d-3799a7b46369"
		date = "2020-06-30"
		modified = "2021-08-23"
		reference = "https://labs.sentinelone.com/new-snake-ransomware-adds-itself-to-the-increasing-collection-of-golang-crimeware/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Snake.yar#L26-L46"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "cf6c81e7332acc798409a05a548460bad0ac3621402672c242e48a1b6bccdae6"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "13ffd63c31df2cbaa6988abcaff3b0a3518437f1d37dcd872817b9cbdb61576f"
		threat_name = "Windows.Ransomware.Snake"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$c1 = { 00 40 83 7C 00 40 9E 7C 00 60 75 7C 00 B0 6C 7C 00 B0 74 7C 00 D0 74 7C 00 B0 59 7C 00 D0 59 7C 00 F0 59 7C 00 10 5A 7C 00 30 5A 7C 00 50 5A 7C 00 70 5A 7C 00 90 5A 7C 00 B0 5A 7C 00 D0 5A 7C 00 D0 6C 7C 00 F0 5A 7C 00 30 5B 7C 00 50 5B 7C 00 70 5B 7C 00 90 5B 7C 00 D0 5E 7C 00 B0 5B 7C 00 D0 5B 7C 00 F0 5B 7C 00 50 60 7C 00 70 61 7C 00 10 5C 7C 00 30 5C 7C 00 50 5C 7C 00 10 63 7C 00 70 5C 7C 00 90 5C 7C 00 90 64 7C 00 B0 5C 7C 00 F0 5C 7C 00 10 5D 7C 00 F0 6C 7C 00 10 6D 7C 00 30 5D 7C 00 50 5D 7C 00 30 6D 7C 00 90 71 7C 00 70 5D 7C 00 90 5D 7C 00 B0 5D 7C 00 D0 5D 7C 00 70 6D 7C 00 F0 5D 7C 00 10 5E 7C 00 30 5E 7C 00 50 5E 7C 00 70 5E 7C 00 90 5E 7C 00 B0 5E 7C 00 F0 5E 7C 00 10 5F 7C 00 30 5F 7C 00 50 5F 7C 00 70 5F 7C 00 90 6D 7C 00 90 5F 7C 00 B0 6D 7C 00 D0 6D 7C 00 F0 6D 7C 00 10 6E 7C 00 B0 5F 7C 00 D0 5F 7C 00 F0 5F 7C 00 10 60 7C 00 30 60 7C 00 30 6E 7C 00 70 60 7C }
		$c2 = { 00 30 64 7C 00 50 64 7C 00 70 64 7C 00 B0 64 7C 00 D0 64 7C 00 30 73 7C 00 F0 64 7C 00 90 71 7C 00 10 65 7C 00 30 65 7C 00 50 65 7C 00 90 72 7C 00 B0 72 7C 00 70 6E 7C 00 70 65 7C 00 B0 65 7C 00 D0 65 7C 00 F0 65 7C 00 10 66 7C 00 30 66 7C 00 50 66 7C 00 70 66 7C 00 90 66 7C 00 B0 66 7C 00 D0 66 7C 00 F0 66 7C 00 30 67 7C 00 90 6E 7C 00 B0 6E 7C 00 D0 6E 7C }

	condition:
		1 of ($c*)
}
rule ELASTIC_Windows_Ransomware_Snake_20Bc5Abc : BETA FILE MEMORY {
    meta:
		description = "Identifies SNAKE ransomware"
		author = "Elastic Security"
		id = "20bc5abc-c519-47d2-a6de-5108071a9144"
		date = "2020-06-30"
		modified = "2021-08-23"
		reference = "https://labs.sentinelone.com/new-snake-ransomware-adds-itself-to-the-increasing-collection-of-golang-crimeware/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Snake.yar#L48-L67"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "f3d8a523e04e516e8e059c9f13df355e6caf29a528cfebdf730e3a7d135e3351"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "e7f1be2bd7e1f39b79ac89cf58c90abdb537ff54cbf161192d997e054d3f0883"
		threat_name = "Windows.Ransomware.Snake"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$b1 = { 57 12 1A 10 1A 10 1A 10 1A 10 1A 10 1A 10 1A 10 1A 10 1A 10 1A }

	condition:
		1 of ($b*)
}
rule ELASTIC_Windows_Trojan_Fickerstealer_Cc02E75E : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Fickerstealer (Windows.Trojan.Fickerstealer)"
		author = "Elastic Security"
		id = "cc02e75e-2049-4ee4-9302-e491e7dad696"
		date = "2021-07-22"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Fickerstealer.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a4113ccb55e06e783b6cb213647614f039aa7dbb454baa338459ccf37897ebd6"
		logic_hash = "ccfd7edf7625c13eea5b88fa29f9b8d3d873688f328f3e52c0500ac722c84511"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "022088764645d85dd20d1ce201395b4e79e3e716723715687eaecfcbe667615e"
		severity = 80
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "..\\\\?\\.\\UNC\\Windows stdio in console mode does not support writing non-UTF-8 byte sequences" ascii fullword
		$a2 = "\"SomeNone" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Fickerstealer_F2159Bec : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Fickerstealer (Windows.Trojan.Fickerstealer)"
		author = "Elastic Security"
		id = "f2159bec-a3ce-47a9-91ad-43b8a19ac172"
		date = "2021-07-22"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Fickerstealer.yar#L22-L40"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a4113ccb55e06e783b6cb213647614f039aa7dbb454baa338459ccf37897ebd6"
		logic_hash = "d36cb90b526a291858291d615272baa78881309c83376f4d4cce1768c740ddbc"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0671691c6d5c7177fe155e4076ab39bf5f909ed300f32c1530e80d471dff0296"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 10 12 F2 0F 10 5A 08 31 C1 89 C6 8B 42 50 89 7D F0 F2 0F 11 8D 18 FF }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Xeno_F92Ffb82 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Xeno (Windows.Trojan.Xeno)"
		author = "Elastic Security"
		id = "f92ffb82-b743-4df1-9d6b-2afa3b7bb61f"
		date = "2024-10-10"
		modified = "2024-10-24"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Xeno.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "22dbdbcdd4c8b6899006f9f07e87c19b6a2947eeff8cc89c653309379b388cf4"
		logic_hash = "17d5107b297c150cf737382c175e491e6bc4b17b2db583ff193f4acd40fdd459"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "2ae1aebd652afb7da5799f46883205b1f3a5c5b01e975b526640407d9bd0d22c"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 28 00 00 0A 7D 0E 00 00 04 02 7B 0E 00 00 04 28 29 00 00 0A 07 7B 03 00 00 04 02 7B 0E 00 00 04 6F 2A 00 00 0A 3A F2 00 00 00 02 7B 07 00 00 04 02 7B 09 00 00 04 6F 32 00 00 06 6F 2B 00 00 0A }

	condition:
		all of them
}
rule ELASTIC_Windows_Hacktool_Certify_Ffe1Cca2 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Certify (Windows.Hacktool.Certify)"
		author = "Elastic Security"
		id = "ffe1cca2-106c-4197-9d26-eb90331435d9"
		date = "2024-03-27"
		modified = "2024-05-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_Certify.yar#L1-L27"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "3c7f759a6c38d0c0780fba2d43be6dcf9e4869d54b66f16c0703ec8e58124953"
		logic_hash = "e1d37ad683bfbe34433dc5e13ae2cf7c873fed640e1c58a3b0274b4b34900e53"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "69f5648f1a9621fe33e63c150d184cb89ceef472885a928aa501a08d8069234d"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "<DisplayNtAuthCertificates>b_"
		$a2 = "<PrintAllowPermissions>b_"
		$a3 = "<ShowVulnerableTemplates>b_"
		$a4 = "<ParseCertificateApplicationPolicies>b_"
		$a5 = "<PrintCertTemplate>b_"
		$b1 = "64524ca5-e4d0-41b3-acc3-3bdbefd40c97" ascii wide nocase
		$b2 = "64524CA5-E4D0-41B3-ACC3-3BDBEFD40C97" ascii wide nocase
		$b3 = "Certify.exe find /vulnerable" wide
		$b4 = "Certify.exe request /ca" wide

	condition:
		all of ($a*) or any of ($b*)
}
rule ELASTIC_Windows_Trojan_Bumblebee_35F50Bea : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bumblebee (Windows.Trojan.Bumblebee)"
		author = "Elastic Security"
		id = "35f50bea-c497-4cc6-b915-8ad3aca7bee6"
		date = "2022-04-28"
		modified = "2022-06-09"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Bumblebee.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9fff05a5aa9cbbf7d37bc302d8411cbd63fb3a28dc6f5163798ae899b9edcda6"
		logic_hash = "9f22b1b7f9e2d7858738d02730ef5477f8d430ad3606ebf4ac8b01314fdc9c46"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f2e07a9b7d143ca13852f723e7d0bd55365d6f8b5d9315b7e24b7f1101010820"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 43 28 45 33 D2 4D 8D 0C 00 44 88 54 24 20 66 48 0F 7E C9 66 0F }
		$a2 = { 31 DA 48 31 C7 45 ?? C9 B9 E8 03 C7 45 ?? 00 00 BA 01 C7 45 ?? 00 00 00 48 C7 45 ?? B8 88 77 66 C7 45 ?? 55 44 33 22 C7 45 ?? 11 FF D0 EB C6 45 }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Bumblebee_70Bed4F3 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bumblebee (Windows.Trojan.Bumblebee)"
		author = "Elastic Security"
		id = "70bed4f3-f515-4186-ac6c-e9db72b8a95a"
		date = "2022-04-28"
		modified = "2022-06-09"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Bumblebee.yar#L22-L46"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9fff05a5aa9cbbf7d37bc302d8411cbd63fb3a28dc6f5163798ae899b9edcda6"
		logic_hash = "3ff97986bfd8df812c4ef94395b3ac7f9ead4d059c398f8984ee217a1bcee4af"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "016477598ce022cc75f591d1c72535a3353ecc4e888642e72aa29476464a8c2f"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Checking Virtual PC processes %s " wide fullword
		$a2 = "SELECT * FROM Win32_ComputerSystemProduct" ascii fullword
		$a3 = "Injection-Date" ascii fullword
		$a4 = " -Command \"Wait-Process -Id " ascii fullword
		$a5 = "%WINDIR%\\System32\\wscript.exe" wide fullword
		$a6 = "objShell.Run \"rundll32.exe my_application_path"
		$a7 = "Checking reg key HARDWARE\\Description\\System - %s is set to %s" wide fullword

	condition:
		5 of them
}
rule ELASTIC_Windows_Trojan_Spectralviper_43Abeeeb : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Spectralviper (Windows.Trojan.SpectralViper)"
		author = "Elastic Security"
		id = "43abeeeb-d81a-475e-9b9e-6b6337bf2ce0"
		date = "2023-04-13"
		modified = "2023-05-26"
		reference = "https://www.elastic.co/security-labs/elastic-charms-spectralviper"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_SpectralViper.yar#L1-L27"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "7e35ba39c2c77775b0394712f89679308d1a4577b6e5d0387835ac6c06e556cb"
		logic_hash = "976e5b5b4ba73f1b392c2f6b32a86b09b5fd9e5a3510c60b77a39f1e0d705822"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0e19e57e936d08f68c5580d21c2d69d451cfc11d413c6125dbdaab863b73d5c7"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 13 00 8D 58 FF 0F AF D8 F6 C3 01 0F 94 44 24 26 83 FD 0A 0F 9C 44 24 27 4D 89 CE 4C 89 C7 48 89 D3 48 89 CE B8 }
		$a2 = { 15 00 8D 58 FF 0F AF D8 F6 C3 01 0F 94 44 24 2E 83 FD 0A 0F 9C 44 24 2F 4D 89 CE 4C 89 C7 48 89 D3 48 89 CE B8 }
		$a3 = { 00 8D 68 FF 0F AF E8 40 F6 C5 01 0F 94 44 24 2E 83 FA 0A 0F 9C 44 24 2F 4C 89 CE 4C 89 C7 48 89 CB B8 }
		$a4 = { 00 48 89 C6 0F 29 30 0F 29 70 10 0F 29 70 20 0F 29 70 30 0F 29 70 40 0F 29 70 50 48 C7 40 60 00 00 00 00 48 89 C1 E8 }
		$a5 = { 41 0F 45 C0 45 84 C9 41 0F 45 C0 EB BA 48 89 4C 24 08 89 D0 EB B1 48 8B 44 24 08 48 83 C4 10 C3 56 57 53 48 83 EC 30 8B 05 }
		$a6 = { 00 8D 70 FF 0F AF F0 40 F6 C6 01 0F 94 44 24 25 83 FF 0A 0F 9C 44 24 26 89 D3 48 89 CF 48 }
		$a7 = { 48 89 CE 48 89 11 4C 89 41 08 41 0F 10 01 41 0F 10 49 10 41 0F 10 51 20 0F 11 41 10 0F 11 49 20 0F 11 51 30 }
		$a8 = { 00 8D 58 FF 0F AF D8 F6 C3 01 0F 94 44 24 22 83 FD 0A 0F 9C 44 24 23 48 89 D6 48 89 CF 4C 8D }

	condition:
		5 of them
}
rule ELASTIC_Windows_Trojan_Spectralviper_368C36A0 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Spectralviper (Windows.Trojan.SpectralViper)"
		author = "Elastic Security"
		id = "368c36a0-d8ec-4cd6-92b3-193907898dc1"
		date = "2023-05-10"
		modified = "2023-05-10"
		reference = "https://www.elastic.co/security-labs/elastic-charms-spectralviper"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_SpectralViper.yar#L29-L53"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "d1c32176b46ce171dbce46493eb3c5312db134b0a3cfa266071555c704e6cff8"
		logic_hash = "6182bde93e18dc6a83a94b50b193f5f29ed9abfa89b53c290818e7dab5bbb334"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "cfe4df5390a625d59f1c30775fe26119707a296feb1a205f3df734a4c0fcc25c"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 18 48 89 4F D8 0F 10 40 20 0F 11 47 E0 0F 10 40 30 0F 11 47 F0 48 8D }
		$a2 = { 24 27 48 83 C4 28 5B 5D 5F 5E C3 56 57 53 48 83 EC 20 48 89 CE 48 }
		$a3 = { C7 84 C9 0F 45 C7 EB 86 48 8B 44 24 28 48 83 C4 30 5B 5F 5E C3 48 83 }
		$s1 = { 40 53 48 83 EC 20 48 8B 01 48 8B D9 48 8B 51 10 48 8B 49 08 FF D0 48 89 43 18 B8 04 00 00 }
		$s2 = { 40 53 48 83 EC 20 48 8B 01 48 8B D9 48 8B 49 08 FF D0 48 89 43 10 B8 04 00 00 00 48 83 C4 20 5B }
		$s3 = { 48 83 EC 28 4C 8B 41 18 4C 8B C9 48 B8 AB AA AA AA AA AA AA AA 48 F7 61 10 48 8B 49 08 48 C1 EA }

	condition:
		2 of ($a*) or any of ($s*)
}
rule ELASTIC_Windows_Trojan_Downtown_901C4Fdd : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Downtown (Windows.Trojan.DownTown)"
		author = "Elastic Security"
		id = "901c4fdd-858c-4ad8-be12-f88799d591b9"
		date = "2023-05-10"
		modified = "2023-06-13"
		reference = "https://www.elastic.co/security-labs/introducing-the-ref5961-intrusion-set"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_DownTown.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "6368d37fa9ba4e32131e16bceaee322f2fa8507873d01ebd687536e593354725"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "1ef6dfd9be1e6fa2d1c6b5ce32ad13252f5becf709493a7cceff3519750e0b1e"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "SendFileBuffer error -1 !!!" fullword
		$a2 = "ScheduledDownloadTasks CODE_FILE_VIEW " fullword
		$a3 = "ExplorerManagerC.dll" fullword

	condition:
		3 of them
}
rule ELASTIC_Windows_Trojan_Downtown_145Ecd2F : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Downtown (Windows.Trojan.DownTown)"
		author = "Elastic Security"
		id = "145ecd2f-d012-4566-a2e9-696cdbd793ce"
		date = "2023-08-23"
		modified = "2023-09-20"
		reference = "https://www.elastic.co/security-labs/introducing-the-ref5961-intrusion-set"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_DownTown.yar#L23-L44"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "744a51c5317e265177185d9d0b8838a8fc939b4c56cc5e5bc51d5432d046d9f1"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "d755ad4a24b390ce56d4905e40cec83a39ea515cfbe7e1a534950ca858343e70"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "DeletePluginObject"
		$a2 = "GetPluginInfomation"
		$a3 = "GetPluginObject"
		$a4 = "GetRegisterCode"

	condition:
		all of them
}
rule ELASTIC_Windows_Exploit_CVE_2022_38028_31Fdb122 : FILE MEMORY CVE_2022_38028 {
    meta:
		description = "Detects Windows Exploit Cve 2022 38028 (Windows.Exploit.CVE-2022-38028)"
		author = "Elastic Security"
		id = "31fdb122-36fd-4fae-b605-542dc344575c"
		date = "2024-06-06"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Exploit_CVE_2022_38028.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6b311c0a977d21e772ac4e99762234da852bbf84293386fbe78622a96c0b052f"
		logic_hash = "df0ef11ce8e840c331d1db8f98917367dc2a33b6f1be48adb9d0b86729ecbe99"
		score = 75
		quality = 73
		tags = "FILE, MEMORY, CVE-2022-38028"
		fingerprint = "e489287412ee673f4d93c5efc9e61b5d26d877bb0f4ddf827926b4d5d87dc399"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 70 72 69 6E 74 54 69 63 6B 65 74 2E 58 6D 6C 4E 6F 64 65 2E 6C 6F 61 64 28 27 25 53 3A 2F 2F 67 6F 27 29 3B }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Plugx_5F3844Ff : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Plugx (Windows.Trojan.PlugX)"
		author = "Elastic Security"
		id = "5f3844ff-2da6-48b4-9afb-343149af03ac"
		date = "2023-08-28"
		modified = "2023-09-20"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_PlugX.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a823380e46878dfa8deb3ca0dc394db1db23bb2544e2d6e49c0eceeffb595875"
		logic_hash = "a1a484f4cf00ec0775a3f322bae66ce5f9cc52f08306b38f079445233c49bf52"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "5365e6978ffca67e232165bca7bcdc5064abd5c589e49e19aa640f59dd5285ab"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "EAddr:0x%p"
		$a2 = "Host: [%s:%d]" ascii fullword
		$a3 = "CONNECT %s:%d HTTP/1.1" ascii fullword
		$a4 = "%4.4d-%2.2d-%2.2d %2.2d:%2.2d:%2.2d:" wide fullword
		$a5 = "\\bug.log" wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Plugx_F338Dab5 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Plugx (Windows.Trojan.PlugX)"
		author = "Elastic Security"
		id = "f338dab5-8c8f-46d7-8f93-48077fc76da1"
		date = "2024-06-05"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_PlugX.yar#L25-L45"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "8af3fc1f8bd13519d78ee83af43daaa8c5e2c3f184c09f5c41941e0c6f68f0f7"
		logic_hash = "0482305a73bc500aa7c266536cb8286ea796f6b1eaba39547bed22313bbb4457"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "7c9f3d739eb17c545ded116387400340117acc23f3ef9fec9eacf993f1d2eb80"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 45 08 FF B0 60 03 00 00 E8 A8 0C 00 00 83 C4 24 8D 45 08 89 }
		$a2 = { 2C 5E 5F 5B 5D C3 CC 55 53 57 56 83 EC 10 8B 6C 24 30 8B 44 }
		$a3 = { 89 4D D4 83 60 04 00 3B F3 75 40 E8 53 DA FF FF 8B 40 08 89 }

	condition:
		2 of them
}
rule ELASTIC_Windows_Vulndriver_Hrsword_15B431Ee : FILE MEMORY {
    meta:
		description = "Detects Windows Vulndriver Hrsword (Windows.VulnDriver.HrSword)"
		author = "Elastic Security"
		id = "15b431ee-2597-44b1-bf33-4fb4b614bb10"
		date = "2023-05-25"
		modified = "2024-09-30"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_VulnDriver_HrSword.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "272e934cec4a84ab92b2bccb98539d73542ea9184960a2c9923d4edc667f4d4f"
		logic_hash = "d8aed70f101a717efe83adceea0f220fb0b145ab8aa39b6250ac2bc057bf51ce"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "7e907d2f13c11c18063c3aa74c46f06bf7aa5ca4cb79193ca985e65eac1697f1"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$original_file_name = { 4F 00 72 00 69 00 67 00 69 00 6E 00 61 00 6C 00 46 00 69 00 6C 00 65 00 6E 00 61 00 6D 00 65 00 00 00 73 00 79 00 73 00 64 00 69 00 61 00 67 00 2E 00 73 00 79 00 73 00 00 00 }
		$str1 = "Huorong Internet Security Core Kext" wide

	condition:
		int16 ( uint32(0x3C)+0x5c)==0x0001 and int16 ( uint32(0x3C)+0x18)==0x020b and $original_file_name and $str1
}
rule ELASTIC_Windows_Ransomware_Stop_1E8D48Ff : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Stop (Windows.Ransomware.Stop)"
		author = "Elastic Security"
		id = "1e8d48ff-e0ab-478d-8268-a11f2e87ab79"
		date = "2021-06-10"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Stop.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "821b27488f296e15542b13ac162db4a354cbf4386b6cd40a550c4a71f4d628f3"
		logic_hash = "d743feae072a5f3e1b008354352bef48218bb041bc8a5ba39526815ab9cd2690"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "715888e3e13aaa33f2fd73beef2c260af13e9726cb4b43d349333e3259bf64eb"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = "E:\\Doc\\My work (C++)\\_Git\\Encryption\\Release\\encrypt_win_api.pdb" ascii fullword
		$b = { 68 FF FF FF 50 FF D3 8D 85 78 FF FF FF 50 FF D3 8D 85 58 FF }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Behinder_B9A49F4B : FILE MEMORY {
    meta:
		description = "Webshell found in REF2924, either Behinder or Godzilla based shell in C#"
		author = "Elastic Security"
		id = "b9a49f4b-5923-420e-a9e6-9bfa05c93bbf"
		date = "2023-03-02"
		modified = "2023-06-13"
		reference = "https://www.elastic.co/security-labs/ref2924-howto-maintain-persistence-as-an-advanced-threat"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Behinder.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a50ca8df4181918fe0636272f31e19815f1b97cce6d871e15e03b0ee0e3da17b"
		logic_hash = "2303ef82e4dc5e8be87ddc4563dcd06963d17e1fbf25cf246a6c81e4e74adbcb"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "cb7856a7d3e792cc60837587fe4afc04448af74cb5ce0478a09eb129e53bf7f1"
		threat_name = "Windows.Trojan.Behinder"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$load = { 53 79 73 74 65 6D 2E 52 65 66 6C 65 63 74 69 6F 6E 2E 41 73 73 65 6D 62 6C 79 }
		$key = "e45e329feb5d925b" ascii wide

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Dustywarehouse_A6Cfc9F7 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Dustywarehouse (Windows.Trojan.DustyWarehouse)"
		author = "Elastic Security"
		id = "a6cfc9f7-6d4a-4904-8294-790243eca76a"
		date = "2023-08-25"
		modified = "2023-11-02"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_DustyWarehouse.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "8c4de69e89dcc659d2fff52d695764f1efd7e64e0a80983ce6d0cb9eeddb806c"
		logic_hash = "2b4cd9316e2fda882c95673edecb9c82a03ef4fdcc2d2e25783644cc5dfb5bf0"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a0ef31535c7df8669e2b0cf38e9128e662bf64decabac5c9f3dad3a98f811033"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "%4d.%2d.%2d-%2d:%2d:%2d" wide fullword
		$a2 = ":]%d-%d-%d %d:%d:%d" wide fullword
		$a3 = "\\sys.key" wide fullword
		$a4 = "[rwin]" wide fullword
		$a5 = "Software\\Tencent\\Plugin\\VAS" fullword

	condition:
		3 of them
}
rule ELASTIC_Windows_Trojan_Dustywarehouse_3Fef514B : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Dustywarehouse (Windows.Trojan.DustyWarehouse)"
		author = "Elastic Security"
		id = "3fef514b-9499-47ce-bf84-8393f8d0260f"
		date = "2024-05-30"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_DustyWarehouse.yar#L25-L43"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "4ad024f53595fdd380f5b5950b62595cd47ac424d2427c176a7b2dfe4e1f35f7"
		logic_hash = "865ea1e54950a465b71939a41f7a726ccddcfa9f0d777ea853926f65bca0da84"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "077bc59b4b6298e405c1cd37d9416667371190e5d8c83a9a9502753c9065df58"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 48 83 EC 30 48 C7 44 24 20 FE FF FF FF 48 89 5C 24 48 48 89 74 24 50 C7 44 24 40 [4] 48 8B 39 48 8B 71 08 48 8B 59 10 48 8B 49 18 ?? ?? ?? ?? ?? ?? 84 DB 74 05 E8 E1 01 00 00 48 8B CE }

	condition:
		all of them
}
rule ELASTIC_Windows_Hacktool_Sharpgpoabuse_14Ea480E : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Sharpgpoabuse (Windows.Hacktool.SharpGPOAbuse)"
		author = "Elastic Security"
		id = "14ea480e-fbd5-4dd3-885c-9a13bfb4400b"
		date = "2024-03-25"
		modified = "2024-05-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_SharpGPOAbuse.yar#L1-L26"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "d13f87b9eaf09ef95778b2f1469aa34d03186d127c8f73c73299957d386c78d1"
		logic_hash = "efc1259f4ed05c8f41df75c056d36fd5a808a92b5c88cfb0522caedea39476b4"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "1f86d5dfc193076127dcc4355cbf0c4bdffc0785ca2daf8e1364d76ee273b343"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$name = "SharpGPOAbuse" wide fullword
		$s1 = "AddUserTask" wide fullword
		$s2 = "AddComputerTask" wide fullword
		$s3 = "AddComputerScript" wide fullword
		$s4 = "AddUserScript" wide fullword
		$s5 = "GPOName" wide fullword
		$s6 = "ScheduledTasks" wide fullword
		$s7 = "NewImmediateTask" wide fullword

	condition:
		($name and 1 of ($s*)) or all of ($s*)
}
rule ELASTIC_Windows_Vulndriver_Threatfire_Cbe7Ac92 : FILE MEMORY {
    meta:
		description = "Detects Windows Vulndriver Threatfire (Windows.VulnDriver.ThreatFire)"
		author = "Elastic Security"
		id = "cbe7ac92-062e-4781-b46b-71eb5096ca6b"
		date = "2024-08-19"
		modified = "2024-09-30"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_VulnDriver_ThreatFire.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1c1a4ca2cbac9fe5954763a20aeb82da9b10d028824f42fff071503dcbe15856"
		logic_hash = "689e17c9fdfc9de10a2cf3d39306103712504ab46db35ac65ed0340c83af240d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "db3932950c8db0b145b0995fa90753ddded4ce1c89f891dce9b0e51a95157dc8"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$original_file_name = { 4F 00 72 00 69 00 67 00 69 00 6E 00 61 00 6C 00 46 00 69 00 6C 00 65 00 6E 00 61 00 6D 00 65 00 00 00 54 00 66 00 53 00 79 00 73 00 4D 00 6F 00 6E 00 2E 00 73 00 79 00 73 00 00 00 }
		$str1 = "ThreatFire" wide fullword

	condition:
		int16 ( uint32(0x3C)+0x5c)==0x0001 and int16 ( uint32(0x3C)+0x18)==0x020b and all of them
}
rule ELASTIC_Windows_Hacktool_Clroxide_D92D9575 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Clroxide (Windows.Hacktool.ClrOxide)"
		author = "Elastic Security"
		id = "d92d9575-9ad9-464f-95a3-8e100666d7fa"
		date = "2024-02-29"
		modified = "2024-03-21"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_ClrOxide.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f3a4900eff80563bff586ced172c3988347980f902aceef2f9f9f6d188fac8e3"
		logic_hash = "01bb071e1286bb139c5e1c37e421153ef1b28a5994feeaedf6ad27ad7dade5e9"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b403acddadc5adb982a9ee0e0513ecd471b728680cc9a6cd8cd8150eb9c02776"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$s1 = "clroxide..primitives..imethodinfo"
		$s2 = "clroxide..clr..Clr"
		$s3 = "\\src\\primitives\\icorruntimehost.rs"
		$s4 = "\\src\\primitives\\iclrruntimeinfo.rs"
		$s5 = "\\src\\primitives\\iclrmetahost.rs"
		$s6 = "clroxide\\src\\clr\\mod.rs"
		$s7 = "__clrcall"

	condition:
		2 of them
}
rule ELASTIC_Windows_Hacktool_Askcreds_34E3E3D4 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Askcreds (Windows.Hacktool.AskCreds)"
		author = "Elastic Security"
		id = "34e3e3d4-7516-4e0e-b3e7-5bc84404bd08"
		date = "2023-05-16"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_AskCreds.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "d911566ca546a8546928cd0ffa838fd344b35f75a4a7e80789d20e52c7cd38d0"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e00dd2496045d1b71119b35c30c4c010c0ad57f67691649c0f4d206f837bd05d"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Failed to create AskCreds thread."
		$a2 = "CredUIPromptForWindowsCredentialsW failed"
		$a3 = "[+] Password: %ls"

	condition:
		2 of them
}
rule ELASTIC_Windows_Trojan_Generic_A681F24A : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Generic (Windows.Trojan.Generic)"
		author = "Elastic Security"
		id = "a681f24a-7054-4525-bcf8-3ee64a1d8413"
		date = "2021-06-10"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Generic.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a796f316b1ed7fa809d9ad5e9b25bd780db76001345ea83f5035a33618f927fa"
		logic_hash = "72bfefc8f92dbe65d197e02bf896315dcbc54d7b68d0434f43de026ccf934f40"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "6323ed5b60e728297de19c878cd96b429bfd6d82157b4cf3475f3a3123921ae0"
		severity = 25
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = "_kasssperskdy" wide fullword
		$b = "[Time:]%d-%d-%d %d:%d:%d" wide fullword
		$c = "{SDTB8HQ9-96HV-S78H-Z3GI-J7UCTY784HHC}" wide fullword

	condition:
		2 of them
}
rule ELASTIC_Windows_Trojan_Generic_Ae824B13 : REF1296 FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Generic (Windows.Trojan.Generic)"
		author = "Elastic Security"
		id = "ae824b13-eaae-49e6-a965-ff10379f3c41"
		date = "2022-02-03"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Generic.yar#L23-L43"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "cee46c1efdaa1815606f932a4f79b316e02c1b481e73c4c2f8b7c72023e8684c"
		score = 75
		quality = 67
		tags = "REF1296, FILE, MEMORY"
		fingerprint = "8658996385aac060ebe9eab45bbea8b05b9008926bb3085e5589784473bc3086"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 31 31 34 2E 31 31 34 2E 31 31 34 2E 31 31 34 }
		$a2 = { 69 6E 66 6F 40 63 69 61 2E 6F 72 67 30 }
		$a3 = { 55 73 65 72 2D 41 67 65 6E 74 3A 20 4D 6F 7A 69 6C 6C 61 2F 35 2E 30 20 28 57 69 6E 64 6F 77 73 20 4E 54 20 36 2E 33 3B 20 57 4F 57 36 34 29 20 41 70 70 6C 65 57 65 62 4B 69 74 2F 35 33 37 2E 33 36 20 28 4B 48 54 4D 4C 2C 20 6C 69 6B 65 20 47 65 63 6B 6F 29 20 43 68 72 6F 6D 65 2F 35 30 2E 30 2E 32 36 36 31 2E 39 34 20 53 61 66 61 72 69 2F 35 33 37 2E 33 36 }
		$a4 = { 75 73 65 72 25 33 64 61 64 6D 69 6E 25 32 36 70 61 73 73 77 6F 72 64 25 33 64 64 65 66 61 75 6C 74 25 34 30 72 6F 6F 74 }

	condition:
		3 of them
}
rule ELASTIC_Windows_Trojan_Generic_Eb47E754 : REF1296 FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Generic (Windows.Trojan.Generic)"
		author = "Elastic Security"
		id = "eb47e754-9b4d-45e7-b76c-027d03326c6c"
		date = "2022-02-03"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Generic.yar#L45-L65"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "1d96e813ed0261bd0d7caca2803ed8d5fe4d77ea00efc9130eef86aa872c4656"
		score = 75
		quality = 67
		tags = "REF1296, FILE, MEMORY"
		fingerprint = "b71d13a34e5f791612ed414b8b0e993b1f476a8398a1b0be39046914ac5ac21d"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 41 20 61 74 20 4C 20 25 64 }
		$a2 = { 74 63 70 69 70 5F 74 68 72 65 61 64 }
		$a3 = { 32 30 38 2E 36 37 2E 32 32 32 2E 32 32 32 }
		$a4 = { 55 73 65 72 2D 41 67 65 6E 74 3A 20 4D 6F 7A 69 6C 6C 61 2F 35 2E 30 20 28 57 69 6E 64 6F 77 73 20 4E 54 20 36 2E 33 3B 20 57 4F 57 36 34 29 20 41 70 70 6C 65 57 65 62 4B 69 74 2F 35 33 37 2E 33 36 20 28 4B 48 54 4D 4C 2C 20 6C 69 6B 65 20 47 65 63 6B 6F 29 20 43 68 72 6F 6D 65 2F 35 37 2E 30 2E 32 39 38 37 2E 31 33 33 20 53 61 66 61 72 69 2F 35 33 37 2E 33 36 }

	condition:
		3 of them
}
rule ELASTIC_Windows_Trojan_Generic_C7Fd8D38 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Generic (Windows.Trojan.Generic)"
		author = "Elastic Security"
		id = "c7fd8d38-eaba-424d-b91a-098c439dab6b"
		date = "2022-02-17"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Generic.yar#L67-L89"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a1702ec12c2bf4a52e11fbdab6156358084ad2c662c8b3691918ef7eabacde96"
		logic_hash = "81c56cd741692a7f2a894c2b8f2676aad47f14221228b9466a2ab0f05d76c623"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "dc14cd519b3bbad7c2e655180a584db0a4e2ad4eea073a52c94b0a88152b37ba"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "PCREDENTIAL" ascii fullword
		$a2 = "gHotkey" ascii fullword
		$a3 = "EFORMATEX" ascii fullword
		$a4 = "ZLibEx" ascii fullword
		$a5 = "9Root!" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Generic_Bbe6C282 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Generic (Windows.Trojan.Generic)"
		author = "Elastic Security"
		id = "bbe6c282-e92d-4021-bdaf-189337e4abf0"
		date = "2022-03-02"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Generic.yar#L91-L109"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a44c46d4b9cf1254aaabd1e689f84c4d2c3dd213597f827acabface03a1ae6d1"
		logic_hash = "fe874d69ae71775cf997845c90e731479569e2ac1ac882a4b8c3c73d015b1f30"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e004d77440a86c23f23086e1ada6d1453178b9c2292782c1c88a7b14151c10fe"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 00 D1 1C A5 03 08 08 00 8A 5C 01 08 08 00 8A 58 01 2E 54 FF }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Generic_889B1248 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Generic (Windows.Trojan.Generic)"
		author = "Elastic Security"
		id = "889b1248-a694-4c9b-8792-c04e582e814c"
		date = "2022-03-11"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Generic.yar#L111-L132"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a48d57a139c7e3efa0c47f8699e2cf6159dc8cdd823b16ce36257eb8c9d14d53"
		logic_hash = "b3bb93b95377d6c6606d29671395b78c0954cc47d5cc450436799638d0458469"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "a5e0c2bbd6a297c01f31eccabcbe356730f50f074587f679da6caeca99e54bc1"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "BELARUS-VIRUS-MAKER" ascii fullword
		$a2 = "C:\\windows\\temp\\" ascii fullword
		$a3 = "~c~a~n~n~a~b~i~s~~i~s~~n~o~t~~a~~d~r~u~g~" ascii fullword
		$a4 = "untInfector" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Generic_02A87A20 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Generic (Windows.Trojan.Generic)"
		author = "Elastic Security"
		id = "02a87a20-a5b4-44c6-addc-c70b327d7b2c"
		date = "2022-03-04"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Generic.yar#L134-L152"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "13037b749aa4b1eda538fda26d6ac41c8f7b1d02d83f47b0d187dd645154e033"
		logic_hash = "610db1b429ed2ecfc552f73ed4782cb56254e6fc98b728ffeff6938fbcce9616"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "fb25a522888efa729ee6d43a3eec7ade3d08dba394f3592d1c3382a5f7a813c8"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 24 3C 8B C2 2B C1 83 F8 01 72 3A 8D 41 01 83 FA 08 89 44 24 38 8D 44 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Generic_4Fbff084 : FILE MEMORY {
    meta:
		description = "Shellcode found in REF2924, belonging to for now unknown trojan"
		author = "Elastic Security"
		id = "4fbff084-5280-4ff8-9c21-c437207231a5"
		date = "2023-02-28"
		modified = "2023-04-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Generic.yar#L154-L175"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "7010a69ba77e65e70f4f3f4a10af804e6932c2218ff4abd5f81240026822b401"
		logic_hash = "47d1a01e0edee3239d99ff1f32eb4cfc77d6e38823fed799a562e142d3d3a22d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "728d7877e7a16fbb756b1c3b6c90ff3b718f0f750803b6a1549cb32c69be0dfc"
		threat_name = "Windows.Trojan.Generic"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$string_decryption = { 8A 44 30 ?? 8A CD 88 45 ?? 32 C5 C0 C1 ?? 88 04 3E 0F B6 C5 0F B6 D9 0F AF D8 0F B6 C1 0F B6 D1 88 6D ?? 0F AF D0 0F B6 C5 0F B6 CD 0F AF C8 8A 6D ?? 8A 45 ?? C0 CB ?? 02 D1 32 DA 02 EB 88 6D ?? 38 45 ?? 74 ?? 8B 45 ?? 46 81 FE ?? ?? ?? ?? 7C ?? }
		$thread_start = { E8 ?? ?? ?? ?? 6A ?? 8D 44 24 ?? BB ?? ?? ?? ?? 50 6A ?? 5A 8B CF 89 5C 24 ?? E8 ?? ?? ?? ?? 6A ?? 8D 44 24 ?? 89 5C 24 ?? 50 6A ?? 5A 8B CF E8 ?? ?? ?? ?? 6A ?? 8D 44 24 ?? 89 5C 24 ?? 50 6A ?? 5A 8B CF E8 ?? ?? ?? ?? 6A ?? 8D 44 24 ?? 89 5C 24 ?? 50 6A ?? 5A 8B CF E8 ?? ?? ?? ?? }
		$resolve = { 8B 7A ?? 8D 5D ?? 85 FF 74 ?? 0F B7 0F 8D 7F ?? 8D 41 ?? 83 F8 ?? 77 ?? 83 C1 ?? 0F B7 33 83 C3 ?? 8D 46 ?? 83 F8 ?? 77 ?? 83 C6 ?? 85 C9 }

	condition:
		2 of them
}
rule ELASTIC_Windows_Trojan_Generic_73Ed7375 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Generic (Windows.Trojan.Generic)"
		author = "Elastic Security"
		id = "73ed7375-c8ab-4d95-ae66-62b1b02a3d1e"
		date = "2023-05-09"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Generic.yar#L177-L196"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "2b17328a3ef0e389419c9c86f81db4118cf79640799e5c6fdc97de0fc65ad556"
		logic_hash = "7e27c9377d0b2058a2a36da4ac7d37a54c566f3246e69aa356171edae6b478c5"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a026cc2db3bfebca4b4ea6e9dc41c2b18d0db730754ef3131d812d7ef9cd17d6"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 48 8B 03 48 8B CE 49 8D 54 04 02 41 FF D6 48 89 03 48 83 C3 08 48 }
		$a2 = { 41 3C 42 8B BC 08 88 00 00 00 46 8B 54 0F 20 42 8B 5C 0F 24 4D }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Generic_96Cdf3C4 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Generic (Windows.Trojan.Generic)"
		author = "Elastic Security"
		id = "96cdf3c4-6f40-4eb3-8bfd-b3c41422388a"
		date = "2023-05-09"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Generic.yar#L198-L217"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9a4d68de36f1706a3083de7eb41f839d8c7a4b8b585cc767353df12866a48c81"
		logic_hash = "f92e5549aca320d71e1eec8daa82e8bbf3517c7f23f376bb355fdfa32da2e7a9"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "1037576e2c819031d5dc8067650c6b869e4d352ab7553fb5676a358059b37943"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 74 24 28 48 8B 46 10 48 8B 4E 18 E8 9A CA F8 FF 84 C0 74 27 48 8B 54 }
		$a2 = { F2 74 28 48 89 54 24 18 48 89 D9 48 89 D3 E8 55 40 FF FF 84 C0 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Generic_F0C79978 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Generic (Windows.Trojan.Generic)"
		author = "Elastic Security"
		id = "f0c79978-2df9-4ae2-bc5d-b5366acff41b"
		date = "2023-07-27"
		modified = "2023-09-20"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Generic.yar#L219-L238"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "8f800b35bfbc8474f64b76199b846fe56b24a3ffd8c7529b92ff98a450d3bd38"
		logic_hash = "b16971ed0947660dda8d79c11531a9498a80e00f2dbc2c0eb63895b7f5c5f980"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "94b2a5784ae843b831f9ce34e986b2687ded5c754edf44ff20490b851e0261fc"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "\\IronPython."
		$a2 = "\\helpers\\execassembly_x64"

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Generic_40899C85 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Generic (Windows.Trojan.Generic)"
		author = "Elastic Security"
		id = "40899c85-bb49-412c-8081-3a1359957c52"
		date = "2023-12-15"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Generic.yar#L240-L260"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "88eb4f2e7085947bfbd03c69573fdca0de4a74bab844f09ecfcf88e358af20cc"
		logic_hash = "317034add0343baa26548712de8b2acc04946385fbee048cea0bd8d7ae642b36"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "d02a17a3b9efc2fd991320a5db7ab2384f573002157cddcd12becf137e893bd8"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "_sqlDataTypeSize"
		$a2 = "ChromeGetName"
		$a3 = "get_os_crypt"

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Generic_9997489C : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Generic (Windows.Trojan.Generic)"
		author = "Elastic Security"
		id = "9997489c-4e22-4df1-90cb-dd098ca26505"
		date = "2024-01-31"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Generic.yar#L262-L290"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "857bbf64ced06f76eb50afbfbb699c62e11625196213c2e5267b828cca911b74"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "4c872be4e5eaf46c92e6f7d62ed0801992c36fee04ada1a1a3039890e2893d8c"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$ldrload_dll = { 43 6A 45 9E }
		$loadlibraryw = { F1 2F 07 B7 }
		$ntallocatevirtualmemory = { EC B8 83 F7 }
		$ntcreatethreadex = { B0 CF 18 AF }
		$ntqueryinformationprocess = { C2 5D DC 8C }
		$ntprotectvirtualmemory = { 88 28 E9 50 }
		$ntreadvirtualmemory = { 03 81 28 A3 }
		$ntwritevirtualmemory = { 92 01 17 C3 }
		$rtladdvectoredexceptionhandler = { 89 6C F0 2D }
		$rtlallocateheap = { 5A 4C E9 3B }
		$rtlqueueworkitem = { 8E 02 92 AE }
		$virtualprotect = { 0D 50 57 E8 }

	condition:
		4 of them
}
rule ELASTIC_Windows_Trojan_Generic_2993E5A5 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Generic (Windows.Trojan.Generic)"
		author = "Elastic Security"
		id = "2993e5a5-26b2-4cfd-8130-4779abcfecb2"
		date = "2024-03-18"
		modified = "2024-03-18"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Generic.yar#L292-L310"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9f9b926cef69e879462d9fa914dda8c60a01f3d409b55afb68c3fb94bf1a339b"
		logic_hash = "37a10597d1afeb9411f6c652537186628291cbe6af680abe12bb96591add7e78"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "709015984e3c9abaf141b76bf574921466493475182ca30a56dbc3671030b632"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 0C 8B 45 F0 89 45 C8 8B 45 C8 8B 40 3C 8B 4D F0 8D 44 01 04 89 }

	condition:
		1 of them
}
rule ELASTIC_Windows_Trojan_Generic_0E135D58 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Generic (Windows.Trojan.Generic)"
		author = "Elastic Security"
		id = "0e135d58-efd9-4d5e-95d8-ddd597f8e6a8"
		date = "2024-03-19"
		modified = "2024-03-19"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Generic.yar#L312-L330"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a91c1d3965f11509d1c1125210166b824a79650f29ea203983fffb5f8900858c"
		logic_hash = "bc10218b1d761f72836bb5f9bb41d3f0fe13c4baa1109025269f938ec642aec4"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e1a9e0c4e5531ae4dd2962285789c3bb8bb2621aa20437384fc3abcc349718c6"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 55 8B EC 8B 45 14 56 57 8B 7D 08 33 F6 89 47 0C 39 75 10 76 15 8B }

	condition:
		1 of them
}
rule ELASTIC_Windows_Trojan_Bloodalchemy_3793364E : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bloodalchemy (Windows.Trojan.BloodAlchemy)"
		author = "Elastic Security"
		id = "3793364e-a73c-4cf0-855c-fdcdb2b88386"
		date = "2023-09-25"
		modified = "2023-09-25"
		reference = "https://www.elastic.co/security-labs/disclosing-the-bloodalchemy-backdoor"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_BloodAlchemy.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "c9f03767b92bb2c44f6b386e1f0a521f1a7a063cf73799844cc3423d4a7de7be"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b4620f360093284ae6f2296b4239227099f58f8f0cfe9f70298c84d6cbe7fa29"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 51 83 65 FC 00 53 56 57 BF 00 20 00 00 57 6A 40 FF 15 }
		$a2 = { 55 8B EC 81 EC 80 00 00 00 53 56 57 33 FF 8D 45 80 6A 64 57 50 89 7D E4 89 7D EC 89 7D F0 89 7D }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Bloodalchemy_E510798D : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bloodalchemy (Windows.Trojan.BloodAlchemy)"
		author = "Elastic Security"
		id = "e510798d-a938-47ba-92e3-0c1bcd3ce9a9"
		date = "2023-09-25"
		modified = "2023-09-25"
		reference = "https://www.elastic.co/security-labs/disclosing-the-bloodalchemy-backdoor"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_BloodAlchemy.yar#L22-L41"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "7919bb5f19745a1620e6be91622c40083cbd2ddb02905215736a2ed11e9af5c4"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "151519156e4c6b5395c03f70c77601681f17f86a08db96a622b9489a3df682d6"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 83 EC 54 53 8B 5D 08 56 57 33 FF 89 55 F4 89 4D F0 BE 00 00 00 02 89 7D F8 89 7D FC 85 DB }
		$a2 = { 55 8B EC 83 EC 0C 56 57 33 C0 8D 7D F4 AB 8D 4D F4 AB AB E8 42 10 00 00 8B 7D F4 33 F6 85 FF 74 03 8B 77 08 }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Bloodalchemy_63084Eea : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bloodalchemy (Windows.Trojan.BloodAlchemy)"
		author = "Elastic Security"
		id = "63084eea-358b-4fb0-9668-3f40f0aae9e7"
		date = "2023-09-25"
		modified = "2023-09-25"
		reference = "https://www.elastic.co/security-labs/disclosing-the-bloodalchemy-backdoor"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_BloodAlchemy.yar#L43-L61"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "3fe64502992281511e942b8f4541d61b33e900dbe23ea9f976c7eb9522ce4cbd"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "3f6ef0425b846b2126263c590d984bc618ad61de91a9141160c2b804c585ff6d"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 55 8B EC 83 EC 38 53 56 57 8B 75 08 8D 7D F0 33 C0 33 DB AB 89 5D C8 89 5D D0 89 5D D4 AB 89 5D }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Bloodalchemy_C2D80609 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bloodalchemy (Windows.Trojan.BloodAlchemy)"
		author = "Elastic Security"
		id = "c2d80609-9a66-4fbb-b594-17d16372cb14"
		date = "2023-09-25"
		modified = "2023-09-25"
		reference = "https://www.elastic.co/security-labs/disclosing-the-bloodalchemy-backdoor"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_BloodAlchemy.yar#L63-L81"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "694a0f917f106fbdde4c8e5dd8f9cdce56e9423ce5a7c3a5bf30bf43308d42e9"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "8815e42ef85ae5a8915cd26b573cd7411c041778cdf4bc99efd45526e3699642"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 55 8B EC 83 EC 30 53 56 57 33 C0 8D 7D F0 AB 33 DB 68 02 80 00 00 6A 40 89 5D FC AB AB FF 15 28 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Bloodalchemy_De591C5A : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bloodalchemy (Windows.Trojan.BloodAlchemy)"
		author = "Elastic Security"
		id = "de591c5a-95a5-4a23-bc02-7bc487b6ca4b"
		date = "2023-09-25"
		modified = "2023-11-02"
		reference = "https://www.elastic.co/security-labs/disclosing-the-bloodalchemy-backdoor"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_BloodAlchemy.yar#L83-L106"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "fd5cfe2558a7c02a617003140cdcf477ec451ecea4adf2808bef8f93673c28f1"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "6765378490707c5965dc4abd04169d4a94b787be3fccf3b77f1eff5d507090a4"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$crypto_0 = { 32 C7 8A DF 88 04 39 8B C1 6A 05 59 F7 F1 8A C7 8D 4A 01 D2 E3 B1 07 2A CA D2 E8 8B 4D F8 0A D8 02 FB 41 }
		$crypto_1 = { 8A 1F 0F B6 C3 83 E0 7F D3 E0 99 09 55 ?? 0B F0 47 84 DB 79 ?? 83 C1 07 83 F9 3F }
		$crypto_2 = { E8 [4] 03 F0 33 D2 8B C6 89 75 ?? 25 FF FF FF 7F 6A 34 59 F7 F1 8B 45 ?? 66 8B 0C 55 [4] 66 89 0C 43 40 89 45 ?? 3B C7 }
		$crypto_3 = { 61 00 62 00 63 00 64 00 65 00 66 00 67 00 68 00 69 00 6A 00 6B 00 6C 00 6D 00 6E 00 6F 00 70 00 71 00 72 00 73 00 74 00 }
		$com_tm_cid = { 9F 36 87 0F E5 A4 FC 4C BD 3E 73 E6 15 45 72 DD }
		$com_tm_iid = { C0 C7 A4 AB 2F A9 4D 13 40 96 97 20 CC 3F D4 0F 85 }

	condition:
		any of ($crypto_*) and all of ($com_tm_*)
}
rule ELASTIC_Windows_Trojan_Bazar_711D59F6 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bazar (Windows.Trojan.Bazar)"
		author = "Elastic Security"
		id = "711d59f6-6e8a-485d-b362-4c1bf1bda66e"
		date = "2021-06-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Bazar.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f29253139dab900b763ef436931213387dc92e860b9d3abb7dcd46040ac28a0e"
		logic_hash = "3bde62b468c44bdc18878fd369a7f0cf06f7be64149587a11524f725fa875f69"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a9e78b4e39f4acaba86c2595db67fcdcd40d1af611d41a023bd5d8ca9804efa4"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 0F 94 C3 41 0F 95 C0 83 FA 0A 0F 9C C1 83 FA 09 0F 9F C2 31 C0 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Bazar_9Dddea36 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bazar (Windows.Trojan.Bazar)"
		author = "Elastic Security"
		id = "9dddea36-1345-434b-8ce6-54d2eab39616"
		date = "2021-06-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Bazar.yar#L21-L39"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "63df43daa61f9a0fbea2e5409b8f0063f7af3363b6bc8d6984ce7e90c264727d"
		logic_hash = "cf88e2e896fce742ad3325d53523167d6eb42188309ed4e66f73601bbb85574e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e322e36006cc017d5d5d9887c89b180c5070dbe5a9efd9fb7ae15cda5b726d6c"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { C4 10 5B 5F 5E C3 41 56 56 57 55 53 48 83 EC 18 48 89 C8 48 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Bazar_3A2Cc53B : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bazar (Windows.Trojan.Bazar)"
		author = "Elastic Security"
		id = "3a2cc53b-4f73-41f9-aabd-08b8755ba44c"
		date = "2021-06-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Bazar.yar#L41-L59"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b057eb94e711995fd5fd6c57aa38a243575521b11b98734359658a7a9829b417"
		logic_hash = "8cde37be646dbcf7e7f5e3f28f0fe8c95480861c62fa2ee8cdd990859313756c"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f146d4fff29011acf595f2cba10ed7c3ce6ba07fbda0864d746f8e6355f91add"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 48 63 41 3C 45 33 ED 44 8B FA 48 8B F9 8B 9C 08 88 00 00 00 44 8B A4 08 8C 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Bazar_De8D625A : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bazar (Windows.Trojan.Bazar)"
		author = "Elastic Security"
		id = "de8d625a-8f85-47b7-bcad-e3cc012e4654"
		date = "2022-01-14"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Bazar.yar#L61-L79"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1ad9ac4785b82c8bfa355c7343b9afc7b1f163471c41671ea2f9152a1b550f0c"
		logic_hash = "5fd7bb4ac818ec1b4bfcb7d236868a31b2f726182407c07c7f06c1d7e9c15d02"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "17b2de5803589634fd7fb4643730fbebfa037c4d0b66be838a1c78af22da0228"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 48 89 5C 24 08 48 89 74 24 10 57 48 83 EC 20 49 8B F0 48 8B FA 48 8B D9 48 85 D2 74 61 4D 85 C0 74 5C 48 39 11 75 06 4C 39 41 08 74 2B 48 8B 49 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Xpertrat_Ce03C41D : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Xpertrat (Windows.Trojan.Xpertrat)"
		author = "Elastic Security"
		id = "ce03c41d-d5c3-43f5-b3ca-f244f177d710"
		date = "2021-08-06"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Xpertrat.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "d7f2fddb43eb63f9246f0a4535dfcca6da2817592455d7eceaacde666cf1aaae"
		logic_hash = "f6ff0a11f261bc75c9d0015131f177d39bb9e8e30346a75209ba8fa808ac4fcb"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "8aa4336ba6909c820f1164c78453629959e28cb619fda45dbe46291f9fbcbec4"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "[XpertRAT-Mutex]" wide fullword
		$a2 = "XPERTPLUGIN" wide fullword
		$a3 = "keylog.tmp" wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Hacktool_Sharplaps_381C3F40 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Sharplaps (Windows.Hacktool.SharpLAPS)"
		author = "Elastic Security"
		id = "381c3f40-b6c6-4e50-be28-3d34ba07b644"
		date = "2022-12-22"
		modified = "2022-12-22"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_SharpLAPS.yar#L1-L26"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ef0d508b3051fe6f99ba55202a17237f29fdbc0085e3f5c99b1aef52c8ebe425"
		logic_hash = "d94f9e4200a63283346919c121873130ad90e4ad5979c017cb71dc0cc910a64a"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "556b9ba9c0a2f08ff0b27e38e273f5817011de335436feb2a30cac74285d7e4f"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$guid = "1e0986b4-4bf3-4cea-a885-347b6d232d46" ascii wide nocase
		$str_name = "SharpLAPS.exe" ascii wide
		$str0 = "Using the current session" ascii wide
		$str1 = "Extracting LAPS password" ascii wide
		$str2 = "(&(objectCategory=computer)(ms-MCS-AdmPwd=*)(sAMAccountName=" ascii wide
		$str4 = "Machine" ascii wide
		$str5 = "sAMAccountName" ascii wide
		$str6 = "ms-Mcs-AdmPwd" ascii wide

	condition:
		$guid or 6 of ($str*)
}
rule ELASTIC_Windows_Trojan_Masslogger_511B001E : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Masslogger (Windows.Trojan.MassLogger)"
		author = "Elastic Security"
		id = "511b001e-dc67-4e45-9096-0b01101ca0ab"
		date = "2022-03-02"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_MassLogger.yar#L1-L24"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "177875c756a494872c516000beb6011cec22bd9a73e58ba6b2371dba2ab8c337"
		logic_hash = "5abac5e32e55467710842e19c25cab5c7f1cdb0f8a68fb6808d54467c69ebdf6"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "14ec9c32af7c1dd4a1f73e37ef9e042c18d9e0179b0e5732752767f93be6d4e2"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "ExecutionPolicy Bypass -WindowStyle Hidden -Command netsh advfirewall firewall add rule name='allow RemoteDesktop' dir=in protoc" wide
		$a2 = "https://raw.githubusercontent.com/lisence-system/assemply/main/VMprotectEncrypt.jpg" wide fullword
		$a3 = "ECHO $SMTPServer  = smtp.gmail.com >> %PSScript%" wide fullword
		$a4 = "Injecting Default Template...." wide fullword
		$a5 = "GetVncLoginMethodAsync" ascii fullword
		$a6 = "/c start computerdefaults.exe" wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Vulndriver_Windivert_25991186 : FILE MEMORY {
    meta:
		description = "Detects Windows Vulndriver Windivert (Windows.VulnDriver.WinDivert)"
		author = "Elastic Security"
		id = "25991186-7a44-446c-9e97-e91bb9adfd77"
		date = "2024-06-20"
		modified = "2024-07-02"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_VulnDriver_WinDivert.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "8da085332782708d8767bcace5327a6ec7283c17cfb85e40b03cd2323a90ddc2"
		logic_hash = "a67679bb2f23d1f6691c9ad23da1fd4c2402701ba1929c7abf078d7d95011a08"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "43c7f0dfe43c64d644fcb0171433a8af0f7b4c38f7601d42923762c3d882ac31"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$original_file_name = { 4F 00 72 00 69 00 67 00 69 00 6E 00 61 00 6C 00 46 00 69 00 6C 00 65 00 6E 00 61 00 6D 00 65 00 00 00 57 00 69 00 6E 00 44 00 69 00 76 00 65 00 72 00 74 00 2E 00 73 00 79 00 73 00 00 00 }

	condition:
		int16 ( uint32(0x3C)+0x5c)==0x0001 and int16 ( uint32(0x3C)+0x18)==0x020b and $original_file_name
}
rule ELASTIC_Windows_Trojan_Raccoon_Af6Decc6 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Raccoon (Windows.Trojan.Raccoon)"
		author = "Elastic Security"
		id = "af6decc6-f917-4a80-b96d-1e69b8f8ebe0"
		date = "2021-06-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Raccoon.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "fe09bef10b21f085e9ca411e24e0602392ab5044b7268eaa95fb88790f1a124d"
		logic_hash = "50ec446e8fd51129c7333c943dfe62db099fe1379530441f6b102fcbe3bc0dbd"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f9314a583040e4238aab7712ac16d7638a3b7c9194cbcf2ea9b4516c228c546b"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "A:\\_Work\\rc-build-v1-exe\\json.hpp" wide fullword
		$a2 = "\\stealler\\json.hpp" wide fullword

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Raccoon_58091F64 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Raccoon (Windows.Trojan.Raccoon)"
		author = "Elastic Security"
		id = "58091f64-2118-47f8-bcb2-407a3c62fa33"
		date = "2021-06-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Raccoon.yar#L22-L40"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "fe09bef10b21f085e9ca411e24e0602392ab5044b7268eaa95fb88790f1a124d"
		logic_hash = "8a7388e9c3dd0dd1a79215dbabcd964a0afa883490611afb6bb500635fbfff9a"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ea819b46ec08ba6b33aa19dcd6b5ad27d107a8e37f3f9eb9ff751fe8e1612f88"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 74 FF FF FF 10 8D 4D AC 53 6A 01 8D 85 60 FF FF FF 0F 43 85 60 FF }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Raccoon_Deb6325C : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Raccoon (Windows.Trojan.Raccoon)"
		author = "Elastic Security"
		id = "deb6325c-5556-44ce-a184-6369105485d5"
		date = "2022-06-28"
		modified = "2022-07-18"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Raccoon.yar#L42-L63"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f7b1aaae018d5287444990606fc43a0f2deb4ac0c7b2712cc28331781d43ae27"
		logic_hash = "94f70c60ed4fab021e013cf6a632321e0e1bdeef25a48a598d9e7388e7e445ca"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "17c34b5b9a0211255a93f9662857361680e72a45135d6ea9b5af8d77b54583b9"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "\\ffcookies.txt" wide fullword
		$a2 = "wallet.dat" wide fullword
		$a3 = "0Network\\Cookies" wide fullword
		$a4 = "Wn0nlDEXjIzjLlkEHYxNvTAXHXRteWg0ieGKVyD52CvONbW7G91RvQDwSZi/N2ISm4xEWRKYJwjnYUGS9OZmj/TAie8jG07EXEcO8D7h2m2lGzWnFG31R1rsxG1+G8E="

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Blackmatter_B548D151 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Blackmatter (Windows.Ransomware.Blackmatter)"
		author = "Elastic Security"
		id = "b548d151-5dde-459b-9d4a-b4a48c1b5545"
		date = "2021-08-03"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Blackmatter.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "072158f5588440e6c94cb419ae06a27cf584afe3b0cb09c28eff0b4662c15486"
		logic_hash = "cf76a311de9d292a2ea09b3937b8eb7fd761b7c33a464a31acf6b9a5bf121959"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "351658f8fe3f9c956634e3cf7a03b272c55359f069c5200e948d817c6b554c87"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 93 F0 DA 07 E7 F0 DA 07 E0 5B 99 65 47 38 96 6C 75 91 65 46 5A D0 B0 25 DA 90 42 CE F1 73 10 B1 14 BD 3C EC FD 7C AF 9B 8D 86 89 A5 FF C0 3F 78 57 8E E2 AD 2E 3A 2F 74 79 B1 FE 27 69 6B 9F 97 CE C8 67 88 1A 0B 01 F1 B7 76 35 18 E8 FF E1 D7 66 8C 41 03 EB F8 64 E5 7E F1 06 73 AB BF 6B 1D 6A B9 B6 BA 41 A2 91 49 5E 85 51 A0 83 23 46 D6 E0 E5 0F C2 53 89 2A 35 94 AF FC 87 A0 D8 08 E7 B8 DB 08 E7 78 22 E5 7E AE BB EF 16 87 08 3C 47 F0 49 1E 0D 2D 9A 1B 55 54 05 14 69 A3 1B 9C 7A 97 7B CF 85 2B 09 F9 DC 2C EB A6 55 F1 A0 07 B4 AA 80 EA ED 26 87 C0 }

	condition:
		any of them
}
rule ELASTIC_Windows_Ransomware_Blackmatter_8394F6D5 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Blackmatter (Windows.Ransomware.Blackmatter)"
		author = "Elastic Security"
		id = "8394f6d5-4761-4df6-974d-eaa0a25353da"
		date = "2021-08-03"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Blackmatter.yar#L21-L39"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "072158f5588440e6c94cb419ae06a27cf584afe3b0cb09c28eff0b4662c15486"
		logic_hash = "50a9b65ca6dde4fc32d2d57e72042f4380dd6c263ec5c33ce7c158151b91a5ae"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "3825f59ffe9b2adc1f9dd175f4d57c9aa3dd6ff176616ecbe7c673b5b4d414f8"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { FF E1 D7 66 8C 41 03 EB F8 64 E5 7E F1 06 73 AB BF 6B 1D 6A B9 B6 BA 41 A2 91 49 5E 85 51 A0 83 23 }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_STRRAT_A3E48Cd2 : MEMORY {
    meta:
		description = "Detects Windows Trojan Strrat (Windows.Trojan.STRRAT)"
		author = "Elastic Security"
		id = "a3e48cd2-e65f-40db-ab55-8015ad871dd6"
		date = "2024-03-13"
		modified = "2024-03-21"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_STRRAT.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "97e67ac77d80d26af4897acff2a3f6075e0efe7997a67d8194e799006ed5efc9"
		logic_hash = "32f79695829f703bf9996d212aeb563791aed28e1bbb9f700cb45325fd02db77"
		score = 75
		quality = 75
		tags = "MEMORY"
		fingerprint = "efda9a8bd5f9e227a6696de1b4ea7eb7343b08563cfcbe73fdd75164593bd111"
		severity = 100
		arch_context = "x86"
		scan_context = "memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$str1 = "strigoi/server/ping.php?lid="
		$str2 = "/strigoi/server/?hwid="

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Rook_Ee21Fa67 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Rook (Windows.Ransomware.Rook)"
		author = "Elastic Security"
		id = "ee21fa67-bd82-40fb-9c6d-bab5abfe14b3"
		date = "2022-01-14"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Rook.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c2d46d256b8f9490c9599eea11ecef19fde7d4fdd2dea93604cee3cea8e172ac"
		logic_hash = "6fe19cfc572a3dceba5e26615d111a3c0fa1036e275a5640a5c5a8f8cdaf6dc1"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "8ef731590e73f79a13d04db39e58b03d0a29fd8e46a0584b0fcaf57ac0efe473"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 01 75 09 8B C3 FF C3 48 89 74 C5 F0 48 FF C7 48 83 FF 1A 7C DB }

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Maui_266Dea64 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Maui (Windows.Ransomware.Maui)"
		author = "Elastic Security"
		id = "266dea64-2ed2-4bfc-977b-5ddb68ab05ac"
		date = "2022-07-08"
		modified = "2022-07-18"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Maui.yar#L1-L29"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "5b7ecf7e9d0715f1122baf4ce745c5fcd769dee48150616753fec4d6da16e99e"
		logic_hash = "2094920615b6297adb222003d25a8d0934a89f24869e7e70644a4956021c7afc"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "6f6451b7a972924b2efe339b8793c30409123df37d3d64802037a5af8cb4b5f3"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Please append it by <Godhead> using -maui option." wide fullword
		$a2 = "Please overwrite it by <Godhead> using -maui option." wide fullword
		$a3 = "maui.log" wide fullword
		$a4 = "maui.key" wide fullword
		$a5 = "maui.evd" wide fullword
		$a6 = "Encrypt[%s]: %s" wide fullword
		$a7 = "PROCESS_GOINGON[%d%% / %d%%]: %s" wide fullword
		$a8 = "PROCESS_REPLACECONFIRM: %s" wide fullword
		$seq_encrypt_priv_key = { 55 8B 6C 24 ?? 57 8B F9 85 DB 74 ?? 85 FF 74 ?? 85 ED 74 ?? 56 8D 87 ?? ?? ?? ?? 50 6A ?? E8 ?? ?? ?? ?? 8B 4D ?? 8B 51 ?? 6A ?? 52 8B F0 56 53 57 E8 ?? ?? ?? ?? 8B F8 83 C4 ?? 85 FF 7F ?? E8 ?? ?? ?? ?? 56 E8 ?? ?? ?? ?? 83 C4 ?? 5E 5F 83 C8 ?? 5D C3 }
		$seq_get_private_key = { 57 8B F8 85 FF 75 ?? 5F C3 56 E8 ?? ?? ?? ?? 50 E8 ?? ?? ?? ?? 83 C4 ?? 80 7F ?? ?? 8B F0 74 ?? 8B 07 50 56 E8 ?? ?? ?? ?? EB ?? 8B 0F 51 56 E8 ?? ?? ?? ?? 83 C4 ?? 85 F6 75 ?? 5E 33 C0 5F C3 }
		$seq_get_pub_key = { B9 F4 FF FF FF 2B 4C 24 ?? 6A 02 51 53 E8 ?? ?? ?? ?? 8B 54 24 ?? 8B 07 53 6A ?? 52 50 E8 ?? ?? ?? ?? 53 E8 ?? ?? ?? ?? 32 DB 8B C7 E8 ?? ?? ?? ?? 89 46 28 8B 0F 51 E8 ?? ?? ?? ?? 57 E8 ?? ?? ?? ?? 8B 8C 24 ?? ?? ?? ?? 83 C4 ?? 5F 8B C6 5E 5B 33 CC E8 ?? ?? ?? ?? 81 C4 ?? ?? ?? ?? C3 }

	condition:
		5 of ($a*) or 2 of ($seq*)
}
rule ELASTIC_Windows_Hacktool_Sharpdump_7C17D8B1 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Sharpdump (Windows.Hacktool.SharpDump)"
		author = "Elastic Security"
		id = "7c17d8b1-35cf-440e-8f4e-44abdc2054bb"
		date = "2022-10-20"
		modified = "2022-11-24"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_SharpDump.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "14c3ea569a1bd9ac3aced4f8dd58314532dbf974bfa359979e6c7b6a4bbf41ca"
		logic_hash = "10ca29b097d9f1cef27349751e8f1e584ead1056a636224a80f00823ca878c13"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "cf1e23fc0a317959fceadae8984240b174dac22a1bcabccf43c34f0186a3ac23"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$guid = "9c9bba3-a0ea-431c-866c-77004802d" ascii wide nocase
		$print_str0 = "Please use \"SharpDump.exe [pid]\" format" ascii wide
		$print_str1 = "[*] Use \"sekurlsa::minidump debug.out\" \"sekurlsa::logonPasswords full\" on the same OS/arch" ascii wide
		$print_str2 = "[+] Dumping completed. Rename file to \"debug{0}.gz\" to decompress" ascii wide
		$print_str3 = "[X] Not in high integrity, unable to MiniDump!" ascii wide

	condition:
		$guid or all of ($print_str*)
}
rule ELASTIC_Windows_Rootkit_R77_5Bab748B : FILE MEMORY {
    meta:
		description = "Detects Windows Rootkit R77 (Windows.Rootkit.R77)"
		author = "Elastic Security"
		id = "5bab748b-8576-4967-9b50-a3778db1dd71"
		date = "2022-03-04"
		modified = "2022-04-12"
		reference = "https://www.elastic.co/security-labs/elastic-security-labs-steps-through-the-r77-rootkit"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Rootkit_R77.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "cfc76dddc74996bfbca6d9076d2f6627912ea196fdbdfb829819656d4d316c0c"
		logic_hash = "ebf851ef41fde8e3118acc742cd2b38651f662a00f11dd6f7c65cf56019c43d5"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "2523d25c46bbb9621f0eceeda10aff31e236ed0bf03886de78524bdd2d39cfaa"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 01 04 10 41 8B 4A 04 49 FF C1 48 8D 41 F8 48 D1 E8 4C 3B C8 }

	condition:
		all of them
}
rule ELASTIC_Windows_Rootkit_R77_Eb366Abc : FILE MEMORY {
    meta:
		description = "Detects Windows Rootkit R77 (Windows.Rootkit.R77)"
		author = "Elastic Security"
		id = "eb366abc-d256-4dd2-ad97-898fdf905b8a"
		date = "2023-05-09"
		modified = "2023-06-13"
		reference = "https://www.elastic.co/security-labs/elastic-security-labs-steps-through-the-r77-rootkit"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Rootkit_R77.yar#L22-L42"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "21e7f69986987fc75bce67c4deda42bd7605365bac83cf2cecb25061b2d86d4f"
		logic_hash = "3d6f1c60bf749c53f4a4fcfd6490d309e4450d5f7e64de4665c3d80af1bce44f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "beaa87877382a0cba0fcad6397b22bef2ff6dad8e3454ae517b529fbc76ff97a"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 8C 20 88 00 00 00 42 8B 44 21 10 42 8B 4C 21 1C 48 2B D0 49 }
		$a2 = { 53 00 4F 00 46 00 54 00 57 00 41 00 52 00 45 00 5C 00 24 00 37 00 37 00 63 00 6F 00 6E 00 66 00 69 00 67 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Rootkit_R77_99050E7D : FILE MEMORY {
    meta:
		description = "Detects Windows Rootkit R77 (Windows.Rootkit.R77)"
		author = "Elastic Security"
		id = "99050e7d-b9b2-411f-b315-0ac7f556314c"
		date = "2023-05-09"
		modified = "2023-06-13"
		reference = "https://www.elastic.co/security-labs/elastic-security-labs-steps-through-the-r77-rootkit"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Rootkit_R77.yar#L44-L64"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "3dc94c88caa3169e096715eb6c2e6de1b011120117c0a51d12f572b4ba999ea6"
		logic_hash = "0fedf4698cc652076090b1fe256d05d2c0bc3ad2ab7ed5faa270c5c7fe0efca1"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "1fa724556616eed4adfe022602795ffc61fe64dd910b5b83fd7610933b79d71f"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 5C 00 5C 00 2E 00 5C 00 70 00 69 00 70 00 65 00 5C 00 24 00 37 00 37 00 63 00 68 00 69 00 6C 00 64 00 70 00 72 00 6F 00 63 00 36 00 34 00 }
		$a2 = { 5C 00 5C 00 2E 00 5C 00 70 00 69 00 70 00 65 00 5C 00 24 00 37 00 37 00 63 00 68 00 69 00 6C 00 64 00 70 00 72 00 6F 00 63 00 33 00 32 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Rootkit_R77_Be403E3C : FILE MEMORY {
    meta:
		description = "Detects Windows Rootkit R77 (Windows.Rootkit.R77)"
		author = "Elastic Security"
		id = "be403e3c-a70d-4126-b464-83060138c79b"
		date = "2023-05-18"
		modified = "2023-06-13"
		reference = "https://www.elastic.co/security-labs/elastic-security-labs-steps-through-the-r77-rootkit"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Rootkit_R77.yar#L66-L85"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "91c6e2621121a6871af091c52fafe41220ae12d6e47e52fd13a7b9edd8e31796"
		logic_hash = "efbf924c7a299f2543c639b6262007eb3bdbf6ff5e33dab7d6102814b9477811"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "46fd9d53771a0c6d14b364589a7cfa291a1c0405d74a97beac75db78faea7e0b"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 33 C9 48 89 8C 24 C0 00 00 00 4C 8B CB 48 89 8C 24 B8 00 00 00 45 33 C0 48 89 8C 24 B0 00 00 00 48 89 8C 24 A8 00 00 00 89 8C 24 A0 00 00 00 }

	condition:
		$a
}
rule ELASTIC_Windows_Rootkit_R77_Ee853C9F : FILE MEMORY {
    meta:
		description = "Detects Windows Rootkit R77 (Windows.Rootkit.R77)"
		author = "Elastic Security"
		id = "ee853c9f-97ec-45b2-8c67-7b86331f4946"
		date = "2023-05-18"
		modified = "2023-06-13"
		reference = "https://www.elastic.co/security-labs/elastic-security-labs-steps-through-the-r77-rootkit"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Rootkit_R77.yar#L87-L112"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "916c805b0d512dd7bbd88f46632d66d9613de61691b4bd368e4b7cb1f0ac7f60"
		logic_hash = "94f080f310ecace76da32ba2b4edcc80dedfb339113823708167c1d842db8cf3"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a2bf137ff29044a1f80494aa4b51bd7aa49ae64808b9f1d4566750b9717b847d"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$r77_str0 = "$77stager" wide fullword
		$r77_str1 = "$77svc32" wide fullword
		$r77_str2 = "$77svc64" wide fullword
		$r77_str3 = "\\\\.\\pipe\\$77childproc64" wide fullword
		$r77_str4 = "SOFTWARE\\$77config"
		$obfuscate_ps = { 0F B7 04 4B 33 D2 C7 45 FC 34 00 00 00 F7 75 FC 66 8B 44 55 90 66 89 04 4B 41 3B CE }
		$amsi_patch_ps = "[Runtime.InteropServices.Marshal]::Copy([Byte[]](0xb8,0x57,0,7,0x80,0xc3)" wide fullword

	condition:
		($obfuscate_ps and $amsi_patch_ps) or ( all of ($r77_str*))
}
rule ELASTIC_Windows_Rootkit_R77_D0367E28 : FILE MEMORY {
    meta:
		description = "Detects Windows Rootkit R77 (Windows.Rootkit.R77)"
		author = "Elastic Security"
		id = "d0367e28-2c37-45c8-8a74-7ea881f2d471"
		date = "2023-05-18"
		modified = "2023-06-13"
		reference = "https://www.elastic.co/security-labs/elastic-security-labs-steps-through-the-r77-rootkit"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Rootkit_R77.yar#L114-L141"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "96849108e13172d14591169f8fdcbf8a8aa6be05b7b6ef396d65529eacc02d89"
		logic_hash = "588b18c54c344ca267b86143df20c7dcaab081e0ef6acae0bd0dae61593eb521"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "c3f6fe38fcc2ec40ae7c033e37f7a2830f5d53f0e796281bd484bdb65502cd0e"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$str0 = "service_names" wide fullword
		$str1 = "process_names" wide fullword
		$str2 = "tcp_local" wide fullword
		$str3 = "tcp_remote" wide fullword
		$str4 = "startup" wide fullword
		$str5 = "ReflectiveDllMain" ascii fullword
		$str6 = ".detourd" ascii fullword
		$binary0 = { 48 8B 10 48 8B 0B E8 ?? ?? ?? ?? 85 C0 74 ?? 48 8B 57 08 48 8B 4B 08 E8 ?? ?? ?? ?? 85 C0 74 ?? 48 8B 57 10 48 8B 4B 10 E8 ?? ?? ?? ?? 85 C0 74 ?? 48 8B 57 18 48 8B 4B 18 E8 ?? ?? ?? ?? 85 C0 74 ?? 48 8B 57 20 48 8B 4B 20 E8 ?? ?? ?? ?? 85 C0 74 ?? 48 8B 57 28 48 8B 4B 28 E8 ?? ?? ?? ?? 85 C0 }
		$binary1 = { 8B 56 04 8B 4F 04 E8 ?? ?? ?? ?? 85 C0 74 ?? 8B 56 08 8B 4F 08 E8 ?? ?? ?? ?? 85 C0 74 ?? 8B 56 0C 8B 4F 0C E8 ?? ?? ?? ?? 85 C0 74 ?? 8B 56 10 8B 4F 10 E8 ?? ?? ?? ?? 85 C0 74 ?? 8B 56 14 8B 4F 14 E8 ?? ?? ?? ?? 85 C0 74 ?? 8B 56 18 8B 4F 18 E8 ?? ?? ?? ?? 85 C0 74 ?? 8B 56 1C 8B 4F 1C }

	condition:
		( all of ($str*)) or $binary0 or $binary1
}
rule ELASTIC_Windows_Trojan_Diamondfox_18Bc11E3 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Diamondfox (Windows.Trojan.DiamondFox)"
		author = "Elastic Security"
		id = "18bc11e3-5872-40b0-a3b7-cef4b32fac15"
		date = "2022-03-02"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_DiamondFox.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a44c46d4b9cf1254aaabd1e689f84c4d2c3dd213597f827acabface03a1ae6d1"
		logic_hash = "c64e4b3349b33cfd0fec1fe41f91ad819bb6b6751e822d7ab8d14638ad27571d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "6f908d11220e218a7b59239ff3cc00c7e273fb46ec99ef7ae37e4aceb4de7831"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "\\wscript.vbs" wide fullword
		$a2 = "\\snapshot.jpg" wide fullword
		$a3 = "&soft=" wide fullword
		$a4 = "ping -n 4 127.0.0.1 > nul" wide fullword
		$a5 = "Select Name from Win32_Process Where Name = '" wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Amadey_7Abb059B : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Amadey (Windows.Trojan.Amadey)"
		author = "Elastic Security"
		id = "7abb059b-4001-4eec-8185-1e0497e15062"
		date = "2021-06-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Amadey.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "33e6b58ce9571ca7208d1c98610005acd439f3e37d2329dae8eb871a2c4c297e"
		logic_hash = "23b75d6df9e2a7f8e1efee46ecaf1fc84247312b19a8a1941ddbca1b2ce5e1db"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "686ae7cf62941d7db051fa8c45f0f7a27440fa0fdc5f0919c9667dfeca46ca1f"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 18 83 78 14 10 72 02 8B 00 6A 01 6A 00 6A 00 6A 00 6A 00 56 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Amadey_C4Df8D4A : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Amadey (Windows.Trojan.Amadey)"
		author = "Elastic Security"
		id = "c4df8d4a-01f4-466f-8225-7c7f462b29e7"
		date = "2021-06-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Amadey.yar#L21-L39"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9039d31d0bd88d0c15ee9074a84f8d14e13f5447439ba80dd759bf937ed20bf2"
		logic_hash = "7f96c4de585223033fb7e7906be6d6898651ecf30be51ed01abde18ef52c0e1e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "4623c591ea465e23f041db77dc68ddfd45034a8bde0f20fd5fbcec060851200c"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "D:\\Mktmp\\NL1\\Release\\NL1.pdb" fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Doubleback_D2246A35 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Doubleback (Windows.Trojan.DoubleBack)"
		author = "Elastic Security"
		id = "d2246a35-e582-4707-acd0-f04bb66df722"
		date = "2022-05-29"
		modified = "2022-07-18"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_DoubleBack.yar#L1-L31"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "03d2a0747d06458ccddf65ff5847a511a105e0ad4dcb5134082623af6f705012"
		logic_hash = "2241d2c6e5b5896fe6f3b02cb1786c39fa620ee503c4585bd75c8763b6d3c06a"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "949f8d30125fad133f4b897c945c6aa0eccda5456dc887bde4c0a5affece5195"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$s1 = "client.dll" ascii fullword
		$s2 = "=i.ext;" ascii fullword
		$s3 = "## dbg delay" ascii fullword
		$s4 = "ehost"
		$s5 = "msie"
		$s6 = "POST"
		$s7 = "%s(%04Xh:%u/%u)[%s %s]: %s" ascii fullword
		$x64_powershell_msi_check = { 81 3C 39 70 6F 77 65 74 ?? 81 3C 39 6D 73 69 65 41 }
		$x86_powershell_msi_check = { 81 3C 30 70 6F 77 65 74 ?? 81 3C 30 6D 73 69 65 6A 03 5A 0F }
		$x64_salted_hash_func = { 8B 7D ?? 4C 8D 45 ?? 81 C7 ?? ?? ?? ?? 48 8D 4D ?? BA 04 00 00 00 89 7D ?? }
		$x86_salted_hash_func = { 8B 75 ?? 8D 45 ?? 50 6A ?? 81 C6 ?? ?? ?? ?? 8D 4D ?? 5A 89 75 ?? }
		$x64_guid = { 48 83 EC ?? 45 33 C9 41 B8 DD CC BB AA 45 8D 51 ?? }
		$x86_guid = { 55 8B EC 83 EC ?? B8 DD CC BB AA 56 57 6A ?? 8D 75 ?? 5F }

	condition:
		5 of ($s*) or 2 of ($x64_*) or 2 of ($x86_*)
}
rule ELASTIC_Windows_Wiper_Caddywiper_484Bd98A : FILE MEMORY {
    meta:
		description = "Detects Windows Wiper Caddywiper (Windows.Wiper.CaddyWiper)"
		author = "Elastic Security"
		id = "484bd98a-543f-42de-a58c-fe9c7b5605a3"
		date = "2022-03-14"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Wiper_CaddyWiper.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a294620543334a721a2ae8eaaf9680a0786f4b9a216d75b55cfd28f39e9430ea"
		logic_hash = "f473673afc211b02328f4e9d88e709acd95bf4b1fa565f5aca972b92324bf589"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "de16515a72cd1f7b4d7ee46a4fafde07cf224c2b6df9037bcd20ab4d39181fa8"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { C6 45 AC 43 C6 45 AD 3A C6 45 AE 5C C6 45 AF 55 C6 45 B0 73 C6 45 B1 65 C6 45 B2 72 C6 45 B3 73 }
		$a2 = { C6 45 E0 44 C6 45 E1 3A C6 45 E2 5C }
		$a3 = { C6 45 9C 6E C6 45 9D 65 C6 45 9E 74 C6 45 9F 61 C6 45 A0 70 C6 45 A1 69 C6 45 A2 33 C6 45 A3 32 }
		$s1 = "DsRoleGetPrimaryDomainInformation"

	condition:
		all of them
}
rule ELASTIC_Windows_Hacktool_Ringq_B9715540 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Ringq (Windows.Hacktool.RingQ)"
		author = "Elastic Security"
		id = "b9715540-77ae-4723-a29e-d4d88d626982"
		date = "2024-06-28"
		modified = "2024-07-26"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_RingQ.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "450e01c32618cd4e4a327147896352ed1b34dca9fb28389dba450acf95f8b735"
		logic_hash = "80d693c43a7026d28121e035ae875689512fd46d7f06c3f469b83d6fe707f36b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f2a2d97b31cb648a6515dbf02a885a6afd434f38ed555c1e30296b7eb4550438"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Loading Dir main.txt ..." ascii fullword
		$a2 = "Loading LocalFile ..." ascii fullword
		$a3 = "No Find main,txt and StringTable ..." ascii fullword
		$a4 = "https://github.com/T4y1oR/RingQ"
		$a5 = "RingQ :)" ascii fullword
		$a6 = "1. Create.exe fscan.exe" ascii fullword
		$a7 = "C:/Users/username/Documents/file.txt" ascii fullword

	condition:
		2 of them
}
rule ELASTIC_Windows_Hacktool_Sharpwmi_A67D6Fe5 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Sharpwmi (Windows.Hacktool.SharpWMI)"
		author = "Elastic Security"
		id = "a67d6fe5-3ce5-4e63-979e-3fb799d9d173"
		date = "2022-10-20"
		modified = "2022-11-24"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_SharpWMI.yar#L1-L27"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "2134a5e1a5eece1336f831a7686c5ea3b6ca5aaa63ab7e7820be937da0678e15"
		logic_hash = "de8749951ece8d4798ade4661d531515e12edf8e8606ddc330000d847a66a26c"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "20719ea15d4dee90c95b474689752172a6b6fb941dced81803f9f726ddc26d29"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$guid = "6DD22880-DAC5-4B4D-9C91-8C35CC7B8180" ascii wide nocase
		$str0 = "powershell -w hidden -nop -c \"$e=([WmiClass]'{0}:{1}').Properties['{2}'].Value;[IO.File]::WriteAllBytes('{3}',[Byte[]][Int[]]($e-split','))\"" ascii wide
		$str1 = "powershell -w hidden -nop -c \"iex($env:{0})\"" ascii wide
		$str2 = "SELECT * FROM Win32_Process" ascii wide
		$str3 = "DOWNLOAD_URL" ascii wide
		$str4 = "TARGET_FILE" ascii wide
		$str5 = "SELECT Enabled,DisplayName,Action,Direction,InstanceID from MSFT_NetFirewallRule WHERE Enabled=1" ascii wide
		$print_str0 = "This may indicate called SharpWMI did not invoked WMI using elevated/impersonated token." ascii wide
		$print_str1 = "[+] Attempted to terminate remote process ({0}). Returned: {1}" ascii wide

	condition:
		$guid or ( all of ($str*) and 1 of ($print_str*))
}
rule ELASTIC_Windows_Trojan_Revcoderat_8E6D4182 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Revcoderat (Windows.Trojan.Revcoderat)"
		author = "Elastic Security"
		id = "8e6d4182-4ea8-4d4c-ad3a-d16b42e387f4"
		date = "2021-09-02"
		modified = "2022-01-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Revcoderat.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "77732e74850050bb6f935945e510d32a0499d820fa1197752df8bd01c66e8210"
		logic_hash = "35626d752b291e343350534aece35f1d875068c2c050d12312a60e67753c71e1"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "bc259d888e913dffb4272e2f871592238eb78922989d30ac4dc23cdeb988cc78"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "PLUGIN_PROCESS_REVERSE_PROXY: Plugin already exists, skipping download!" ascii fullword
		$a2 = "TARGET_HOST_UPDATE(): Sync successful!" ascii fullword
		$a3 = "WEBCAM_ACTIVATE: Plugin already exists, skipping download!" ascii fullword
		$a4 = "send_keylog_get" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Vidar_9007Feb2 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Vidar (Windows.Trojan.Vidar)"
		author = "Elastic Security"
		id = "9007feb2-6ad1-47b6-bae2-3379d114e4f1"
		date = "2021-06-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Vidar.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "34c0cb6eaf2171d3ab9934fe3f962e4e5f5e8528c325abfe464d3c02e5f939ec"
		logic_hash = "fcdef7397f17ee402155e526c6fa8b51f3ea96e203a095b0b4c36cb7d3cc83d1"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "8416b14346f833264e32c63253ea0b0fe28e5244302b2e1b266749c543980fe2"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { E8 53 FF D6 50 FF D7 8B 45 F0 8D 48 01 8A 10 40 3A D3 75 F9 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Vidar_114258D5 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Vidar (Windows.Trojan.Vidar)"
		author = "Elastic Security"
		id = "114258d5-f05e-46ac-914b-1a7f338ccf58"
		date = "2021-06-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Vidar.yar#L21-L44"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "34c0cb6eaf2171d3ab9934fe3f962e4e5f5e8528c325abfe464d3c02e5f939ec"
		logic_hash = "9ea3ea0533d14edd0332fa688497efd566a890d1507214fc8591a0a11433d060"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "9b4f7619e15398fcafc622af821907e4cf52964c55f6a447327738af26769934"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "BinanceChainWallet" fullword
		$a2 = "*wallet*.dat" fullword
		$a3 = "SOFTWARE\\monero-project\\monero-core" fullword
		$b1 = "CC\\%s_%s.txt" fullword
		$b2 = "History\\%s_%s.txt" fullword
		$b3 = "Autofill\\%s_%s.txt" fullword

	condition:
		1 of ($a*) and 1 of ($b*)
}
rule ELASTIC_Windows_Trojan_Vidar_32Fea8Da : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Vidar (Windows.Trojan.Vidar)"
		author = "Elastic Security"
		id = "32fea8da-b381-459c-8bf4-696388b8edcc"
		date = "2023-05-04"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Vidar.yar#L46-L66"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6f5c24fc5af2085233c96159402cec9128100c221cb6cb0d1c005ced7225e211"
		logic_hash = "1a18cdc3bd533c34eb05b239830ecec418dc76ee9f4fcfc48afc73b07d55b3cd"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "ebcced7b2924cc9cfe9ed5b5f84a8959e866a984f2b5b6e1ec5b1dd096960325"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 4F 4B 58 20 57 65 62 33 20 57 61 6C 6C 65 74 }
		$a2 = { 8B E5 5D C3 5E B8 03 00 00 00 5B 8B E5 5D C3 5E B8 08 00 00 }
		$a3 = { 83 79 04 00 8B DE 74 08 8B 19 85 DB 74 62 03 D8 8B 03 85 C0 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Vidar_C374Cd85 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Vidar (Windows.Trojan.Vidar)"
		author = "Elastic Security"
		id = "c374cd85-714b-47c5-8645-cc7918fa2ff1"
		date = "2024-01-31"
		modified = "2024-10-14"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Vidar.yar#L68-L86"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1c677585a8b724332849c411ffe2563b2b753fd6699c210f0720352f52a6ab72"
		logic_hash = "8e183f780400f3bf9840798d53b431a4bf28bc43e07d69a3d614217e02f5dd79"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "4936566b7f3f8250b068aa8e4a9b745c3e9ce2fa35164a94e77b31068d3d6ebf"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 EC 0C 53 8B 5E 74 39 9E 44 01 00 00 75 07 33 C0 E9 88 00 00 00 57 8B BE E0 00 00 00 85 FF 74 79 8B 8E E4 00 00 00 85 C9 74 6F 8B 86 44 01 00 00 8B D0 03 C7 8D 4C 01 F8 2B D3 89 4D }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Vidar_65D3D7E5 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Vidar (Windows.Trojan.Vidar)"
		author = "Elastic Security"
		id = "65d3d7e5-2a5f-4434-8578-6ccaa4528086"
		date = "2024-10-14"
		modified = "2024-10-24"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Vidar.yar#L88-L114"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "83d7c2b437a5cbb314c457d3b7737305dadb2bc02d6562a98a8a8994061fe929"
		logic_hash = "2b340f43faf563c7edbce6323d551208c4d9541d7153ea6c1c0d9a95b351e54b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "249ba1f0078792d3b4cb61b6c7e902b327305a1398a3c88f1720ad8e6c30fe57"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$str_1 = "avghooka.dll" wide fullword
		$str_2 = "api_log.dll" wide fullword
		$str_3 = "babyfox.dll" ascii fullword
		$str_4 = "vksaver.dll" ascii fullword
		$str_5 = "delays.tmp" wide fullword
		$str_6 = "\\Monero\\wallet.keys" ascii fullword
		$str_7 = "wallet_path" ascii fullword
		$str_8 = "Hong Lee" ascii fullword
		$str_9 = "milozs" ascii fullword

	condition:
		6 of them
}
rule ELASTIC_Windows_Trojan_Havoc_77F3D40E : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Havoc (Windows.Trojan.Havoc)"
		author = "Elastic Security"
		id = "77f3d40e-9365-4e76-a1a3-36d128e775a9"
		date = "2022-10-20"
		modified = "2022-11-24"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Havoc.yar#L1-L35"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "3427dac129b760a03f2c40590c01065c9bf2340d2dfa4a4a7cf4830a02e95879"
		logic_hash = "3d2733ed24d90e9e851ec36a08c497e9c90b47c3dcbb8755e3f6b6a6bd3a8b54"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "95d35d167df7f77f23b1afb1b7655cc47830c9986c54791b562c33db8f2773ae"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$core = { 48 ?? ?? 2C 06 00 00 00 ?? ?? 48 ?? ?? 5C 06 00 00 00 ?? ?? ?? ?? ?? ?? 48 8B ?? 5C 06 00 00 ?? F6 99 5A 2E E8 ?? ?? ?? ?? 48 8B ?? 48 ?? ?? 4C 02 00 00 48 8B ?? 5C 06 00 00 ?? 23 DB 07 03 E8 ?? ?? ?? ?? 48 8B ?? 48 ?? ?? 44 02 00 00 48 8B ?? 5C 06 00 00 ?? DA 81 B3 C0 E8 ?? ?? ?? ?? 48 8B ?? 48 ?? ?? 54 02 00 00 48 8B ?? 5C 06 00 00 ?? D7 71 BA 70 E8 ?? ?? ?? ?? 48 8B ?? 48 ?? ?? 64 02 00 00 48 8B ?? 5C 06 00 00 ?? 88 2B 49 8E E8 ?? ?? ?? ?? 48 8B ?? 48 ?? ?? 84 02 00 00 48 8B ?? 5C 06 00 00 ?? EF F0 A1 3A E8 ?? ?? ?? ?? }
		$commands_table = { 0B 00 00 00 ?? ?? ?? ?? ?? ?? ?? ?? 64 00 00 00 ?? ?? ?? ?? ?? ?? ?? ?? 15 00 00 00 ?? ?? ?? ?? ?? ?? ?? ?? 10 10 00 00 ?? ?? ?? ?? ?? ?? ?? ?? 0C 00 00 00 ?? ?? ?? ?? ?? ?? ?? ?? [0-12] 0F 00 00 00 ?? ?? ?? ?? ?? ?? ?? ?? 14 00 00 00 ?? ?? ?? ?? ?? ?? ?? ?? 01 20 00 00 ?? ?? ?? ?? ?? ?? ?? ?? 03 20 00 00 ?? ?? ?? ?? ?? ?? ?? ?? C4 09 00 00 ?? ?? ?? ?? ?? ?? ?? ?? CE 09 00 00 ?? ?? ?? ?? ?? ?? ?? ?? D8 09 00 00 ?? ?? ?? ?? ?? ?? ?? ?? 34 08 00 00 ?? ?? ?? ?? ?? ?? ?? ?? 16 00 00 00 ?? ?? ?? ?? ?? ?? ?? ?? 18 00 00 00 ?? ?? ?? ?? ?? ?? ?? ?? 1A 00 00 00 ?? ?? ?? ?? ?? ?? ?? ?? 28 00 00 00 ?? ?? ?? ?? ?? ?? ?? ?? 5C 00 00 00 ?? ?? ?? ?? ?? ?? ?? ?? }
		$hashes_0 = { F6 99 5A 2E }
		$hashes_1 = { DA 81 B3 C0 }
		$hashes_2 = { D7 71 BA 70 }
		$hashes_3 = { 88 2B 49 8E }
		$hashes_4 = { EF F0 A1 3A }
		$hashes_5 = { F5 39 34 7C }
		$hashes_6 = { 2A 92 12 D8 }
		$hashes_7 = { 8D F1 4F 84 }
		$hashes_8 = { 5B BC CE 73 }
		$hashes_9 = { 59 24 93 B8 }
		$hashes_10 = { 02 9E D0 C2 }
		$hashes_11 = { E5 36 26 AE }
		$hashes_12 = { 5C 3C B4 F3 }
		$hashes_13 = { 2F 87 D8 1C }
		$hashes_14 = { D7 53 22 AC }

	condition:
		$core or ($commands_table and all of ($hashes*))
}
rule ELASTIC_Windows_Trojan_Havoc_9C7Bb863 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Havoc (Windows.Trojan.Havoc)"
		author = "Elastic Security"
		id = "9c7bb863-b6c2-4d5f-ae50-0fd900f1d4eb"
		date = "2023-04-28"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Havoc.yar#L37-L56"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "261b92d9e8dcb9d0abf1627b791831ec89779f2b7973b1926c6ec9691288dd57"
		logic_hash = "c1245c38c54b0a72fb335680d9ea191390e4e2fe7e47a3ed776878c5e01a3e16"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "cda55a9e65badb984e71778b081929db2bdef223792b78bba32b2259757f1348"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 56 48 89 E6 48 83 E4 F0 48 83 EC 20 E8 0F 00 00 00 48 89 F4 5E C3 }
		$a2 = { 65 48 8B 04 25 60 00 00 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Havoc_88053562 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Havoc (Windows.Trojan.Havoc)"
		author = "Elastic Security"
		id = "88053562-ae19-44fe-8aaf-d6b9687d6b80"
		date = "2024-01-04"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Havoc.yar#L58-L76"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "2f0b59f8220edd0d34fba92905faf0b51aead95d53be8b5f022eed7e21bdb4af"
		logic_hash = "f79b39cc2ca4bbf6ad4b6585a9914a75797110d6fb68bcb7141c5c3d0429c412"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "818011b7972ab71cbfe07ec2266f504ba0ec7df30136e414d15366aa68ad5b8a"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 48 81 EC F8 04 00 00 48 8D 7C 24 78 44 89 8C 24 58 05 00 00 48 8B AC 24 60 05 00 00 4C 8D 6C 24 78 F3 AB B9 59 00 00 00 48 C7 44 24 70 00 00 00 00 C7 44 24 78 68 00 00 00 C7 84 24 B4 00 00 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Havoc_Ffecc8Af : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Havoc (Windows.Trojan.Havoc)"
		author = "Elastic Security"
		id = "ffecc8af-4a64-4252-b7ca-3316d27c3942"
		date = "2024-04-29"
		modified = "2024-05-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Havoc.yar#L78-L107"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "495d323651c252e38814b77b9c6c913b9489e769252ac8bbaf8432f15e0efe44"
		logic_hash = "c9da6215db1de91a6cd52dd6558dc5a60bbd69abc6fa0db8714f001cdae20ddb"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "d09b0519d518b741cec7f6e42efaa657410edd36d027f54e515be510b33fa821"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$commands_table = { 0B 00 00 00 00 00 00 00 [8] 64 00 00 00 00 00 00 00 [8] 15 00 00 00 00 00 00 00 [8] 10 10 00 00 00 00 00 00 [8] 0C 00 00 00 00 00 00 00 [8] 0F 00 00 00 00 00 00 00 [8] 14 00 00 00 00 00 00 00 [8] 01 20 00 00 00 00 00 00 [8] 03 20 00 00 00 00 00 00 [8] C4 09 00 00 00 00 00 00 [8] CE 09 00 00 00 00 00 00 [8] D8 09 00 00 00 00 00 00 [8] 34 08 00 00 00 00 00 00 [8] 16 00 00 00 00 00 00 00 [8] 18 00 00 00 00 00 00 00 [8] 1A 00 00 00 00 00 00 00 [8] 28 00 00 00 00 00 00 00 [8] E2 09 00 00 00 00 00 00 [8] EC 09 00 00 00 00 00 00 [8] F6 09 00 00 00 00 00 00 [8] 00 0A 00 00 00 00 00 00 [8] 5C 00 00 00 00 00 00 00 }
		$hash_ldrloaddll = { 43 6A 45 9E }
		$hash_ldrgetprocedureaddress = { B6 6B CE FC }
		$hash_ntaddbootentry = { 76 C7 FC 8C }
		$hash_ntallocatevirtualmemory = { EC B8 83 F7 }
		$hash_ntfreevirtualmemory = { 09 C6 02 28 }
		$hash_ntunmapviewofsection = { CD 12 A4 6A }
		$hash_ntwritevirtualmemory = { 92 01 17 C3 }
		$hash_ntsetinformationvirtualmemory = { 39 C2 6A 94 }
		$hash_ntqueryvirtualmemory = { 5D E8 C0 10 }
		$hash_ntopenprocesstoken = { 99 CA 0D 35 }
		$hash_ntopenthreadtoken = { D2 47 33 80 }

	condition:
		$commands_table and 4 of ($hash_*)
}
rule ELASTIC_Windows_Trojan_Phoreal_66E91De3 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Phoreal (Windows.Trojan.Phoreal)"
		author = "Elastic Security"
		id = "66e91de3-a510-4a64-b03d-5385ceb32360"
		date = "2022-02-16"
		modified = "2022-04-12"
		reference = "https://www.elastic.co/security-labs/phoreal-malware-targets-the-southeast-asian-financial-sector"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Phoreal.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "88f073552b30462a00d1d612b1638b0508e4ef02c15cf46203998091f0aef4de"
		logic_hash = "c68131fd5e0272d3d473db387a186056a38e6611925ae448d5b668022e6e163a"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "36c9150137b3d65ea6127abe54571f7346c5ebffd1966bf0a9ff99406fe5aa24"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 5C 00 5C 00 2E 00 5C 00 70 00 69 00 70 00 65 00 5C 00 7B 00 41 00 30 00 36 00 46 00 31 00 37 00 36 00 46 00 2D 00 37 00 39 00 46 00 31 00 2D 00 34 00 37 00 33 00 45 00 2D 00 41 00 46 00 34 00 34 00 2D 00 39 00 37 00 36 00 33 00 45 00 33 00 43 00 42 00 33 00 34 00 45 00 35 00 7D 00 }
		$a2 = { 4C 00 6F 00 63 00 61 00 6C 00 5C 00 7B 00 35 00 46 00 42 00 43 00 33 00 46 00 35 00 33 00 2D 00 41 00 37 00 36 00 44 00 2D 00 34 00 32 00 34 00 38 00 2D 00 39 00 36 00 39 00 41 00 2D 00 33 00 31 00 37 00 34 00 30 00 43 00 42 00 43 00 38 00 41 00 44 00 36 00 7D 00 }
		$a3 = { 7B 46 44 35 46 38 34 34 37 2D 36 35 37 41 2D 34 35 43 31 2D 38 39 34 42 2D 44 35 33 33 39 32 36 43 39 42 36 36 7D 2E 64 6C 6C }
		$b1 = { 8B FF 55 8B EC 56 E8 3F 3E 00 00 E8 34 3E 00 00 50 E8 14 3E 00 00 85 C0 75 2A 8B 75 08 56 E8 21 }

	condition:
		2 of them
}
rule ELASTIC_Windows_Trojan_Hancitor_6738D84A : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Hancitor (Windows.Trojan.Hancitor)"
		author = "Elastic Security"
		id = "6738d84a-7393-4db2-97cc-66f471b5699a"
		date = "2021-06-17"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Hancitor.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a674898f39377e538f9ec54197689c6fa15f00f51aa0b5cc75c2bafd86384a40"
		logic_hash = "448243b6925c4e419b1fd492ac5e8d43a7baa4492ba7a5a0b44bc8e036c77ec2"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "44a4dd7c35e0b4f3f161b82463d8f0ee113eaedbfabb7d914ce9486b6bd3a912"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "GUID=%I64u&BUILD=%s&INFO=%s&EXT=%s&IP=%s&TYPE=1&WIN=%d.%d"
		$b1 = "Rundll32.exe %s, start" ascii fullword
		$b2 = "MASSLoader.dll" ascii fullword

	condition:
		$a1 or all of ($b*)
}
rule ELASTIC_Windows_Trojan_Dcrat_1Aeea1Ac : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Dcrat (Windows.Trojan.DCRat)"
		author = "Elastic Security"
		id = "1aeea1ac-69b9-4cc6-91af-18b7a79f35ce"
		date = "2022-01-15"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_DCRat.yar#L1-L24"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "6163e04a40ed52d5e94662131511c3ae08d473719c364e0f7de60dff7fa92cf7"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "fc67d76dc916b7736de783aa245483381a8fe071c533f3761e550af80a873fe9"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "havecamera" ascii fullword
		$a2 = "timeout 3 > NUL" wide fullword
		$a3 = "START \"\" \"" wide fullword
		$a4 = "L2Mgc2NodGFza3MgL2NyZWF0ZSAvZiAvc2Mgb25sb2dvbiAvcmwgaGlnaGVzdCAvdG4g" wide fullword
		$a5 = "U09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUnVuXA==" wide fullword
		$b1 = "DcRatByqwqdanchun" ascii fullword
		$b2 = "DcRat By qwqdanchun1" ascii fullword

	condition:
		5 of ($a*) or 1 of ($b*)
}
rule ELASTIC_Windows_Trojan_Wineloader_13E8860A : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Wineloader (Windows.Trojan.WineLoader)"
		author = "Elastic Security"
		id = "13e8860a-9d83-4ae6-b07e-20bb4037010c"
		date = "2024-03-24"
		modified = "2024-05-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_WineLoader.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f5cb3234eff0dbbd653d5cdce1d4b1026fa9574ebeaf16aaae3d4e921b6a7f9d"
		logic_hash = "c072abb73377ed59c0dd9fab25a4c84575ab9badbddfda1ed51e576e4e12fa82"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "d21c6d97360deea724b94b8f65116f00c11625c5deb1bac0790a23ede6eaaac6"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 48 8B 1E 48 89 F1 E8 ?? ?? 00 00 48 8B 56 08 48 89 F9 49 89 D8 E8 ?? ?? FF FF 48 89 F1 E8 ?? 5C 00 00 90 48 81 C4 ?? 00 00 00 5B 5D 5F 5E 41 5C 41 5E 41 5F C3 C3 41 57 41 56 41 55 41 54 56 57 }
		$a2 = { 85 C0 0F 84 ?? 03 00 00 4C 8D A4 24 BC 00 00 00 41 C7 04 24 04 00 00 00 B8 0F 00 00 00 48 8D 7C 24 70 48 89 47 F8 48 B8 }
		$a3 = { 48 85 DB 0F 84 B3 00 00 00 83 BC 24 80 01 00 00 00 0F 84 5A 01 00 00 4C 8D 74 24 50 49 C7 46 F8 0D 00 00 00 48 B8 }

	condition:
		any of them
}
rule ELASTIC_Windows_Hacktool_Dinvokerust_512D3B59 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Dinvokerust (Windows.Hacktool.DinvokeRust)"
		author = "Elastic Security"
		id = "512d3b59-6bd3-4716-aa5f-1541044bbf9a"
		date = "2024-02-28"
		modified = "2024-03-21"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_DinvokeRust.yar#L1-L24"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ebf0f1bfd166d2d49b642fa43cb0c7364c0c605d9a7f108dc49d9f1cc859ab4a"
		logic_hash = "7be1a4e25cf41e47ab135c718b7ec5a49a2890cf873c52597f8dab4d47636ed8"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "0587368dc33b7fee0037be9247daaeaf6846c2b4a839660511ebf5eb0fdfb087"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$s1 = { 64 69 6E 76 6F 6B 65 ?? ?? 67 65 74 5F }
		$s2 = { 64 69 6E 76 6F 6B 65 ?? ?? 6E 74 5F }
		$s3 = { 64 69 6E 76 6F 6B 65 ?? ?? 6C 69 74 63 72 79 70 74 }
		$s4 = { 64 69 6E 76 6F 6B 65 5C 73 72 63 5C 6C 69 62 2E 72 73 }
		$s5 = { 75 6E 77 69 6E 64 65 72 ?? ?? 63 61 6C 6C 5F 66 75 6E 63 74 69 6F 6E }
		$s6 = { 75 6E 77 69 6E 64 65 72 ?? ?? 69 6E 64 69 72 65 63 74 5F 73 79 73 63 61 6C 6C }

	condition:
		2 of them
}
rule ELASTIC_Windows_Trojan_Shadowpad_Be71209D : FILE MEMORY {
    meta:
		description = "Target ShadowPad loader"
		author = "Elastic Security"
		id = "be71209d-b1c0-4922-87ae-47d0930d8755"
		date = "2023-01-31"
		modified = "2023-02-01"
		reference = "https://www.elastic.co/security-labs/update-to-the-REF2924-intrusion-set-and-related-campaigns"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_ShadowPad.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "452b08d6d2aa673fb6ccc4af6cebdcb12b5df8722f4d70d1c3491479e7b39c05"
		logic_hash = "24e035bbcd5d44877e6e582a995d0035ad26c53e832c34b0c8a3836cb1a11637"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "629f1502ce9f429ba6d497b8f2b0b35e57ca928a764ee6f3cb43521bfa6b5af4"
		threat_name = "Windows.Trojan.ShadowPad"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "{%8.8x-%4.4x-%4.4x-%8.8x%8.8x}"

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Shadowpad_0D899241 : MEMORY {
    meta:
		description = "Target ShadowPad payload"
		author = "Elastic Security"
		id = "0d899241-6ef8-4524-a728-4ed53e4d2cec"
		date = "2023-01-31"
		modified = "2023-02-01"
		reference = "https://www.elastic.co/security-labs/update-to-the-REF2924-intrusion-set-and-related-campaigns"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_ShadowPad.yar#L23-L48"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "cb3a425565b854f7b892e6ebfb3734c92418c83cd590fc1ee9506bcf4d8e02ea"
		logic_hash = "57385e149c6419aed2dcd3ecbbe26d8598918395a6480dd5cdb799ce7328901a"
		score = 75
		quality = 75
		tags = "MEMORY"
		fingerprint = "7070eb3608c2c39804ccad4a05e4de12ec4eb47388589ef72c723b353b920a68"
		threat_name = "Windows.Trojan.ShadowPad"
		severity = 100
		arch_context = "x86"
		scan_context = "memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "hH#whH#w" fullword
		$a2 = "Yuv~YuvsYuvhYuv]YuvRYuvGYuv1:tv<Yuvb#tv1Yuv-8tv&Yuv" fullword
		$a3 = "pH#wpH#w" fullword
		$a4 = "HH#wHH#wA" fullword
		$a5 = "xH#wxH#w:$" fullword
		$re1 = /(HTTPS|TCP|UDP):\/\/[^:]+:443/

	condition:
		4 of them
}
rule ELASTIC_Windows_Backdoor_Goldbackdoor_91902940 : FILE MEMORY {
    meta:
		description = "Detects Windows Backdoor Goldbackdoor (Windows.Backdoor.Goldbackdoor)"
		author = "Elastic Security"
		id = "91902940-a291-4fc6-81c5-2cde2328e8d9"
		date = "2022-04-29"
		modified = "2022-06-09"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Backdoor_Goldbackdoor.yar#L1-L26"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "485246b411ef5ea9e903397a5490d106946a8323aaf79e6041bdf94763a0c028"
		logic_hash = "71e26cce6d730560e1303b2a4f49d0da6d1341263bb47ade46338f03e528cbf7"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "83a404a24e54bd05319d3df3a830f1ffe51d30f71ca55d63ca152d5169511df4"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$pdf = "D:\\Development\\GOLD-BACKDOOR\\"
		$agent = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.3112.113 Safari/537.36"
		$str0 = "client_id"
		$str1 = "client_secret"
		$str2 = "redirect_uri"
		$str3 = "refresh_token"
		$a = { 56 57 8B 7D 08 8B F1 6A 00 6A 00 6A 00 6A 00 68 ?? ?? ?? ?? FF 15 ?? ?? ?? ?? 89 46 30 85 C0 75 ?? 33 C0 5F 5E }
		$b = { 66 8B 02 83 C2 02 66 85 C0 75 ?? 2B D1 D1 FA 75 ?? 33 C0 E9 ?? ?? ?? ?? 6A 40 8D 45 ?? 6A 00 50 E8 }

	condition:
		($pdf and $agent) or ( all of ($str*) and $a and $b)
}
rule ELASTIC_Windows_Backdoor_Goldbackdoor_F11D57Df : FILE MEMORY {
    meta:
		description = "Detects Windows Backdoor Goldbackdoor (Windows.Backdoor.Goldbackdoor)"
		author = "Elastic Security"
		id = "f11d57df-8dd4-481c-a557-f83ae05d53fe"
		date = "2022-04-29"
		modified = "2022-06-09"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Backdoor_Goldbackdoor.yar#L28-L51"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "45ece107409194f5f1ec2fbd902d041f055a914e664f8ed2aa1f90e223339039"
		logic_hash = "6401b215523289a3842dec6d3e016a2ca99512c5889e87cb5ff13023bb0b8e1e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "fed0317d43910d962908604812c2cd1aff6e67f7e245c82b39f2ac6dc14b6edb"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { C7 45 ?? 64 69 72 25 C7 45 ?? 5C 53 79 73 C7 45 ?? 74 65 6D 33 C7 45 ?? 32 5C 00 00 C7 45 ?? 2A 2E 65 78 C7 45 ?? 65 00 00 00 E8 ?? ?? ?? ?? FF D0 }
		$b = { B9 18 48 24 9D E8 ?? ?? ?? ?? FF D0 }
		$c = { B9 F8 92 FA 98 E8 ?? ?? ?? ?? FF D0 }
		$a1 = { 64 A1 30 00 00 00 53 55 56 }
		$b1 = { B9 76 DB 7A AA 6A 40 68 00 30 00 00 FF 75 ?? 50 E8 ?? ?? ?? ?? FF D0 }
		$c1 = { B9 91 51 13 EE 50 68 80 00 00 00 6A 04 50 50 ?? ?? ?? ?? ?? ?? ?? 6A 04 50 E8 ?? ?? ?? ?? FF D0 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Hijackloader_A8444812 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Hijackloader (Windows.Trojan.HijackLoader)"
		author = "Elastic Security"
		id = "a8444812-6aef-4ed7-a44b-b147301544c8"
		date = "2023-11-15"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_HijackLoader.yar#L1-L24"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "065c379a33ef1539e8a68fd4b7638fe8a30ec19fc128642ed0c68539656374b9"
		logic_hash = "6cd88adc7a0d35013a26d1135efb294ee6f9ddab99b4549e82d3d6f5f65509b6"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "dd9f3bca44b585e3a31626b66223288634fcb092e43ecb053806726e5f2006e9"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 8B 45 ?? 40 89 45 ?? 8B 45 ?? 3B 45 ?? 73 ?? 8B 45 ?? 03 45 ?? 66 0F BE 00 66 89 45 ?? FF 75 ?? FF 75 ?? 8D 45 ?? 50 E8 [4] 83 C4 0C EB ?? }
		$a2 = { 8B 45 ?? 8B 4D ?? 8B [1-5] 0F AF [1-5] 0F B7 [2] 03 C1 8B 4D ?? 89 01 }
		$a3 = { 33 C0 40 74 ?? 8B 45 ?? 8B 4D ?? 8B 55 ?? 03 14 81 89 55 ?? FF 75 ?? FF 75 ?? E8 [4] 59 59 89 45 ?? 8B 45 ?? 8B 4D ?? 0F B7 04 41 8B 4D ?? 8B 55 ?? 03 14 81 89 55 ?? 8B 45 ?? 3B 45 ?? 75 ?? 8B 45 ?? EB ?? 8B 45 ?? 40 89 45 ?? EB ?? }
		$a4 = { 8B 45 ?? 8B 4D ?? 8B [1-5] 0F AF [1-5] 0F B7 4D ?? 03 C1 8B 4D ?? 89 01 }
		$a5 = { 8B 45 ?? 83 C0 04 89 45 ?? 8B 45 ?? 3B 45 ?? 73 ?? 8B 45 ?? 8B 4D ?? 8B 04 81 03 45 ?? 8B 4D ?? 8B 55 ?? 89 04 8A 8B 45 ?? 40 89 45 ?? EB ?? }
		$a6 = { 8B 45 ?? 83 C0 04 89 45 ?? 8B 45 ?? 3B 45 ?? 73 ?? 8B 45 ?? 03 45 ?? 89 45 ?? 8B 45 ?? 8B 00 89 45 ?? 8B 45 ?? 33 45 ?? 8B 4D ?? 89 01 EB ?? }

	condition:
		3 of them
}
rule ELASTIC_Windows_Trojan_Arkeistealer_84C7086A : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Arkeistealer (Windows.Trojan.ArkeiStealer)"
		author = "Elastic Security"
		id = "84c7086a-abc3-4b97-b325-46a078b90a95"
		date = "2022-02-17"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_ArkeiStealer.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "708d9fb40f49192d4bf6eff62e0140c920a7eca01b9f78aeaf558bef0115dbe2"
		logic_hash = "b7129094389f789f0b43f0da54645c24a6d1149f53d6536c14714e3ff44f935b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f1d701463b0001de8996b30d2e36ddecb93fe4ca2a1a26fc4fcdaeb0aa3a3d6d"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 01 89 55 F4 8B 45 F4 3B 45 10 73 31 8B 4D 08 03 4D F4 0F BE 19 8B }

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Clop_6A1670Aa : BETA FILE MEMORY {
    meta:
		description = "Identifies CLOP ransomware in unpacked state"
		author = "Elastic Security"
		id = "6a1670aa-7f78-455b-9e28-f39ed4c6476e"
		date = "2020-05-03"
		modified = "2021-08-23"
		reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.clop"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Clop.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "afe28000d50495bf2f2adc6cbf0159591ce87bff207f3c6a1d38e09f9ed328d7"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "7c24cc6a519922635a519dad412d1a07728317b91f90a120ccc1c7e7e2c8a002"
		threat_name = "Windows.Ransomware.Clop"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$b1 = { FF 15 04 E1 40 00 83 F8 03 74 0A 83 F8 02 }

	condition:
		1 of ($b*)
}
rule ELASTIC_Windows_Ransomware_Clop_E04959B5 : BETA FILE MEMORY {
    meta:
		description = "Identifies CLOP ransomware in unpacked state"
		author = "Elastic Security"
		id = "e04959b5-f3da-428d-8b56-8a9817fdebe0"
		date = "2020-05-03"
		modified = "2021-08-23"
		reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.clop"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Clop.yar#L22-L50"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "039fcb0e48898c7546588cd095fac16f06cf5e5568141aefb6db382a61e80a8d"
		score = 75
		quality = 50
		tags = "BETA, FILE, MEMORY"
		fingerprint = "7367b90772ce6db0d639835a0a54a994ef8ed351b6dadff42517ed5fbc3d0d1a"
		threat_name = "Windows.Ransomware.Clop"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "-%s\\CIopReadMe.txt" wide fullword
		$a2 = "CIopReadMe.txt" wide fullword
		$a3 = "%s-CIop^_" wide fullword
		$a4 = "%s%s.CIop" wide fullword
		$a5 = "BestChangeT0p^_-666" ascii fullword
		$a6 = ".CIop" wide fullword
		$a7 = "A%s\\ClopReadMe.txt" wide fullword
		$a8 = "%s%s.Clop" wide fullword
		$a9 = "CLOP#666" wide fullword
		$a10 = "MoneyP#666" wide fullword

	condition:
		1 of ($a*)
}
rule ELASTIC_Windows_Ransomware_Clop_9Ac9Ea3E : BETA FILE MEMORY {
    meta:
		description = "Identifies CLOP ransomware in unpacked state"
		author = "Elastic Security"
		id = "9ac9ea3e-72e1-4151-a2f8-87869f5f98e3"
		date = "2020-05-03"
		modified = "2021-08-23"
		reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.clop"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Clop.yar#L52-L71"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "1228ee4b934faf1d5f8cf4518974cd2c80a73d84c8a354bde4813fb97ba516d7"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "1cb0adb36e94ef8f8d74862250205436ed3694ed7719d8e639cfdd0c8632fd6c"
		threat_name = "Windows.Ransomware.Clop"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$c1 = { 8B 1D D8 E0 40 00 33 F6 8B 3D BC E0 40 00 }

	condition:
		1 of ($c*)
}
rule ELASTIC_Windows_Ransomware_Clop_606020E7 : BETA FILE MEMORY {
    meta:
		description = "Identifies CLOP ransomware in unpacked state"
		author = "Elastic Security"
		id = "606020e7-ce1a-4a48-b801-100fd22b3791"
		date = "2020-05-03"
		modified = "2021-08-23"
		reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.clop"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Clop.yar#L73-L92"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "f5169b324bc19f6f5a04c99f1d3326c97300d038ec383c3eab94eb258963ac30"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "5ec4e00ddf2cb1315ec7d62dd228eee0d9c15fafe4712933d42e868f83f13569"
		threat_name = "Windows.Ransomware.Clop"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$d1 = { B8 E1 83 0F 3E F7 E6 8B C6 C1 EA 04 8B CA C1 E1 05 03 CA }

	condition:
		1 of ($d*)
}
rule ELASTIC_Windows_Trojan_Metasploit_A6E956C9 : FILE MEMORY {
    meta:
		description = "Identifies the API address lookup function leverage by metasploit shellcode"
		author = "Elastic Security"
		id = "a6e956c9-799e-49f9-b5c5-ac68aaa2dc21"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Metasploit.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "fb4e3e54618075d5ef6ec98d1ba9c332ce9f677f0879e07b34a2ca08b2180dd9"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "21855599bc51ec2f71d694d4e0f866f815efe54a42842dfe5f8857811530a686"
		threat_name = "Windows.Trojan.Metasploit"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 60 89 E5 31 C0 64 8B 50 30 8B 52 0C 8B 52 14 8B 72 28 0F B7 4A 26 31 FF AC 3C 61 7C 02 2C 20 }

	condition:
		$a1
}
rule ELASTIC_Windows_Trojan_Metasploit_38B8Ceec : FILE MEMORY {
    meta:
		description = "Identifies the API address lookup function used by metasploit. Also used by other tools (like beacon)."
		author = "Elastic Security"
		id = "38b8ceec-601c-4117-b7a0-74720e26bf38"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Metasploit.yar#L21-L39"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "8e3bc02661cedb9885467373f8120542bb7fc8b0944803bc01642fbc8426298b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "44b9022d87c409210b1d0807f5a4337d73f19559941660267d63cd2e4f2ff342"
		threat_name = "Windows.Trojan.Metasploit"
		severity = 85
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 89 E5 31 D2 64 8B 52 30 8B 52 0C 8B 52 14 8B 72 28 0F B7 4A 26 31 FF 31 C0 AC 3C 61 }

	condition:
		$a1
}
rule ELASTIC_Windows_Trojan_Metasploit_7Bc0F998 : FILE MEMORY {
    meta:
		description = "Identifies the API address lookup function leverage by metasploit shellcode"
		author = "Elastic Security"
		id = "7bc0f998-7014-4883-8a56-d5ee00c15aed"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Metasploit.yar#L41-L59"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "29cb48086dbcd48bd83c5042ed78370e127e1ea5170ee7383b88659b31e896b5"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "fdb5c665503f07b2fc1ed7e4e688295e1222a500bfb68418661db60c8e75e835"
		threat_name = "Windows.Trojan.Metasploit"
		severity = 84
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 48 31 D2 65 48 8B 52 60 48 8B 52 18 48 8B 52 20 48 8B 72 50 48 0F B7 4A 4A 4D 31 C9 48 31 C0 AC 3C 61 }

	condition:
		$a1
}
rule ELASTIC_Windows_Trojan_Metasploit_F7F826B4 : FILE MEMORY {
    meta:
		description = "Identifies metasploit kernel->user shellcode. Likely used in ETERNALBLUE and BlueKeep exploits."
		author = "Elastic Security"
		id = "f7f826b4-6456-4819-bc0c-993aeeb7e325"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Metasploit.yar#L61-L79"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "2f5264e07c65d5ef4efe49a48c24ccef9a4b9379db581d2cf18e1131982e6f2f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "9b07dc54d5015d0f0d84064c5a989f94238609c8167cae7caca8665930a20f81"
		threat_name = "Windows.Trojan.Metasploit"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 48 92 31 C9 51 51 49 89 C9 4C 8D 05 0? 00 00 00 89 CA 48 83 EC 20 FF D0 48 83 C4 30 C3 }

	condition:
		$a1
}
rule ELASTIC_Windows_Trojan_Metasploit_24338919 : FILE MEMORY {
    meta:
		description = "Identifies metasploit wininet reverse shellcode. Also used by other tools (like beacon)."
		author = "Elastic Security"
		id = "24338919-8efe-4cf2-a23a-a3f22095b42d"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Metasploit.yar#L81-L99"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "af8cceebdebca863019860afca5d7c6400b68c8450bc17b7d7b74aeab2d62d16"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ac76190a84c4bdbb6927c5ad84a40e2145ca9e76369a25ac2ffd727eefef4804"
		threat_name = "Windows.Trojan.Metasploit"
		severity = 80
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 68 6E 65 74 00 68 77 69 6E 69 54 68 4C 77 26 07 }

	condition:
		$a1
}
rule ELASTIC_Windows_Trojan_Metasploit_0F5A852D : FILE MEMORY {
    meta:
		description = "Identifies 64 bit metasploit wininet reverse shellcode. May also be used by other malware families."
		author = "Elastic Security"
		id = "0f5a852d-cacd-43d7-8754-204b09afba2f"
		date = "2021-04-07"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Metasploit.yar#L101-L119"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "11cddf2191a2f70222a0c8c591e387b4b5667bc432a2f686629def9252361c1d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "97daac4249e85a73d4e6a4450248e59e0d286d5e7c230cf32a38608f8333f00d"
		threat_name = "Windows.Trojan.Metasploit"
		severity = 80
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 49 BE 77 69 6E 69 6E 65 74 00 41 56 48 89 E1 49 C7 C2 4C 77 26 07 FF D5 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Metasploit_C9773203 : FILE MEMORY {
    meta:
		description = "Identifies the 64 bit API hashing function used by Metasploit. This has been re-used by many other malware families."
		author = "Elastic Security"
		id = "c9773203-6d1e-4246-a1e0-314217e0207a"
		date = "2021-04-07"
		modified = "2021-08-23"
		reference = "https://github.com/rapid7/metasploit-framework/blob/04e8752b9b74cbaad7cb0ea6129c90e3172580a2/external/source/shellcode/windows/x64/src/block/block_api.asm"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Metasploit.yar#L121-L140"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "1d6503ccf05b8e8b4368ed0fb2e57aa2be94151ce7e2445b5face7b226a118e9"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "afde93eeb14b4d0c182f475a22430f101394938868741ffa06445e478b6ece36"
		threat_name = "Windows.Trojan.Metasploit"
		severity = 10
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 48 31 C0 AC 41 C1 C9 0D 41 01 C1 38 E0 75 F1 4C 03 4C 24 08 45 39 D1 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Metasploit_Dd5Ce989 : FILE MEMORY {
    meta:
		description = "Identifies Meterpreter DLL used by Metasploit"
		author = "Elastic Security"
		id = "dd5ce989-3925-4e27-97c1-3b8927c557e9"
		date = "2021-04-14"
		modified = "2021-08-23"
		reference = "https://www.rapid7.com/blog/post/2015/03/25/stageless-meterpreter-payloads/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Metasploit.yar#L142-L164"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "86cf98bf854b01a55e3f306597437900e11d429ac6b7781e090eeda3a5acb360"
		logic_hash = "5c094979be1cd347ffee944816b819b6fbb62804b183a6120cd3a93d2759155b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "4fc7c309dca197f4626d6dba8afcd576e520dbe2a2dd6f7d38d7ba33ee371d55"
		threat_name = "Windows.Trojan.Metasploit"
		severity = 90
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "metsrv.x64.dll" fullword
		$a2 = "metsrv.dll" fullword
		$b1 = "ReflectiveLoader"

	condition:
		1 of ($a*) and 1 of ($b*)
}
rule ELASTIC_Windows_Trojan_Metasploit_96233B6B : FILE MEMORY {
    meta:
		description = "Identifies another 64 bit API hashing function used by Metasploit."
		author = "Elastic Security"
		id = "96233b6b-d95a-4e0e-8f83-f2282a342087"
		date = "2021-06-10"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Metasploit.yar#L166-L185"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "e7a2d966deea3a2df6ce1aeafa8c2caa753824215a8368e0a96b394fb46b753b"
		logic_hash = "09a2b9414a126367df65322966b671fe7ea963cd65ef48e316c9d139ee502d31"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "40032849674714bc9eb020971dd9f27a07b53b8ff953b793cb3aad136256fd70"
		threat_name = "Windows.Trojan.Metasploit"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 89 E5 31 D2 64 8B 52 30 8B 52 0C 8B 52 14 8B 72 28 31 FF 0F B7 4A 26 31 C0 AC 3C 61 7C 02 2C 20 C1 CF 0D }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Metasploit_4A1C4Da8 : FILE MEMORY {
    meta:
		description = "Identifies Metasploit 64 bit reverse tcp shellcode."
		author = "Elastic Security"
		id = "4a1c4da8-837d-4ad1-a672-ddb8ba074936"
		date = "2021-06-10"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Metasploit.yar#L187-L206"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9582d37ed9de522472abe615dedef69282a40cfd58185813c1215249c24bbf22"
		logic_hash = "9d3a3164ed1019dcb557cf20734a81be9964a555ddb2e0104f7202880b2ed177"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "7a31ce858215f0a8732ce6314bfdbc3975f1321e3f87d7f4dc5a525f15766987"
		threat_name = "Windows.Trojan.Metasploit"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 6A 10 56 57 68 99 A5 74 61 FF D5 85 C0 74 0A FF 4E 08 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Metasploit_91Bc5D7D : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Metasploit (Windows.Trojan.Metasploit)"
		author = "Elastic Security"
		id = "91bc5d7d-31e3-4c02-82b3-a685194981f3"
		date = "2021-08-02"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Metasploit.yar#L208-L226"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0dd993ff3917dc56ef02324375165f0d66506c5a9b9548eda57c58e041030987"
		logic_hash = "74154902b03c36a4ee9bc54ae9399bae9e6afb7fe8d0fe232b88250afc368d6f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "8848a3de66a25dd98278761a7953f31b7995e48621dec258f3d92bd91a4a3aa3"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 49 BE 77 73 32 5F 33 32 00 00 41 56 49 89 E6 48 81 EC A0 01 00 00 49 89 E5 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Metasploit_A91A6571 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Metasploit (Windows.Trojan.Metasploit)"
		author = "Elastic Security"
		id = "a91a6571-ae2d-4ab4-878b-38b455f42c01"
		date = "2022-06-08"
		modified = "2022-09-29"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Metasploit.yar#L228-L246"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ff7795edff95a45b15b03d698cbdf70c19bc452daf4e2d5e86b2bbac55494472"
		logic_hash = "cc59320ba9f8907d1d9b9dc120d8b4807b419e49c55be1fd5d2cdbb0c5d4e5cc"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e372484956eab80e4bf58f4ae1031de705cb52eaefa463aa77af7085c463638d"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { FC 48 83 E4 F0 E8 CC 00 00 00 41 51 41 50 52 48 31 D2 51 56 65 48 8B 52 60 48 8B 52 18 48 8B 52 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Metasploit_B29Fe355 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Metasploit (Windows.Trojan.Metasploit)"
		author = "Elastic Security"
		id = "b29fe355-b7f8-4325-bf06-7975585f3888"
		date = "2022-06-08"
		modified = "2022-09-29"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Metasploit.yar#L248-L268"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "4f0ab4e42e6c10bc9e4a699d8d8819b04c17ed1917047f770dc6980a0a378a68"
		logic_hash = "7a2189b59175acb66a7497c692a43c413a476f5c4371f797bf03a8ddb550992c"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a943325b7a227577ccd45748b4e705288c5b7d91d0e0b2a115daeea40e1a2148"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "%04x-%04x:%s" fullword
		$a2 = "\\\\%s\\pipe\\%s" fullword
		$a3 = "PACKET TRANSMIT" fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Metasploit_66140F58 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Metasploit (Windows.Trojan.Metasploit)"
		author = "Elastic Security"
		id = "66140f58-1815-4e21-8544-24fed74194f1"
		date = "2022-08-15"
		modified = "2022-09-29"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Metasploit.yar#L270-L288"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "01a0c5630fbbfc7043d21a789440fa9dadc6e4f79640b370f1a21c6ebf6a710a"
		logic_hash = "0a855b7296f7cea39cc5d57b239d3906133ea43a0811ec60e4d91765cf89aced"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "79879b2730e98f3eddeca838dff438d75a43ac20c0da6a4802474ff05f9cc7a3"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { FC 48 83 E4 F0 E8 CC 00 00 00 41 51 41 50 52 48 31 D2 51 65 48 8B 52 60 48 8B 52 18 48 8B 52 20 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Metasploit_2092C42A : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Metasploit (Windows.Trojan.Metasploit)"
		author = "Elastic Security"
		id = "2092c42a-793b-4b0e-868b-9a39c926f44c"
		date = "2023-05-09"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Metasploit.yar#L290-L309"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "e47d88c11a89dcc84257841de0c9f1ec388698006f55a0e15567354b33f07d3c"
		logic_hash = "83c46c6b957f10d406ea9985c518eb2fba3e82b9023bfdefa8bdd4be7fb67826"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "4f17bfb02d3ac97e48449b6e30c9b07f604c13d5e12a99af322853c5d656ee88"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 65 6E 61 62 6C 65 5F 6B 65 79 62 6F 61 72 64 5F 69 6E 70 75 74 }
		$a2 = { 01 04 10 49 83 C2 02 4D 85 C9 75 9C 41 8B 43 04 4C 03 D8 48 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Metasploit_46E1C247 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Metasploit (Windows.Trojan.Metasploit)"
		author = "Elastic Security"
		id = "46e1c247-1ebb-434f-835f-faf421b35169"
		date = "2023-05-10"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Metasploit.yar#L311-L330"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ef70e1faa3b1f40d92b0a161c96e13c96c43ec6651e7c87ee3977ed07b950bab"
		logic_hash = "760a4e28e312a7d744208dc833ffad8d139ce7c536b407625a7fb0dff5ddb1d1"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "6cd37d32976add38d7165f8088f38f4854b59302d6adf20db5c46cd3e8c7d9e7"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 73 74 64 61 70 69 5F 66 73 5F 66 69 6C 65 }
		$a2 = { 85 D2 74 0E 8B F3 2B 75 F8 8A 01 88 04 0E 41 4A 75 F7 0F B7 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Metasploit_B62Aac1E : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Metasploit (Windows.Trojan.Metasploit)"
		author = "Elastic Security"
		id = "b62aac1e-2ce8-4803-90ee-138b509e814d"
		date = "2023-05-10"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Metasploit.yar#L332-L351"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "af9af81f7e46217330b447900f80c9ce38171655becb3b63e51f913b95c71e70"
		logic_hash = "3ef6b7fb258b060ae00b060dbf9b07620f8cda0d9a827985bbb3ed9617969ef6"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "58340ea67e2544d22adba3317350150c61c84fba1d16c7c9f8d0c626c3421296"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 42 3C 8B AC 10 88 00 00 00 44 8B 54 15 20 44 8B 5C 15 24 4C }
		$a2 = { CB 4D 85 D2 74 10 41 8A 00 4D 03 C3 88 02 49 03 D3 4D 2B D3 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Metasploit_47F5D54A : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Metasploit (Windows.Trojan.Metasploit)"
		author = "Elastic Security"
		id = "47f5d54a-2578-4bbd-b157-8b225f6d34b3"
		date = "2023-11-13"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Metasploit.yar#L353-L372"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "bc3754cf4a04491a7ad7a75f69dd3bb2ddf0d8592ce078b740d7c9c7bc85a7e1"
		logic_hash = "be080d0aae457348c4a02c204507a8cb14d1728d1bc50d7cf12b577aa06daf9f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b6dbc1b273bc9a328d5c437d11db23e8f1d3bf764bb624aa4f552c14b3dc5260"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a32 = { 89 45 F8 FF 15 [11] 8B D8 85 DB 74 76 6A 00 6A 04 6A 00 FF 35 [4] 6A 00 6A 00 FF 15 }
		$a64 = { 48 89 7C 24 48 FF 15 [4] 33 D2 44 8B C0 B9 40 00 10 00 FF 15 [4] 48 8B F8 48 85 C0 74 55 48 8B 15 [10] 4C 8B C0 48 8B CB 48 C7 44 24 20 }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Dbatloader_F93A8E90 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Dbatloader (Windows.Trojan.DBatLoader)"
		author = "Elastic Security"
		id = "f93a8e90-10ac-44de-ac3b-c0e976628e98"
		date = "2022-03-11"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_DBatLoader.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f72d7e445702bbf6b762ebb19d521452b9c76953d93b4d691e0e3e508790256e"
		logic_hash = "6fe91d91bb383c66a6dc623b02817411a39b88030142517f4048c5c25fbb4ac5"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "81b87663fbad9854430e5c4dcade464a15b995e645f9993a3e234593ee4df901"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { FF 00 74 17 8B 45 E8 0F B6 7C 18 FF 66 03 7D EC 66 0F AF 7D F4 66 03 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_A310Logger_520Cd7Ec : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan A310Logger (Windows.Trojan.A310logger)"
		author = "Elastic Security"
		id = "520cd7ec-840c-4d45-961b-8bc5e329c52f"
		date = "2022-01-11"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_A310logger.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "60fb9597e5843c72d761525f73ca728409579d81901860981ebd84f7d153cfa3"
		logic_hash = "6095ce913e3fb1cfc2f1b091598fc06b2dfec30c2353be7df08dcbb1a06b07c3"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f4ee88e555b7bd0102403cc804372f5376debc59555e8e7b4a16e18b04d1b314"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "/dumps9taw" ascii fullword
		$a2 = "/logstatus" ascii fullword
		$a3 = "/checkprotection" ascii fullword
		$a4 = "[CLIPBOARD]<<" wide fullword
		$a5 = "&chat_id=" wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Dridex_63Ddf193 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Dridex (Windows.Trojan.Dridex)"
		author = "Elastic Security"
		id = "63ddf193-31a6-4139-b452-960fe742da93"
		date = "2021-08-07"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Dridex.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b1d66350978808577159acc7dc7faaa273e82c103487a90bf0d040afa000cb0d"
		logic_hash = "e792f4693be0a7c71d1e638212a8fb3acb1e14dedd48218861fad8c09811da29"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "7b4c5fde8e107a67ff22f3012200e56ec452e0a57a49edb2e06ee225ecfe228c"
		severity = 90
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "snxhk.dll" ascii fullword
		$a2 = "LondLibruryA" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Dridex_C6F01353 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Dridex (Windows.Trojan.Dridex)"
		author = "Elastic Security"
		id = "c6f01353-cf55-4eac-9f25-6f9cce3b7990"
		date = "2021-08-07"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Dridex.yar#L22-L40"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "739682ccb54170e435730c54ba9f7e09f32a3473c07d2d18ae669235dcfe84de"
		logic_hash = "7146204d779610c04badfc7d884ff882ff5f1439b61f889d1edf4419240c5751"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "fbdb230032e3655448d26a679afc612c79d33ac827bcd834e54fe5c05f04d828"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 56 57 55 8B FA 85 C9 74 58 85 FF 74 54 0F B7 37 85 F6 75 04 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Octopus_15813E26 : FILE MEMORY {
    meta:
		description = "Identifies Octopus, an Open source pre-operation C2 server based on Python and PowerShell"
		author = "Elastic Security"
		id = "15813e26-77f8-46cf-a6a3-ae081925b85a"
		date = "2021-11-10"
		modified = "2022-01-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Octopus.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "0d30b96ead4ccba75e08f6ba1db73cee61a29b5b0c7ee0fb523cbcd61dce9d87"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a3294547f7e3cead0cd64eb3d2e7dbd8ccfc4d9eedede240a643c8cd114cbcce"
		threat_name = "Windows.Trojan.Octopus"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = "C:\\Users\\UNKNOWN\\source\\repos\\OctopusUnmanagedExe\\OctopusUnmanagedExe\\obj\\x64\\Release\\SystemConfiguration.pdb" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Flawedgrace_8C5Eb04B : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Flawedgrace (Windows.Trojan.FlawedGrace)"
		author = "Elastic Security"
		id = "8c5eb04b-301b-4d05-a010-3329e5b764c6"
		date = "2023-11-01"
		modified = "2023-11-02"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_FlawedGrace.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "966112f3143d751a95c000a990709572ac8b49b23c0e57b2691955d6fda1016e"
		logic_hash = "dc07197cb9a02ff8d271f78756c2784c74d09e530af20377a584dbfe77e973aa"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "46ce025974792cdefe9d4f4493cee477c0eaf641564cd44becd687c27d9e7c30"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Grace finalized, no more library calls allowed." ascii fullword
		$a2 = ".?AVReadThread@TunnelIO@NS@@" ascii fullword
		$a3 = ".?AVTunnelClientDirectIO@NS@@" ascii fullword
		$a4 = ".?AVWireClientConnectionThread@NS@@" ascii fullword
		$a5 = ".?AVWireParam@NS@@" ascii fullword

	condition:
		3 of them
}
rule ELASTIC_Windows_Trojan_Darkcomet_1Df27Bcc : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Darkcomet (Windows.Trojan.Darkcomet)"
		author = "Elastic Security"
		id = "1df27bcc-9f18-48d4-bd7f-73bdc7cb1e63"
		date = "2021-08-16"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Darkcomet.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "7fbe87545eef49da0df850719536bb30b196f7ad2d5a34ee795c01381ffda569"
		logic_hash = "5886e3316839e64f934a0e84d85074e076f3e1e44f86fee35a87eb560bfa2aa7"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "63b77999860534b71b7b4e7b3da9df175ccd0009f4c13215a59c6b83e0e95b3b"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "BTRESULTHTTP Flood|Http Flood task finished!|" ascii fullword
		$a2 = "is now open!|" ascii fullword
		$a3 = "ActiveOnlineKeylogger" ascii fullword
		$a4 = "#BOT#RunPrompt" ascii fullword
		$a5 = "GETMONITORS" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Backdoor_Dragoncastling_4Ecf6F9F : FILE MEMORY {
    meta:
		description = "Detects Windows Backdoor Dragoncastling (Windows.Backdoor.DragonCastling)"
		author = "Elastic Security"
		id = "4ecf6f9f-a4c8-4962-9f16-cf7fb76467d3"
		date = "2022-11-08"
		modified = "2022-12-20"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Backdoor_DragonCastling.yar#L1-L27"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9776c7ae6ca73f87d7c838257a5bcd946372fbb77ebed42eebdfb633b13cd387"
		logic_hash = "26ff86354230f1006bd451eab5c1634b91888330d124a06dd2dfa5ab515d6e1a"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "be22acb2c9c28b68d9fffe255f7d72065fb683ef2e3c4f73914f51e14ae43175"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "recv bomb" ascii fullword
		$a2 = "%s\\kbg%x.dat"
		$a3 = "\\smcache.dat" wide fullword
		$a4 = "%s\\game_%x.log"
		$a5 = "{%08X-%04X-%04X-%02X%02X-%02X%02X%02X%02X%02X%02X}"
		$a7 = "HOST: %ws:%ws" ascii fullword
		$a8 = "; Windows NT %d.%d" wide fullword
		$a9 = "Mozilla / 5.0 (Windows NT 6.3; WOW64) AppleWebKit / 537.36 (KHTML, like Gecko) Chrome / 41.0.2272.118 Safari / 537.36" ascii fullword
		$a10 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\User Agent\\Post Platform" wide fullword

	condition:
		5 of them
}
rule ELASTIC_Windows_Trojan_Squirrelwaffle_88033Ff1 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Squirrelwaffle (Windows.Trojan.Squirrelwaffle)"
		author = "Elastic Security"
		id = "88033ff1-f9b1-4cdc-bb68-bd3a10027584"
		date = "2021-09-20"
		modified = "2022-01-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Squirrelwaffle.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "00d045c89934c776a70318a36655dcdd77e1fedae0d33c98e301723f323f234c"
		logic_hash = "695d7d411a4de23ba1517a06bda3ce73add37dca1e6fe9046e7c2dcae237389e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "94c0d8ce3e06cf02a6fb57c074ff0ef60346babcde43c61371d099b011d9fcf9"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "start /i /min /b start /i /min /b start /i /min /b " ascii fullword
		$a2 = " HTTP/1.1" ascii fullword
		$a3 = "Host:" ascii fullword
		$a4 = "APPDATA" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Squirrelwaffle_D3B685A1 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Squirrelwaffle (Windows.Trojan.Squirrelwaffle)"
		author = "Elastic Security"
		id = "d3b685a1-2d1c-44a3-8d83-ff661d491a52"
		date = "2021-09-21"
		modified = "2022-01-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Squirrelwaffle.yar#L24-L42"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "00d045c89934c776a70318a36655dcdd77e1fedae0d33c98e301723f323f234c"
		logic_hash = "7d187aa75fc767f5009f3090852de4894776f4b3f99f189478e7e9fd9c3acbe7"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "15df7efab9cc40ff57070d18ae67b549c55595d7cbf3ca02963336e4297156c4"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 08 85 C0 75 0F 8D 45 94 50 8D 45 D0 6A 20 50 FF D7 83 C4 0C }

	condition:
		all of them
}
rule ELASTIC_Multi_Attacksimulation_Blindspot_D93F54C5 : FILE MEMORY {
    meta:
		description = "Detects Multi Attacksimulation Blindspot (Multi.AttackSimulation.Blindspot)"
		author = "Elastic Security"
		id = "d93f54c5-6574-4999-a3c0-39ef688b28dc"
		date = "2022-05-23"
		modified = "2022-08-16"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_AttackSimulation_Blindspot.yar#L1-L18"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "41984a0ad20ab21186252bb2f3f68604d2cbeea0e1ce22895dd163f7acbf2ca1"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "4ec38f841aa4dfe32b1f6b6cd2e361c7298839ef1e983061cb90827135f34a58"
		severity = 1
		arch_context = "x86, arm64"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$a = "\\\\.\\pipe\\blindspot-%d."

	condition:
		all of them
}
rule ELASTIC_Windows_Remoteadmin_Ultravnc_965F054A : FILE MEMORY {
    meta:
		description = "Detects Windows Remoteadmin Ultravnc (Windows.RemoteAdmin.UltraVNC)"
		author = "Elastic Security"
		id = "965f054a-4b78-43f3-87db-1ecd64c317a0"
		date = "2023-03-18"
		modified = "2023-04-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_RemoteAdmin_UltraVNC.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "59bddb5ccdc1c37c838c8a3d96a865a28c75b5807415fd931eaff0af931d1820"
		logic_hash = "a9b9d0958f09b23fa7b27ef7ec32b3feb98edca3be5a21552a3a2f50e3fd41c1"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "7e612ffb9fdf94471f938039b4077d5546edd5d6f700733e1c1e732aef36ed42"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$s1 = ".\\vncsockconnect.cpp"
		$s2 = ".\\vnchttpconnect.cpp"
		$s3 = ".\\vncdesktopthread.cpp"
		$s4 = "Software\\UltraVNC"
		$s5 = "VncCanvas.class"
		$s6 = "WinVNC_Win32_Instance_Mutex"
		$s7 = "WinVNC.AddClient"

	condition:
		5 of them
}
rule ELASTIC_Windows_Trojan_Falsefont_D1F0D357 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Falsefont (Windows.Trojan.FalseFont)"
		author = "Elastic Security"
		id = "d1f0d357-26cb-4dab-8ca6-65f17109982b"
		date = "2024-03-26"
		modified = "2024-05-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_FalseFont.yar#L1-L26"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "364275326bbfc4a3b89233dabdaf3230a3d149ab774678342a40644ad9f8d614"
		logic_hash = "af356dec77f773cec01626a3823dbea7e9d3719b9d152ec4057c0b97efabf0df"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ad63447832e9a160d479fccd780de89b9c29b9697f69ac3553e39bc388d49b83"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$s1 = "KillById"
		$s2 = "KillByName"
		$s3 = "SignalRHub"
		$s4 = "ExecUseShell"
		$s5 = "ExecAndKeepAlive"
		$s6 = "SendAllDirectoryWithStartPath"
		$s7 = "AppLiveDirectorySendHard"
		$s8 = "AppLiveDirectorySendScreen"

	condition:
		4 of them
}
rule ELASTIC_Windows_Trojan_Pony_D5516Fe8 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Pony (Windows.Trojan.Pony)"
		author = "Elastic Security"
		id = "d5516fe8-3b25-4c46-9e5b-111ca312a824"
		date = "2021-08-14"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Pony.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "423e792fcd00265960877482e8148a0d49f0898f4bbc190894721fde22638567"
		logic_hash = "4a850d32fb28477e7e3fef2dda6ba327b800e2ebcae1a483970cde78f34a4ff7"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "9d4d847f55a693a45179a904efe20afd05a92650ac47fb19ef523d469a33795f"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "\\Global Downloader" ascii fullword
		$a2 = "wiseftpsrvs.bin" ascii fullword
		$a3 = "SiteServer %d\\SFTP" ascii fullword
		$a4 = "%s\\Keychain" ascii fullword
		$a5 = "Connections.txt" ascii fullword
		$a6 = "ftpshell.fsi" ascii fullword
		$a7 = "inetcomm server passwords" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Twistedtinsel_Aa56E527 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Twistedtinsel (Windows.Trojan.TwistedTinsel)"
		author = "Elastic Security"
		id = "aa56e527-df1a-4db7-ad89-187dff5e8745"
		date = "2023-12-06"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_TwistedTinsel.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ef1cbdf9a23ae028a858e1d09529982eaeda61197ae029e091918690d3a86e2e"
		logic_hash = "de31d0a5560baf6b37897eba3a637b00b539f542a2620983c3407a6898e003c7"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "e78a92c34ce7ab5545cd44930839551f72d8b19256d4f3280aad81358233f9eb"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 43 3A 5C 50 72 6F 67 72 61 6D 44 61 74 61 5C 4D 69 63 72 6F 73 6F 66 74 5C 45 64 67 65 55 70 64 61 74 65 5C 4C 6F 67 5C 63 68 75 61 6E 67 6B 6F 75 2E 6C 6F 67 }
		$a2 = { 55 8B EC 83 EC 20 C7 45 EC 01 00 00 00 8B 45 08 8B 48 04 89 4D F4 8B 55 08 8B 02 B9 08 00 00 00 C1 E1 00 8D 54 08 78 89 55 E4 8B 45 E4 83 78 04 00 0F 86 81 01 00 00 8B 4D E4 8B 55 F4 03 11 89 }

	condition:
		any of them
}
rule ELASTIC_Windows_Vulndriver_Rentdrv_B6711B6B : FILE MEMORY {
    meta:
		description = "Detects Windows Vulndriver Rentdrv (Windows.VulnDriver.RentDrv)"
		author = "Elastic Security"
		id = "b6711b6b-50c6-4859-9098-454ac8c86708"
		date = "2024-08-19"
		modified = "2024-09-30"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_VulnDriver_RentDrv.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9165d4f3036919a96b86d24b64d75d692802c7513f2b3054b20be40c212240a5"
		logic_hash = "3b3d66fefb4f0efbc8b86687925eac25284a6efad3acc74ad4a627d975cd5e7b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "241bb2c74d62bb29f09982b87fda4df93d2975db67ebd7831d632fafc8d8a126"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$str1 = "rentdrv_x64.pdb"
		$str2 = "KillProcess"

	condition:
		int16 ( uint32(0x3C)+0x5c)==0x0001 and int16 ( uint32(0x3C)+0x18)==0x020b and all of them
}
rule ELASTIC_Windows_Trojan_Babylonrat_0F66E73B : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Babylonrat (Windows.Trojan.Babylonrat)"
		author = "Elastic Security"
		id = "0f66e73b-7824-46b6-a9e6-5abf018c9ffa"
		date = "2021-09-02"
		modified = "2022-01-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Babylonrat.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "4278064ec50f87bb0471053c068b13955ed9d599434e687a64bf2060438a7511"
		logic_hash = "66223dc9e2ef7330e26c91f0c82c555e96e4c794a637ab2cbe36410f3eca202a"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "3998824e381f51aaa2c81c12d4c05157c642d8aef39982e35fa3e124191640ea"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "BabylonRAT" wide fullword
		$a2 = "Babylon RAT Client" wide fullword
		$a3 = "ping 0 & del \"" wide fullword
		$a4 = "\\%Y %m %d - %I %M %p" wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Hacktool_Sharphound_5Adf9D6D : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Sharphound (Windows.Hacktool.SharpHound)"
		author = "Elastic Security"
		id = "5adf9d6d-b6db-43ea-95bd-e9747b82a36d"
		date = "2022-10-20"
		modified = "2022-11-24"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_SharpHound.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1f74ed6e61880d19e53cde5b0d67a0507bfda0be661860300dcb0f20ea9a45f4"
		logic_hash = "2c9f38187866985109a42ffdf8940b5d195aadd3815b2de952b190d4b0b95c3c"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "53d295223e2330a973f9495a7ca625c1e9429bc5daf7dda1b84b2aaeca5ea898"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$guid0 = "A517A8DE-5834-411D-ABDA-2D0E1766539C" ascii wide nocase
		$guid1 = "90A6822C-4336-433D-923F-F54CE66BA98F" ascii wide nocase
		$print_str0 = "Initializing SharpHound at {time} on {date}" ascii wide
		$print_str1 = "SharpHound completed {Number} loops! Zip file written to {Filename}" ascii wide
		$print_str2 = "[-] Removed DCOM Collection" ascii wide

	condition:
		$guid0 or $guid1 or all of ($print_str*)
}
rule ELASTIC_Windows_Trojan_Smokeloader_4E31426E : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Smokeloader (Windows.Trojan.Smokeloader)"
		author = "Elastic Security"
		id = "4e31426e-d62e-4b6d-911b-4223e1f6adef"
		date = "2021-07-21"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Smokeloader.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1ce643981821b185b8ad73b798ab5c71c6c40e1f547b8e5b19afdaa4ca2a5174"
		logic_hash = "44ac7659964519ae72f83076bcd1b3e5244eb9cadd9a3b123dda78b0e9e07424"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "cf6d8615643198bc53527cb9581e217f8a39760c2e695980f808269ebe791277"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 5B 81 EB 34 10 00 00 6A 30 58 64 8B 00 8B 40 0C 8B 40 1C 8B 40 08 89 85 C0 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Smokeloader_4Ee15B92 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Smokeloader (Windows.Trojan.Smokeloader)"
		author = "Elastic Security"
		id = "4ee15b92-c62f-42d2-bbba-1dac2fa5644f"
		date = "2022-02-17"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Smokeloader.yar#L21-L39"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "09b9283286463b35ea2d5abfa869110eb124eb8c1788eb2630480d058e82abf2"
		logic_hash = "7d5ba6a4cc1f1b87f7ea1963b41749f5488197ea28b31f20a235091236250463"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "5d2ed385c76dbb4c1c755ae88b68306086a199a25a29317ae132bc874b253580"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 24 34 30 33 33 8B 45 F4 5F 5E 5B C9 C2 10 00 55 89 E5 83 EC }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Smokeloader_Ea14B2A5 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Smokeloader (Windows.Trojan.Smokeloader)"
		author = "Elastic Security"
		id = "ea14b2a5-ea0d-4da2-8190-dbfcda7330d9"
		date = "2023-05-03"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Smokeloader.yar#L41-L60"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "15fe237276b9c2c6ceae405c0739479d165b406321891c8a31883023e7b15d54"
		logic_hash = "8a96985902f82979f1512d4d30cfa41fd23562b8f86bf2f722351ef2adf4365f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "950ce9826fdff209b6e03c70a4f78b812d211a2a9de84bec0e5efe336323001b"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { AC 41 80 01 AC 41 80 00 AC 41 80 00 AC 41 C0 00 AC 41 80 01 }
		$a2 = { AC 41 80 00 AC 41 80 07 AC 41 80 00 AC 41 80 00 AC 41 80 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Smokeloader_De52Ed44 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Smokeloader (Windows.Trojan.Smokeloader)"
		author = "Elastic Security"
		id = "de52ed44-062c-4b0d-9a41-1bfc31a8daa9"
		date = "2023-05-04"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Smokeloader.yar#L62-L81"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c689a384f626616005d37a94e6a5a713b9eead1b819a238e4e586452871f6718"
		logic_hash = "95a60079a316016ca3f78f18e7920b962f5770bef4211dd70e37f45bbe069406"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "950db8f87a81ef05cc2ecbfa174432ab31a3060c464836f3b38448bd8e5801be"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 08 31 FF 89 7D CC 66 8C E8 66 85 C0 74 03 FF 45 CC FF 53 48 }
		$a2 = { B0 8F 45 C8 8D 45 B8 89 38 8D 4D C8 6A 04 57 6A 01 51 57 57 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Smokeloader_Bf391Fe0 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Smokeloader (Windows.Trojan.Smokeloader)"
		author = "Elastic Security"
		id = "bf391fe0-7e7f-4f29-8a8c-c13aa2c1eef1"
		date = "2024-08-27"
		modified = "2024-09-30"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Smokeloader.yar#L83-L102"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "fe2489230d024f5e0e7d0da0210f93e70248dc282192c092cbb5e0eddc7bd528"
		logic_hash = "8a697596f8aa9a2af230b294c64ee844fcb593814a070ebf10e084c18e7f5ac7"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "513355978aca1f1dd21c199c7fbf72a59639ad08d0c8712d7d076a67da737ab5"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 8A 54 3C 18 0F B6 C2 03 F0 23 F1 8A 44 34 18 88 44 3C 18 88 54 34 18 0F B6 4C 3C 18 }
		$b = { 8D 87 77 05 00 00 50 8B 44 24 18 05 36 01 00 00 50 }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Smokeloader_A01Aa3Ab : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Smokeloader (Windows.Trojan.Smokeloader)"
		author = "Elastic Security"
		id = "a01aa3ab-b1d8-4cd1-8349-ff105e285f5d"
		date = "2024-08-27"
		modified = "2024-09-30"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Smokeloader.yar#L104-L123"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "3a189a736cfdfbb1e3789326c35cecfa901a2adccc08c66c5de1cac8e4c1791b"
		logic_hash = "385f93a98e71f8e78e2f916775bd8db182842c8439a2f15238780388b63e2e91"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "75b4fd2ace9aa87dab9fef950171a566bed8355ae4f7076755fa5293c68936a6"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 83 A6 43 0C 00 00 00 83 A6 3F 0C 00 00 00 45 33 C9 45 8D 41 04 33 D2 33 C9 }
		$b = { 42 0F B6 14 0C 41 8D 04 12 44 0F B6 D0 42 8A 04 14 42 88 04 0C 42 88 14 14 42 0F B6 }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Smokeloader_62Eb5427 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Smokeloader (Windows.Trojan.Smokeloader)"
		author = "Elastic Security"
		id = "62eb5427-0488-4c6c-aefc-00f4120bd2a9"
		date = "2024-08-27"
		modified = "2024-09-30"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Smokeloader.yar#L125-L145"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "21e7fcce8ffb7826108800b6aee21d6b8ea9275975b639ed5ca9f8ddd747329e"
		logic_hash = "e3c70731792a8fbf0b08443f6df3c42f44a548fa9d19be7ee98c677952600e5b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "eb9b8149997deb5701c51d6cac58e03a111c23cba2cc1bb4abcfaa56f201cc08"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { C7 45 FC 00 00 00 00 8B 45 08 03 40 3C 8B 40 78 03 45 08 50 8B 48 18 8B 50 20 03 55 08 }
		$b = { 8B 7D F4 89 F1 B8 19 04 00 00 F2 66 AF }
		$c = { C7 44 05 D0 53 6C 65 65 8B 45 C8 83 C0 04 89 45 C8 }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Raspberryrobin_4B4D6899 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Raspberryrobin (Windows.Trojan.RaspberryRobin)"
		author = "Elastic Security"
		id = "4b4d6899-bcde-4c40-90c9-bbb621aa1ebf"
		date = "2023-12-13"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_RaspberryRobin.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "2f0451f38adb74cb96c857de455887b00c5038b68210294c7f52b0b5ff64cc1e"
		logic_hash = "bbafad9509b367e811e86cb8f2f64d9c1d59f82b5cd58a7af43325bb7fa9d9c3"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f74bd83ba1ede9b1dce070967aedc7f8df923c7393c69fcf7c4cfcf7988e0f24"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 55 89 E5 83 EC 0C 8B 45 08 3D 01 00 10 00 89 45 FC 89 4D F8 73 0F 8B 45 FC 89 45 F4 8B 4D F4 64 8B 11 89 55 F8 8B 45 F8 83 C4 0C 5D C3 }

	condition:
		all of them
}
rule ELASTIC_Windows_Vulndriver_Ccprotect_0D3Ee86F : FILE MEMORY {
    meta:
		description = "Detects Windows Vulndriver Ccprotect (Windows.VulnDriver.CCProtect)"
		author = "Elastic Security"
		id = "0d3ee86f-c15e-4f6c-ae2c-56e309b20519"
		date = "2024-09-09"
		modified = "2024-09-30"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_VulnDriver_CCProtect.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "5f0cfe8357bb52b45068ddbac053e32bc38e6cb5e086746f5402657b0a5cfb1c"
		logic_hash = "4da5cf6b5cd00f8f7ba6daf8e8b4c6161cf9e0166dea39943b32a54f35dfd6c2"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "84812f5aada840c4a0ae96a5a269a48cec215927211227bd362bed7e143e37eb"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$pdb = "\\CcProtect.pdb"
		$original_filename = { 4F 00 72 00 69 00 67 00 69 00 6E 00 61 00 6C 00 46 00 69 00 6C 00 65 00 6E 00 61 00 6D 00 65 00 00 00 43 00 63 00 50 00 72 00 6F 00 74 00 65 00 63 00 74 00 2E 00 73 00 79 00 73 00 00 }
		$file_version = { 46 00 69 00 6C 00 65 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00 00 00 00 00 31 00 2E 00 ( 30 | 31 | 32 | 33 ) 00 3? 00 00 00 }

	condition:
		int16 ( uint32(0x3C)+0x5c)==0x0001 and all of them
}
rule ELASTIC_Windows_Ransomware_Wannacry_D9855102 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Wannacry (Windows.Ransomware.WannaCry)"
		author = "Elastic Security"
		id = "d9855102-56dc-4e4c-9599-82fa52922b95"
		date = "2022-08-29"
		modified = "2022-09-29"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_WannaCry.yar#L1-L26"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0b7878babbaf7c63d808f3ce32c7306cb785fdfb1ceb73be07fb48fdd091fdfb"
		logic_hash = "5edf6a42c9f20de3819b46f24be243940b79e7e9004fee3d601794ea0b534cf1"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f96f2f0eb3cdf6e882adcad06ad10e375412dec99687b3d38d4dbe9bdde52db5"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "@WanaDecryptor@.exe" wide fullword
		$a2 = ".WNCRY" wide fullword
		$a3 = "$%d worth of bitcoin" fullword
		$a4 = "%d%d.bat" fullword
		$a5 = "This folder protects against ransomware. Modifying it will reduce protection" wide fullword
		$b1 = { 53 55 56 57 FF 15 D0 70 00 10 8B E8 A1 8C DD 00 10 85 C0 75 6A 68 B8 0B 00 00 FF 15 70 70 00 10 }
		$b2 = { A1 90 DD 00 10 53 56 57 85 C0 75 3E 8B 1D 60 71 00 10 8B 3D 70 70 00 10 6A 00 FF D3 83 C4 04 A3 }
		$b3 = { 56 8B 74 24 08 57 8B 3D 70 70 00 10 56 E8 2E FF FF FF 83 C4 04 A3 8C DD 00 10 85 C0 75 09 68 88 }

	condition:
		5 of ($a*) or 1 of ($b*)
}
rule ELASTIC_Windows_Ransomware_Royal_B7D42109 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Royal (Windows.Ransomware.Royal)"
		author = "Elastic Security"
		id = "b7d42109-f327-4ec3-86ac-d1ebb9478860"
		date = "2022-11-04"
		modified = "2022-12-20"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Royal.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "491c2b32095174b9de2fd799732a6f84878c2e23b9bb560cd3155cbdc65e2b80"
		logic_hash = "06f4a1487e97e0b8c1f5df380ab4f90b37ef0a508aba7dac272c16c8371d8143"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ff518f25b39b02769b67c437f38958d14e4e8f50b91f4c73591203da297a5d2a"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Try Royal today and enter the new era of data security" ascii fullword
		$a2 = "If you are reading this, it means that your system were hit by Royal ransomware." ascii fullword
		$a3 = "http://royal"
		$a4 = "\\README.TXT" wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Lockbit_89E64044 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Lockbit (Windows.Ransomware.Lockbit)"
		author = "Elastic Security"
		id = "89e64044-74e4-4679-b6ad-bfb9b264330c"
		date = "2021-08-06"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Lockbit.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0d6524b9a1d709ecd9f19f75fa78d94096e039b3d4592d13e8dbddf99867182d"
		logic_hash = "bd504b078704b9f307a50c8556c143eee061015a9727670137aadc47ae93e2a6"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ec45013d3ecbc39ffce5ac18d5bf8b0d18bcadd66659975b0a9f26bcae0a5b49"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "\\LockBit_Ransomware.hta" wide fullword
		$a2 = "\\Registry\\Machine\\Software\\Classes\\Lockbit\\shell" wide fullword
		$a3 = "%s\\%02X%02X%02X%02X.lock" wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Lockbit_A1C60939 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Lockbit (Windows.Ransomware.Lockbit)"
		author = "Elastic Security"
		id = "a1c60939-e257-420d-87ed-f31f30f2fc2a"
		date = "2021-08-06"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Lockbit.yar#L23-L41"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0d6524b9a1d709ecd9f19f75fa78d94096e039b3d4592d13e8dbddf99867182d"
		logic_hash = "6e6d88251e93f69788ad22fc915133f3ba0267984d6a5004d5ca44dcd9f5f052"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a41fb21e82ee893468393428d655b03ce251d23f34acb54bbf01ae0eb86817bf"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 3C 8B 4C 18 78 8D 04 19 89 45 F8 3B C3 74 70 33 C9 89 4D F4 39 }

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Lockbit_369E1E94 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Lockbit (Windows.Ransomware.Lockbit)"
		author = "Elastic Security"
		id = "369e1e94-3fbb-4828-bb78-89d26e008105"
		date = "2022-07-05"
		modified = "2022-07-18"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Lockbit.yar#L43-L67"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "d61af007f6c792b8fb6c677143b7d0e2533394e28c50737588e40da475c040ee"
		logic_hash = "c34dafc024d85902b85fc3424573abb8781d6fab58edd86c255266db3635ce98"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "9cf4c112c0ee708ae64052926681e8351f1ccefeb558c41e875dbd9e4bdcb5f2"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 66 83 F8 61 72 ?? 66 83 F8 66 77 ?? 66 83 E8 57 EB ?? 66 83 F8 30 72 ?? 66 83 F8 39 77 ?? 66 83 E8 30 EB ?? }
		$a2 = { 8B EC 53 56 57 33 C0 8B 5D ?? 33 C9 33 D2 8B 75 ?? 8B 7D ?? 85 F6 74 ?? 55 8B 6D ?? 8A 54 0D ?? 02 D3 8A 5C 15 ?? 8A 54 1D ?? }
		$a3 = { 53 51 6A ?? 58 0F A2 F7 C1 ?? ?? ?? ?? 0F 95 C0 84 C0 74 ?? 0F C7 F0 0F C7 F2 59 5B C3 6A ?? 58 33 C9 0F A2 F7 C3 ?? ?? ?? ?? 0F 95 C0 84 C0 74 ?? 0F C7 F8 0F C7 FA 59 5B C3 0F 31 8B C8 C1 C9 ?? 0F 31 8B D0 C1 C2 ?? 8B C1 59 5B C3 }
		$b1 = { 6D 00 73 00 65 00 78 00 63 00 68 00 61 00 6E 00 67 00 65 00 00 00 73 00 6F 00 70 00 68 00 6F 00 73 00 }
		$b2 = "LockBit 3.0 the world's fastest and most stable ransomware from 2019" ascii fullword
		$b3 = "http://lockbit"
		$b4 = "Warning! Do not delete or modify encrypted files, it will lead to problems with decryption of files!" ascii fullword

	condition:
		2 of ($a*) or all of ($b*)
}
rule ELASTIC_Windows_Ransomware_Darkside_D7Fc4594 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Darkside (Windows.Ransomware.Darkside)"
		author = "Elastic Security"
		id = "d7fc4594-185c-4afb-986e-5718c0beabf1"
		date = "2021-05-20"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Darkside.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "bfb31c96f9e6285f5bb60433f2e45898b8a7183a2591157dc1d766be16c29893"
		logic_hash = "0083fb64955973e7dbbb35d08cb780fa0b4ff4d064c102dc8f86e29af8358bad"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "90444cd2d3a38296b4979f91345a9999b0032f6c0abee6ff7c15d149b59e5e88"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 5F 30 55 56 BD 0A 00 00 00 8B 07 8B 5F 10 8B 4F 20 8B 57 30 }

	condition:
		any of them
}
rule ELASTIC_Windows_Ransomware_Darkside_Aceac5D9 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Darkside (Windows.Ransomware.Darkside)"
		author = "Elastic Security"
		id = "aceac5d9-fb38-4dca-ab1f-44ee40005d37"
		date = "2021-05-20"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Darkside.yar#L21-L39"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "bfb31c96f9e6285f5bb60433f2e45898b8a7183a2591157dc1d766be16c29893"
		logic_hash = "888ab06b55b07879ee6b9a45c04f1a09c570aeb4be55c698300566d57fd47252"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "521b0f574b27151ad03fc7693fd692e1a13e81a28e39d04d3f7ea149a0da59b9"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 41 54 55 53 48 83 EC 28 48 8B 1F 4C 8B 66 08 48 8D 7C 24 10 4C }

	condition:
		any of them
}
rule ELASTIC_Windows_Hacktool_Mimikatz_1388212A : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Mimikatz (Windows.Hacktool.Mimikatz)"
		author = "Elastic Security"
		id = "1388212a-2146-4565-b93d-4555a110364f"
		date = "2021-04-13"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_Mimikatz.yar#L1-L43"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "66b4a0681cae02c302a9b6f1d611ac2df8c519d6024abdb506b4b166b93f636a"
		logic_hash = "1b717453810455e3f530e399f5f9f163d1ad0d71a5464fa5c68aa82edd699cda"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "dbbdc492c07e3b95d677044751ee4365ec39244e300db9047ac224029dfe6ab7"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "   Password: %s" wide fullword
		$a2 = "  * Session Key   : 0x%08x - %s" wide fullword
		$a3 = "   * Injecting ticket : " wide fullword
		$a4 = " ## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )" wide fullword
		$a5 = "Remove mimikatz driver (mimidrv)" wide fullword
		$a6 = "mimikatz(commandline) # %s" wide fullword
		$a7 = "  Password: %s" wide fullword
		$a8 = " - SCardControl(FEATURE_CCID_ESC_COMMAND)" wide fullword
		$a9 = " * to 0 will take all 'cmd' and 'mimikatz' process" wide fullword
		$a10 = "** Pass The Ticket **" wide fullword
		$a11 = "-> Ticket : %s" wide fullword
		$a12 = "Busylight Lync model (with bootloader)" wide fullword
		$a13 = "mimikatz.log" wide fullword
		$a14 = "Log mimikatz input/output to file" wide fullword
		$a15 = "ERROR kuhl_m_dpapi_masterkey ; kull_m_dpapi_unprotect_domainkey_with_key" wide fullword
		$a16 = "ERROR kuhl_m_lsadump_dcshadow ; unable to start the server: %08x" wide fullword
		$a17 = "ERROR kuhl_m_sekurlsa_pth ; GetTokenInformation (0x%08x)" wide fullword
		$a18 = "ERROR mimikatz_doLocal ; \"%s\" module not found !" wide fullword
		$a19 = "Install and/or start mimikatz driver (mimidrv)" wide fullword
		$a20 = "Target: %hhu (0x%02x - %s)" wide fullword
		$a21 = "mimikatz Ho, hey! I'm a DC :)" wide fullword
		$a22 = "mimikatz service (mimikatzsvc)" wide fullword
		$a23 = "[masterkey] with DPAPI_SYSTEM (machine, then user): " wide fullword
		$a24 = "$http://blog.gentilkiwi.com/mimikatz 0" ascii fullword
		$a25 = " * Username : %wZ" wide fullword

	condition:
		3 of ($a*)
}
rule ELASTIC_Windows_Hacktool_Mimikatz_674Fd079 : FILE MEMORY {
    meta:
		description = "Detection for default mimikatz memssp module"
		author = "Elastic Security"
		id = "674fd079-f7fe-4d89-87e7-ac11aa21c9ed"
		date = "2021-04-14"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_Mimikatz.yar#L45-L77"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "66b4a0681cae02c302a9b6f1d611ac2df8c519d6024abdb506b4b166b93f636a"
		logic_hash = "f63f3de05dd4f4f40cda6df67b75e37d7baa82c4b4cafd3ebdca35adfb0b15f8"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b8f71996180e5f03c10e39eb36b2084ecaff78d7af34bd3d0d75225d2cfad765"
		threat_name = "Windows.Hacktool.Mimikatz"
		severity = 99
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 44 30 00 38 00 }
		$a2 = { 48 78 00 3A 00 }
		$a3 = { 4C 25 00 30 00 }
		$a4 = { 50 38 00 78 00 }
		$a5 = { 54 5D 00 20 00 }
		$a6 = { 58 25 00 77 00 }
		$a7 = { 5C 5A 00 5C 00 }
		$a8 = { 60 25 00 77 00 }
		$a9 = { 64 5A 00 09 00 }
		$a10 = { 6C 5A 00 0A 00 }
		$a11 = { 68 25 00 77 00 }
		$a12 = { 68 25 00 77 00 }
		$a13 = { 6C 5A 00 0A 00 }
		$b1 = { 6D 69 6D 69 C7 84 24 8C 00 00 00 6C 73 61 2E C7 84 24 90 00 00 00 6C 6F 67 }

	condition:
		all of ($a*) or $b1
}
rule ELASTIC_Windows_Hacktool_Mimikatz_355D5D3A : FILE MEMORY {
    meta:
		description = "Detection for Invoke-Mimikatz"
		author = "Elastic Security"
		id = "355d5d3a-e50e-4614-9a84-0da668c40852"
		date = "2021-04-14"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_Mimikatz.yar#L79-L112"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "945245ca795e0a3575ee4fdc174df9d377a598476c2bf4bf0cdb0cde4286af96"
		logic_hash = "c6b48ab2cc92deb507d7eead1fb6381ee40b698e84d9eaac45288f95dbda66b3"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "9a23845ec9852d2490171af111612dc257a6b21ad7fdfd8bf22d343dc301d135"
		threat_name = "Windows.Hacktool.Mimikatz"
		severity = 90
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "$PEBytes32 = \"TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAEAAA4fug4AtAnNIbgBTM0hVGhpcyBwc"
		$a2 = "$PEBytes64 = \"TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAEAAA4fug4AtAnNIbgBTM0hVGhpcyBwc"
		$b1 = "Write-BytesToMemory -Bytes $Shellcode"
		$b2 = "-MemoryAddress $GetCommandLineWAddrTemp"
		$b3 = "-MemoryAddress $GetCommandLineAAddrTemp"
		$c1 = "Invoke-Command -ScriptBlock $RemoteScriptBlock -ArgumentList @($PEBytes64, $PEBytes32, \"Void\", 0, \"\", $ExeArgs)" fullword
		$c2 = "Invoke-Command -ScriptBlock $RemoteScriptBlock -ArgumentList @($PEBytes64, $PEBytes32, \"Void\", 0, \"\", $ExeArgs) -ComputerNam"
		$c3 = "at: http://blog.gentilkiwi.com"
		$c4 = "on the local computer to dump certificates."
		$c5 = "Throw \"Unable to write shellcode to remote process memory.\"" fullword
		$c6 = "-Command \"privilege::debug exit\" -ComputerName \"computer1\""
		$c7 = "dump credentials without"
		$c8 = "#The shellcode writes the DLL address to memory in the remote process at address $LoadLibraryARetMem, read this memory" fullword
		$c9 = "two remote computers to dump credentials."
		$c10 = "#If a remote process to inject in to is specified, get a handle to it" fullword

	condition:
		(1 of ($a*) or 2 of ($b*)) or 5 of ($c*)
}
rule ELASTIC_Windows_Hacktool_Mimikatz_1Ff74F7E : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Mimikatz (Windows.Hacktool.Mimikatz)"
		author = "Elastic Security"
		id = "1ff74f7e-ec5a-45ae-b51b-2f8205445cc8"
		date = "2023-05-09"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_Mimikatz.yar#L156-L175"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1b6aad500d45de7b076942d31b7c3e77487643811a335ae5ce6783368a4a5081"
		logic_hash = "f47f760b4c373a073399c69681e76eb9dde6cfdb36c1cc31d7131376493931c0"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "6775be439ad1822bcaa04ed2d392143616746cfd674202aa29773c98642346f4"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 74 65 48 8B 44 24 28 0F B7 80 E0 00 00 00 83 F8 10 75 54 48 8B 44 }
		$a2 = { 74 69 48 8B 44 24 28 0F B7 80 D0 00 00 00 83 F8 10 75 58 48 8B 44 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Tofsee_26124Fe4 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Tofsee (Windows.Trojan.Tofsee)"
		author = "Elastic Security"
		id = "26124fe4-f2a1-4fc9-8155-585b581476de"
		date = "2022-03-31"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Tofsee.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "e658fe6d3bd685f41eb0527432099ee01075bfdb523ef5aa3e5ebd42221c8494"
		logic_hash = "e765953dec7c7b2a1fbebf92c2fff46453c8258722ad5ca92ba4c7526a8b0c66"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "dc7ada5c6341e98bc41182a5698527b1649c4e80924ba0405f1b94356f63ff31"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 55 8B EC 8B 45 ?? 57 8B 7D ?? B1 01 85 FF 74 ?? 56 8B 75 ?? 2B F0 8A 14 06 32 55 ?? 88 10 8A D1 02 55 ?? F6 D9 00 55 ?? 40 4F 75 ?? 5E 8B 45 ?? 5F 5D C3 }
		$b = { 8B 44 24 ?? 53 8A 18 84 DB 74 ?? 8B D0 2B 54 24 ?? 8B 4C 24 ?? 84 DB 74 ?? 8A 19 84 DB 74 ?? 38 1C 0A 75 ?? 41 80 3C 0A 00 75 ?? 80 39 00 74 ?? 40 8A 18 42 84 DB 75 ?? 33 C0 5B C3 }

	condition:
		any of them
}
rule ELASTIC_Windows_Ransomware_Conti_89F3F6Fa : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Conti (Windows.Ransomware.Conti)"
		author = "Elastic Security"
		id = "89f3f6fa-492c-40e3-a4aa-a526004197b2"
		date = "2021-08-05"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Conti.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "eae876886f19ba384f55778634a35a1d975414e83f22f6111e3e792f706301fe"
		logic_hash = "4c1834e45d5e42f466249b75a89561ce1e88b9e3c07070e2833d4897fbed22ee"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a82331eba3cbd52deb4bed5e11035ac1e519ec27931507f582f2985865c0fb1a"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { F7 FE 88 57 FF 83 EB 01 75 DA 8B 45 FC 5F 5B 40 5E 8B E5 5D C3 8D }

	condition:
		all of them
}
rule ELASTIC_Windows_Hacktool_Sleepobfloader_460A1A75 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Sleepobfloader (Windows.Hacktool.SleepObfLoader)"
		author = "Elastic Security"
		id = "460a1a75-7242-41d6-8b39-51f2f0276a33"
		date = "2024-01-24"
		modified = "2024-01-29"
		reference = "https://www.elastic.co/security-labs/unmasking-financial-services-intrusion-ref0657"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_SleepObfLoader.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "84b3bc58ec04ab272544d31f5e573c0dd7812b56df4fa445194e7466f280e16d"
		logic_hash = "c0bc1b7ef71c1a91fc487f904315c6f187530ab39825f90f55ac36625d5b93cf"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "8dbba5af9f379ac16a79b4989067b8715e084490ae2f048eb3a28d8d33c716e9"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { BA 01 00 00 00 41 B8 20 01 00 00 8B 48 3C 8B 4C 01 28 48 03 C8 48 89 0D ?? ?? ?? ?? FF ?? ?? ?? ?? ?? 48 8D 15 ?? ?? ?? ?? B9 01 00 00 00 }
		$b = { 8A 50 20 83 60 24 F0 80 E2 F8 48 8B ?? ?? ?? 4C 8B ?? ?? ?? 48 89 08 48 8B ?? ?? ?? 48 89 48 08 }
		$c = { 8B 46 FB 41 89 40 18 0F B7 46 FF 66 41 89 40 1C 8A 46 01 41 88 40 1E }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Netwire_6A7Df287 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Netwire (Windows.Trojan.Netwire)"
		author = "Elastic Security"
		id = "6a7df287-1656-4779-9a96-c0ab536ae86a"
		date = "2021-06-28"
		modified = "2021-08-23"
		reference = "https://www.elastic.co/security-labs/netwire-dynamic-configuration-extraction"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Netwire.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "e6f446dbefd4469b6c4d24988dd6c9ccd331c8b36bdbc4aaf2e5fc49de2c3254"
		logic_hash = "d5f36e2a81cf0a9037267d39266b4c31ca9c07b05fb9772e296aeac2da6051a5"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "85051a0b94da4388eaead4c4f4b2d16d4a5eb50c3c938b3daf5c299c9c12f1e6"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 0F B6 74 0C 10 89 CF 29 C7 F7 C6 DF 00 00 00 74 09 41 89 F3 88 5C }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Netwire_1B43Df38 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Netwire (Windows.Trojan.Netwire)"
		author = "Elastic Security"
		id = "1b43df38-886e-4f58-954a-a09f30f19907"
		date = "2021-06-28"
		modified = "2021-08-23"
		reference = "https://www.elastic.co/security-labs/netwire-dynamic-configuration-extraction"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Netwire.yar#L22-L43"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "e6f446dbefd4469b6c4d24988dd6c9ccd331c8b36bdbc4aaf2e5fc49de2c3254"
		logic_hash = "bb0eb1c1969bc1416e933822843293c5d41bf9bc3d402fa5dbdc3cdf2f4b394a"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "4142ea14157939dc23b8d1f5d83182aef3a5877d2506722f7a2706b7cb475b76"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "[%.2d/%.2d/%d %.2d:%.2d:%.2d]" fullword
		$a2 = "\\Login Data"
		$a3 = "SOFTWARE\\NetWire" fullword

	condition:
		2 of them
}
rule ELASTIC_Windows_Trojan_Netwire_F85E4Abc : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Netwire (Windows.Trojan.Netwire)"
		author = "Elastic Security"
		id = "f85e4abc-f2d7-491b-a1ad-a59f287e5929"
		date = "2022-08-14"
		modified = "2022-09-29"
		reference = "https://www.elastic.co/security-labs/netwire-dynamic-configuration-extraction"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Netwire.yar#L45-L64"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ab037c87d8072c63dc22b22ff9cfcd9b4837c1fee2f7391d594776a6ac8f6776"
		logic_hash = "af8fc8fff2e1a0b6c87ac6d24fecf2e1cefe6313ec66da13fddd1be25c1c3d92"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "66cae88c9f8b975133d2b3af94a869244d273021261815b15085c638352bf2ca"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { C9 0F 44 C8 D0 EB 8A 44 24 12 0F B7 C9 75 D1 32 C0 B3 01 8B CE 88 44 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Netwire_F42Cb379 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Netwire (Windows.Trojan.Netwire)"
		author = "Elastic Security"
		id = "f42cb379-ac8c-4790-a6d3-aad6dc4acef6"
		date = "2022-08-14"
		modified = "2022-09-29"
		reference = "https://www.elastic.co/security-labs/netwire-dynamic-configuration-extraction"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Netwire.yar#L66-L90"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ab037c87d8072c63dc22b22ff9cfcd9b4837c1fee2f7391d594776a6ac8f6776"
		logic_hash = "fc1436596987d3971a464e707ee6fd5689e7d2800df471c125c1e3f748537f5d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a52d2be082d57d07ab9bb9087dd258c29ef0528c4207ac6b31832f975a1395b6"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "http://%s%ComSpec" ascii fullword
		$a2 = "%c%.8x%s" ascii fullword
		$a3 = "%6\\6Z65dlNh\\YlS.dfd" ascii fullword
		$a4 = "GET %s HTTP/1.1" ascii fullword
		$a5 = "R-W65: %6:%S" ascii fullword
		$a6 = "PTLLjPq %6:%S -qq9/G.y" ascii fullword

	condition:
		4 of them
}
rule ELASTIC_Windows_PUP_Veriato_Fae5978C : FILE MEMORY {
    meta:
		description = "Detects Windows Pup Veriato (Windows.PUP.Veriato)"
		author = "Elastic Security"
		id = "fae5978c-f26c-4215-9407-d16e492ab5c1"
		date = "2022-06-08"
		modified = "2022-09-29"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_PUP_Veriato.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "53f09e60b188e67cdbf28bda669728a1f83d47b0279debf3d0a8d5176479d17f"
		logic_hash = "8ae6f8b2b6e3849b33e6a477af52982efe137d7ebeff0c92cee5667d75f05145"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "8d351cdd11d6dddc76cd89e7de9e65b28ef5c8183db804b2a450095e2f3214e5"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$s1 = "InitializeDll" fullword
		$a1 = "C:\\Windows\\winipbin\\svrltmgr.dll" fullword
		$a2 = "C:\\Windows\\winipbin\\svrltmgr64.dll" fullword

	condition:
		$s1 and ($a1 or $a2)
}
rule ELASTIC_Windows_Hacktool_Sharpersist_06606812 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Sharpersist (Windows.Hacktool.Sharpersist)"
		author = "Elastic Security"
		id = "06606812-2be2-4155-a82b-6ab4629c5b5a"
		date = "2022-10-20"
		modified = "2022-11-24"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_SharPersist.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "e9711f47cf9171f79bf34b342279f6fd9275c8ae65f3eb2c6ebb0b8432ea14f8"
		logic_hash = "ddabfb54422f6fb2ad6999b724b1d8f186adf71f96f01a8770715029529e869a"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "44fd3f1146d81c34051f8ef4619db369d364e809799e7ca57bea93fb8fef5d4c"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$guid = "9D1B853E-58F1-4BA5-AEFC-5C221CA30E48" ascii wide nocase
		$print_str0 = "schtaskbackdoor: backdoor scheduled task" ascii wide
		$print_str1 = "schtaskbackdoor -m list -n <schtask name>" ascii wide
		$print_str2 = "SharPersist" ascii wide
		$print_str3 = "[+] SUCCESS: Keepass persistence backdoor added" ascii wide

	condition:
		$guid or all of ($print_str*)
}
rule ELASTIC_Windows_Trojan_Ghostpulse_A1311F49 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Ghostpulse (Windows.Trojan.GhostPulse)"
		author = "Elastic Security"
		id = "a1311f49-65a7-4136-a5ab-28cf4de4d40f"
		date = "2023-10-06"
		modified = "2023-10-26"
		reference = "https://www.elastic.co/security-labs/ghostpulse-haunts-victims-using-defense-evasion-bag-o-tricks"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_GhostPulse.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0175448655e593aa299278d5f11b81f2af76638859e104975bdb5d30af5c0c11"
		logic_hash = "21838f230ac1a77f09d01d30f4ea3b66313618660e63ab7012b030e0b819547e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e07a8152ab75624aa8dd0a8301d690a6a4bdd3b0e069699632541fb6a32e419b"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 0F BE 00 48 0F BE C0 85 C0 74 0D B8 01 00 00 00 03 45 00 89 45 00 EB E1 8B 45 00 48 8D 65 10 5D C3 }
		$a2 = { 88 4C 24 08 48 83 EC 18 0F B6 44 24 20 88 04 24 0F BE 44 24 20 83 F8 41 7C 13 0F BE 04 24 83 F8 5A 7F 0A 0F BE 04 24 83 C0 20 88 04 24 }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Ghostpulse_3Fe1D02D : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Ghostpulse (Windows.Trojan.GhostPulse)"
		author = "Elastic Security"
		id = "3fe1d02d-5de3-42df-8389-6a55fc2b8afd"
		date = "2023-10-12"
		modified = "2023-10-26"
		reference = "https://www.elastic.co/security-labs/ghostpulse-haunts-victims-using-defense-evasion-bag-o-tricks"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_GhostPulse.yar#L23-L41"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "4ef78d436a153ed751a8483c1e43ec2ba053dedfa0da2780fded42012d3042c1"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "18aed348ba64bee842fb6af3b3220e108052a67f49724cf34ba52c8ec7c15cac"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 48 89 5C 24 08 48 89 7C 24 10 8B DA 45 33 D2 48 8B F9 41 2B D9 74 50 4C 8B D9 4C 2B C1 0F 1F 00 33 C9 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Ghostpulse_3673D337 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Ghostpulse (Windows.Trojan.GhostPulse)"
		author = "Elastic Security"
		id = "3673d337-218b-4ea8-93f5-ecbc6fe51885"
		date = "2023-12-11"
		modified = "2024-01-12"
		reference = "https://www.elastic.co/security-labs/ghostpulse-haunts-victims-using-defense-evasion-bag-o-tricks"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_GhostPulse.yar#L43-L63"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "3013ba32838f6d97d7d75e25394f9611b1c5def94d93588f0a05c90b25b7d6d5"
		logic_hash = "a92815f27533338e17afd5ebdbe82e382636fb81167a82d1b613c0dccc5b7ed3"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0b46a0e04ab2ca2760b2ace397a09b681bc6c0da5581c3f0f5cdb1a60f307a15"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$IDAT_parser_x86 = { 80 F9 3F 75 ?? 38 54 1E 02 74 ?? 80 FA 3F 75 ?? 38 6C 1E 03 74 ?? 80 FD 3F 75 ?? 8A 74 24 04 38 74 1E 04 }
		$IDAT_parser_x64 = { 80 FB 3F 0F 94 44 24 27 3C 3F 0F 94 44 24 30 40 80 FF 3F 0F 94 44 24 31 41 80 FD 3F 0F 94 44 24 32 41 80 FC 3F 0F 94 44 24 33 }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Ghostpulse_8Ae8310B : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Ghostpulse (Windows.Trojan.GhostPulse)"
		author = "Elastic Security"
		id = "8ae8310b-4ead-4b5c-be73-7db365470891"
		date = "2024-05-27"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_GhostPulse.yar#L65-L84"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "5b64f91b41a7390d89cd3b1fccf02b08b18b7fed17a43b0bfac63d75dc0df083"
		logic_hash = "b3873a3c728e98d65984033620c0ac8ee93be21db5b6d9bd4665b9f7d0d759fa"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "61213fd4ce9ddebdc7de8e6b23827347af3cbddd61254f95917e9af6b8a2b7b2"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 48 8B 84 24 ?? 0D 00 00 8B 40 14 0F BA E8 09 48 8B 8C 24 ?? 0D 00 00 89 41 14 48 8B 84 24 ?? 0D 00 00 48 8B 8C 24 ?? 05 00 00 48 89 88 C0 ?? 00 00 }
		$b = { BA C8 90 F0 B2 48 8B ?? ?? ?? E8 ?? ?? ?? 00 48 89 ?? ?? ?? 07 00 00 BA 9C 6C DA DC 48 8B ?? ?? ?? E8 ?? ?? ?? 00 48 89 ?? ?? ?? 07 00 00 BA 8D 20 4A A1 48 8B ?? ?? ?? E8 ?? ?? ?? 00 48 89 ?? ?? ?? 07 00 00 BA D4 7C 1A A8 }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Ghostpulse_9E22C56D : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Ghostpulse (Windows.Trojan.GhostPulse)"
		author = "Elastic Security"
		id = "9e22c56d-91bf-4259-8b60-aa7323b5e8f9"
		date = "2024-07-21"
		modified = "2024-07-26"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_GhostPulse.yar#L86-L106"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "349b4dfa1e93144b010affba926663264288a5cfcb7b305320f466b2551b93df"
		logic_hash = "5dbd0d6a936a73e933181017c67c36fde7576b47643ec00848f7b58170bd9c6b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "5e9883ad58fee79960a6e5e3c266885c6dc72057a16f4ea0e371088571e9b663"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { C7 44 24 28 80 3C 36 FE C7 44 24 2C FF FF FF FF 53 6A 00 }
		$b = { 80 7C 24 04 3F ?? ?? 8A 74 24 08 38 74 1E 05 8A 6C 24 10 ?? ?? 80 7C 24 08 3F }
		$c = { 89 41 5C 8B 44 24 ?? 8B 80 04 01 00 00 89 44 24 ?? 8B 42 3C 8B 44 02 78 8B 4C 02 20 01 D1 89 4C 24 ?? 8B 4C 02 1C 89 4C 24 ?? 8B 44 02 24 89 44 }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Ghostpulse_Bb38Fcb3 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Ghostpulse (Windows.Trojan.GhostPulse)"
		author = "Elastic Security"
		id = "bb38fcb3-c781-4fcd-9f1d-ae20da565365"
		date = "2024-10-15"
		modified = "2024-10-24"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_GhostPulse.yar#L108-L127"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b54d9db283e6c958697bfc4f97a5dd0ba585bc1d05267569264a2d700f0799ae"
		logic_hash = "95a7f663f0bac81a5426d722ec95e11f37fcde45cbf8ebd4e32b9f4c72873c2b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b2e96e25b7c663a3b8902f4d0413cef3563a57c517219443896e3ed8630eab94"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$stage_1 = { 49 63 D0 42 8B 0C 0A 41 03 CA 89 0C 1A 8B 05 ?? ?? ?? ?? 44 03 C0 8B 05 ?? ?? ?? ?? 44 3B C0 }
		$stage_2 = { 48 89 01 48 8B 84 24 D8 00 00 00 48 8B 4C 24 78 8B 49 0C 89 08 C7 44 24 44 00 00 00 00 }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Ghostpulse_Caea316B : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Ghostpulse (Windows.Trojan.GhostPulse)"
		author = "Elastic Security"
		id = "caea316b-6896-40ca-87fc-1daae5ce8b9a"
		date = "2024-10-10"
		modified = "2024-10-24"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_GhostPulse.yar#L129-L147"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "454e898405a10ecc06b4243c25f86c855203722a4970dee4c4e1a4e8e75f5137"
		logic_hash = "740dad0ce9d6b7c5a4125db9c6ad36e767bacba478ee627032b7fe00431c6d7b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "71cc7e628aa6d189907cd320585b46cb73415ba60811c607951fb8398173a491"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 48 83 EC 18 C7 04 24 00 00 00 00 8B 04 24 48 8B 4C 24 20 0F B7 04 41 85 C0 74 0A 8B 04 24 FF C0 89 04 24 EB E6 C7 44 24 08 00 00 00 00 8B 04 24 FF C8 8B C0 48 8B 4C 24 20 0F B7 04 41 83 F8 5C }

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Helloxd_0C50F01B : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Helloxd (Windows.Ransomware.Helloxd)"
		author = "Elastic Security"
		id = "0c50f01b-5f3d-4112-9930-ca1150fc12fa"
		date = "2022-06-14"
		modified = "2022-07-18"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Helloxd.yar#L1-L26"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "435781ab608ff908123d9f4758132fa45d459956755d27027a52b8c9e61f9589"
		logic_hash = "71e09fa1a00fa6f3688129ee2b2a8957b84f64ef51fcba5123a6a9df80a9c7e1"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "462d8c231d608e28e66d810b811f9fdf82d0b3770d21267a4375669a26bbaafd"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$mutex = "With best wishes And good intentions..."
		$ransomnote0 = ":: our TOX below >:)"
		$ransomnote1 = "You can download TOX here"
		$ransomnote2 = "...!XD ::"
		$productname = "HelloXD" ascii wide
		$legalcopyright = "uKn0w" ascii wide
		$description = "VhlamAV" ascii wide
		$companyname = "MicloZ0ft" ascii wide

	condition:
		($mutex and all of ($ransomnote*)) or (3 of ($productname,$legalcopyright,$description,$companyname))
}
rule ELASTIC_Windows_Ransomware_Blackhunt_7B46Cb9C : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Blackhunt (Windows.Ransomware.BlackHunt)"
		author = "Elastic Security"
		id = "7b46cb9c-4601-4be0-a2de-6a4f27d1a446"
		date = "2024-03-12"
		modified = "2024-03-21"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_BlackHunt.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6c4e968c9b53906ba0e86a41eccdabe2b736238cb126852023e15850e956293d"
		logic_hash = "97bb8436574fd814d8278e5a7043e011d0e4f9a7dd9df5e67605f28ac1af1e74"
		score = 50
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "1e46e2de840bfd557147e686eb00c350d00f6d1c6b2b8d1df98165c73cbe89ba"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "#BlackHunt_ReadMe.txt" wide fullword
		$a2 = "#BlackHunt_Private.key" wide fullword
		$a3 = "#BlackHunt_ID.txt" wide fullword
		$a4 = "BLACK_HUNT_MUTEX" ascii fullword
		$a5 = "BlackKeys" ascii fullword
		$a6 = "ENCRYPTED VOLUME : %dGB" ascii fullword
		$a7 = "RUNNING TIME : %02dm:%02ds" ascii fullword

	condition:
		4 of them
}
rule ELASTIC_Windows_Trojan_Lumma_693A5234 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Lumma (Windows.Trojan.Lumma)"
		author = "Elastic Security"
		id = "693a5234-de8c-4801-8146-bb4d5378abc5"
		date = "2024-06-05"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Lumma.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "88340abcdc3cfe7574ee044aea44808446daf3bb7bf9fc60b16a2b1360c5d9c0"
		logic_hash = "2b29ac9bc73f191bdbfc92601cab923aa9f2f3380c8123ee469ced3754625dd0"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "9e51b8833b6fffe740f3c9f87a874dbf4d668d68307393b20cf9e4e69e899d3f"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 02 0F B7 16 83 C6 02 66 85 D2 75 EF 66 C7 00 00 00 0F B7 11 }
		$a2 = { 0C 0F B7 4C 24 04 66 89 0F 83 C7 02 39 F7 73 0C 01 C3 39 EB }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Lumma_30608A8C : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Lumma (Windows.Trojan.Lumma)"
		author = "Elastic Security"
		id = "30608a8c-f77e-4a86-b4d7-20e339af223b"
		date = "2024-10-07"
		modified = "2024-10-24"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Lumma.yar#L22-L41"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "672e06b9729da0616b103c19d68b812bed33e3e12c788a584f13925f81d68129"
		logic_hash = "1793a535db3fd7e8ad3db4b2de22efffabbcd3e91d89f36de71e95dc0fa9012f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a8ed2b322f5fab90940227de34ce49cf6f9c0e4c3ae1fd47e55e3bdb6c885ba3"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 8B 4C 24 04 8B 14 24 31 CA F7 D2 21 CA 29 D0 }
		$b = { 89 F1 C1 E9 0C 80 C9 E0 88 08 89 F1 C1 E9 06 80 E1 3F 80 C9 80 88 48 01 80 E2 3F }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Garble_Eae7F2F7 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Garble (Windows.Trojan.Garble)"
		author = "Elastic Security"
		id = "eae7f2f7-49b3-427c-9cf3-cce64d772c78"
		date = "2022-06-08"
		modified = "2022-09-29"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Garble.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "4820a1ec99981e03675a86c4c01acba6838f04945b5f753770b3de4e253e1b8c"
		logic_hash = "5d88579b0f0f71b8b4310c141fb243f39696e158227da0a1e0140b030b783c65"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b72b8d475ef50a5e703d741f195d8ce0916f46ee5744c5bc7c8d452ab23df388"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = ".\"G!-$G#-&J%.(G'-*G)-,J+..G--0G/-2J1.4G3-6G5-8J7.:G9-<G;->J=+@A?-BAA*DAC*FAE*HFG+JAI-LAK*NAM*PAO*RFQ+TAS-VAU9"

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Lobshot_013C1B0B : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Lobshot (Windows.Trojan.Lobshot)"
		author = "Elastic Security"
		id = "013c1b0b-da18-4c09-ab18-5c8428a1f4dc"
		date = "2023-04-18"
		modified = "2023-04-23"
		reference = "https://www.elastic.co/security-labs/elastic-security-labs-discovers-lobshot-malware"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Lobshot.yar#L1-L30"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "e4ea88887753a936eaf3361dcc00380b88b0c210dcbde24f8f7ce27991856bf6"
		logic_hash = "e1fb245c3441c9bd393a47a9bed01bf7f62aa3ec36d460584d75e326e7e92ad4"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e39109421b3e156f814d33f1df327005f808f58f59bfe34ed6190076d7aace4b"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$str0 = "HVNC Remote Control" ascii fullword
		$str1 = " Error # %d - %08lx" ascii fullword
		$str2 = "Set  clipboard text failed." ascii fullword
		$str3 = "OK %08lx %08lx %d" ascii fullword
		$str4 = "\") & (rundll32.exe \"" wide fullword
		$str5 = "%LOCALAPPDATA%\\svc.db" wide fullword
		$str6 = "cmd.exe /c (ping -n 10 127.0.0.1) & (del /F /Q \"" wide fullword
		$seq_str_decrypt = { 8A 5A ?? 8D 52 ?? 80 EB ?? 85 FF 74 ?? C0 E0 ?? 2C ?? 0A C3 32 C1 32 C7 88 06 32 E8 83 C6 ?? 83 C5 ?? EB ?? }
		$seq_emu_check = { 8B 35 ?? ?? ?? ?? 8D 44 24 ?? 50 8D 44 24 ?? C7 44 24 ?? 48 41 4C 39 50 C7 44 24 ?? 54 48 00 00 FF D6 }
		$seq_enum_xor = { FF 15 ?? ?? ?? ?? 84 C0 0F 84 ?? ?? ?? ?? 83 7C 24 ?? 00 0F 84 ?? ?? ?? ?? 8B 4C 24 ?? 68 07 80 00 00 8B 41 ?? 8A 00 32 01 A2 ?? ?? ?? ?? }
		$seq_create_guid = { 8D 48 ?? 80 F9 ?? 77 ?? 2C ?? C1 E2 ?? 46 0F B6 C8 0B D1 83 FE ?? 7C ?? 5F 8B C2 5E C3 }

	condition:
		2 of ($seq*) or 5 of ($str*)
}
rule ELASTIC_Windows_Trojan_Pikabot_8C6750B5 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Pikabot (Windows.Trojan.PikaBot)"
		author = "Elastic Security"
		id = "8c6750b5-d232-4b72-8fe0-3a00f7058420"
		date = "2023-06-05"
		modified = "2023-06-19"
		reference = "https://www.elastic.co/security-labs/pikabot-i-choose-you"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_PikaBot.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "59f42ecde152f78731e54ea27e761bba748c9309a6ad1c2fd17f0e8b90f8aed1"
		logic_hash = "03e36f927513625d1dd997c79843b1b14e344e8411155740213d7aff9794c5c6"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "5995c2857b660d92afc197d8a2b0323f4b4f6a0d65d1aeea5d53353c10e8092a"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$byte_seq0 = { B8 00 00 00 00 CD 2D 90 C3 CC CC CC CC CC CC CC }
		$byte_seq1 = { 64 A1 30 00 00 00 8B 40 ?? C3 }
		$byte_seq2 = { 8B 45 FC 8B 44 85 B4 89 45 F0 8B 45 08 89 45 F8 8B 45 10 C1 E8 02 89 45 F4 }
		$byte_seq3 = { 8B 4C 8D BC ?? 75 FC 33 C0 64 A1 30 00 00 00 8B 40 68 83 E0 70 89 45 FC }
		$byte_seq4 = { 8B 45 F8 8B 4D 0C 89 08 8B 45 F8 83 C0 04 89 45 F8 8B 45 F4 48 89 45 F4 }
		$byte_seq5 = { 64 A1 30 00 00 00 8B 40 0C 8B 40 0C 8B 00 8B 00 8B 40 18 C3 }

	condition:
		4 of them
}
rule ELASTIC_Windows_Trojan_Pikabot_5B220E9C : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Pikabot (Windows.Trojan.PikaBot)"
		author = "Elastic Security"
		id = "5b220e9c-3232-4a86-82b7-31f96c95242c"
		date = "2024-02-06"
		modified = "2024-02-08"
		reference = "https://www.elastic.co/security-labs/pikabot-i-choose-you"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_PikaBot.yar#L27-L52"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "d836b06b0118e6d258e318b1cfdc509cacc0859c6a6b3d7c5f4d2525e00d97b2"
		logic_hash = "1d2158716b7c32734f12f8528352a3872e21fea2f9b21a36d6ac44fcd50a9f3c"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "3a7ba8156f9ad017cdb8630770bf900c198215306a125f6f7dcd845f2c683948"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$byte_seq0 = { 03 44 95 ?? 42 83 FA ?? 7C ?? EB ?? }
		$byte_seq1 = { 3B C1 73 ?? 80 3C 18 ?? 75 ?? C6 04 18 ?? 40 EB ?? }
		$byte_seq2 = { 03 C7 03 C8 0F B6 F9 8A 84 3D 34 FD FF FF 88 84 35 34 FD FF FF }
		$byte_seq3 = { 55 8B EC 83 EC 0C 33 C0 C7 45 F4 05 00 00 00 C7 45 F8 32 00 00 00 8B D0 C7 45 FC C9 FF FF FF }
		$byte_seq4 = { 55 8B EC 51 51 53 56 89 55 F8 89 4D FC 8B 75 FC 8B 45 F8 33 C9 0F A2 89 06 89 5E 04 89 4E 08 89 }
		$byte_seq5 = { 8D 5D E8 59 33 D2 C7 45 F8 04 00 00 00 8A 03 8D 0C 16 43 88 04 39 83 6D F8 01 8D 52 04 75 EE 46 }
		$byte_seq6 = { 55 8B EC 51 51 53 56 89 55 F8 89 4D FC 8B 75 FC 8B 45 F8 33 C9 0F A2 89 06 89 5E 04 89 4E 08 89 }

	condition:
		2 of them
}
rule ELASTIC_Windows_Trojan_Pikabot_5441F511 : FILE MEMORY {
    meta:
		description = "Related to Pikabot core"
		author = "Elastic Security"
		id = "5441f511-82f2-4971-b9ff-7fe739041357"
		date = "2024-02-15"
		modified = "2024-02-21"
		reference = "https://www.elastic.co/security-labs/pikabot-i-choose-you"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_PikaBot.yar#L54-L78"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "fa44408874c6a007212dfc206cbecbac7a3e50df94da4ce02de2e04e9119c79f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "7a90c7e21ebffd6276bd53e37d4a09df29d3d1167024b96a39504518f0a38dfe"
		threat_name = "Windows.Trojan.PikaBot"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$handler_table = { 72 26 [6] 6F 24 [6] CB 0A [6] 6C 03 [6] 92 07 }
		$api_hashing = { 3C 60 76 ?? 83 E8 20 8B 0D ?? ?? ?? ?? 6B FF 21 }
		$debug_check = { A1 ?? ?? ?? ?? FF 50 ?? 50 50 80 7E ?? 01 74 ?? 83 7D ?? 00 75 ?? }
		$checksum = { 55 89 E5 8B 55 08 69 02 E1 10 00 00 05 38 15 00 00 89 02 5D C3 }
		$load_sycall = { 8F 05 ?? ?? ?? ?? 83 C0 04 50 8F 05 ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 C4 04 A3 ?? ?? ?? ?? 31 C0 64 8B 0D C0 00 00 00 85 C9 }
		$read_xbyte_config = { 8B 43 04 8B 55 F4 B9 FC FF FF FF 83 C0 04 29 D1 01 4B 0C 8D 0C 10 89 4B 04 85 F6 ?? ?? 89 16 89 C3 }

	condition:
		2 of them
}
rule ELASTIC_Windows_Trojan_Pikabot_95Db8B5A : FILE MEMORY {
    meta:
		description = "Related to Pikabot loader"
		author = "Elastic Security"
		id = "95db8b5a-f97d-42bd-a114-e35e031784e2"
		date = "2024-02-15"
		modified = "2024-02-21"
		reference = "https://www.elastic.co/security-labs/pikabot-i-choose-you"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_PikaBot.yar#L80-L103"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "74073ceae1b26b953b7644d56a2ec92993b83802a30ce82c6921df5448ebab06"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f9463fa18fc5975aeabf076490bd8fe79c62c822126c5320f90870a9b4032f60"
		threat_name = "Windows.Trojan.PikaBot"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$syscall_ZwQueryInfoProcess = { 68 9B 8B 16 88 E8 73 FF FF FF }
		$syscall_ZwCreateUserProcess = { 68 B2 CE 2E CF E8 5F FF FF FF }
		$load_sycall = { 8F 05 ?? ?? ?? ?? 83 C0 04 50 8F 05 ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 C4 04 A3 ?? ?? ?? ?? 31 C0 64 8B 0D C0 00 00 00 85 C9 }
		$payload_chunking = { 8A 84 35 ?? ?? ?? ?? 8A 95 ?? ?? ?? ?? 88 84 1D ?? ?? ?? ?? 88 94 35 ?? ?? ?? ?? 02 94 1D ?? ?? ?? ?? }
		$loader_rc4_decrypt_chunk = { F7 FF 8A 84 15 ?? ?? ?? ?? 89 D1 8A 94 1D ?? ?? ?? ?? 88 94 0D ?? ?? ?? ?? 8B 55 08 88 84 1D ?? ?? ?? ?? 02 84 0D ?? ?? ?? ?? 0F B6 C0 8A 84 05 ?? ?? ?? ?? 32 04 32 }

	condition:
		2 of them
}
rule ELASTIC_Windows_Ransomware_Ragnarok_1Cab7Ea1 : BETA FILE MEMORY {
    meta:
		description = "Identifies RAGNAROK ransomware"
		author = "Elastic Security"
		id = "1cab7ea1-8d26-4478-ab41-659c193b5baa"
		date = "2020-05-03"
		modified = "2021-08-23"
		reference = "https://twitter.com/malwrhunterteam/status/1256263426441125888?s=20"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Ragnarok.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "8bae3ea4304473209fc770673b680154bf227ce30f6299101d93fe830da0fe91"
		score = 75
		quality = 73
		tags = "BETA, FILE, MEMORY"
		fingerprint = "e2a8eabb08cb99c4999e05a06d0d0dce46d7e6375a72a6a5e69d718c3d54a3ad"
		threat_name = "Windows.Ransomware.Ragnarok"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$c1 = ".ragnarok" ascii wide fullword

	condition:
		1 of ($c*)
}
rule ELASTIC_Windows_Ransomware_Ragnarok_7E802F95 : BETA FILE MEMORY {
    meta:
		description = "Identifies RAGNAROK ransomware"
		author = "Elastic Security"
		id = "7e802f95-964e-4dd9-a5d1-13a6cd73d750"
		date = "2020-05-03"
		modified = "2021-08-23"
		reference = "https://twitter.com/malwrhunterteam/status/1256263426441125888?s=20"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Ragnarok.yar#L22-L42"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "8f293cdbdc3c395e18c304dfa43d0dcdb52b18bde5b5d084190ceec70aea6cbd"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "c62b3706a2024751f1346d0153381ac28057995cf95228e43affc3d1e4ad0fad"
		threat_name = "Windows.Ransomware.Ragnarok"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$d1 = { 68 04 94 42 00 FF 35 A0 77 43 00 }
		$d2 = { 68 90 94 42 00 FF 35 A0 77 43 00 E8 8F D6 00 00 8B 40 10 50 }

	condition:
		1 of ($d*)
}
rule ELASTIC_Windows_Ransomware_Ragnarok_Efafbe48 : BETA FILE MEMORY {
    meta:
		description = "Identifies RAGNAROK ransomware"
		author = "Elastic Security"
		id = "efafbe48-7740-4c21-b585-467f7ad76f8d"
		date = "2020-05-03"
		modified = "2021-08-23"
		reference = "https://twitter.com/malwrhunterteam/status/1256263426441125888?s=20"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Ragnarok.yar#L44-L71"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "c9d203620e0e6e04d717595ca70a5e5efa74abfc11e4e732d729caab2d246c27"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "a1535bc01756ac9e986eb564d712b739df980ddd61cfde5a7b001849a6b07b57"
		threat_name = "Windows.Ransomware.Ragnarok"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "cmd_firewall" ascii fullword
		$a2 = "cmd_recovery" ascii fullword
		$a3 = "cmd_boot" ascii fullword
		$a4 = "cmd_shadow" ascii fullword
		$a5 = "readme_content" ascii fullword
		$a6 = "readme_name" ascii fullword
		$a8 = "rg_path" ascii fullword
		$a9 = "cometosee" ascii fullword
		$a10 = "&prv_ip=" ascii fullword

	condition:
		6 of ($a*)
}
rule ELASTIC_Windows_Ransomware_Ragnarok_5625D3F6 : BETA FILE MEMORY {
    meta:
		description = "Identifies RAGNAROK ransomware"
		author = "Elastic Security"
		id = "5625d3f6-7071-4a09-8ddf-faa2d081b539"
		date = "2020-05-03"
		modified = "2021-08-23"
		reference = "https://twitter.com/malwrhunterteam/status/1256263426441125888?s=20"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Ragnarok.yar#L73-L95"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "8c22cf9dfbeba7391f6d2370c88129650ef4c778464e676752de1d0fd9c5b34e"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "5c0a4e2683991929ff6307855bf895e3f13a61bbcc6b3c4b47d895f818d25343"
		threat_name = "Windows.Ransomware.Ragnarok"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$b1 = "prv_ip" ascii fullword
		$b2 = "%i.%i.%i" ascii fullword
		$b3 = "pub_ip" ascii fullword
		$b4 = "cometosee" ascii fullword

	condition:
		all of ($b*)
}
rule ELASTIC_Windows_Trojan_Beam_E41B243A : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Beam (Windows.Trojan.Beam)"
		author = "Elastic Security"
		id = "e41b243a-020f-485e-b4bc-4db9d593e7af"
		date = "2021-12-07"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Beam.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "233a1f1dcbb679d31dab7744358b434cccabfc752baf53ba991388ced098f7c8"
		logic_hash = "295837743ecfa51e1713d19cba24ff8885c8716201caac058ae8b2bc9e008e6c"
		score = 75
		quality = 69
		tags = "FILE, MEMORY"
		fingerprint = "0863f858fcc03d9b5994e73ee3b9daf64b57b0eecd67b718eafa2ed162cf7878"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 69 70 22 3A 22 28 5B 30 2D 39 2E 5D 2B 29 }
		$a2 = { 63 6F 75 6E 74 72 79 5F 63 6F 64 65 22 3A 22 28 5C 77 2A 29 }
		$a3 = { 20 2F 66 20 26 20 65 72 61 73 65 20 }
		$a4 = "\\BeamWinHTTP2\\Release\\BeamWinHTTP.pdb"

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Beam_5A951D13 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Beam (Windows.Trojan.Beam)"
		author = "Elastic Security"
		id = "5a951d13-9568-4a5f-bda3-645143bc16a1"
		date = "2021-12-07"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Beam.yar#L24-L42"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "233a1f1dcbb679d31dab7744358b434cccabfc752baf53ba991388ced098f7c8"
		logic_hash = "3419b649717b69f07334bd966f438dd0b77f03572fe14f4b88ce95a2a86cae07"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e3de6b47e563ebfd735cdd56f5b4077a8923026520ecca0628c5704272ea52bb"
		severity = 99
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 24 40 8B CE 2B C8 3B CA 0F 42 D1 83 FF 10 8D 4C 24 18 0F 43 CB }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Afdk_C952Fcfa : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Afdk (Windows.Trojan.Afdk)"
		author = "Elastic Security"
		id = "c952fcfa-75e1-4880-a4e3-1e4cc89c160f"
		date = "2023-12-01"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Afdk.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6723a9489e7cfb5e2d37ff9160d55cda065f06907122d73764849808018eb7a0"
		logic_hash = "a0589a3bf9e733e615b6e552395b3ff513e4fad7efd7d2ebea634aa91d2f60d9"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "577b2f82944711a51e52eb35a0eaf17379576ae151dd820d8b442e8fed8a5373"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 55 8B EC 51 51 83 65 F8 00 8D 45 F8 83 65 FC 00 50 E8 80 FF FF FF 59 85 C0 75 2B 8B 4D 08 8B 55 F8 8B 45 FC 89 41 04 8D 45 F8 89 11 83 CA 1F 50 89 55 F8 E8 7B FF FF FF 59 85 C0 75 09 E8 DA 98 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Afdk_5F8Cc135 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Afdk (Windows.Trojan.Afdk)"
		author = "Elastic Security"
		id = "5f8cc135-88b1-478d-aedb-0d60cee0bbf2"
		date = "2023-12-01"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Afdk.yar#L21-L41"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6723a9489e7cfb5e2d37ff9160d55cda065f06907122d73764849808018eb7a0"
		logic_hash = "0523a0cc3a4446f2ac88c72999568313c6b40f7f8975b8e332c0c6b1e48c5d76"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "275bfaac332f3cbc1164c35bdbc5cbe8bfd45559f6b929a0b8b64af2de241bd8"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Cannot set the log file name"
		$a2 = "Cannot install the hook procedure"
		$a3 = "Keylogger is up and running..."

	condition:
		2 of them
}
rule ELASTIC_Windows_Ransomware_Grief_9953339A : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Grief (Windows.Ransomware.Grief)"
		author = "Elastic Security"
		id = "9953339a-2c67-4ebd-be51-d1055e341abc"
		date = "2021-08-04"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Grief.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0864575d4f487e52a1479c61c2c4ad16742d92e16d0c10f5ed2b40506bbc6ca0"
		logic_hash = "f99ea1e1f59dc2999659cbe649e76001dd7139b1438440717b60f081d1e99d70"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "d7d70c3681c4d4103d9ff52c3bdd174ccbdb49343c34407e90abb5a83a8422f4"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 65 64 73 63 6F 72 70 69 6F 71 65 6E 61 62 6C 65 54 72 61 6E 73 6C 61 74 65 2E 41 64 65 65 6D 65 64 59 00 5A 41 70 70 6C 69 63 61 74 69 6F 6E 65 69 74 68 65 72 33 34 2E 30 28 39 39 25 6D 65 6D 6F 72 79 2C 77 69 74 68 6F 75 74 00 66 6F 72 47 6F 6F 67 6C 65 6C 74 68 65 6D 6F 72 65 6D 77 61 73 00 39 32 41 6E 69 6E 65 74 68 65 75 48 73 74 61 62 6C 65 73 6F 66 66 69 63 69 61 6C 00 43 4B 76 65 72 73 69 6F 6E 46 71 74 68 65 63 6F 6D 70 61 6E 79 2C 74 6F 6E 2E 35 30 37 00 6E 69 6E 2D 70 61 67 65 44 73 63 61 6E 6E 69 6E 67 61 63 63 65 73 73 48 69 63 6F 6E 72 65 6D }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Rhadamanthys_21B60705 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Rhadamanthys (Windows.Trojan.Rhadamanthys)"
		author = "Elastic Security"
		id = "21b60705-9696-43ba-a820-d8ab9c34cca2"
		date = "2023-03-19"
		modified = "2023-04-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Rhadamanthys.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "3ba97c51ba503fa4bdcfd5580c75436bc88794b4ae883afa1d92bb0b2a0f5efe"
		logic_hash = "ef3f60689d72553111b42b27e0a1a0316288ae07fbfaf159eea8c76380d528fa"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "8a756bf4a8c9402072531aca2c29a382881c1808a790432ccac2240b35c09383"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Session\\%u\\MSCTF.Asm.{%08lx-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x}" wide fullword
		$a2 = "MSCTF.Asm.{%08lx-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x}" wide fullword
		$a3 = " \"%s\",Options_RunDLL %s" wide fullword
		$a4 = "%%TEMP%%\\vcredist_%05x.dll" wide fullword
		$a5 = "%%APPDATA%%\\vcredist_%05x.dll" wide fullword
		$a6 = "TEQUILABOOMBOOM" wide fullword
		$a7 = "%Systemroot%\\system32\\rundll32.exe" wide fullword

	condition:
		4 of them
}
rule ELASTIC_Windows_Trojan_Rhadamanthys_1Da1C2C2 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Rhadamanthys (Windows.Trojan.Rhadamanthys)"
		author = "Elastic Security"
		id = "1da1c2c2-90ea-4f76-aa38-666934c0aa68"
		date = "2023-03-28"
		modified = "2023-04-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Rhadamanthys.yar#L27-L52"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9bfc4fed7afc79a167cac173bf3602f9d1f90595d4e41dab68ff54973f2cedc1"
		logic_hash = "bf5d45fe79dacfc6aee5cfd788ec6ce77e99e55d5a6d294da57c126bedf75ee9"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "7b3830373b773be03dc6d0f030595f625a2ef0b6a83312a5b0a958c0d2e5b1c0"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "%s\\tdata\\key_datas" wide fullword
		$a2 = "\\config\\loginusers.vdf" wide fullword
		$a3 = "/bin/KeePassHax.dll" ascii fullword
		$a4 = "%%APPDATA%%\\ns%04x.dll" wide fullword
		$a5 = "\\\\.\\pipe\\{%08lx-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x}" wide fullword
		$a6 = " /s /n /i:\"%s,%u,%u,%u\" \"%s\"" wide fullword
		$a7 = "strbuf(%lx) reallocs: %d, length: %d, size: %d" ascii fullword
		$a8 = "SOFTWARE\\FTPWare\\CoreFTP\\Sites\\%s" wide fullword

	condition:
		6 of them
}
rule ELASTIC_Windows_Trojan_Rhadamanthys_Ae00F48C : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Rhadamanthys (Windows.Trojan.Rhadamanthys)"
		author = "Elastic Security"
		id = "ae00f48c-f420-4a23-aae7-6f2bde29593c"
		date = "2023-05-05"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Rhadamanthys.yar#L54-L74"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "56b5ff5132ec1c5836223ced287d51a9ecee8d2b081f449245e136b1262a8714"
		logic_hash = "423b68717a7aead3c871e7fc744e35dad1cfd7727bfba2bdaec69fb782540380"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "8e3d13998a8e512aabf15534d61c06e0c6c51a4e8e46456538c654694310e670"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 75 30 8B 51 28 8B 41 2C 85 DB 74 03 89 53 28 85 D2 74 15 39 }
		$a2 = { 3C 65 74 50 3C 68 74 2A 3C 6E }
		$a3 = { 49 74 39 49 74 2D 49 49 74 29 49 49 74 25 49 49 74 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Rhadamanthys_Cf5Dd2E2 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Rhadamanthys (Windows.Trojan.Rhadamanthys)"
		author = "Elastic Security"
		id = "cf5dd2e2-a505-4927-8653-3c9addd3ac90"
		date = "2024-04-03"
		modified = "2024-05-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Rhadamanthys.yar#L76-L97"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "39ccc224c2c6d89d0bce3d9e2c677465cbc7524f2d2aa903f79ad26b340dec3d"
		logic_hash = "039d6de0d072be6717ba3eb90735d7b4898d3bbac83db4feb75efcdbca8fd98b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "3b2bdfd45a11649deb3430044c7b707aebcf74a3745398e3db09a7465fa62a6c"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 33 D2 49 8B C4 49 83 C4 57 48 F7 F7 41 8A C2 46 0F B6 04 1A 33 D2 42 8D 4C 05 00 C1 E9 03 F6 E9 8A C8 49 8B C0 41 C0 E8 05 }
		$a2 = { 8A 04 19 32 03 88 04 1A 48 83 C3 01 48 83 EF 01 }
		$a3 = { 4C 01 27 48 8B 0F 48 8B 47 10 C6 04 01 00 48 83 07 01 48 8B 0F 48 8B 47 10 }
		$a4 = { 69 F6 93 01 00 01 0F B6 C0 48 83 C1 01 33 F0 8A 01 84 C0 }

	condition:
		2 of them
}
rule ELASTIC_Windows_Trojan_Rhadamanthys_C4760266 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Rhadamanthys (Windows.Trojan.Rhadamanthys)"
		author = "Elastic Security"
		id = "c4760266-bbff-4428-a7a5-bca7513c7993"
		date = "2024-06-05"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Rhadamanthys.yar#L99-L117"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "05074675b07feb8e7556c5af449f5e677e0fabfb09b135971afbb11743bf3165"
		logic_hash = "b8c1c56681aac4e1b1741dfa3ea929677214873b6f1795423a80742f699249de"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "53a04d385ef3a59b76500effaf740cd0e7d825ea5515f871097d82899b0cfc44"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 55 8B EC 83 EC 14 83 7D 08 00 53 8B D8 74 50 56 57 8B 7D 0C 6A 10 2B FB 5E 56 8D 45 EC 53 50 ?? ?? ?? ?? ?? 83 C4 0C 90 8B 4D 10 8B C3 2B CB 89 75 FC 8A 14 07 32 10 88 14 01 40 FF 4D FC 75 F2 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Lokibot_1F885282 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Lokibot (Windows.Trojan.Lokibot)"
		author = "Elastic Security"
		id = "1f885282-b60e-491e-ae1b-d26825e5aadb"
		date = "2021-06-22"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Lokibot.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "916eded682d11cbdf4bc872a8c1bcaae4d4e038ac0f869f59cc0a83867076409"
		logic_hash = "c76941a83e18f11ed5af701e89616d324ddba613a95069997ea8f1830f328307"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a7519bb0751a6c928af7548eaed2459e0ed26128350262d1278f74f2ad91331b"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "MAC=%02X%02X%02XINSTALL=%08X%08Xk" fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Lokibot_0F421617 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Lokibot (Windows.Trojan.Lokibot)"
		author = "Elastic Security"
		id = "0f421617-df2b-4cb5-9d10-d984f6553012"
		date = "2021-07-20"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Lokibot.yar#L21-L39"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "de6200b184832e7d3bfe00c193034192774e3cfca96120dc97ad6fed1e472080"
		logic_hash = "0076ccbe43ae77e3a80164d43832643f077e659a595fff01c87694e2274c5e86"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "9ff5d594428e4a5de84f0142dfa9f54cb75489192461deb978c70f1bdc88acda"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 08 8B CE 0F B6 14 38 D3 E2 83 C1 08 03 F2 48 79 F2 5F 8B C6 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_P8Loader_E478A831 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan P8Loader (Windows.Trojan.P8Loader)"
		author = "Elastic Security"
		id = "e478a831-b2a1-4436-8b17-ca92b9581c39"
		date = "2023-04-13"
		modified = "2023-05-26"
		reference = "https://www.elastic.co/security-labs/elastic-charms-spectralviper"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_P8Loader.yar#L1-L26"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "f1a7de6bb4477ea82c18aea1ddc4481de2fc362ce5321f4205bb3b74c1c45a7e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "267743fc82c701d3029cde789eb471b49839001b21b90eeb20783382a56fb2c3"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "\t[+] Create pipe direct std success\n" fullword
		$a2 = "\tPEAddress: %p\n" fullword
		$a3 = "\tPESize: %ld\n" fullword
		$a4 = "DynamicLoad(%s, %s) %d\n" fullword
		$a5 = "LoadLibraryA(%s) FAILED in %s function, line %d" fullword
		$a6 = "\t[+] No PE loaded on memory\n" wide fullword
		$a7 = "\t[+] PE argument: %ws\n" wide fullword
		$a8 = "LoadLibraryA(%s) FAILED in %s function, line %d" fullword

	condition:
		5 of them
}
rule ELASTIC_Windows_Trojan_Stealc_B8Ab9Ab5 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Stealc (Windows.Trojan.Stealc)"
		author = "Elastic Security"
		id = "b8ab9ab5-5731-4651-b982-03ad8fe347fb"
		date = "2024-03-13"
		modified = "2024-03-21"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Stealc.yar#L1-L27"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0d1c07c84c54348db1637e21260dbed09bd6b7e675ef58e003d0fe8f017fd2c8"
		logic_hash = "5fc5d5cea481d1d204d1aa6c52679a23eb59438df2fe547d14c00524772867bb"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "49253b1d1e39ba25b2d3b622d00633b9629715e65e1537071b0f3b0318b7db12"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$seq_str_decrypt = { 55 8B EC 83 EC ?? 8D 4D ?? E8 ?? ?? ?? ?? 8B 45 ?? 50 E8 ?? ?? ?? ?? 83 C4 ?? 50 8D 4D ?? E8 ?? ?? ?? ?? 83 C0 ?? 50 }
		$seq_lang_check = { 81 E9 19 04 00 00 89 4D ?? 83 7D ?? ?? 77 ?? 8B 55 ?? 0F B6 82 ?? ?? ?? ?? FF 24 85 ?? ?? ?? ?? }
		$seq_mem_check_constant = { 72 09 81 7D F8 57 04 00 00 73 08 }
		$seq_hwid_algo = { 8B 08 69 C9 0B A3 14 00 81 E9 51 75 42 69 8B 55 08 }
		$str1 = "- Country: ISO?" ascii fullword
		$str2 = "%d/%d/%d %d:%d:%d" ascii fullword
		$str3 = "%08lX%04lX%lu" ascii fullword
		$str4 = "\\Outlook\\accounts.txt" ascii fullword
		$str5 = "/c timeout /t 5 & del /f /q" ascii fullword

	condition:
		(2 of ($seq*) or 4 of ($str*))
}
rule ELASTIC_Windows_Trojan_Stealc_A2B71Dc4 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Stealc (Windows.Trojan.Stealc)"
		author = "Elastic Security"
		id = "a2b71dc4-4041-4c1f-b546-a2b6947702d1"
		date = "2024-03-13"
		modified = "2024-03-21"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Stealc.yar#L29-L50"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0d1c07c84c54348db1637e21260dbed09bd6b7e675ef58e003d0fe8f017fd2c8"
		logic_hash = "b79ac3e65cd7d2819d6a49f59ec661241c97174f66a7c4ada91932f10fc43583"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "9eeb13fededae39b8a531fa5d07eaf839b56a1c828ecd11322c604962e8b1aec"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$seq_1 = { 8B C6 C1 E8 02 33 C6 D1 E8 33 C6 C1 E8 02 33 C6 83 E0 01 A3 D4 35 61 00 C1 E0 0F 66 D1 E9 66 0B C8 }
		$seq_2 = { FF D3 8B 4D ?? E8 [4] 6A ?? 33 D2 5F 8B C8 F7 F7 85 D2 74 ?? }
		$seq_3 = { 33 D2 8B F8 59 F7 F1 8B C7 3B D3 76 04 2B C2 03 C1 }
		$seq_4 = { 6A 7C 58 66 89 45 FC 8D 45 F0 50 8D 45 FC 50 FF 75 08 C7 45 F8 01 }

	condition:
		2 of ($seq*)
}
rule ELASTIC_Windows_Trojan_Stealc_5D3F297C : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Stealc (Windows.Trojan.Stealc)"
		author = "Elastic Security"
		id = "5d3f297c-b812-401a-8671-2e00369cd6f2"
		date = "2024-03-05"
		modified = "2024-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Stealc.yar#L52-L70"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "885c8cd8f7ad93f0fd43ba4fb7f14d94dfdee3d223715da34a6e2fbb4d25b9f4"
		logic_hash = "556d3bc9374a5ec23faa410900dfc94b5534434c9733165355d281976444a42b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ff90bfcb28bb3164fb11da5f35f289af679805f7e4047e48d97ae89e5b820dcd"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 EC 08 C7 45 F8 00 00 00 00 83 7D 08 00 74 4A 83 7D 0C 00 74 44 8B 45 0C 83 C0 01 50 6A 40 ?? ?? ?? ?? ?? ?? 89 45 F8 83 7D F8 00 74 2C C7 45 FC 00 00 00 00 EB 09 8B 4D FC 83 C1 01 }

	condition:
		all of them
}
rule ELASTIC_Windows_Hacktool_Sharpmove_05E28928 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Sharpmove (Windows.Hacktool.SharpMove)"
		author = "Elastic Security"
		id = "05e28928-6109-4afe-bd86-908d354ddd80"
		date = "2022-11-20"
		modified = "2023-01-11"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_SharpMove.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "051f60f9f4665b96f764810defe9525ae7b4f9898249b83a23094cee63fa0c3b"
		logic_hash = "021a56dd47d9929e71b82b00d24aa8969a31945681dcf414c69b8d175fb0b6eb"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "634efb2dedbb181a31ea41ff34d1d0810d1ab4823c8611737d68cb56601a052d"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$guid = "8BF82BBE-909C-4777-A2FC-EA7C070FF43E" ascii wide nocase
		$print_str0 = "[X]  Failed to connecto to WMI: {0}" ascii wide fullword
		$print_str1 = "[+] Executing DCOM ShellBrowserWindow   : {0}" ascii wide fullword
		$print_str2 = "[+]  User credentials  : {0}" ascii wide fullword
		$print_str3 = "[+] Executing DCOM ExcelDDE   : {0}" ascii wide fullword

	condition:
		$guid or all of ($print_str*)
}
rule ELASTIC_Windows_Trojan_Njrat_30F3C220 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Njrat (Windows.Trojan.Njrat)"
		author = "Elastic Security"
		id = "30f3c220-b8dc-45a1-bcf0-027c2f76fa63"
		date = "2021-06-13"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Njrat.yar#L1-L24"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "741a0f3954499c11f9eddc8df7c31e7c59ca41f1a7005646735b8b1d53438c1b"
		logic_hash = "76347165829415646f943bb984cd17ca138cf238d03f114c498dbcec081d5ae3"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "d15e131bca6beddcaecb20fffaff1784ad8a33a25e7ce90f7450d1a362908cc4"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "get_Registry" ascii fullword
		$a2 = "SEE_MASK_NOZONECHECKS" wide fullword
		$a3 = "Download ERROR" wide fullword
		$a4 = "cmd.exe /c ping 0 -n 2 & del \"" wide fullword
		$a5 = "netsh firewall delete allowedprogram \"" wide fullword
		$a6 = "[+] System : " wide fullword

	condition:
		3 of them
}
rule ELASTIC_Windows_Trojan_Njrat_Eb2698D2 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Njrat (Windows.Trojan.Njrat)"
		author = "Elastic Security"
		id = "eb2698d2-c9fa-4b0b-900f-1c4c149cca4b"
		date = "2023-05-04"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Njrat.yar#L26-L44"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "d537397bc41f0a1cb964fa7be6658add5fe58d929ac91500fc7770c116d49608"
		logic_hash = "c32a641f2d639f56a8137b3e0d0be3261fba30084eeba9d1205974713413af9f"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "8eedcdabf459de87e895b142cd1a1b8c0e403ad8ec6466bc6ca493dd5daa823b"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 24 65 66 65 39 65 61 64 63 2D 64 34 61 65 2D 34 62 39 65 2D 62 38 61 62 2D 37 65 34 37 66 38 64 62 36 61 63 39 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Blackwood_2B94Bce9 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Blackwood (Windows.Trojan.Blackwood)"
		author = "Elastic Security"
		id = "2b94bce9-a9cc-4b22-a9c7-2790553942b0"
		date = "2024-03-22"
		modified = "2024-05-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Blackwood.yar#L1-L26"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c37dd77f659059da7e12e13b063036ee69097a4d2f88c170832fff78f3788991"
		logic_hash = "279e85ce3bb974ce5af541e7307cb2fd1031f36c9da013756883172a765b0e19"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "1162bd3cc0f30cd927f5f2d7d5703204ce8df0d627944222e2dc4ae42d1ea99a"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 5F 8C FB 62 69 00 65 00 78 00 70 00 6C 00 6F 00 72 00 65 00 2E 00 65 00 78 00 65 00 }
		$a2 = { C6 44 24 0C 6D C6 44 24 0D 73 C6 44 24 0E 68 C6 44 24 10 70 C6 44 24 11 2E C6 44 24 12 64 }
		$a3 = { 6D 79 6E 73 70 2E 64 6C 6C 00 4E 53 50 43 6C 65 61 6E 75 70 00 4E 53 50 53 74 61 72 74 75 70 }
		$b1 = "index.dat"
		$b2 = "Mozilla/4.0 (compatible;MSIE 5.0; Windows 98)"
		$b3 = "http://www.baidu.com/id=%s&ad=%d&os=%d.%d&t=%d"
		$b4 = "SetEntriesInAcl Error %u"
		$b5 = "AllocateAndInitializeSid Error %u"

	condition:
		1 of ($a*) or all of ($b*)
}
rule ELASTIC_Windows_Wiper_Doublezero_65Ec0C50 : FILE MEMORY {
    meta:
		description = "Detects Windows Wiper Doublezero (Windows.Wiper.DoubleZero)"
		author = "Elastic Security"
		id = "65ec0c50-4038-46a7-879b-fbb4aab18725"
		date = "2022-03-22"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Wiper_DoubleZero.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "3b2e708eaa4744c76a633391cf2c983f4a098b46436525619e5ea44e105355fe"
		logic_hash = "bce33817d99f71b9d087ea079ef8db08b496315b72cf9d1cf6f0b107a604e52c"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "2441bcdf7bc48df098f4ef68231fb15fc5c8f96af2e170de77f1718487b945b2"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$s1 = "\\Users\\\\.*?\\\\AppData\\\\Roaming\\\\Microsoft.*" wide fullword
		$s2 = "\\Users\\\\.*?\\\\AppData\\\\Local\\\\Application Data.*" wide fullword
		$s3 = "\\Users\\\\.*?\\\\Local Settings.*" wide fullword
		$s4 = "get__beba00adeeb086e6" ascii fullword
		$s5 = "FileShareWrite" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Backoff_22798F00 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Backoff (Windows.Trojan.Backoff)"
		author = "Elastic Security"
		id = "22798f00-ff2a-4f5f-a9ef-fab6d04ca679"
		date = "2022-08-10"
		modified = "2022-09-29"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Backoff.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "65b5aff18a4e0bc29d7cc4cfbe2d5882f99a855727fe467b2ba2e2851c43d21b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a45fc701844e6e0cfba5d8ef90d00960b5817af66e6b3d889a54d33539cd5d41"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$str1 = "\\nsskrnl" fullword
		$str2 = "Upload KeyLogs" fullword
		$str3 = "&op=%d&id=%s&ui=%s&wv=%d&gr=%s&bv=%s" fullword
		$str4 = "[%s] - [%.2d/%.2d/%d %.2d:%.2d:%.2d]" fullword
		$str5 = "\\OracleJava\\Log.txt" fullword
		$str6 = "[Ctrl+%c]" fullword

	condition:
		3 of them
}
rule ELASTIC_Windows_Trojan_Solarmarker_D466E548 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Solarmarker (Windows.Trojan.SolarMarker)"
		author = "Elastic Security"
		id = "d466e548-eb88-41e6-9740-ae59980db835"
		date = "2023-12-12"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_SolarMarker.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "330f5067c93041821be4e7097cf32fb569e2e1d00e952156c9aafcddb847b873"
		hash = "e2a620e76352fa7ac58407a711821da52093d97d12293ae93d813163c58eb84b"
		logic_hash = "c0792bc3c1a2f01ff4b8d0a12c95a74491c2805c876f95a26bbeaabecdff70e9"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0f4b0162ee8283959e10c459ddc55eb00eae30d241119aad1aa3ea6c101f9889"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 00 00 2B 03 00 2B 15 00 07 2D 09 08 16 FE 01 16 FE 01 2B 01 17 00 13 04 11 04 2D 8C 07 2D 06 08 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Solarmarker_08Bfc26B : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Solarmarker (Windows.Trojan.SolarMarker)"
		author = "Elastic Security"
		id = "08bfc26b-efda-49b4-b685-57edca8b9d18"
		date = "2024-05-29"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_SolarMarker.yar#L22-L42"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c1a6d2d78cc50f080f1fe4cadc6043027bf201d194f2b73625ce3664433a3966"
		logic_hash = "b31b9f8460b606426c1101eba39a41a75c7ecaafc62388a6a5ac0f24057561ed"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "9c0c4a5bce63c9d99d53813f7250b3ccc395cb99eaebb8c016f8c040fbfa4ea7"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 07 09 91 61 D2 9C 09 20 C8 00 00 00 5D 16 FE 01 16 FE 01 13 }
		$a2 = { 91 07 08 91 61 D2 9C 08 20 C8 00 00 00 5D 16 FE 01 16 FE 01 }
		$a3 = { 06 08 06 08 91 07 08 91 61 D2 9C 08 20 C8 00 00 00 5D 16 FE }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Nighthawk_9F3A5Abb : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Nighthawk (Windows.Trojan.Nighthawk)"
		author = "Elastic Security"
		id = "9f3a5abb-b329-44db-af71-d72eae2737ac"
		date = "2022-11-24"
		modified = "2023-06-20"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Nighthawk.yar#L1-L26"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b775a8f7629966592cc7727e2081924a7d7cf83edd7447aa60627a2b67d87c94"
		logic_hash = "27a34e48141fe260c16c12a2652e440d2540ca5f0c84b41c9c4762dcab44ffd4"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a2c49831d048ba91951780f4295895eba3a15f489a39b26b7a27efbc81746e09"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$loader_build_iat0 = { B9 BF BF D1 D5 E8 ?? ?? ?? ?? BA 7C 75 84 91 [3-12] E8 ?? ?? ?? ?? BA 47 FB EB 2B [3-12] E8 ?? ?? ?? ?? BA 42 24 3D 39 [3-12] E8 ?? ?? ?? ?? BA E7 E9 EF EE [3-12] E8 ?? ?? ?? ?? BA 47 FD 36 2E [3-12] E8 ?? ?? ?? ?? BA 39 DE 19 3D [3-12] E8 ?? ?? ?? ?? BA 20 DF DB F7 [3-12] E8 ?? ?? ?? ?? BA 45 34 2A 41 [3-12] E8 ?? ?? ?? ?? BA 7D 1C 44 2E [3-12] E8 ?? ?? ?? ?? BA 7D 28 44 2E [3-12] E8 ?? ?? ?? ?? BA 94 36 65 8D [3-12] E8 ?? ?? ?? ?? }
		$loader_syscall_func = { 65 48 8B 04 25 30 00 00 00 48 8B 80 10 01 00 00 48 89 44 24 F0 65 48 8B 04 25 30 00 00 00 8B 40 68 49 89 CA FF 64 24 F0 }
		$seq_calc_offset = { 48 8D 0D ?? ?? ?? ?? 51 5A 48 81 C1 ?? ?? ?? ?? 48 81 C2 ?? ?? ?? ?? FF E2 }
		$seq_keying_registry = { BA ?? ?? ?? ?? 48 8B C8 48 8B D8 E8 ?? ?? ?? ?? BA ?? ?? ?? ?? 48 8B CB 4C 8B F0 E8 ?? ?? ?? ?? BA ?? ?? ?? ?? 48 8B CB 4C 8B F8 E8 ?? ?? ?? ?? 0F B6 4E ?? 48 8B D8 83 E9 ?? 74 ?? 83 F9 ?? 75 ?? 48 C7 C1 ?? ?? ?? ?? EB ?? }
		$seq_keying_hostname_user = { 40 53 48 83 EC ?? 8A 42 ?? 48 8B D9 3C ?? 75 ?? B9 ?? ?? ?? ?? E8 ?? ?? ?? ?? BA ?? ?? ?? ?? 48 8B C8 E8 ?? ?? ?? ?? 48 8D 53 ?? 48 8D 4B ?? C7 02 ?? ?? ?? ?? FF D0 85 C0 0F 95 C0 EB ?? }
		$seq_keying_file = { E8 ?? ?? ?? ?? 33 DB 48 8D 4E ?? 48 89 5C 24 ?? 45 33 C9 89 5C 24 ?? BA ?? ?? ?? ?? 4C 8B E0 89 5C 24 ?? 44 8D 43 ?? C7 44 24 ?? ?? ?? ?? ?? FF D7 48 8B F8 48 83 F8 ?? 74 ?? 8B 55 ?? 45 33 C9 45 33 C0 48 8B C8 }
		$seq_crypto_op = { 40 84 F6 74 ?? 48 8B C2 B9 04 00 00 00 F3 0F 6F 44 05 ?? F3 0F 6F 4C 05 ?? 48 8D 40 ?? 66 0F EF C8 F3 0F 7F 4C 05 ?? 48 83 E9 01 }
		$seq_byte_shift = { 48 83 C3 ?? 8D 4D ?? 48 03 CF 0F B6 41 ?? 0F B6 71 ?? C1 E6 08 0B F0 0F B6 41 ?? C1 E6 08 0B F0 0F B6 01 C1 E6 ?? 0B F0 41 3B 75 ?? 76 ?? B8 ?? ?? ?? ?? EB ?? }

	condition:
		($loader_build_iat0 and $loader_syscall_func) or (2 of ($seq*))
}
rule ELASTIC_Windows_Trojan_Nighthawk_2A2E3B9D : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Nighthawk (Windows.Trojan.Nighthawk)"
		author = "Elastic Security"
		id = "2a2e3b9d-e85f-43b6-9754-1aa7c9f6f978"
		date = "2022-11-24"
		modified = "2023-06-20"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Nighthawk.yar#L28-L47"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "38881b87826f184cc91559555a3456ecf00128e01986a9df36a72d60fb179ccf"
		logic_hash = "c42605ebba900fafb4ec2d34d93bb7adb69e731ce151b82a95889dd0d738da00"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "40912e8d6bd09754046598b1311080e0ec6e040cb1b9ca93003c6314725d4d45"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$payload_bytes1 = { 66 C1 E0 05 66 33 D0 66 C1 E2 0A 66 0B D1 0F B7 D2 8B CA 0F B7 C2 C1 E9 02 33 CA 66 D1 E8 D1 E9 33 CA C1 E9 02 33 CA C1 E2 0F 83 E1 01 }
		$payload_bytes2 = { 48 8B D9 44 8B C2 41 C1 E0 0F 8B C2 F7 D0 48 8B F2 44 03 C0 41 8B C0 C1 E8 0C 41 33 C0 8D 04 80 8B C8 C1 E9 04 33 C8 44 69 C1 09 08 00 00 41 8B C0 C1 E8 10 44 33 C0 B8 85 1C A7 AA }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Nighthawk_23489175 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Nighthawk (Windows.Trojan.Nighthawk)"
		author = "Elastic Security"
		id = "23489175-ed41-4f43-ac85-b9ae3ffb55d9"
		date = "2023-06-14"
		modified = "2023-07-10"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Nighthawk.yar#L49-L74"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "697742d5dd071add40b700022fd30424cb231ffde223d21bd83a44890e06762f"
		logic_hash = "be41fc53f7098ca3cf718e8066a488196423ede993466c9a24ad2af387e03b24"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "3ff9fe5ef10afa328025a6abd509af788a9b1d5ef73a379e3767b2a4291566a3"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$pdb = "C:\\Users\\Peter\\Desktop\\dev\\implant\\CommsChannel\\x64\\Release-ReflectiveDLL\\Implant.x64.pdb" ascii fullword
		$seq_str_decrypt = { 48 8B C3 48 83 7B ?? ?? 72 ?? 48 8B 03 0F BE 14 06 49 8B CF E8 ?? ?? ?? ?? 48 85 C0 74 ?? 49 2B C7 48 8D 0D ?? ?? ?? ?? 8A 0C 08 48 8B C3 48 83 7B ?? ?? 72 ?? 48 8B 03 88 0C 06 }
		$seq_hvnc = { BA 06 01 00 00 41 B9 00 00 20 A0 41 B8 20 00 00 00 48 8B CE FF 15 }
		$seq_pe_parsing = { 8B 44 24 ?? 48 6B C0 28 48 8B 4C 24 ?? 8B 44 01 ?? 48 8B 8C 24 ?? ?? ?? ?? 48 03 C8 48 8B C1 48 89 44 24 ?? 8B 44 24 ?? 48 6B C0 28 48 8B 4C 24 ?? 8B 44 01 ?? 89 44 24 ?? EB ?? }
		$seq_library_resolver = { 48 8B 84 24 ?? ?? ?? ?? 48 89 44 24 ?? 48 8B 44 24 ?? 48 63 40 ?? 48 8B 4C 24 ?? 48 03 C8 48 8B C1 48 89 44 24 ?? B8 ?? ?? ?? ?? 48 6B C0 ?? 48 8B 4C 24 ?? 8B 84 01 ?? ?? ?? ?? 89 44 24 ?? 83 7C 24 ?? ?? 75 ?? 33 C0 E9 ?? ?? ?? ?? }
		$seq_disk_info = { 4C 8B A3 B0 00 00 00 48 8B BB A8 00 00 00 49 3B FC 0F 84 ?? ?? ?? ?? 48 8D B3 D8 00 00 00 4C 8D B3 F0 00 00 00 4C 8D BB C0 00 00 00 45 33 ED }
		$seq_keyname = { 8B 4B 08 C1 E1 08 0B 4B 04 C1 E1 10 41 B8 40 00 00 00 48 8D 95 ?? ?? ?? ?? FF 15 ?? ?? ?? ?? }
		$seq_tcptable = { 41 BF 02 00 00 00 41 3B FF 74 ?? 83 FF 17 41 8B C7 75 ?? B8 08 00 00 00 }

	condition:
		(1 of ($pdb)) or (2 of ($seq*))
}
rule ELASTIC_Windows_Infostealer_Phemedronestealer_Bed8Ea8A : FILE MEMORY {
    meta:
		description = "Detects Windows Infostealer Phemedronestealer (Windows.Infostealer.PhemedroneStealer)"
		author = "Elastic Security"
		id = "bed8ea8a-f2a3-4a51-ae57-4986da4d21aa"
		date = "2024-03-21"
		modified = "2024-05-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Infostealer_PhemedroneStealer.yar#L1-L30"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "38279fdad25c7972be9426cadb5ad5e3ee7e9761b0a41ed617945cb9a3713702"
		logic_hash = "88fc33abfe6c7a611aa0c354645b06e9e74121ffc9a5acd20b4d3a59287489d6"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "29702a2dc8b20c230ffef00dfff725133b707e35523e075ff85484a20da3c760"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "<KillDebuggers>b_"
		$a2 = "<Key3Database>b_"
		$a3 = "<IsVM>b_"
		$a4 = "<ParseDatWallets>b_"
		$a5 = "<ParseExtensions>b_"
		$a6 = "<ParseDiscordTokens>b_"
		$b1 = "Phemedrone.Senders"
		$b2 = "Phemedrone.Protections"
		$b3 = "Phemedrone.Extensions"
		$b4 = "Phemedrone.Cryptography"
		$b5 = "Phemedrone-Report.zip"
		$b6 = "Phemedrone Stealer Report"

	condition:
		all of ($a*) or all of ($b*)
}
rule ELASTIC_Windows_Ransomware_Bitpaymer_D74273B3 : BETA FILE MEMORY {
    meta:
		description = "Identifies BITPAYMER ransomware"
		author = "Elastic Security"
		id = "d74273b3-d109-4b5d-beff-dffee9a984b1"
		date = "2020-06-25"
		modified = "2021-08-23"
		reference = "https://www.welivesecurity.com/2018/01/26/friedex-bitpaymer-ransomware-work-dridex-authors/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Bitpaymer.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "126246689b28e92ed10bfa6165f06ff7d4f0e062de7c58b821eaaf5e3cae9306"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "4f913f06f7c7decbeb78187c566674f91ebbf929ad7057641659bb756cf2991b"
		threat_name = "Windows.Ransomware.Bitpaymer"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$b1 = { 24 E8 00 00 00 29 F0 19 F9 89 8C 24 88 00 00 00 89 84 24 84 00 }

	condition:
		1 of ($b*)
}
rule ELASTIC_Windows_Ransomware_Bitpaymer_Bca25Ac6 : BETA FILE MEMORY {
    meta:
		description = "Identifies BITPAYMER ransomware"
		author = "Elastic Security"
		id = "bca25ac6-e351-4823-be75-b0661c89588a"
		date = "2020-06-25"
		modified = "2021-08-23"
		reference = "https://www.welivesecurity.com/2018/01/26/friedex-bitpaymer-ransomware-work-dridex-authors/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Bitpaymer.yar#L22-L48"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "7670f9dafacc8fc5998c1974af66ede388c0997545da067648fec4fd053f0001"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "2ecc7884d47ca7dbba30ba171b632859914d6152601ea7b463c0f52be79ebb8c"
		threat_name = "Windows.Ransomware.Bitpaymer"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "RWKGGE.PDB" fullword
		$a2 = "*Qf69@+mESRA.RY7*+6XEF#NH.pdb" fullword
		$a3 = "04QuURX.pdb" fullword
		$a4 = "9nuhuNN.PDB" fullword
		$a5 = "mHtXGC.PDB" fullword
		$a6 = "S:\\Work\\_bin\\Release-Win32\\wp_encrypt_new.pdb" fullword
		$a7 = "C:\\Work\\_bin\\Release-Win32\\wp_encrypt.pdb" fullword
		$a8 = "k:\\softcare\\release\\h2O.pdb" fullword

	condition:
		1 of ($a*)
}
rule ELASTIC_Windows_Hacktool_Sharpchromium_41Ce5080 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Sharpchromium (Windows.Hacktool.SharpChromium)"
		author = "Elastic Security"
		id = "41ce5080-7d84-4a56-8de8-86959eb92057"
		date = "2022-11-20"
		modified = "2023-01-11"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_SharpChromium.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9dd65aa53728d51f0f3b9aaf51a24f8a2c3f84b4a4024245575975cf9ad7f2e5"
		logic_hash = "50972a6e6af1d7076243320fb6559193e0c46ac1300aa62d12390fdeb2fffdcd"
		score = 75
		quality = 48
		tags = "FILE, MEMORY"
		fingerprint = "b6695ded1a6f647812c7f355e089a2ed7209ac59f51a97d8f6b1897bb1e7d9ad"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$guid = "F1653F20-D47D-4F29-8C55-3C835542AF5F" ascii wide nocase
		$print_str0 = "[X] Exception occurred while writing cookies to file: {0}" ascii wide fullword
		$print_str1 = "[*] All cookies written to {0}" ascii wide fullword
		$print_str2 = "\\{0}-cookies.json" ascii wide fullword
		$print_str3 = "[*] {0} {1} extraction." ascii wide fullword

	condition:
		$guid or all of ($print_str*)
}
rule ELASTIC_Windows_Trojan_Pingpull_09Dd9559 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Pingpull (Windows.Trojan.Pingpull)"
		author = "Elastic Security"
		id = "09dd9559-ce77-4f55-9e81-3b90add40103"
		date = "2022-06-16"
		modified = "2022-07-18"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Pingpull.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "de14f22c88e552b61c62ab28d27a617fb8c0737350ca7c631de5680850282761"
		logic_hash = "114674b1a9acfc7643138d3b07885343a50c9d319b8d22a6ef34e916685c4469"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b471e0f40780523bf396323a3b70fd285944fef2960ae43a36068eaf2f2fea4f"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$s1 = "PROJECT_%s_%s_%08X" ascii fullword
		$s2 = "Iph1psvc" ascii fullword
		$s3 = "IP He1per" ascii fullword
		$s4 = "If this service is stopped, the computer will not have the enhanced connectivity benefits that these technologies offer."
		$a1 = { 02 C? 66 C7 44 24 ?? 3A 00 4C 8D 44 24 ?? 88 4C 24 ?? 48 83 C9 FF 88 44 24 ?? F2 AE 33 ?? 0F 1F }
		$a2 = { 48 85 FF 74 ?? 41 C1 E0 04 0F B6 4C 3C ?? 33 D2 8D 41 ?? ?? 19 77 ?? 80 C1 E0 8D 41 ?? 3C 09 77 }
		$a3 = { 4C 63 74 24 ?? 48 8B ?? 43 8D 44 36 ?? 4C 63 E8 49 8B CD E8 ?? ?? ?? ?? 48 8B ?? 48 85 C0 0F 84 }

	condition:
		3 of them
}
rule ELASTIC_Windows_Trojan_Privateloader_96Ac2734 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Privateloader (Windows.Trojan.PrivateLoader)"
		author = "Elastic Security"
		id = "96ac2734-e36c-4ce2-bb40-b6bd77694333"
		date = "2023-01-03"
		modified = "2023-02-01"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_PrivateLoader.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "077225467638a420cf29fb9b3f0241416dcb9ed5d4ba32fdcf2bf28f095740bb"
		logic_hash = "9f96f1c54853866e124d0996504e6efd3d154111390617999cc10520d7f68fe6"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "029056908abef6c3ceecf7956e64a6d25b67c391f699516b3202d2aa3733f15a"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$xor_decrypt = { 0F 28 85 ?? ?? FF FF 66 0F EF ?? ?? FE FF FF 0F 29 85 ?? ?? FF FF 0F 28 85 ?? ?? FF FF }
		$str0 = "https://ipinfo.io/" wide
		$str1 = "Content-Type: application/x-www-form-urlencoded" wide
		$str2 = "https://db-ip.com/" wide

	condition:
		all of ($str*) and #xor_decrypt>3
}
rule ELASTIC_Windows_Trojan_Onlylogger_B9E88336 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Onlylogger (Windows.Trojan.OnlyLogger)"
		author = "Elastic Security"
		id = "b9e88336-9719-4f43-afc9-b0e6c7d72b6f"
		date = "2022-03-22"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_OnlyLogger.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "69876ee4d89ba68ee86f1a4eaf0a7cb51a012752e14c952a177cd5ffd8190986"
		logic_hash = "b8d1c4c1e33fc0b54a62f82b8f53c9a1b051ad8c2f578d2a43f504158d1d9247"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "5c8c98b250252d178c8dbad60bf398489d9396968e33b3e004219a4f323eeed8"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "C:\\Users\\Ddani\\source\\repos\\onlyLogger\\Release\\onlyLogger.pdb" ascii fullword
		$b1 = "iplogger.org" ascii fullword
		$b2 = "NOT elevated" ascii fullword
		$b3 = "WinHttpSendRequest" ascii fullword

	condition:
		1 of ($a*) or all of ($b*)
}
rule ELASTIC_Windows_Trojan_Onlylogger_Ec14D5F2 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Onlylogger (Windows.Trojan.OnlyLogger)"
		author = "Elastic Security"
		id = "ec14d5f2-5716-47f3-a7fb-98ec2d8679d1"
		date = "2022-03-22"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_OnlyLogger.yar#L24-L46"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f45adcc2aad5c0fd900df4521f404bc9ca71b01e3378a5490f5ae2f0c711912e"
		logic_hash = "2838851a5e013705b64625801d2ab1d56cfc17c52f75a5fd71448cb0a4b4b683"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "c69da3dfe0a464665759079207fbc0c82e690d812b38c83d3f4cd5998ecee1ff"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "KILLME" ascii fullword
		$a2 = "%d-%m-%Y %H" ascii fullword
		$a3 = "/c taskkill /im \"" ascii fullword
		$a4 = "\" /f & erase \"" ascii fullword
		$a5 = "/info.php?pub=" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Trickbot_01365E46 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Trickbot (Windows.Trojan.Trickbot)"
		author = "Elastic Security"
		id = "01365e46-c769-4c6e-913a-4d1e42948af2"
		date = "2021-03-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "5c450d4be39caef1d9ec943f5dfeb6517047175fec166a52970c08cd1558e172"
		logic_hash = "4d61de2cb37e12f62326c1717f6ed44554f5d2aa7ede6033d0c988e5e64df54d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "98505c3418945c10bf4f50a183aa49bdbc7c1c306e98132ae3d0fc36e216f191"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 8B 43 28 4C 8B 53 18 4C 8B 5B 10 4C 8B 03 4C 8B 4B 08 89 44 24 38 48 89 4C 24 30 4C }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Trickbot_06Fd4Ac4 : FILE MEMORY {
    meta:
		description = "Identifies Trickbot unpacker"
		author = "Elastic Security"
		id = "06fd4ac4-1155-4068-ae63-4d83db2bd942"
		date = "2021-03-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L21-L39"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "bde387f1e22d1399fb99f6d41732a37635d8e90f29626f2995914a073a7cac89"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ece49004ed1d27ef92b3b1ec040d06e90687d4ac5a89451e2ae487d92cb24ddd"
		threat_name = "Windows.Trojan.Trickbot"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 5F 33 C0 68 ?? ?? 00 00 59 50 E2 FD 8B C7 57 8B EC 05 ?? ?? ?? 00 89 45 04 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Trickbot_Ce4305D1 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Trickbot (Windows.Trojan.Trickbot)"
		author = "Elastic Security"
		id = "ce4305d1-8a6f-4797-afaf-57e88f3d38e6"
		date = "2021-03-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L41-L58"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "c547114475383e5d84f6b8cb72585ddd5778ae3afa491deddeef8a5ec56be1b5"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ae606e758b02ccf2a9a313aebb10773961121f79a94c447e745289ee045cf4ee"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { F9 8B 45 F4 89 5D E4 85 D2 74 39 83 C0 02 03 C6 89 45 F4 8B }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Trickbot_1E56Fad7 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Trickbot (Windows.Trojan.Trickbot)"
		author = "Elastic Security"
		id = "1e56fad7-383f-4ee0-9f8f-a0b3dcceb691"
		date = "2021-03-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L60-L77"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "815b37804f79fb4607e6b84294882d818233c3df13aececb3d341244900a2e44"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a0916134f47df384bbdacff994970f60d3613baa03c0a581b7d1dd476af3121b"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 5B C9 C2 18 00 43 C1 02 10 7C C2 02 10 54 C1 02 10 67 C1 02 10 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Trickbot_93C9A2A4 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Trickbot (Windows.Trojan.Trickbot)"
		author = "Elastic Security"
		id = "93c9a2a4-a07a-4ed4-a899-b160d235bf50"
		date = "2021-03-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L79-L96"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "dadeeba6147b118b80e014ab067eac7a2c3c2990958a6c7016562d8b64fef53c"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0ff82bf9e70304868ff033f0d96e2a140af6e40c09045d12499447ffb94ab838"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 6A 01 8B CF FF 50 5C 8B 4F 58 49 89 4F 64 8B 4D F4 8B 45 E4 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Trickbot_5340Afa3 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Trickbot (Windows.Trojan.Trickbot)"
		author = "Elastic Security"
		id = "5340afa3-ff90-4f61-a1ac-aba1f32dd375"
		date = "2021-03-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L98-L115"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "8b9d3c978f0c4a04ee5b3446b990172206b17496036bc1cc04180ea7e9b99734"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "7da4726ccda6a76d2da773d41f012763802d586f64a313c1c37733905ae9da81"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { E8 0C 89 5D F4 0F B7 DB 03 5D 08 66 83 F8 03 75 0A 8B 45 14 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Trickbot_E7932501 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Trickbot (Windows.Trojan.Trickbot)"
		author = "Elastic Security"
		id = "e7932501-66bf-4713-b10e-bcda29f4b901"
		date = "2021-03-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L117-L134"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "f82704a408a0cf1def2a5926dc4c02fa56afea1422c88ba41af50d44c60edb07"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ae31b49266386a6cf42289a08da4a20fc1330096be1dae793de7b7230225bfc7"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 24 0C 01 00 00 00 85 C0 7C 2F 3B 46 24 7D 2A 8B 4E 20 8D 04 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Trickbot_Cd0868D5 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Trickbot (Windows.Trojan.Trickbot)"
		author = "Elastic Security"
		id = "cd0868d5-42d8-437f-8c1a-303526c08442"
		date = "2021-03-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L136-L153"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "053a99e5e722fd2aa1cae96266cc344954f9c3a12d0851fa9d5e95a6420651f4"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "2f777285a90fce20cd4eab203f3ec7ed1c62e09fc2dfdce09b57e0802f49628f"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 8D 1C 01 89 54 24 10 8B 54 24 1C 33 C9 66 8B 0B 8D 3C 8A 8B 4C }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Trickbot_515504E2 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Trickbot (Windows.Trojan.Trickbot)"
		author = "Elastic Security"
		id = "515504e2-6b7f-4398-b89b-3af2b46c78a7"
		date = "2021-03-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L155-L172"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "5410068e09de4a1283f98f6364ddf243373e228ba060b00699db6323f1167684"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "8eb741e1b3bd760e2cf511ad6609ac6f1f510958a05fb093eae26462f16ee1d0"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 6A 00 6A 00 8D 4D E0 51 FF D6 85 C0 74 29 83 F8 FF 74 0C 8D }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Trickbot_A0Fc8F35 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Trickbot (Windows.Trojan.Trickbot)"
		author = "Elastic Security"
		id = "a0fc8f35-cbeb-43a8-b00d-7a0f981e84e4"
		date = "2021-03-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L174-L191"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "7ab2b45ddfc1d7fa409a6ea3dfd8d4940e1bdf3fc0cb6c7e8d49c60e7bda5b1b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "033ff4f47fece45dfa7e3ba185df84a767691e56f0081f4ed96f9e2455a563cb"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 18 33 DB 53 6A 01 53 53 8D 4C 24 34 51 8B F0 89 5C 24 38 FF D7 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Trickbot_Cb95Dc06 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Trickbot (Windows.Trojan.Trickbot)"
		author = "Elastic Security"
		id = "cb95dc06-6383-4487-bf10-7fd68d61e37a"
		date = "2021-03-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L193-L210"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "563b2311d37ace2d09601a70325352db3fcbf135e7ce518965f5410081b5d626"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0d28f570db007a1b91fe48aba18be7541531cceb7f11a6a4471e92abd55b3b90"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 08 5F 5E 33 C0 5B 5D C3 8B 55 14 89 02 8B 45 18 5F 89 30 B9 01 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Trickbot_9D4D3Fa4 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Trickbot (Windows.Trojan.Trickbot)"
		author = "Elastic Security"
		id = "9d4d3fa4-4e37-40d7-8399-a49130b7ef49"
		date = "2021-03-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L212-L229"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "7c3c9917a95248fd990b6947a0304ded473bf1bcceec8f4498a7955e879d348b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b06c3c7ba1f5823ce381971ed29554e5ddbe327b197de312738165ee8bf6e194"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 89 44 24 18 33 C9 89 44 24 1C 8D 54 24 38 89 44 24 20 33 F6 89 44 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Trickbot_34F00046 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Trickbot (Windows.Trojan.Trickbot)"
		author = "Elastic Security"
		id = "34f00046-8938-4103-91ec-4a745a627d4a"
		date = "2021-03-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L231-L248"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "f9d646645d6726e3aac5cc3eaea9edf1c89c7e743aff7cfa73998a72f3446711"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "5c6f11e2a040ae32336f4b4c4717e0f10c73359899302b77e1803f3a609309c0"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 30 FF FF FF 03 08 8B 95 30 FF FF FF 2B D1 89 95 30 FF FF FF }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Trickbot_F2A18B09 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Trickbot (Windows.Trojan.Trickbot)"
		author = "Elastic Security"
		id = "f2a18b09-f7b3-4d1a-87ab-3018f520b69c"
		date = "2021-03-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L250-L267"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "c4c4b0b1df1e8fde87284fb27d46e917c47b479a675fec60faeca6185511907d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "3e4474205efe22ea0185c49052e259bc08de8da7c924372f6eb984ae36b91a1c"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 04 39 45 08 75 08 8B 4D F8 8B 41 18 EB 0F 8B 55 F8 8B 02 89 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Trickbot_D916Ae65 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Trickbot (Windows.Trojan.Trickbot)"
		author = "Elastic Security"
		id = "d916ae65-c97b-495c-89c2-4f1ec90081d2"
		date = "2021-03-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L269-L286"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "e0aafe498cd9f0e8addfef78027943a754ca797aafae0cb40f1c6425de501339"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "2e109ed59a1e759ef089e04c21016482bf70228da30d8b350fc370b4e4d120e0"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 5F 24 01 10 CF 22 01 10 EC 22 01 10 38 23 01 10 79 23 01 10 82 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Trickbot_52722678 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Trickbot (Windows.Trojan.Trickbot)"
		author = "Elastic Security"
		id = "52722678-afbe-43ec-a39b-6848b7d49488"
		date = "2021-03-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L288-L305"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "6340171fdde68b32de480f1f410aa4c491a8fffa7c1f699bf5fa72a12ecb77b8"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e67dda5227be74424656957843777ea533b6800576fd85f978fd8fb50504209c"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 2B 5D 0C 89 5D EC EB 03 8B 5D EC 8A 1C 3B 84 DB 74 0D 38 1F }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Trickbot_28A60148 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Trickbot (Windows.Trojan.Trickbot)"
		author = "Elastic Security"
		id = "28a60148-2efb-4cd2-ada1-dd2ae2699adf"
		date = "2021-03-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L307-L324"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "20a26ed3f0da3a77867597494bf0069a2093ec19b1c5e179c0e7934c1b69d4b9"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "c857aa792ef247bfcf81e75fb696498b1ba25c09fc04049223a6dfc09cc064b1"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { C0 31 E8 83 7D 0C 00 89 44 24 38 0F 29 44 24 20 0F 29 44 24 10 0F 29 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Trickbot_997B25A0 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Trickbot (Windows.Trojan.Trickbot)"
		author = "Elastic Security"
		id = "997b25a0-aeac-4f74-aa87-232c4f8329b6"
		date = "2021-03-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L326-L343"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "ca688086c4628c64c32a99083d620bcb5373e3100d154331451a3e9f86081aca"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0bba1c5284ed0548f51fdfd6fb96e24f92f7f4132caefbf0704efb0b1a64b7c4"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 85 D2 74 F0 C6 45 E1 20 8D 4D E1 C6 45 E2 4A C6 45 E3 4A C6 45 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Trickbot_B17B33A1 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Trickbot (Windows.Trojan.Trickbot)"
		author = "Elastic Security"
		id = "b17b33a1-1021-4980-8ffd-2e7aa4ca2ae4"
		date = "2021-03-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L345-L362"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "7fa69674d1e985bafe310597f23ae80113136768141f0a1931baf88b2509e6ef"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "753d15c1ff0cc4cf75250761360bb35280ff0a1a4d34320df354e0329dd35211"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 08 53 55 56 57 64 A1 30 00 00 00 89 44 24 10 8B 44 24 10 8B }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Trickbot_23D77Ae5 : FILE MEMORY {
    meta:
		description = "Targets importDll64 containing Browser data stealer module"
		author = "Elastic Security"
		id = "23d77ae5-80de-4bb0-8701-ddcaff443dcc"
		date = "2021-03-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L364-L396"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "844974a2d3266e1f9ba275520c0e8a5d176df69a0ccd5135b99facf798a5d209"
		logic_hash = "e5f5cf854ebd0e25fffbd6796217f22223a06937e1cacb33baa105ac41731256"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "d382a99e5eed87cf2eab5e238e445ca0bf7852e40b0dd06a392057e76144699f"
		threat_name = "Windows.Trojan.Trickbot"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "/system32/cmd.exe /c \"start microsoft-edge:{URL}\"" ascii fullword
		$a2 = "SELECT name, value, host_key, path, expires_utc, creation_utc, encrypted_value FROM cookies" ascii fullword
		$a3 = "attempt %d. Cookies not found" ascii fullword
		$a4 = "attempt %d. History not found" ascii fullword
		$a5 = "Cookies version is %d (%d)" ascii fullword
		$a6 = "attempt %d. Local Storage not found" ascii fullword
		$a7 = "str+='xie.com.'+p+'.guid='+'{'+components[i]+'}\\n';" ascii fullword
		$a8 = "Browser exec is: %s" ascii fullword
		$a9 = "found mozilla key: %s" ascii fullword
		$a10 = "Version %d is not supported" ascii fullword
		$a11 = "id %d - %s" ascii fullword
		$a12 = "prot: %s, scope: %s, port: %d" ascii fullword
		$a13 = "***** Send %d bytes to callback from %s *****" ascii fullword
		$a14 = "/chrome.exe {URL}" ascii fullword

	condition:
		4 of ($a*)
}
rule ELASTIC_Windows_Trojan_Trickbot_5574Be7D : FILE MEMORY {
    meta:
		description = "Targets injectDll64 containing injection functionality to steal banking credentials"
		author = "Elastic Security"
		id = "5574be7d-7502-4357-8110-2fb4a661b2bd"
		date = "2021-03-29"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L398-L432"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "8c5c0d27153f60ef8aec57def2f88e3d5f9a7385b5e8b8177bab55fa7fac7b18"
		logic_hash = "ed0fc98c5d628ce38b923e1410eaf7a4a65ecffea42bed35314e30c99a52219b"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "23d9b89917a0fc5aad903595b89b650f6dbb0f82ce28ce8bcc891904f62ccf1b"
		threat_name = "Windows.Trojan.Trickbot"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "webinject64.dll" ascii fullword
		$a2 = "Mozilla Firefox version: %s" ascii fullword
		$a3 = "socks=127.0.0.1:" ascii fullword
		$a4 = "<conf ctl=\"dpost\" file=\"dpost\" period=\"60\"/>" ascii fullword
		$a5 = "<moduleconfig>" ascii fullword
		$a6 = "https://%.*s%.*s" ascii fullword
		$a7 = "http://%.*s%.*s" ascii fullword
		$a8 = "Chrome version: %s" ascii fullword
		$a9 = "IE version real: %s" ascii fullword
		$a10 = "IE version old: %s" ascii fullword
		$a11 = "Build date: %s %s" ascii fullword
		$a12 = "EnumDpostServer" ascii fullword
		$a13 = "ESTR_PASS_" ascii fullword
		$a14 = "<conf ctl=\"dinj\" file=\"dinj\" period=\"20\"/>" ascii fullword
		$a15 = "<conf ctl=\"sinj\" file=\"sinj\" period=\"20\"/>" ascii fullword
		$a16 = "<autoconf>" ascii fullword

	condition:
		4 of ($a*)
}
rule ELASTIC_Windows_Trojan_Trickbot_1473F0B4 : FILE MEMORY {
    meta:
		description = "Targets mailsearcher64.dll module"
		author = "Elastic Security"
		id = "1473f0b4-a6b5-4b19-a07e-83d32a7e44a0"
		date = "2021-03-29"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L434-L459"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9cfb441eb5c60ab1c90b58d4878543ee554ada2cceee98d6b867e73490d30fec"
		logic_hash = "dc13625e58c029c60b8670f8e63cd7786bf3e9705c462f3cbbf5b39e7c02f9a1"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "15438ae141a2ac886b1ba406ba45119da1a616c3b2b88da3f432253421aa8e8b"
		threat_name = "Windows.Trojan.Trickbot"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "mailsearcher.dll" ascii fullword
		$a2 = "%s/%s/%s/send/" wide fullword
		$a3 = "Content-Disposition: form-data; name=\"list\"" ascii fullword
		$a4 = "<moduleconfig><needinfo name=\"id\"/><needinfo name=\"ip\"/><autostart>no</autostart><autoconf><conf ctl=\"SetConf\" file=\"mail"
		$a5 = "eriod=\"60\"/></autoconf></moduleconfig>" ascii fullword
		$a6 = "=Waitu H" ascii fullword
		$a7 = "Content-Length: %d" ascii fullword

	condition:
		2 of ($a*)
}
rule ELASTIC_Windows_Trojan_Trickbot_Dcf25Dde : FILE MEMORY {
    meta:
		description = "Targets networkDll64.dll module containing functionality to gather network and system information"
		author = "Elastic Security"
		id = "dcf25dde-36c4-4a24-aa2b-0b3f42324918"
		date = "2021-03-29"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L461-L502"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ba2a255671d33677cab8d93531eb25c0b1f1ac3e3085b95365a017463662d787"
		logic_hash = "64d15d92faf0919a8fa1ce6772750cde47eaa24b09cf4243393777334bad9712"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "4088ae29cb3b665ccedf69e9d02c1ff58620d4b589343cd4077983b25c5b479f"
		threat_name = "Windows.Trojan.Trickbot"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Host Name - %s" wide fullword
		$a2 = "Last Boot Up Time - %02u/%02u/%04u %02d.%02d.%02d" wide fullword
		$a3 = "Install Date - %02u/%02u/%04u %02d.%02d.%02d" wide fullword
		$a4 = "System Directory - %s" wide fullword
		$a5 = "OS Version - %s" wide fullword
		$a6 = "***PROCESS LIST***" wide fullword
		$a7 = "Product Type - Domain Controller" wide fullword
		$a8 = "Registered Organization - %s" wide fullword
		$a9 = "Product Type - Domain Controller" wide fullword
		$a10 = "Build Type - %s" wide fullword
		$a11 = "Boot Device - %s" wide fullword
		$a12 = "Serial Number - %s" wide fullword
		$a13 = "OS Architecture - %s" wide fullword
		$a14 = "<moduleconfig><needinfo name=\"id\"/><needinfo name=\"ip\"/><autoconf><conf ctl=\"SetConf\" file=\"dpost\" period=\"1440\"/></au"
		$a15 = "oduleconfig>" ascii fullword
		$a16 = "Computer name: %s" wide fullword
		$a17 = "/c net view /all /domain" ascii fullword
		$a18 = "/c nltest /domain_trusts" ascii fullword
		$a19 = "***SYSTEMINFO***" wide fullword
		$a20 = "***LOCAL MACHINE DATA***" wide fullword
		$a21 = "Admin Name: %s" wide fullword
		$a22 = "Domain controller: %s" wide fullword
		$a23 = "Admin E-mail: %s" wide fullword

	condition:
		4 of ($a*)
}
rule ELASTIC_Windows_Trojan_Trickbot_46Dc12Dd : FILE MEMORY {
    meta:
		description = "Targets newBCtestDll64 module containing reverse shell functionality"
		author = "Elastic Security"
		id = "46dc12dd-d81a-43a6-b7c3-f59afa1c863e"
		date = "2021-03-29"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L504-L528"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "bf38a787aee5afdcab00b95ccdf036bc7f91f07151b4444b54165bb70d649ce5"
		logic_hash = "e01209a83f4743cbad7dda01595c053277868bd47208e48214b557ae339b5b3c"
		score = 50
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "997fe1c5a06bfffb754051436c48a0538ff2dcbfddf0d865c3a3797252247946"
		threat_name = "Windows.Trojan.Trickbot"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "setconf" ascii fullword
		$a2 = "<moduleconfig><autostart>yes</autostart><sys>yes</sys><needinfo name = \"id\"/><needinfo name = \"ip\"/><autoconf><conf ctl = \""
		$a3 = "nf\" file = \"bcconfig\" period = \"90\"/></autoconf></moduleconfig>" ascii fullword
		$a4 = "<moduleconfig><autostart>yes</autostart><sys>yes</sys><needinfo name = \"id\"/><needinfo name = \"ip\"/><autoconf><conf ctl = \""
		$a5 = "<addr>" ascii fullword
		$a6 = "</addr>" ascii fullword

	condition:
		4 of ($a*)
}
rule ELASTIC_Windows_Trojan_Trickbot_78A26074 : FILE MEMORY {
    meta:
		description = "Targets psfin64.dll module containing point-of-sale recon functionality"
		author = "Elastic Security"
		id = "78a26074-dc4b-436d-8188-2a3cfdabf6db"
		date = "2021-03-29"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L530-L564"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "8cd75fa8650ebcf0a6200283e474a081cc0be57307e54909ee15f4d04621dde0"
		logic_hash = "3837c22f7f9d55f03cb0bc1336798f0e2a91549c187b9f5136491cbafd26ce6e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f0446c7e1a497b93720824f4a5b72f23f00d0ee9a1607bc0c1b097109ec132a8"
		threat_name = "Windows.Trojan.Trickbot"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "<moduleconfig><needinfo name=\"id\"/><needinfo name=\"ip\"/><autoconf><conf ctl=\"SetConf\" file=\"dpost\" period=\"14400\"/></a"
		$a2 = "Dpost servers unavailable" ascii fullword
		$a3 = "moduleconfig>" ascii fullword
		$a4 = "ALOHA found: %d" wide fullword
		$a5 = "BOH found: %d" wide fullword
		$a6 = "MICROS found: %d" wide fullword
		$a7 = "LANE found: %d" wide fullword
		$a8 = "RETAIL found: %d" wide fullword
		$a9 = "REG found: %d" wide fullword
		$a10 = "STORE found: %d" wide fullword
		$a11 = "POS found: %d" wide fullword
		$a12 = "DOMAIN %s" wide fullword
		$a13 = "/%s/%s/90" wide fullword
		$a14 = "CASH found: %d" wide fullword
		$a15 = "COMPUTERS:" wide fullword
		$a16 = "TERM found: %d" wide fullword

	condition:
		3 of ($a*)
}
rule ELASTIC_Windows_Trojan_Trickbot_217B9C97 : FILE MEMORY {
    meta:
		description = "Targets pwgrab64.dll module containing functionality use to retrieve local passwords"
		author = "Elastic Security"
		id = "217b9c97-a637-49b8-a652-5a42ea19ee8e"
		date = "2021-03-29"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L566-L601"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1e90a73793017720c9a020069ed1c87879174c19c3b619e5b78db8220a63e9b7"
		logic_hash = "9b2b8a8154d4aba06029fd35d896331449f7baa961f183fb0cb47e890610ff99"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "7d5dcb60526a80926bbaa7e3cd9958719e326a160455095ff9f0315e85b8adf6"
		threat_name = "Windows.Trojan.Trickbot"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "pwgrab.dll" ascii fullword
		$a2 = "\\\\.\\pipe\\pidplacesomepipe" ascii fullword
		$a3 = "\\Google\\Chrome\\User Data\\Default\\Login Data.bak" ascii fullword
		$a4 = "select origin_url, username_value, password_value, length(password_value) from logins where blacklisted_by_user = 0" ascii fullword
		$a5 = "<moduleconfig><autostart>yes</autostart><all>yes</all><needinfo name=\"id\"/><needinfo name=\"ip\"/><autoconf><conf ctl=\"dpost"
		$a6 = "Grab_Passwords_Chrome(0)" ascii fullword
		$a7 = "Grab_Passwords_Chrome(1)" ascii fullword
		$a8 = "=\"dpost\" period=\"60\"/></autoconf></moduleconfig>" ascii fullword
		$a9 = "Grab_Passwords_Chrome(): Can't open database" ascii fullword
		$a10 = "UPDATE %Q.%s SET sql = CASE WHEN type = 'trigger' THEN sqlite_rename_trigger(sql, %Q)ELSE sqlite_rename_table(sql, %Q) END, tbl_"
		$a11 = "Chrome login db copied" ascii fullword
		$a12 = "Skip Chrome login db copy" ascii fullword
		$a13 = "Mozilla\\Firefox\\Profiles\\" ascii fullword
		$a14 = "Grab_Passwords_Chrome() success" ascii fullword
		$a15 = "No password provided by user" ascii fullword
		$a16 = "Chrome login db should be copied (copy absent)" ascii fullword
		$a17 = "Software\\Microsoft\\Internet Explorer\\IntelliForms\\Storage2" wide fullword

	condition:
		4 of ($a*)
}
rule ELASTIC_Windows_Trojan_Trickbot_D2110921 : FILE MEMORY {
    meta:
		description = "Targets shareDll64.dll module containing functionality use to spread Trickbot across local networks"
		author = "Elastic Security"
		id = "d2110921-b957-49b7-8a26-4c0b7d1d58ad"
		date = "2021-03-29"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L603-L632"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "05ef40f7745db836de735ac73d6101406e1d9e58c6b5f5322254eb75b98d236a"
		logic_hash = "39ef17836f29c358f596e0047d582b5f1d1af523c8f6354ac8a783eda9969554"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "55dbbcbc77ec51a378ad2ba8d56cb0811d23b121cacd037503fd75d08529c5b5"
		threat_name = "Windows.Trojan.Trickbot"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "module64.dll" ascii fullword
		$a2 = "Size - %d kB" ascii fullword
		$a3 = "%s - FAIL" wide fullword
		$a4 = "%s - SUCCESS" wide fullword
		$a5 = "ControlSystemInfoService" ascii fullword
		$a6 = "<moduleconfig><autostart>yes</autostart></moduleconfig>" ascii fullword
		$a7 = "Copy: %d" wide fullword
		$a8 = "Start sc 0x%x" wide fullword
		$a9 = "Create sc 0x%x" wide fullword
		$a10 = "Open sc %d" wide fullword
		$a11 = "ServiceInfoControl" ascii fullword

	condition:
		3 of ($a*)
}
rule ELASTIC_Windows_Trojan_Trickbot_0114D469 : FILE MEMORY {
    meta:
		description = "Targets systeminfo64.dll module containing functionality use to retrieve system information"
		author = "Elastic Security"
		id = "0114d469-8731-4f4f-8657-49cded5efadb"
		date = "2021-03-29"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L634-L667"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "083cb35a7064aa5589efc544ac1ed1b04ec0f89f0e60383fcb1b02b63f4117e9"
		logic_hash = "6ca8e73f758d3fa956fe53cc83abb43806359f93df05c42a58e2f394a1a3c117"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "4f1fa072f4ba577d590bb8946ea9b9774aa291cb2406f13be5932e97e8e760c6"
		threat_name = "Windows.Trojan.Trickbot"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "<user>%s</user>" wide fullword
		$a2 = "<service>%s</service>" wide fullword
		$a3 = "<users>" wide fullword
		$a4 = "</users>" wide fullword
		$a5 = "%s%s%s</general>" wide fullword
		$a6 = "<program>%s</program>" wide fullword
		$a7 = "<moduleconfig><autostart>no</autostart><limit>2</limit></moduleconfig>" ascii fullword
		$a8 = "<cpu>%s</cpu>" wide fullword
		$a9 = "<ram>%s</ram>" wide fullword
		$a10 = "</installed>" wide fullword
		$a11 = "<installed>" wide fullword
		$a12 = "<general>" wide fullword
		$a13 = "SELECT * FROM Win32_Processor" wide fullword
		$a14 = "SELECT * FROM Win32_OperatingSystem" wide fullword
		$a15 = "SELECT * FROM Win32_ComputerSystem" wide fullword

	condition:
		6 of ($a*)
}
rule ELASTIC_Windows_Trojan_Trickbot_07239Dad : FILE MEMORY {
    meta:
		description = "Targets vncDll64.dll module containing remote control VNC functionality"
		author = "Elastic Security"
		id = "07239dad-7f9e-4b20-a691-d9538405b931"
		date = "2021-03-29"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L669-L703"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "dbd534f2b5739f89e99782563062169289f23aa335639a9552173bedc98bb834"
		logic_hash = "231592d1a45798de6d22c922626ca28ef4019bae95d552a0f2822823d8dec384"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "32d63b8db4307fd67e2c9068e22f843f920f19279c4a40e17cd14943577e7c81"
		threat_name = "Windows.Trojan.Trickbot"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "C:\\Users\\MaxMikhaylov\\Documents\\Visual Studio 2010\\MMVNC.PROXY\\VNCSRV\\x64\\Release\\VNCSRV.pdb" ascii fullword
		$a2 = "vncsrv.dll" ascii fullword
		$a3 = "-new -noframemerging http://www.google.com" ascii fullword
		$a4 = "IE.HTTP\\shell\\open\\command" ascii fullword
		$a5 = "EDGE\\shell\\open\\command" ascii fullword
		$a6 = "/K schtasks.exe |more" ascii fullword
		$a7 = "<moduleconfig><needinfo name=\"id\"/><needinfo name=\"ip\"/></moduleconfig> " ascii fullword
		$a8 = "\\Microsoft Office\\Office16\\outlook.exe" ascii fullword
		$a9 = "\\Microsoft Office\\Office11\\outlook.exe" ascii fullword
		$a10 = "\\Microsoft Office\\Office15\\outlook.exe" ascii fullword
		$a11 = "\\Microsoft Office\\Office12\\outlook.exe" ascii fullword
		$a12 = "\\Microsoft Office\\Office14\\outlook.exe" ascii fullword
		$a13 = "TEST.TEMP:" ascii fullword
		$a14 = "Chrome_WidgetWin" wide fullword
		$a15 = "o --disable-gpu --disable-d3d11 --disable-accelerated-2d-canvas" ascii fullword
		$a16 = "NetServerStart" ascii fullword

	condition:
		6 of ($a*)
}
rule ELASTIC_Windows_Trojan_Trickbot_Fd7A39Af : FILE MEMORY {
    meta:
		description = "Targets wormDll64.dll module containing spreading functionality"
		author = "Elastic Security"
		id = "fd7a39af-c6ea-4682-a00a-01f775c3bb8d"
		date = "2021-03-29"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L705-L739"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "d5bb8d94b71d475b5eb9bb4235a428563f4104ea49f11ef02c8a08d2e859fd68"
		logic_hash = "15cb286504e6167c78e194488555f565965a03e7714fe16692a115df26985a01"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "3f2e654f2ffdd940c27caec3faeb4bda24c797a17d0987378e36c1e16fadc772"
		threat_name = "Windows.Trojan.Trickbot"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "module64.dll" ascii fullword
		$a2 = "worming.png" wide
		$a3 = "Size - %d kB" ascii fullword
		$a4 = "[+] %s -" wide fullword
		$a5 = "%s\\system32" ascii fullword
		$a6 = "[-] %s" wide fullword
		$a7 = "<moduleconfig><autostart>yes</autostart><sys>yes</sys><needinfo name=\"id\"/><needinfo name=\"ip\"/></moduleconfig>" ascii fullword
		$a8 = "*****MACHINE IN WORKGROUP*****" wide fullword
		$a9 = "*****MACHINE IN DOMAIN*****" wide fullword
		$a10 = "\\\\%s\\IPC$" ascii fullword
		$a11 = "Windows 5" ascii fullword
		$a12 = "InfMach" ascii fullword
		$a13 = "%s x64" wide fullword
		$a14 = "%s x86" wide fullword
		$a15 = "s(&(objectCategory=computer)(userAccountControl:" wide fullword
		$a16 = "------MACHINE IN D-N------" wide fullword

	condition:
		5 of ($a*)
}
rule ELASTIC_Windows_Trojan_Trickbot_2D89E9Cd : FILE MEMORY {
    meta:
		description = "Targets tabDll64.dll module containing functionality using SMB for lateral movement"
		author = "Elastic Security"
		id = "2d89e9cd-2941-4b20-ab4e-a487d329ff76"
		date = "2021-03-29"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L741-L785"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "3963649ebfabe8f6277190be4300ecdb68d4b497ac5f81f38231d3e6c862a0a8"
		logic_hash = "c15833687c2aed55aae0bb5de83c088cb66edeb4ad1964543522f5477c1f1942"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "e6eea38858cfbbe5441b1f69c5029ff9279e7affa51615f6c91981fe656294fc"
		threat_name = "Windows.Trojan.Trickbot"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "[INJECT] inject_via_remotethread_wow64: pExecuteX64( pX64function, ctx ) failed" ascii fullword
		$a2 = "[INJECT] inject_via_remotethread_wow64: VirtualAlloc pExecuteX64 failed" ascii fullword
		$a3 = "%SystemRoot%\\system32\\stsvc.exe" ascii fullword
		$a4 = "[INJECT] inject_via_remotethread_wow64: pExecuteX64=0x%08p, pX64function=0x%08p, ctx=0x%08p" ascii fullword
		$a5 = "DLL and target process must be same architecture" ascii fullword
		$a6 = "[INJECT] inject_via_remotethread_wow64: VirtualAlloc pX64function failed" ascii fullword
		$a7 = "%SystemDrive%\\stsvc.exe" ascii fullword
		$a8 = "Wrote shellcode to 0x%x" ascii fullword
		$a9 = "ERROR: %d, line - %d" wide fullword
		$a10 = "[INJECT] inject_via_remotethread_wow64: Success, hThread=0x%08p" ascii fullword
		$a11 = "GetProcessPEB:EXCEPT" wide fullword
		$a12 = "Checked count - %i, connected count %i" wide fullword
		$a13 = "C:\\%s\\%s C:\\%s\\%s" ascii fullword
		$a14 = "C:\\%s\\%s" ascii fullword
		$a15 = "%s\\ADMIN$\\stsvc.exe" wide fullword
		$a16 = "%s\\C$\\stsvc.exe" wide fullword
		$a17 = "Size - %d kB" ascii fullword
		$a18 = "<moduleconfig><autostart>yes</autostart><sys>yes</sys><needinfo name=\"id\"/><needinfo name=\"ip\"/><autoconf><conf ctl=\"dpost"
		$a19 = "%s - FAIL" wide fullword
		$a20 = "%s - SUCCESS" wide fullword
		$a21 = "CmainSpreader::init() CreateEvent, error code %i" wide fullword
		$a22 = "Incorrect ModuleHandle %i, expect %i" wide fullword
		$a23 = "My interface is \"%i.%i.%i.%i\", mask \"%i.%i.%i.%i\"" wide fullword
		$a24 = "WormShare" ascii fullword
		$a25 = "ModuleHandle 0x%08X, call Control: error create thread %i" wide fullword
		$a26 = "Enter to Control: moduleHandle 0x%08X, unknown Ctl = \"%S\"" wide fullword

	condition:
		3 of ($a*)
}
rule ELASTIC_Windows_Trojan_Trickbot_32930807 : FILE MEMORY {
    meta:
		description = "Targets cookiesdll.dll module containing functionality used to retrieve browser cookie data"
		author = "Elastic Security"
		id = "32930807-30bb-4c57-8e17-0da99a816405"
		date = "2021-03-30"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L787-L808"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "e999b83629355ec7ff3b6fda465ef53ce6992c9327344fbf124f7eb37808389d"
		logic_hash = "e98503696bd72cab4d0d1633991bdb87c0537fd1e2d95507ccd474125328f318"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0aeb68977f4926272f27d5fba44e66bdbb9d6a113da5d7b4133a379b06df4474"
		threat_name = "Windows.Trojan.Trickbot"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "select name, encrypted_value, host_key, path, length(encrypted_value), creation_utc, expires_utc from cookies where datetime(exp"
		$a2 = "Cookies send failure: servers unavailable" ascii fullword
		$a3 = "<moduleconfig>"

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Trickbot_618B27D2 : FILE MEMORY {
    meta:
		description = "Targets Outlook.dll module containing functionality used to retrieve Outlook data"
		author = "Elastic Security"
		id = "618b27d2-22ad-4542-86ed-7148f17971da"
		date = "2021-03-30"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L810-L843"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "d3ec8f4a46b21fb189fc3d58f3d87bf9897653ecdf90b7952dcc71f3b4023b4e"
		logic_hash = "e66a9dd7efdbff8b9e30119d0e99187e3dfa4ca1c1bc1ade0f8f1003d10e2620"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "df4336e5cbca495dac4fe110bd7a727e91bb3d465f76d3f3796078332c13633c"
		threat_name = "Windows.Trojan.Trickbot"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "OutlookX32.dll" ascii fullword
		$a2 = "Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows Messaging Subsystem\\Profiles\\Outlook" wide fullword
		$a3 = "Software\\Microsoft\\Office\\16.0\\Outlook\\Profiles\\Outlook" wide fullword
		$a4 = "Software\\Microsoft\\Office\\15.0\\Outlook\\Profiles\\Outlook" wide fullword
		$a5 = "OutlookX32" ascii fullword
		$a6 = " Port:" wide fullword
		$a7 = " User:" wide fullword
		$a8 = " Pass:" wide fullword
		$a9 = "String$" ascii fullword
		$a10 = "outlookDecrU" ascii fullword
		$a11 = "Cannot Decrypt" ascii fullword
		$a12 = " Mail:" wide fullword
		$a13 = " Serv:" wide fullword
		$a14 = ",outlookDecr" ascii fullword
		$a15 = "CryptApi" ascii fullword

	condition:
		5 of ($a*)
}
rule ELASTIC_Windows_Trojan_Trickbot_6Eb31E7B : FILE MEMORY {
    meta:
		description = "Targets DomainDll module containing functionality using LDAP to retrieve credentials and configuration information"
		author = "Elastic Security"
		id = "6eb31e7b-9dc3-48ff-91fe-8c584729c415"
		date = "2021-03-30"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L845-L872"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "3e3d82ea4764b117b71119e7c2eecf46b7c2126617eafccdfc6e96e13da973b1"
		logic_hash = "5b6902c8644c79bd183725f0e41bf2f7ae425bf0eb1dddea6fd1a38b77f176ba"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "d145b7c95bca0dc0c46a8dff60341a21dce474edd169dd0ee5ea2396dad60b92"
		threat_name = "Windows.Trojan.Trickbot"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "module32.dll" ascii fullword
		$a2 = "Size - %d kB" ascii fullword
		$a3 = "</moduleconfig> " ascii fullword
		$a4 = "<moduleconfig>" ascii fullword
		$a5 = "\\\\%ls\\SYSVOL\\%ls" wide fullword
		$a6 = "DomainGrabber"
		$a7 = "<autostart>yes</autostart>" ascii fullword
		$a8 = "<needinfo name=\"id\"/>" ascii fullword
		$a9 = "(&(objectCategory=computer)(userAccountControl:1.2.840.113556.1.4.803:=8192))" wide fullword

	condition:
		5 of ($a*)
}
rule ELASTIC_Windows_Trojan_Trickbot_91516Cf4 : FILE MEMORY {
    meta:
		description = "Generic signature used to identify Trickbot module usage"
		author = "Elastic Security"
		id = "91516cf4-c826-4d5d-908f-e1c0b3bccec5"
		date = "2021-03-30"
		modified = "2021-08-31"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L874-L896"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6cd0d4666553fd7184895502d48c960294307d57be722ebb2188b004fc1a8066"
		logic_hash = "6c0bdd6827bebb337c0012cdb6e931cd96ce2ad61f3764f288b96ff049b2d007"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "2667c7181fb4db3f5765369fc2ec010b807a7bf6e2878fc42af410f036c61cbe"
		threat_name = "Windows.Trojan.Trickbot"
		severity = 80
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "<moduleconfig>" ascii wide
		$a2 = "<autostart>" ascii wide
		$a3 = "</autostart>" ascii wide
		$a4 = "</moduleconfig>" ascii wide

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Trickbot_Be718Af9 : FILE MEMORY {
    meta:
		description = "Targets permadll module used to fingerprint BIOS/firmaware data"
		author = "Elastic Security"
		id = "be718af9-5995-4ae2-ba55-504e88693c96"
		date = "2021-03-30"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L898-L921"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c1f1bc58456cff7413d7234e348d47a8acfdc9d019ae7a4aba1afc1b3ed55ffa"
		logic_hash = "d020f7d1637fc4ee3246e97c9acae0be1782e688154bd109f53f807211beebd7"
		score = 75
		quality = 25
		tags = "FILE, MEMORY"
		fingerprint = "047b1c64b8be17d4a6030ab2944ad715380f53a8a6dd9c8887f198693825a81d"
		threat_name = "Windows.Trojan.Trickbot"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "user_platform_check.dll" ascii fullword
		$a2 = "<moduleconfig><nohead>yes</nohead></moduleconfig>" ascii fullword
		$a3 = "DDEADFDEEEEE"
		$a4 = "\\`Ruuuuu_Exs|_" ascii fullword
		$a5 = "\"%pueuu%" ascii fullword

	condition:
		3 of ($a*)
}
rule ELASTIC_Windows_Trojan_Trickbot_F8Dac4Bc : FILE MEMORY {
    meta:
		description = "Targets rdpscan module used to bruteforce RDP"
		author = "Elastic Security"
		id = "f8dac4bc-2ea1-4733-a260-59f3cae2eba8"
		date = "2021-03-30"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L923-L954"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "13d102d546b9384f944f2a520ba32fb5606182bed45a8bba681e4374d7e5e322"
		logic_hash = "d4536aac0ee402abcb87826e45c892d6f39562bc1e39b72ae8880dc077f230d9"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "256daf823f6296ae02103336817dec565129a11f37445b791b2f8e3163f0c17f"
		threat_name = "Windows.Trojan.Trickbot"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "rdpscan.dll" ascii fullword
		$a2 = "F:\\rdpscan\\Bin\\Release_nologs\\"
		$a3 = "Cookie: %s %s" wide fullword
		$a4 = "<moduleconfig><needinfo name=\"id\"/><needinfo name=\"ip\"/><autoconf><conf ctl=\"srv\" file=\"srv\" period=\"60\"/></autoconf><"
		$a5 = "<moduleconfig><needinfo name=\"id\"/><needinfo name=\"ip\"/><autoconf><conf ctl=\"srv\" file=\"srv\" period=\"60\"/></autoconf><"
		$a6 = "X^Failed to create a list of contr" ascii fullword
		$a7 = "rdp/domains" wide fullword
		$a8 = "Your product name" wide fullword
		$a9 = "rdp/over" wide fullword
		$a10 = "rdp/freq" wide fullword
		$a11 = "rdp/names" wide fullword
		$a12 = "rdp/dict" wide fullword
		$a13 = "rdp/mode" wide fullword

	condition:
		4 of ($a*)
}
rule ELASTIC_Windows_Trojan_Trickbot_9C0Fa8Fe : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Trickbot (Windows.Trojan.Trickbot)"
		author = "Elastic Security"
		id = "9c0fa8fe-8d5f-4581-87a0-92a4ed1b32b3"
		date = "2021-07-13"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Trickbot.yar#L956-L974"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f528c3ea7138df7c661d88fafe56d118b6ee1d639868212378232ca09dc9bfad"
		logic_hash = "23aebc3139c34ecd609db7920fa0d5e194173409e1862555e4c468dad6c46299"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "bd49ed2ee65ff0cfa95efc9887ed24de3882c5b5740d0efc6b9690454ca3f5dc"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 74 19 48 85 FF 74 60 8B 46 08 39 47 08 76 6A 33 ED B1 01 B0 01 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Siestagraph_8C36Ddc1 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Siestagraph (Windows.Trojan.SiestaGraph)"
		author = "Elastic Security"
		id = "8c36ddc1-c7fa-4c25-a05c-59c29e4e7c31"
		date = "2022-12-14"
		modified = "2022-12-15"
		reference = "https://www.elastic.co/security-labs/siestagraph-new-implant-uncovered-in-asean-member-foreign-ministry"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_SiestaGraph.yar#L1-L28"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "50c2f1bb99d742d8ae0ad7c049362b0e62d2d219b610dcf25ba50c303ccfef54"
		logic_hash = "17ce8090b88100f00c07df0599cd51dc7682f4c43de989ce58621df97eca42fb"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "a76d2b45261da65215797a4792a3aae5051d88ba15d01b24487c83d6a38b9ff7"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "downloadAsync" ascii nocase fullword
		$a2 = "UploadxAsync" ascii nocase fullword
		$a3 = "GetAllDriveRootChildren" ascii fullword
		$a4 = "GetDriveRoot" ascii fullword
		$a5 = "sendsession" wide fullword
		$b1 = "ListDrives" wide fullword
		$b2 = "Del OK" wide fullword
		$b3 = "createEmailDraft" ascii fullword
		$b4 = "delMail" ascii fullword

	condition:
		all of ($a*) and 2 of ($b*)
}
rule ELASTIC_Windows_Trojan_Siestagraph_Ad3Fe5C6 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Siestagraph (Windows.Trojan.SiestaGraph)"
		author = "Elastic Security"
		id = "ad3fe5c6-88ba-46cf-aefd-bd8ab0eff917"
		date = "2023-09-12"
		modified = "2023-09-20"
		reference = "https://www.elastic.co/security-labs/siestagraph-new-implant-uncovered-in-asean-member-foreign-ministry"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_SiestaGraph.yar#L30-L56"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "fe8f99445ad139160a47b109a8f3291eef9c6a23b4869c48d341380d608ed4cb"
		logic_hash = "b625221b77803c2c052db09c90a76666cf9e0ae34cb0d59ae303e890e646e94b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "653ca92d31c7212c1f154c2e18b3be095e9a39fe482ce99fbd84e19f4bf6ca64"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "GetAllDriveRootChildren" ascii fullword
		$a2 = "GetDriveRoot" ascii fullword
		$a3 = "sendsession" wide fullword
		$b1 = "status OK" wide fullword
		$b2 = "upload failed" wide fullword
		$b3 = "Failed to fetch file" wide fullword
		$c1 = "Specified file doesn't exist" wide fullword
		$c2 = "file does not exist" wide fullword

	condition:
		6 of them
}
rule ELASTIC_Windows_Trojan_Siestagraph_D801Ce71 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Siestagraph (Windows.Trojan.SiestaGraph)"
		author = "Elastic Security"
		id = "d801ce71-2e3d-47bb-a194-c68b437d8ecc"
		date = "2023-09-12"
		modified = "2023-09-20"
		reference = "https://www.elastic.co/security-labs/siestagraph-new-implant-uncovered-in-asean-member-foreign-ministry"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_SiestaGraph.yar#L58-L79"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "fe8f99445ad139160a47b109a8f3291eef9c6a23b4869c48d341380d608ed4cb"
		logic_hash = "c2d00d64d69cb5d24d76f6c551b49aa1acef1e1bab96f7ed7facc148244a8370"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "8e1d95313526650c2fa3dd00e779aec0e62d1a2273722ad913100eab003fc8b6"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$hashgenfunc = { 02 2C ?? 20 [4] 0A 16 0B 2B ?? 02 07 6F [4] 06 61 20 [4] 5A 0A 07 17 58 0B 07 02 6F [4] 32 ?? }
		$sendpostfunc = { 72 [4] 72 [4] 72 [4] 02 73 [4] 73 [4] 28 [4] 0A 72 [4] 72 [4] 06 28 [4] 2A }
		$command15 = { 25 16 1F 3A 9D 6F [4] 17 9A 13 ?? 11 ?? 28 [4] 13 ?? 11 ?? 28 [4] 11 ?? 28 [4] 2C 33 28 [4] 28 [4] 6F [4] 6F [4] 11 ?? 28 [4] 09 7B [4] 18 9A 72 [4] 72 [4] 28 [4] 26 DE }

	condition:
		all of them
}
rule ELASTIC_Windows_Hacktool_Rubeus_43F18623 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Rubeus (Windows.Hacktool.Rubeus)"
		author = "Elastic Security"
		id = "43f18623-6024-4608-8019-e3fecd54cf84"
		date = "2022-10-20"
		modified = "2022-11-24"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_Rubeus.yar#L1-L27"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b7b4691ad1cdad7663c32d07e911a03d9cc8b104f724c2825fd4957007649235"
		logic_hash = "8714f30e12c0dc61c83491a71dbf9f1e9b6bc66663a8f2c069e7a7841d52cf68"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "fbc2f67f394a4d21cac532b42c6749002cb7284b4a3912e18672881e6e74765d"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$guid = "658C8B7F-3664-4A95-9572-A3E5871DFC06" ascii wide nocase
		$print_str0 = "[*] Printing argument list for use with Rubeus" ascii wide
		$print_str1 = "[+] Ticket successfully imported!" ascii wide
		$print_str2 = "[+] Tickets successfully purged!" ascii wide
		$print_str3 = "[*] Searching for accounts that support AES128_CTS_HMAC_SHA1_96/AES256_CTS_HMAC_SHA1_96" ascii wide
		$print_str4 = "[*] Action: TGT Harvesting (with auto-renewal)" ascii wide
		$print_str5 = "[X] Unable to retrieve TGT using tgtdeleg" ascii wide
		$print_str6 = "[!] Unhandled Rubeus exception:" ascii wide
		$print_str7 = "[*] Using a TGT /ticket to request service tickets" ascii wide

	condition:
		$guid or 4 of ($print_str*)
}
rule ELASTIC_Multi_Ransomware_Luna_8614D3D7 : FILE MEMORY {
    meta:
		description = "Detects Multi Ransomware Luna (Multi.Ransomware.Luna)"
		author = "Elastic Security"
		id = "8614d3d7-7fd2-4cf9-aa97-48a8d9333f38"
		date = "2022-08-02"
		modified = "2022-08-16"
		reference = "https://www.elastic.co/security-labs/luna-ransomware-attack-pattern"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Ransomware_Luna.yar#L1-L27"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1cbbf108f44c8f4babde546d26425ca5340dccf878d306b90eb0fbec2f83ab51"
		logic_hash = "14e40c5b1a21ba31664ed31b04bfc4a8646b3e31f96d39e0928a3d6a50d79307"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "90c97ecfce451e1373af0d7538cf12991cc844d05c99ee18570e176143ccd899"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$str_extensions = ".ini.exe.dll.lnk"
		$str_ransomnote_bs64 = "W1dIQVQgSEFQUEVORUQ/XQ0KDQpBbGwgeW91ciBmaWxlcyB3ZXJlIG1vdmVkIHRvIHNlY3VyZSBzdG9yYWdlLg0KTm9ib"
		$str_path = "/home/username/"
		$str_error1 = "Error while writing encrypted data to:"
		$str_error2 = "Error while writing public key to:"
		$str_error3 = "Error while renaming file:"
		$chunk_calculation0 = { 48 8D ?? 00 00 48 F4 48 B9 8B 3D 10 B6 9A 5A B4 36 48 F7 E1 48 }
		$chunk_calculation1 = { 48 C1 EA 12 48 89 D0 48 C1 E0 05 48 29 D0 48 29 D0 48 3D C4 EA 00 00 }

	condition:
		5 of ($str_*) or all of ($chunk_*)
}
rule ELASTIC_Multi_Trojan_Mythic_4Beb7E17 : FILE MEMORY {
    meta:
		description = "Detects Multi Trojan Mythic (Multi.Trojan.Mythic)"
		author = "Elastic Security"
		id = "4beb7e17-34c2-4f5c-a668-e54512175f53"
		date = "2023-08-01"
		modified = "2023-09-20"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Trojan_Mythic.yar#L1-L28"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "7b3b7bae1763f3c73df206f97065920fa55b973d22c967acb3d26ac8e89e60c7"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0b25c5b069cec31e9af31b7822ea19b813fe1882dfaa584661ff14414ae41df5"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$a1 = "task_id"
		$a2 = "post_response"
		$a3 = "c2_profile"
		$a4 = "get_tasking"
		$a5 = "tasking_size"
		$a6 = "get_delegate_tasks"
		$a7 = "total_chunks"
		$a8 = "is_screenshot"
		$a9 = "file_browser"
		$a10 = "is_file"
		$a11 = "access_time"

	condition:
		7 of them
}
rule ELASTIC_Multi_Trojan_Mythic_E0Ea7Ef9 : FILE MEMORY {
    meta:
		description = "Detects Multi Trojan Mythic (Multi.Trojan.Mythic)"
		author = "Elastic Security"
		id = "e0ea7ef9-452c-404c-95ba-4057ec40ef4b"
		date = "2024-05-23"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Trojan_Mythic.yar#L30-L61"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "e091d63c8e8b0a32a3d25cffdf02419fdbec714f31e4061bafd80b1971831c5f"
		logic_hash = "237307d85fe7886eb2cf351a9f7872e3e5551f05535f0b6a966a960d204aee90"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "57afe989db139314a7505a2ccc01367cdd13132318dc19b57d4b79f65bfe982c"
		severity = 100
		arch_context = "x86, arm64"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$profile1 = "src/profiles/mod.rs"
		$profile2 = "src/profiles/http.rs"
		$rs_ssh1 = "src/ssh/spawn.rs"
		$rs_ssh2 = "src/ssh/agent.rs"
		$rs_ssh3 = "src/ssh/cat.rs"
		$rs_ssh4 = "src/ssh/upload.rs"
		$rs_ssh5 = "src/ssh/exec.rs"
		$rs_ssh6 = "src/ssh/download.rs"
		$rs_ssh7 = "src/ssh/rm.rs"
		$rs_ssh8 = "src/ssh/ls.rs"
		$rs_misc1 = "src/utils/linux.rs"
		$rs_misc2 = "src/portscan.rs"
		$rs_misc3 = "src/payloadvars.rs"
		$rs_misc4 = "src/getprivs.rs"

	condition:
		all of ($profile*) and 8 of ($rs*)
}
rule ELASTIC_Multi_Trojan_Mythic_528324B4 : FILE MEMORY {
    meta:
		description = "Detects Multi Trojan Mythic (Multi.Trojan.Mythic)"
		author = "Elastic Security"
		id = "528324b4-822d-4e48-b4ab-f5b234348773"
		date = "2024-05-23"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Trojan_Mythic.yar#L63-L89"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "2cd883eab722a5eacbca7fa82e0eebb5f6c30cffa955abcb1ab8cf169af97202"
		logic_hash = "8c85d086b30030a24fba9f519aed3fdf3c821932d71ceaecfe354fe07cd1d631"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "5188aa792c02acf7a6346f395389390ae187cb08083bfca27283a4f4dd4d7206"
		severity = 100
		arch_context = "x86, arm64"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$import1 = "Autofac"
		$import2 = "Obfuscar"
		$import3 = "Agent.Profiles.Http"
		$import4 = "Agent.Managers.Linux"
		$import5 = "Agent.Managers.Reflection"
		$athena1 = "Athena.Commands.dll"
		$athena2 = "Athena.Handler.Linux.dll"
		$athena3 = "Athena.dll"
		$athena4 = "Athena.Profiles.HTTP.dll"

	condition:
		(2 of ($import*)) or (2 of ($athena*))
}
rule ELASTIC_Windows_Trojan_Hazelcobra_6A9Fe48A : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Hazelcobra (Windows.Trojan.HazelCobra)"
		author = "Elastic Security"
		id = "6a9fe48a-6fd9-4bce-ac43-254c02d6b3a4"
		date = "2023-11-01"
		modified = "2023-11-01"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_HazelCobra.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b5acf14cdac40be590318dee95425d0746e85b1b7b1cbd14da66f21f2522bf4d"
		logic_hash = "dc4d561497c2e3da270d305ceaf3194b48d64c0d8e212ee6f03a2d89c8e006e8"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "4dc883be5fb6aae0dac0ec5d64baf24f0f3aaded6d759ec7dccb1a2ae641ae7b"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 83 E9 37 48 63 C2 F6 C2 01 75 0C C0 E1 04 48 D1 F8 88 4C 04 40 EB 07 }
		$s1 = "Data file loaded. Running..." fullword
		$s2 = "No key in args" fullword
		$s3 = "Can't read data file" fullword

	condition:
		$a1 or all of ($s*)
}
rule ELASTIC_Windows_Trojan_Bitsloth_05Fc3A0A : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bitsloth (Windows.Trojan.BITSloth)"
		author = "Elastic Security"
		id = "05fc3a0a-ce19-4042-90f8-32a43f40616e"
		date = "2024-07-16"
		modified = "2024-07-26"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_BITSloth.yar#L1-L27"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0944b17a4330e1c97600f62717d6bae7e4a4260604043f2390a14c8d76ef1507"
		logic_hash = "8210dc28cf408f7f836aad3c32868ea21dd0862070c2c37d98b089a80be9285e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "520722d4502230eed76b0c53fffb90bd2b818256363bc1393f51c378ff6cdd9b"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$str_1 = "/%s/index.htm?RspID=%d" wide fullword
		$str_2 = "/%s/%08x.rpl" wide fullword
		$str_3 = "/%s/wu.htm" wide fullword
		$str_4 = "GET_DESKDOP" wide fullword
		$str_5 = "http://updater.microsoft.com/index.aspx" wide fullword
		$str_6 = "[U] update error..." wide fullword
		$str_7 = "RMC_KERNEL ..." wide fullword
		$seq_global_protocol_check = { 81 3D ?? ?? ?? ?? F9 03 00 00 B9 AC 0F 00 00 0F 46 C1 }
		$seq_exit_windows = { 59 85 C0 0F 84 ?? ?? ?? ?? E9 ?? ?? ?? ?? 6A 02 EB ?? 56 EB }

	condition:
		2 of them
}
rule ELASTIC_Windows_Trojan_Darkvnc_Bd803C2E : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Darkvnc (Windows.Trojan.DarkVNC)"
		author = "Elastic Security"
		id = "bd803c2e-77bd-4b8c-bdfa-11a9bd54a454"
		date = "2023-01-23"
		modified = "2023-02-01"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_DarkVNC.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0fcc1b02fdaf211c772bd4fa1abcdeb5338d95911c226a9250200ff7f8e45601"
		logic_hash = "d9e8a42a424d6a186939682e1cd2ed794c8a3765824188e863b1b2829650e2d5"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "131f4b3ef5b01720a52958058ecc4c3681ed0ca975a1a06cd034d7205680e710"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "BOT-%s(%s)_%S-%S%u%u" wide fullword
		$a2 = "{%08X-%04X-%04X-%04X-%08X%04X}" wide fullword
		$a3 = "monitor_off / monitor_on" ascii fullword
		$a4 = "bot_shell >" ascii fullword
		$a5 = "keyboard and mouse are blocked !" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Ryuk_25D3C5Ba : BETA FILE MEMORY {
    meta:
		description = "Identifies RYUK ransomware"
		author = "Elastic Security"
		id = "25d3c5ba-8f80-4af0-8a5d-29c974fb016a"
		date = "2020-04-30"
		modified = "2021-08-23"
		reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.ryuk"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Ryuk.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "4d461ff9b87e3a17637cef89ff8a85ef22f69695d4664f6fe8f271a6a5f7b4bc"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "18e70599e3a187e77697844fa358dd150e7e25ac74060e8c7cf2707fb7304efd"
		threat_name = "Windows.Ransomware.Ryuk"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$g1 = { 41 8B C0 45 03 C7 99 F7 FE 48 63 C2 8A 4C 84 20 }

	condition:
		1 of ($g*)
}
rule ELASTIC_Windows_Ransomware_Ryuk_878Bae7E : BETA FILE MEMORY {
    meta:
		description = "Identifies RYUK ransomware"
		author = "Elastic Security"
		id = "878bae7e-1e53-4648-93aa-b4075eef256d"
		date = "2020-04-30"
		modified = "2021-08-23"
		reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.ryuk"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Ryuk.yar#L22-L42"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "94bed2220aeb41ae8069cee56cc5299b9fc56797d3b54085b8246a03d9e8bd93"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "93a501463bb2320a9ab824d70333da2b6f635eb5958d6f8de43fde3a21de2298"
		threat_name = "Windows.Ransomware.Ryuk"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$b2 = "RyukReadMe.html" wide fullword
		$b3 = "RyukReadMe.txt" wide fullword

	condition:
		1 of ($b*)
}
rule ELASTIC_Windows_Ransomware_Ryuk_6C726744 : BETA FILE MEMORY {
    meta:
		description = "Identifies RYUK ransomware"
		author = "Elastic Security"
		id = "6c726744-acdb-443a-b683-b11f8b657f7a"
		date = "2020-04-30"
		modified = "2021-08-23"
		reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.ryuk"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Ryuk.yar#L44-L67"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "ee7586d5cbef23d1863a4dfcc5da9b97397c993268881922c681022bf4f293f0"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "d0a4608907e48d02d78ff40a59d47cad1b9258df31b7312dd1a85f8fee2a28d5"
		threat_name = "Windows.Ransomware.Ryuk"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "172.16." ascii fullword
		$a2 = "192.168." ascii fullword
		$a3 = "DEL /F" wide fullword
		$a4 = "lsaas.exe" wide fullword
		$a5 = "delete[]" ascii fullword

	condition:
		4 of ($a*)
}
rule ELASTIC_Windows_Ransomware_Ryuk_1A4Ad952 : BETA FILE MEMORY {
    meta:
		description = "Identifies RYUK ransomware"
		author = "Elastic Security"
		id = "1a4ad952-cc99-4653-932b-290381e7c871"
		date = "2020-04-30"
		modified = "2021-08-23"
		reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.ryuk"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Ryuk.yar#L69-L88"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "bb854f5760f41e2c103c99d8f128a2546926a614dff8753eaa1287ac583e213a"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "d8c5162850e758e27439e808e914df63f42756c0b8f7c2b5f9346c0731d3960c"
		threat_name = "Windows.Ransomware.Ryuk"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$e1 = { 8B 0A 41 8D 45 01 45 03 C1 48 8D 52 08 41 3B C9 41 0F 45 C5 44 8B E8 49 63 C0 48 3B C3 72 E1 }

	condition:
		1 of ($e*)
}
rule ELASTIC_Windows_Ransomware_Ryuk_72B5Fd9D : BETA FILE MEMORY {
    meta:
		description = "Identifies RYUK ransomware"
		author = "Elastic Security"
		id = "72b5fd9d-23db-4f18-88d9-a849ec039135"
		date = "2020-04-30"
		modified = "2021-08-23"
		reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.ryuk"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Ryuk.yar#L90-L109"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "b2abc8f70df5d730ce6a7d0bc125bb623f27b292e7d575914368a8bfc0fb5837"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "7c394aa283336013b74a8aaeb56e8363033958b4a1bd8011f3b32cfe2d37e088"
		threat_name = "Windows.Ransomware.Ryuk"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$d1 = { 48 2B C3 33 DB 66 89 1C 46 48 83 FF FF 0F }

	condition:
		1 of ($d*)
}
rule ELASTIC_Windows_Ransomware_Ryuk_8Ba51798 : BETA FILE MEMORY {
    meta:
		description = "Identifies RYUK ransomware"
		author = "Elastic Security"
		id = "8ba51798-15d7-4f02-97fa-1844465ae9d8"
		date = "2020-04-30"
		modified = "2021-08-23"
		reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.ryuk"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Ryuk.yar#L111-L137"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "0733ae6a7e38bc2a25aa76a816284482d3ee25626559ec5af554b5f5070e534a"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "8e284bc6015502577a6ddd140b9cd110fd44d4d2cb55d0fdec5bebf3356fd7b3"
		threat_name = "Windows.Ransomware.Ryuk"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$c1 = "/v \"svchos\" /f" wide fullword
		$c2 = "cmd /c \"WMIC.exe shadowcopy delet\"" ascii fullword
		$c3 = "lsaas.exe" wide fullword
		$c4 = "FA_Scheduler" wide fullword
		$c5 = "ocautoupds" wide fullword
		$c6 = "CNTAoSMgr" wide fullword
		$c7 = "hrmlog" wide fullword
		$c8 = "UNIQUE_ID_DO_NOT_REMOVE" wide fullword

	condition:
		3 of ($c*)
}
rule ELASTIC_Windows_Ransomware_Ryuk_88Daaf8E : BETA FILE MEMORY {
    meta:
		description = "Identifies RYUK ransomware"
		author = "Elastic Security"
		id = "88daaf8e-0bfe-46c4-9a75-2527d0e10538"
		date = "2020-04-30"
		modified = "2021-08-23"
		reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.ryuk"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Ryuk.yar#L139-L158"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "6fc463976c0fb9c3e4f25d854545d07800c63730826f3974298f0077d272cff0"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "b1f218a9bc6bf5f3ec108a471de954988e7692de208e68d7d4ee205194cbbb40"
		threat_name = "Windows.Ransomware.Ryuk"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$f1 = { 48 8B CF E8 AB 25 00 00 85 C0 74 35 }

	condition:
		1 of ($f*)
}
rule ELASTIC_Multi_Hacktool_Stowaway_89F1D452 : FILE MEMORY {
    meta:
		description = "Detects Multi Hacktool Stowaway (Multi.Hacktool.Stowaway)"
		author = "Elastic Security"
		id = "89f1d452-f40b-47da-ba75-10c90d67c13b"
		date = "2024-06-28"
		modified = "2024-07-26"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Hacktool_Stowaway.yar#L1-L27"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c073d3be469c8eea0f007bb37c722bad30e06dc994d3a59773838ed8be154c95"
		logic_hash = "c5db1335fea606ec32f7a6540ee4dee637dd2ad5aee27e092b89fa03ad085690"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "313e22009ad758c0dd0977c274eb165511591e3d99a8e2dd4be00622668981da"
		severity = 100
		arch_context = "x86, arm64"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$a1 = "Stowaway/share.ActivePreAuth" ascii fullword
		$a2 = "Stowaway/agent/handler" ascii fullword
		$a3 = "Origin: http://stowaway:22" ascii fullword
		$a4 = "Stowaway/admin.NewAdmin" ascii fullword
		$a5 = "Stowaway/global/global.go" ascii fullword
		$a6 = "Stowaway/crypto.AESDecrypt" ascii fullword
		$a7 = "Stowaway/utils.CheckIfIP4" ascii fullword
		$a8 = "Exit Stowaway"
		$a9 = "Stowaway/protocol.ConstructMessage" ascii fullword

	condition:
		3 of them
}
rule ELASTIC_Windows_Trojan_Bandook_38497690 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bandook (Windows.Trojan.Bandook)"
		author = "Elastic Security"
		id = "38497690-6663-47c9-a864-0bbe6a3f7a8b"
		date = "2022-08-10"
		modified = "2022-09-29"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Bandook.yar#L1-L24"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "4d079586a51168aac708a9ab7d11a5a49dfe7a16d9ced852fbbc5884020c0c97"
		logic_hash = "199614993f63636764808313f25199348afdf4d537c8dca06f673559e34636b8"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b6debea805a8952b9b7473ad7347645e4aced3ecde8d6e53fa2d82c35b285b3c"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$str1 = "%s~!%s~!%s~!%s~!%s~!%s~!"
		$str2 = "ammyy.abc"
		$str3 = "StealUSB"
		$str4 = "DisableMouseCapture"
		$str5 = "%sSkype\\%s\\config.xml"
		$str6 = "AVE_MARIA"

	condition:
		3 of them
}
rule ELASTIC_Windows_Ransomware_Lockfile_74185716 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Lockfile (Windows.Ransomware.Lockfile)"
		author = "Elastic Security"
		id = "74185716-e79d-4d63-b6ae-9480f24dcd4f"
		date = "2021-08-31"
		modified = "2022-01-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Lockfile.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "bf315c9c064b887ee3276e1342d43637d8c0e067260946db45942f39b970d7ce"
		logic_hash = "e922c2fc9dd52dd0238847a9d48691bea90d028cf680fc3a1a0dbdfef1d8dce3"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "849a0fb5a2e08b2d32db839a7fdbde03a184a48726678e65e7f8452b354a3ca8"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "LOCKFILE-README"
		$a2 = "wmic process where \"name  like '%virtualbox%'\" call terminate"
		$a3 = "</computername>"
		$a4 = ".lockfile"

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Nightsky_A7F19411 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Nightsky (Windows.Ransomware.Nightsky)"
		author = "Elastic Security"
		id = "a7f19411-4c28-4cc7-b60c-ef51cb10b905"
		date = "2022-01-11"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Nightsky.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1fca1cd04992e0fcaa714d9dfa97323d81d7e3d43a024ec37d1c7a2767a17577"
		logic_hash = "defc7ab43035c663302edfda60a4b57cb301b3d61662afe3ce1de2ac93cfc3e2"
		score = 75
		quality = 48
		tags = "FILE, MEMORY"
		fingerprint = "0f2aac3a538a921b78f7c2521adf65678830abab8ec8b360ac3dddae5fbc4756"
		severity = 90
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "\\NightSkyReadMe.hta" wide fullword
		$a2 = ".nightsky" wide fullword
		$a3 = "<h1 id=\"nightsky\"><center><span style=\"color: black; font-size: 48pt\">NIGHT SKY</span></center>" ascii fullword
		$a4 = "URL:https://contact.nightsky.cyou" ascii fullword

	condition:
		2 of them
}
rule ELASTIC_Windows_Ransomware_Nightsky_253C4D0D : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Nightsky (Windows.Ransomware.Nightsky)"
		author = "Elastic Security"
		id = "253c4d0d-157f-4929-9f0e-5830ebc377dc"
		date = "2022-03-14"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Nightsky.yar#L24-L42"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "2c940a35025dd3847f7c954a282f65e9c2312d2ada28686f9d1dc73d1c500224"
		logic_hash = "ba9e6dab664e464e0fdc65bd8bdccc661846d85e7fd8fbf089e72e9e5b71fb17"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "739529dfb1f8c8ab2a7f6a4b2b18b27dd2fcc38eda0f110897fc6cb5d64b1c92"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 43 B8 48 2B D9 49 89 43 C0 4C 8B E2 49 89 43 C8 4C 8B F1 49 89 }

	condition:
		all of them
}
rule ELASTIC_Multi_Ransomware_Akira_21842Eb3 : FILE MEMORY {
    meta:
		description = "Detects Multi Ransomware Akira (Multi.Ransomware.Akira)"
		author = "Elastic Security"
		id = "21842eb3-9ccc-4dec-9536-37791ef79714"
		date = "2024-11-21"
		modified = "2024-11-22"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Ransomware_Akira.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "3298d203c2acb68c474e5fdad8379181890b4403d6491c523c13730129be3f75"
		logic_hash = "1c50f4da476cef9f9818f8c0117621eae232be0245ad244babe51d493f0a5a48"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "62f1a985bb718fa27c56d2f23d4f36a5b90b35626f0ef5def83441d27122a503"
		severity = 100
		arch_context = "x86, arm64"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$a1 = "Well, for now let's keep all the tears and resentment to ourselves"

	condition:
		all of them
}
rule ELASTIC_Windows_Hacktool_Iox_98Cd1Cd8 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Iox (Windows.Hacktool.Iox)"
		author = "Elastic Security"
		id = "98cd1cd8-8a0c-489e-86d1-58da88dc2c71"
		date = "2024-01-24"
		modified = "2024-01-29"
		reference = "https://www.elastic.co/security-labs/unmasking-financial-services-intrusion-ref0657"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_Iox.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "d4544a521d4e6eb07336816b1aae54f92c5c4fd2eb31dcfbdf26e4ef890e73db"
		logic_hash = "d7f9e4f399410d54416e974fbd66b2caa27359ae0f2e33e01d62f1aa618daa34"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "8c0f4041223713bef105ca5986b9ec30b4bfb22aeeab8f4465938cf8212fc7c1"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$param_check_b0 = { 48 83 FB 05 0F 85 ?? ?? ?? ?? 81 38 70 72 6F 78 66 0F 1F 44 00 00 0F 85 ?? ?? ?? ?? 80 78 04 79 0F 85 ?? ?? ?? ?? 48 83 F9 03 }
		$param_check_b1 = { 48 8B 14 24 4C 8B 5C 24 18 4C 8B 64 24 08 4C 8B 6C 24 08 4C 8B 7C 24 20 66 0F 1F 84 00 00 00 00 00 48 83 FB 03 0F 85 ?? ?? ?? ?? 66 81 38 66 77 0F 85 ?? ?? ?? ?? 80 78 02 64 }
		$param_check_b2 = { 81 38 2D 2D 6C 6F 0F 1F 44 00 00 0F 85 ?? ?? ?? ?? 66 81 78 04 63 61 0F 85 ?? ?? ?? ?? 80 78 06 6C }
		$param_check_b3 = { 83 FA 05 0F 85 ?? ?? ?? ?? 81 38 2D 2D 6B 65 0F 85 ?? ?? ?? ?? 80 78 04 79 90 }

	condition:
		3 of them
}
rule ELASTIC_Windows_Trojan_Sysjoker_1Ef19A12 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Sysjoker (Windows.Trojan.SysJoker)"
		author = "Elastic Security"
		id = "1ef19a12-ee26-47da-8d65-272f6749b476"
		date = "2022-02-17"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_SysJoker.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "61df74731fbe1eafb2eb987f20e5226962eeceef010164e41ea6c4494a4010fc"
		logic_hash = "25bd58d546549d208f9f95f4c27d1e58f86f87750dae1e293544cc92b25f8b32"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "9123af8b8b27ebfb9199e70eb34d43378b1796319186d5d848d650a8be02d5d5"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "';Write-Output \"Time taken : $((Get - Date).Subtract($start_time).Seconds) second(s)\"" ascii fullword
		$a2 = "powershell.exe Expand-Archive -LiteralPath '" ascii fullword
		$a3 = "powershell.exe Invoke-WebRequest -Uri '" ascii fullword
		$a4 = "\\recoveryWindows.zip" ascii fullword

	condition:
		3 of them
}
rule ELASTIC_Windows_Trojan_Sysjoker_34559Bcd : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Sysjoker (Windows.Trojan.SysJoker)"
		author = "Elastic Security"
		id = "34559bcd-661a-4213-b896-2d7f882a16ef"
		date = "2022-02-21"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_SysJoker.yar#L24-L48"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1ffd6559d21470c40dcf9236da51e5823d7ad58c93502279871c3fe7718c901c"
		logic_hash = "ebe7f6037f14e37b6efe81614c06c6d26fe0cc17d0475b8b19715f80d0d9aad3"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b1e01d0b94a60f6f5632a14d3d32f78bbe3049886ea3a3e838a29fb790a45918"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "\\txc1.txt\" && type \"" ascii fullword
		$a2 = "tempo1.txt" nocase
		$a3 = "user_token="
		$a4 = "{\"status\":\"success\",\"result\":\"" ascii fullword
		$a5 = "\",\"av\":\"" ascii fullword
		$a6 = "aSwpEHc0QyIxPRAqNmkeEwskMW8HODkkYRkCICIrJysHNmtlIzQiChMiGAxzQg==" ascii fullword
		$a7 = "ESQuBT8uQyglJy4QOicGXDMiayYtPQ==" ascii fullword

	condition:
		4 of them
}
rule ELASTIC_Windows_Trojan_Avemaria_31D2Bce9 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Avemaria (Windows.Trojan.AveMaria)"
		author = "Elastic Security"
		id = "31d2bce9-3266-447b-9a2d-57cf11a0ff1f"
		date = "2021-05-30"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_AveMaria.yar#L1-L31"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "5767bca39fa46d32a6cb69ef7bd1feaac949874768dac192dbf1cf43336b3d7b"
		logic_hash = "7ba59c3be07e35b415719b60b14a0f629619e5729c20f50f00dbea0c2f8bd026"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "8f75e2d8308227a42743168deb021de18ad485763fd257991c5e627c025c30c0"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "cmd.exe /C ping 1.2.3.4 -n 2 -w 1000 > Nul & Del /f /q " ascii fullword
		$a2 = "SMTP Password" wide fullword
		$a3 = "select signon_realm, origin_url, username_value, password_value from logins" ascii fullword
		$a4 = "Elevation:Administrator!new:{3ad05575-8857-4850-9277-11b85bdb8e09}" wide fullword
		$a5 = "for /F \"usebackq tokens=*\" %%A in (\"" wide fullword
		$a6 = "\\Torch\\User Data\\Default\\Login Data" wide fullword
		$a7 = "/n:%temp%\\ellocnak.xml" wide fullword
		$a8 = "\"os_crypt\":{\"encrypted_key\":\"" wide fullword
		$a9 = "Hey I'm Admin" wide fullword
		$a10 = "\\logins.json" wide fullword
		$a11 = "Accounts\\Account.rec0" ascii fullword
		$a12 = "warzone160" ascii fullword
		$a13 = "Ave_Maria Stealer OpenSource github Link: https://github.com/syohex/java-simple-mine-sweeper" wide fullword

	condition:
		8 of ($a*)
}
rule ELASTIC_Multi_Hacktool_Nps_C6Eb4A27 : FILE MEMORY {
    meta:
		description = "Detects Multi Hacktool Nps (Multi.Hacktool.Nps)"
		author = "Elastic Security"
		id = "c6eb4a27-c481-41b4-914d-a27d10672d30"
		date = "2024-01-24"
		modified = "2024-01-29"
		reference = "https://www.elastic.co/security-labs/unmasking-financial-services-intrusion-ref0657"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Hacktool_Nps.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "4714e8ad9c625070ca0a151ffc98d87d8e5da7c8ef42037ca5f43baede6cfac1"
		logic_hash = "53baf04f4ab8967761c6badb24f6632cc1bf4a448abf0049318b96855f30feea"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "1386e4cef0f347b38a4614311d585b0b83cb9526b19215392aee893e594950de"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$str_info0 = "Reconnecting..."
		$str_info1 = "Loading configuration file %s successfully"
		$str_info2 = "successful start-up of local socks5 monitoring, port"
		$str_info3 = "successful start-up of local tcp monitoring, port"
		$str_info4 = "start local file system, local path %s, strip prefix %s ,remote port %"
		$str_info5 = "start local file system, local path %s, strip prefix %s ,remote port %s"

	condition:
		all of them
}
rule ELASTIC_Multi_Hacktool_Nps_F76F257D : FILE MEMORY {
    meta:
		description = "Detects Multi Hacktool Nps (Multi.Hacktool.Nps)"
		author = "Elastic Security"
		id = "f76f257d-0286-4b4d-9f73-2add23cfd07e"
		date = "2024-01-24"
		modified = "2024-01-29"
		reference = "https://www.elastic.co/security-labs/unmasking-financial-services-intrusion-ref0657"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Hacktool_Nps.yar#L27-L50"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "80721b20a8667536a33fca50236f5c8e0c0d07aa7805b980e40818ab92cd9f4a"
		logic_hash = "0bbd7f86bfd2967dc390510c2e403d05e1b56551b965ea716b9e5330f75c9bd5"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "4aaa270129ce0c8fdd40aae2ebc4f6595aec91cbfea9e0188542e9c3f38eedee"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$string_decrypt_add = { 0F B6 BC 34 ?? ?? ?? ?? 44 0F B6 84 34 ?? ?? ?? ?? 44 01 C7 40 88 BC 34 ?? ?? ?? ?? 48 FF C6 }
		$string_decrypt_xor = { 0F B6 54 ?? ?? 0F B6 74 ?? ?? 31 D6 40 88 74 ?? ?? 48 FF C0 }
		$string_decrypt_sub = { 0F B6 94 04 ?? ?? ?? ?? 0F B6 B4 04 ?? ?? ?? ?? 29 D6 40 88 B4 04 ?? ?? ?? ?? 48 FF C0 }
		$NewJsonDb_str0 = { 63 6C 69 65 6E 74 73 2E 6A 73 6F 6E }
		$NewJsonDb_str1 = { 68 6F 73 74 73 2E 6A 73 6F 6E }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Hotpage_414F235F : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Hotpage (Windows.Trojan.HotPage)"
		author = "Elastic Security"
		id = "414f235f-5e16-449a-9ac5-556655c4418e"
		date = "2024-07-18"
		modified = "2024-07-26"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_HotPage.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b8464126b64c809b4ab47aa91c5f322ce2c0ae4fd668a43de738a5caa7567225"
		logic_hash = "cfa0036b22a83a5396b3f9014511720071246a775053ad493791ebc1212400f2"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "6f590056d3f7bb9f743861e8d317ec589d8703353428dfcea9a6d2f61f266cdf"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$SpcSpOpusInfo = { 30 48 A0 1A 80 18 6E 56 53 17 76 FE 7F 51 7F 51 7E DC 79 D1 62 80 67 09 96 50 51 6C 53 F8 }
		$s1 = "\\Device\\KNewTableBaseIo"
		$s2 = "Release\\DwAdsafeLoad.pdb"
		$s3 = "RedDriver.pdb"
		$s4 = "Release\\DwAdSafe.pdb"
		$s5 = "[%s] Begin injecting Broser pid=[%d]"
		$s6 = "[%s] ADDbrowser PID ->[%d]"

	condition:
		$SpcSpOpusInfo or 2 of ($s*)
}
rule ELASTIC_Windows_Trojan_Matanbuchus_B521801B : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Matanbuchus (Windows.Trojan.Matanbuchus)"
		author = "Elastic Security"
		id = "b521801b-5623-4bfe-9a9d-9e16afa63c63"
		date = "2022-03-17"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Matanbuchus.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "4eb85a5532b98cbc4a6db1697cf46b9e2b7e28e89d6bbfc137b36c0736cd80e2"
		logic_hash = "609a0941b118d737124a5cd9c98c007e21557a239cfa3cf97cd3b4348c934f03"
		score = 75
		quality = 25
		tags = "FILE, MEMORY"
		fingerprint = "7792cffc82678bb05ba1aa315011317611eb0bf962665e0657a7db2ce95f81b4"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "%PROCESSOR_ARCHITECTURE%" ascii fullword
		$a2 = "%PROCESSOR_REVISION%\\" ascii fullword
		$a3 = "%LOCALAPPDATA%\\" ascii fullword
		$a4 = "\"C:\\Windows\\system32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Matanbuchus_4Ce9Affb : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Matanbuchus (Windows.Trojan.Matanbuchus)"
		author = "Elastic Security"
		id = "4ce9affb-58ef-4d31-b1ff-5a1c52822a01"
		date = "2022-03-17"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Matanbuchus.yar#L24-L42"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "4eb85a5532b98cbc4a6db1697cf46b9e2b7e28e89d6bbfc137b36c0736cd80e2"
		logic_hash = "16441eb4617b6b3cb1e7d600959a5cbfe15c72c00361b45551b7ef4c81f78462"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "61d32df2ea730343ab497f50d250712e89ec942733c8cc4421083a3823ab9435"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { F4 83 7D F4 00 77 43 72 06 83 7D F0 11 73 3B 6A 00 6A 01 8B }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Matanbuchus_58A61Aaa : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Matanbuchus (Windows.Trojan.Matanbuchus)"
		author = "Elastic Security"
		id = "58a61aaa-51b2-47f2-ab32-2e639957b2d5"
		date = "2022-03-17"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Matanbuchus.yar#L44-L62"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "4eb85a5532b98cbc4a6db1697cf46b9e2b7e28e89d6bbfc137b36c0736cd80e2"
		logic_hash = "7226e2f61bd6f1cca15c1f3f8d8697cb277d1e214f756295ffda5bc16304cc49"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "332794db0ed7488e939a91594d2100ee013a7f8f91afc085e15f06fc69098ad5"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 83 EC 08 53 56 0F 57 C0 66 0F 13 45 F8 EB ?? 8B 45 F8 83 C0 01 8B 4D FC 83 D1 00 89 45 F8 89 4D FC 8B 55 FC 3B 55 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Matanbuchus_C7811Ccc : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Matanbuchus (Windows.Trojan.Matanbuchus)"
		author = "Elastic Security"
		id = "c7811ccc-5d8d-4bc8-a630-ac3282bb207e"
		date = "2022-03-17"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Matanbuchus.yar#L64-L82"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "4eb85a5532b98cbc4a6db1697cf46b9e2b7e28e89d6bbfc137b36c0736cd80e2"
		logic_hash = "e65dc05f6d9289a42c05afdc4da0ce1c18c1129dd87688a277ece925e83d7ef1"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "05f209a24d9eb2be7fa50444d8271b6f147027291f55a352ac3af5e9b3207010"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 8B EC 83 EC 08 53 56 0F 57 C0 66 0F 13 45 F8 EB ?? 8B 45 F8 83 C0 01 8B 4D FC 83 D1 00 89 45 F8 89 4D FC 8B 55 FC 3B 55 10 77 ?? 72 ?? 8B 45 F8 3B 45 0C 73 ?? 6A 00 6A 08 8B 4D FC 51 8B 55 F8 52 E8 ?? ?? ?? ?? 6A 00 6A 08 52 50 E8 ?? ?? ?? ?? 8B C8 8B 45 14 8B 55 18 E8 ?? ?? ?? ?? 0F BE F0 6A 00 6A 01 8B 55 FC 52 8B 45 F8 50 E8 ?? ?? ?? ?? 8B 4D 08 0F BE 1C 01 33 DE 6A 00 6A 01 8B 55 FC 52 8B 45 F8 50 E8 ?? ?? ?? ?? 8B 4D 08 88 1C 01 E9 ?? ?? ?? ?? 5E 5B 8B E5 5D C2 14 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Redlinestealer_17Ee6A17 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Redlinestealer (Windows.Trojan.RedLineStealer)"
		author = "Elastic Security"
		id = "17ee6a17-161e-454a-baf1-2734995c82cd"
		date = "2021-06-12"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_RedLineStealer.yar#L1-L27"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "497bc53c1c75003fe4ae3199b0ff656c085f21dffa71d00d7a3a33abce1a3382"
		logic_hash = "0c868d0673c01e2c115d6822c34c877db77265251167f3a890a448a1de5c6a2d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a1f75937e83f72f61e027a1045374d3bd17cd387b223a6909b9aed52d2bc2580"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "RedLine.Logic.SQLite" ascii fullword
		$a2 = "RedLine.Reburn.Data.Browsers.Gecko" ascii fullword
		$a3 = "RedLine.Client.Models.Gecko" ascii fullword
		$b1 = "SELECT * FROM Win32_Process Where SessionId='{0}'" wide fullword
		$b2 = "get_encryptedUsername" ascii fullword
		$b3 = "https://icanhazip.com" wide fullword
		$b4 = "GetPrivate3Key" ascii fullword
		$b5 = "get_GrabTelegram" ascii fullword
		$b6 = "<GrabUserAgent>k__BackingField" ascii fullword

	condition:
		1 of ($a*) or all of ($b*)
}
rule ELASTIC_Windows_Trojan_Redlinestealer_F54632Eb : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Redlinestealer (Windows.Trojan.RedLineStealer)"
		author = "Elastic Security"
		id = "f54632eb-2c66-4aff-802d-ad1c076e5a5e"
		date = "2021-06-12"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_RedLineStealer.yar#L29-L56"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "d82ad08ebf2c6fac951aaa6d96bdb481aa4eab3cd725ea6358b39b1045789a25"
		logic_hash = "1779919556ee5c9a78342aabafb8408e035cb39632b25c54da6bf195894901dc"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "6a9d45969c4d58181fca50d58647511b68c1e6ee1eeac2a1838292529505a6a0"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "ttp://checkip.amazonaws.com/logins.json" wide fullword
		$a2 = "https://ipinfo.io/ip%appdata%\\" wide fullword
		$a3 = "Software\\Valve\\SteamLogin Data" wide fullword
		$a4 = "get_ScannedWallets" ascii fullword
		$a5 = "get_ScanTelegram" ascii fullword
		$a6 = "get_ScanGeckoBrowsersPaths" ascii fullword
		$a7 = "<Processes>k__BackingField" ascii fullword
		$a8 = "<GetWindowsVersion>g__HKLM_GetString|11_0" ascii fullword
		$a9 = "<ScanFTP>k__BackingField" ascii fullword
		$a10 = "DataManager.Data.Credentials" ascii fullword

	condition:
		6 of ($a*)
}
rule ELASTIC_Windows_Trojan_Redlinestealer_3D9371Fd : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Redlinestealer (Windows.Trojan.RedLineStealer)"
		author = "Elastic Security"
		id = "3d9371fd-c094-40fc-baf8-f0e9e9a54ff9"
		date = "2022-02-17"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_RedLineStealer.yar#L58-L82"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0ec522dfd9307772bf8b600a8b91fd6facd0bf4090c2b386afd20e955b25206a"
		logic_hash = "1c8a64ce7615f502602ab960638dd55f4deaeea3b49d894274d64d4d0b6a1d10"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "2d7ff7894b267ba37a2d376b022bae45c4948ef3a70b1af986e7492949b5ae23"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "get_encrypted_key" ascii fullword
		$a2 = "get_PassedPaths" ascii fullword
		$a3 = "ChromeGetLocalName" ascii fullword
		$a4 = "GetBrowsers" ascii fullword
		$a5 = "Software\\Valve\\SteamLogin Data" wide fullword
		$a6 = "%appdata%\\" wide fullword
		$a7 = "ScanPasswords" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Redlinestealer_63E7E006 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Redlinestealer (Windows.Trojan.RedLineStealer)"
		author = "Elastic Security"
		id = "63e7e006-6c0c-47d8-8090-a6b36f01f3a3"
		date = "2023-05-01"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_RedLineStealer.yar#L84-L104"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "e062c99dc9f3fa780ea9c6249fa4ef96bbe17fd1df38dbe11c664a10a92deece"
		logic_hash = "2085eaf622b52372124e9b23d19e3e4a7fdb7a4559ad9a09216c1cbae96ca5b6"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "47c7b9a39a5e0a41f26fdf328231eb173a51adfc00948c68332ce72bc442e19e"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 30 68 44 27 25 5B 3D 79 21 54 3A }
		$a2 = { 40 5E 30 33 5D 44 34 4A 5D 48 33 }
		$a3 = { 4B EF 4D FF 44 DD 41 70 44 DC 41 00 44 DC 41 03 43 D9 3E 00 44 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Redlinestealer_F07B3Cb4 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Redlinestealer (Windows.Trojan.RedLineStealer)"
		author = "Elastic Security"
		id = "f07b3cb4-a1c5-42c3-a992-d6d9a48bc7a0"
		date = "2023-05-03"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_RedLineStealer.yar#L106-L125"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "5e491625475fc25c465fc7f6db98def189c15a133af7d0ac1ecbc8d887c4feb6"
		logic_hash = "64536e3b340254554154ac1b33adfb4f3c72a2c6c0d1ef27827621b905d431c5"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "8687fa6f540ccebab6000c0c93be4931d874cd04b0692c6934148938bac0026e"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 3C 65 6E 63 72 79 70 74 65 64 5F 6B 65 79 3E 6B 5F 5F 42 61 63 6B 69 6E 67 46 69 65 6C 64 }
		$a2 = { 45 42 37 45 46 31 39 37 33 43 44 43 32 39 35 42 37 42 30 38 46 45 36 44 38 32 42 39 45 43 44 41 44 31 31 30 36 41 46 32 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Redlinestealer_4Df4Bcb6 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Redlinestealer (Windows.Trojan.RedLineStealer)"
		author = "Elastic Security"
		id = "4df4bcb6-a492-4407-8d8f-bbb835322c98"
		date = "2023-05-04"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_RedLineStealer.yar#L127-L145"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9389475bd26c1d3fd04a083557f2797d0ee89dfdd1f7de67775fcd19e61dfbb3"
		logic_hash = "d9027fa9c8d9c938159a734431bb2be67fd7cca1f898c2208f7b909157524da4"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "a9e08bf28e8915615f9b39ab814a46c092b5714ef9133f740a1f1f876bfda2d9"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 34 42 30 35 43 45 42 44 37 44 37 30 46 31 36 30 37 44 34 37 34 43 41 45 31 37 36 46 45 41 45 42 37 34 33 39 37 39 35 46 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Redlinestealer_15Ee6903 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Redlinestealer (Windows.Trojan.RedLineStealer)"
		author = "Elastic Security"
		id = "15ee6903-757f-462b-8e1c-1ed8ca667910"
		date = "2023-05-04"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_RedLineStealer.yar#L147-L166"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "46b506cafb2460ca2969f69bcb0ee0af63b6d65e6b2a6249ef7faa21bde1a6bd"
		logic_hash = "22c8a1f4b5b94261cfabdbcc00e45b9437a0132d4e9d4543b734d4f303336696"
		score = 75
		quality = 71
		tags = "FILE, MEMORY"
		fingerprint = "d3a380f68477b98b3f5adc11cc597042aa95636cfec0b0a5f2e51c201aa61227"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 53 65 65 6E 42 65 66 6F 72 65 33 }
		$a2 = { 73 65 74 5F 53 63 61 6E 47 65 63 6B 6F 42 72 6F 77 73 65 72 73 50 61 74 68 73 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Redlinestealer_6Dfafd7B : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Redlinestealer (Windows.Trojan.RedLineStealer)"
		author = "Elastic Security"
		id = "6dfafd7b-5188-4ec7-9ba4-58b8f05458e5"
		date = "2024-01-05"
		modified = "2024-01-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_RedLineStealer.yar#L168-L186"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "809e303ba26b894f006b8f2d3983ff697aef13b67c36957d98c56aae9afd8852"
		logic_hash = "888bc2fdfae8673cd6bce56fc9894b3cab6d7e3c384d854d6bc8aef47fdecf1c"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "b7770492fc26ada1e5cb5581221f59b1426332e57eb5e04922f65c25b92ad860"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 33 38 46 34 33 31 41 35 34 39 34 31 31 41 45 42 33 32 38 31 30 30 36 38 41 34 43 38 33 32 35 30 42 32 44 33 31 45 31 35 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Redlinestealer_983Cd7A7 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Redlinestealer (Windows.Trojan.RedLineStealer)"
		author = "Elastic Security"
		id = "983cd7a7-4e7b-413f-b859-b5cbfbf14ae6"
		date = "2024-03-27"
		modified = "2024-05-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_RedLineStealer.yar#L188-L208"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "7aa20c57b8815dd63c8ae951e1819c75b5d2deec5aae0597feec878272772f35"
		logic_hash = "2104bad5ec42bc72ec611607a53086a85359bdb4bf084d7377e9a8e234b0e928"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "6dd74c3b67501506ee43340c07b53ddb94e919d27ad96f55eb4eff3de1470699"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$decrypt_config_bytes = { 72 ?? ?? ?? 70 80 ?? ?? ?? 04 72 ?? ?? ?? 70 80 ?? ?? ?? 04 72 ?? ?? ?? 70 80 ?? ?? ?? 04 72 ?? ?? ?? 70 80 ?? ?? ?? 04 [0-6] 2A }
		$str1 = "net.tcp://" wide
		$str2 = "\\Discord\\Local Storage\\leveldb" wide

	condition:
		all of them
}
rule ELASTIC_Windows_Wiper_Hermeticwiper_7206A969 : FILE MEMORY {
    meta:
		description = "Detects Windows Wiper Hermeticwiper (Windows.Wiper.HermeticWiper)"
		author = "Elastic Security"
		id = "7206a969-bbd6-4c2d-a19d-380b71a4ab08"
		date = "2022-02-24"
		modified = "2022-02-24"
		reference = "https://www.elastic.co/security-labs/elastic-protects-against-data-wiper-malware-targeting-ukraine-hermeticwiper"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Wiper_HermeticWiper.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1bc44eef75779e3ca1eefb8ff5a64807dbc942b1e4a2672d77b9f6928d292591"
		logic_hash = "84c61b8223a6ebf1ccfa4fdccee3c9091abca4553e55ac6c2492cff5503b4774"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e3486c785f99f4376d4161704afcaf61e8a5ab6101463a76d134469f8a5581bf"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "\\\\?\\C:\\Windows\\System32\\winevt\\Logs" wide fullword
		$a2 = "\\\\.\\EPMNTDRV\\%u" wide fullword
		$a3 = "tdrv.pdb" ascii fullword
		$a4 = "%s%.2s" wide fullword
		$a5 = "ccessdri" ascii fullword
		$a6 = "Hermetica Digital"

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Wikiloader_C57F3F88 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Wikiloader (Windows.Trojan.WikiLoader)"
		author = "Elastic Security"
		id = "c57f3f88-0d2c-41a6-b2f9-839b1f1e1193"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_WikiLoader.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0f71b1805d7feb6830b856c5a5328d3a132af4c37fcd747d82beb0f61c77f6f5"
		logic_hash = "408c6d811232dbd0c87f75fd28508366151cf9f2f10f012919588db1919e406b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a3802da23431fcbc890a5164d6acdbf29ec29bf1a82d4b862495edd8ae642d52"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 48 81 EC 08 01 00 00 48 89 CB 48 31 C0 48 89 E9 48 29 E1 48 89 E7 F3 AA 48 89 D9 48 89 4D 80 48 89 95 78 FF FF FF 4C 89 45 C0 4C 89 4D 88 4D 89 D4 4D 89 DD 4C 89 65 C8 49 83 ED 10 4C 89 6D 98 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Wikiloader_99681F1C : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Wikiloader (Windows.Trojan.WikiLoader)"
		author = "Elastic Security"
		id = "99681f1c-8b32-4cb0-ab6b-640b316e587a"
		date = "2024-01-17"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_WikiLoader.yar#L21-L39"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0b02cfe16ac73f2e7dc52eaf3b93279b7d02b3d64d061782dfed0c55ab621a8e"
		logic_hash = "fb293d74186e778856780377120ac2ebe9550a508a0b33e706c39f93a5509df8"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "1cd978adc6cbd36a5738fb4c26a2ba4aaa8e69a035bd2618ef2175b3bb2dc4b6"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 48 83 EC 08 48 89 E0 4C 89 20 48 83 EC 08 48 89 E0 4C 89 28 48 83 EC 08 48 89 E0 4C 89 30 48 83 EC 08 48 89 E0 4C 89 38 48 89 E5 48 83 EC 08 48 83 EC 60 48 89 CB 48 31 C0 48 89 E9 48 29 E1 48 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Hawkeye_77C36Ace : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Hawkeye (Windows.Trojan.Hawkeye)"
		author = "Elastic Security"
		id = "77c36ace-3857-43f8-a6de-596ba7964b6f"
		date = "2021-08-16"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Hawkeye.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "28e28025060f1bafd4eb96c7477cab73497ca2144b52e664b254c616607d94cd"
		logic_hash = "e8c1060efde0c4a073247d03a19dedb1c0acc8506fbf6eac93ac44f00fc73be1"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "c9a1c61b4fa78c46d493e1b307e9950bd714ba4e5a6249f15a3b86a74b7638e5"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Logger - Key Recorder - [" wide fullword
		$a2 = "http://whatismyipaddress.com/" wide fullword
		$a3 = "Keylogger Enabled: " wide fullword
		$a4 = "LoadPasswordsSeaMonkey" wide fullword
		$a5 = "\\.minecraft\\lastlogin" wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Hawkeye_975D546C : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Hawkeye (Windows.Trojan.Hawkeye)"
		author = "Elastic Security"
		id = "975d546c-286b-4753-b894-d6ed0aa832f3"
		date = "2023-03-23"
		modified = "2023-04-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Hawkeye.yar#L25-L48"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "aca133bf1d72cf379101e6877871979d6e6e8bc4cc692a5ba815289735014340"
		logic_hash = "cbd8ce991059f961236a4bb83ea5a78efa661199b40fca8b09550856e932198b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "5bbdb07fa6dd3e415f49d7f4fbc249c078ae42ebd81cad3015e32dfdc8f7cda6"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$s1 = "api.telegram.org"
		$s2 = "Browsers/Passwords"
		$s3 = "Installed Browsers.txt"
		$s4 = "Browsers/AutoFills"
		$s5 = "Passwords.txt"
		$s6 = "System Information.txt"

	condition:
		all of them
}
rule ELASTIC_Windows_Hacktool_Sharpsccm_9Bef8Dab : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Sharpsccm (Windows.Hacktool.SharpSCCM)"
		author = "Elastic Security"
		id = "9bef8dab-af2e-46be-811a-0ac78d74a4ef"
		date = "2024-03-25"
		modified = "2024-05-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_SharpSCCM.yar#L1-L31"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "2e169c4fd16627029445bb0365a2f9ee61ab6b3757b8ad02fd210ce85dc9c97f"
		logic_hash = "560c780934a63b3c857a09841c09cbc350205868c696fac958e249e1379cc865"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "dfbb7f142628eb7dc6c96dd271562d88a0970534af85464c10232ec01f58e35b"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$name = "SharpSCCM" wide fullword
		$s1 = "--relay-server" wide fullword
		$s2 = "--username" wide fullword
		$s3 = "--domain" wide fullword
		$s4 = "--sms-provider" wide fullword
		$s5 = "--wmi-namespace" wide fullword
		$s6 = "--management-point" wide fullword
		$s7 = "--get-system" wide fullword
		$s8 = "--run-as-user" wide fullword
		$s9 = "--register-client" wide fullword
		$s10 = "MS_Collection" wide fullword
		$s11 = "SOFTWARE\\Microsoft\\CCM" wide fullword
		$s12 = "CCM_POST" wide fullword

	condition:
		($name and 2 of ($s*)) or 7 of ($s*)
}
rule ELASTIC_Windows_Trojan_Dragonbreath_B27Bc56B : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Dragonbreath (Windows.Trojan.DragonBreath)"
		author = "Elastic Security"
		id = "b27bc56b-41a2-4b3d-bff4-a14b90debe08"
		date = "2024-06-05"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_DragonBreath.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "45023fd0e694d66c284dfe17f78c624fd7e246a6c36860a0d892d232a30949be"
		logic_hash = "b86d5541a7e03a698ad918cdbba987474c6680353b4d2de2f8422ecd0ebcac61"
		score = 75
		quality = 69
		tags = "FILE, MEMORY"
		fingerprint = "4bc82f64191cf907d7ecf7da5453258c9be60e5dbaff770ebc22d9629bcbc7e2"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 50 6C 75 67 69 6E 4D 65 }
		$a2 = { 69 73 41 52 44 6C 6C }
		$a3 = { 25 64 2D 25 64 2D 25 64 20 25 64 3A 25 64 }

	condition:
		all of them
}
rule ELASTIC_Multi_Hacktool_Supershell_F7486598 : FILE MEMORY {
    meta:
		description = "Detects Multi Hacktool Supershell (Multi.Hacktool.SuperShell)"
		author = "Elastic Security"
		id = "f7486598-0b60-4b40-932e-6abfba279b76"
		date = "2024-09-12"
		modified = "2024-09-30"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Hacktool_SuperShell.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "18556a794f5d47f93d375e257fa94b9fb1088f3021cf79cc955eb4c1813a95da"
		logic_hash = "8c2c3f13fad03ece29f7f3fd12e22807b61ecdc16dee00b6430b915631554cff"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "116f89157bfe0d80ddcb8f55984169fa611a51a3d562ef719b13ef2ddd50c432"
		severity = 100
		arch_context = "x86, arm64"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$a = "NHAS/reverse_ssh/internal/terminal"
		$b1 = "foreground|fingerprint|proxy|process_name"
		$b2 = "Failed to kill shell"
		$b3 = "Missing listening address"

	condition:
		$a and 1 of ($b*)
}
rule ELASTIC_Windows_Trojan_Naplistener_E8F16920 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Naplistener (Windows.Trojan.NapListener)"
		author = "Elastic Security"
		id = "e8f16920-52ca-46b6-a945-1b919f975aae"
		date = "2023-02-28"
		modified = "2023-03-20"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_NapListener.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6e8c5bb2dfc90bca380c6f42af7458c8b8af40b7be95fab91e7c67b0dee664c4"
		logic_hash = "6cb7b5051fab2b56f39b2805788b5b0838a095b41fcc623fe412b215736be5d4"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "36689095792e7eb7fce23e7d390675a3554c8a5ba4356aaf9c2fa8986d3a0439"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$start_routine = { 02 28 08 00 00 0A 00 00 28 03 00 00 0A 0A 14 FE 06 04 00 00 06 73 04 00 00 0A 73 05 00 00 0A 0B 16 28 06 00 00 0A 00 07 06 6F 07 00 00 0A 00 00 2A }
		$main_routine = { 6F 22 00 00 0A 13 0E 11 0D 1F 24 14 16 8D 16 00 00 01 14 6F 23 00 00 0A 13 0F 11 0F 14 6F 24 00 00 0A 13 10 11 0E 11 10 18 8D 01 00 00 01 }
		$start_thread = { 00 28 03 00 00 0A 0A 14 FE 06 04 00 00 06 73 04 00 00 0A 73 05 00 00 0A 0B 16 28 06 00 00 0A 00 07 06 6F 07 00 00 0A 00 2A }

	condition:
		2 of them
}
rule ELASTIC_Windows_Trojan_Naplistener_414180A7 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Naplistener (Windows.Trojan.NapListener)"
		author = "Elastic Security"
		id = "414180a7-ca8d-4cf8-a346-08c3e0e1ed8a"
		date = "2023-02-28"
		modified = "2023-03-20"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_NapListener.yar#L23-L46"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6e8c5bb2dfc90bca380c6f42af7458c8b8af40b7be95fab91e7c67b0dee664c4"
		logic_hash = "52d3ddebdc1a8aa4bcb902273bd2d3b4f9b51f248d25e7ae1cc260a9550111f5"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "460b21638f200bf909e9e47bc716acfcb323540fbaa9ea9d0196361696ffa294"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "https://*:443/ews/MsExgHealthCheckd/" ascii wide
		$a2 = "FillFromEncodedBytes" ascii wide
		$a3 = "Exception caught" ascii wide
		$a4 = "text/html; charset=utf-8" ascii wide
		$a5 = ".Run" ascii wide
		$a6 = "sdafwe3rwe23" ascii wide

	condition:
		5 of them
}
rule ELASTIC_Multi_Trojan_Sparkrat_9A21E541 : FILE MEMORY {
    meta:
		description = "Detects Multi Trojan Sparkrat (Multi.Trojan.SparkRat)"
		author = "Elastic Security"
		id = "9a21e541-886c-4d7f-8602-832862121730"
		date = "2023-11-13"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Trojan_SparkRat.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "23efecc03506a9428175546a4b7d40c8a943c252110e83dec132c6a5db8c4dd6"
		logic_hash = "903c5c65436bea8dd044fd5f1f6dda3d1e90ab25802d508f67ba0f7fd06e92d4"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "2691da3a037b651d0f7f6d7be767c34845c3b9a642f4a2fb1c54f391f08089b6"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$a1 = "Spark/client/service/file" ascii wide
		$a2 = "Spark/client/service/desktop" ascii wide
		$a3 = "Spark/utils.Encrypt" ascii wide

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Buerloader_C8A60F46 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Buerloader (Windows.Trojan.Buerloader)"
		author = "Elastic Security"
		id = "c8a60f46-d49a-4566-845b-675fb55c201c"
		date = "2021-08-16"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Buerloader.yar#L1-L24"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "3abed86f46c8be754239f8c878f035efaae91c33b8eb8818c5bbed98c4d9a3ac"
		logic_hash = "d11b117efc10547e77ce8979f8a1d42f34937101e58a0e36228baa37cd30d2aa"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "346233f4b1306eb574b4063d3b47f90e65a81ad7fe1c74d2a68640d99d456c4c"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "User-Agent: Host:  HTTP/1.1" ascii fullword
		$a2 = "ServerHelloPayloadrandom" ascii fullword
		$a3 = "Bad JSON in payload" ascii fullword
		$a4 = { 7B 22 68 65 6C 6C 6F 22 3A 20 22 77 6F 72 6C 64 22 7D 48 54 54 50 2F 31 2E 31 20 33 30 31 20 46 6F 75 6E 64 }
		$a5 = "PayloadU24UnknownExtensiontyp" ascii fullword
		$a6 = " NTDLL.DLL" wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Exploit_Ioring_1E4A8F47 : FILE MEMORY {
    meta:
		description = "Detects Windows Exploit Ioring (Windows.Exploit.IoRing)"
		author = "Elastic Security"
		id = "1e4a8f47-0c04-4219-bc51-03ed0078d8a9"
		date = "2024-02-28"
		modified = "2024-03-21"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Exploit_IoRing.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ba2bd270bf3f312dfa3f77f0716edb634c90506c87f82c04aee09445d18738eb"
		logic_hash = "cbbea9a60bde13356ce88cd96aacaa02a3c99f4ae0b48c4ba84b72528a3d6b91"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a9048bd34f6dd5b7da283ff23397fa22802049fdce15915ea023b27b9b825d30"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$s1 = { 5C 00 5C 00 2E 00 5C 00 70 00 69 00 70 00 65 00 5C 00 69 00 6F 00 72 00 69 00 6E 00 67 00 5F 00 6F 00 75 00 74 00 }
		$s2 = "ioring_read" wide nocase
		$s3 = "ioring_write" wide nocase
		$s4 = "IoRing->RegBuffers" nocase

	condition:
		2 of them
}
rule ELASTIC_Windows_Trojan_Fabookie_024F8759 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Fabookie (Windows.Trojan.Fabookie)"
		author = "Elastic Security"
		id = "024f8759-aaed-40fb-8052-35b58cf69f4e"
		date = "2023-06-22"
		modified = "2023-07-10"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Fabookie.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6c6345c6f0a5beadc4616170c87ec8a577de185d53345581e1b00e72af24c13e"
		logic_hash = "9477406b718c6489161cf4636be66c4f72df923b9c5a7ee4069ef6a9552de485"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0f5be9523a9a3f570e36ed8bbc9d113ffc8a40f868d5826e8b236d65f66e186b"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 48 89 C2 4D 33 C0 4D 33 C9 C7 44 24 20 02 00 00 80 }
		$a2 = { C7 C2 80 84 1E 00 41 C7 C0 00 10 00 00 41 C7 C1 04 00 00 00 48 8B 44 24 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Legionloader_F91120C6 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Legionloader (Windows.Trojan.LegionLoader)"
		author = "Elastic Security"
		id = "f91120c6-395d-4c47-acd2-49c7eb1b8013"
		date = "2024-06-05"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_LegionLoader.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "45670ffa9b24542ae84e3c9eb5ce609c2bcd29129215a7f37eb74b6211e32b22"
		logic_hash = "760402587a9ca3d3e6602fe57d3346ea6f60ba5c8d3a902bf493233baab597b0"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "81476a8981ca0dbd7ac32073d6dc4362ae251ff06827c120e902f1aa3a53ce68"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 55 8B EC 83 EC 08 89 4D F8 8B 4D F8 E8 4F 01 00 00 0F B6 C0 85 C0 75 09 C7 45 FC 01 00 00 00 EB 07 C7 45 FC 00 00 00 00 0F B6 45 FC 8B E5 5D C3 55 8B EC 51 89 4D FC 8B 4D FC E8 21 01 00 00 8B }

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Sodinokibi_83F05Fbe : BETA FILE MEMORY {
    meta:
		description = "Identifies SODINOKIBI/REvil ransomware"
		author = "Elastic Security"
		id = "83f05fbe-65d1-423f-98df-21692167a1d6"
		date = "2020-06-18"
		modified = "2021-08-23"
		reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.revil"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Sodinokibi.yar#L1-L34"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "c88fc2690deae3700e605b2affb5ecac3d1ffc92435f33209f31897d28715b8c"
		score = 75
		quality = 73
		tags = "BETA, FILE, MEMORY"
		fingerprint = "8c32ca099c9117e394379c0cc4771a15e5e4cfb1a98210c288e743a6d9cc9967"
		threat_name = "Windows.Ransomware.Sodinokibi"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$d1 = { 03 C0 01 47 30 11 4F 34 01 57 30 8B 57 78 8B C2 11 77 34 8B 77 7C 8B CE 0F A4 C1 04 C1 E0 04 01 47 28 8B C2 11 4F 2C 8B CE 0F A4 C1 01 03 C0 01 47 28 11 4F 2C 01 57 28 8B 57 70 8B C2 11 77 2C 8B 77 74 8B CE 0F A4 C1 04 C1 E0 04 01 47 20 8B C2 11 4F 24 8B CE 0F A4 C1 01 03 C0 01 47 20 11 4F 24 01 57 20 8B 57 68 8B C2 11 77 24 8B 77 6C 8B CE 0F A4 C1 04 C1 E0 04 01 47 18 8B C2 11 4F 1C 8B CE 0F A4 C1 01 03 C0 01 47 18 11 4F 1C 01 57 18 8B 57 60 8B C2 11 77 1C 8B 77 64 }
		$d2 = { 65 78 70 61 6E 64 20 33 32 2D 62 79 74 65 20 6B 65 78 70 61 6E 64 20 31 36 2D 62 79 74 65 20 6B }
		$d3 = { F7 6F 38 03 C8 8B 43 48 13 F2 F7 6F 20 03 C8 8B 43 38 13 F2 F7 6F 30 03 C8 8B 43 40 13 F2 F7 6F 28 03 C8 8B 43 28 13 F2 F7 6F 40 03 C8 8B 45 08 13 F2 89 48 68 89 70 6C 8B 43 38 F7 6F 38 8B C8 8B F2 8B 43 28 F7 6F 48 03 C8 13 F2 8B 43 48 F7 6F 28 03 C8 8B 43 30 13 F2 F7 6F 40 0F A4 CE 01 03 C9 03 C8 8B 43 40 13 F2 F7 6F 30 03 C8 8B 45 08 13 F2 89 48 70 89 70 74 8B 43 38 F7 6F 40 8B C8 }
		$d4 = { 33 C0 8B 5A 68 8B 52 6C 0F A4 FE 08 C1 E9 18 0B C6 C1 E7 08 8B 75 08 0B CF 89 4E 68 8B CA 89 46 6C 33 C0 8B 7E 60 8B 76 64 0F A4 DA 19 C1 E9 07 0B C2 C1 E3 19 8B 55 08 0B CB 89 4A 60 8B CF 89 42 64 33 C0 8B 5A 10 8B 52 14 0F AC F7 15 C1 E1 0B C1 EE 15 0B C7 0B CE 8B 75 }
		$d5 = { C1 01 C1 EE 1F 0B D1 03 C0 0B F0 8B C2 33 43 24 8B CE 33 4B 20 33 4D E4 33 45 E0 89 4B 20 8B CB 8B 5D E0 89 41 24 8B CE 33 4D E4 8B C2 31 4F 48 33 C3 8B CF 31 41 4C 8B C7 8B CE 33 48 70 8B C2 33 47 74 33 4D E4 33 C3 89 4F 70 8B CF 89 41 74 8B }
		$d6 = { 8B 43 40 F7 6F 08 03 C8 8B 03 13 F2 F7 6F 48 03 C8 8B 43 48 13 F2 F7 2F 03 C8 8B 43 08 13 F2 F7 6F 40 03 C8 8B 43 30 13 F2 F7 6F 18 03 C8 8B 43 18 13 F2 F7 6F 30 03 C8 8B 43 38 13 F2 F7 6F 10 03 C8 8B 43 10 13 F2 F7 6F 38 03 C8 8B 43 28 13 F2 }
		$d7 = { 8B CE 33 4D F8 8B C2 33 C3 31 4F 18 8B CF 31 41 1C 8B C7 8B CE 33 48 40 8B C2 33 4D F8 33 47 44 89 4F 40 33 C3 8B CF 89 41 44 8B C7 8B CE 33 48 68 8B C2 33 47 6C 33 4D F8 33 C3 89 4F 68 8B CF 89 41 6C 8B CE 8B }
		$d8 = { 36 7D 49 30 85 35 C2 C3 68 60 4B 4B 7A BE 83 53 AB E6 8E 42 F9 C6 62 A5 D0 6A AD C6 F1 7D F6 1D 79 CD 20 FC E7 3E E1 B8 1A 43 38 12 C1 56 28 1A 04 C9 22 55 E0 D7 08 BB 9F 0B 1F 1C B9 13 06 35 }
		$d9 = { C2 C1 EE 03 8B 55 08 0B CE 89 4A 4C 8B CF 89 42 48 33 C0 8B 72 30 8B 52 34 C1 E9 0C 0F A4 DF 14 0B C7 C1 E3 14 8B 7D 08 0B CB 89 4F 30 8B CE 89 47 34 33 C0 C1 E1 0C 0F AC D6 14 0B C6 C1 EA 14 89 47 08 0B CA }
		$d10 = { 8B F2 8B 43 38 F7 6F 28 03 C8 8B 43 18 13 F2 F7 6F 48 03 C8 8B 43 28 13 F2 F7 6F 38 03 C8 8B 43 40 13 F2 F7 6F 20 0F A4 CE 01 03 C9 03 C8 8B 43 20 13 F2 F7 6F 40 03 C8 8B 43 30 13 F2 F7 6F 30 03 C8 }
		$d11 = { 33 45 FC 31 4B 28 8B CB 31 41 2C 8B CE 8B C3 33 48 50 8B C2 33 43 54 33 CF 33 45 FC 89 4B 50 8B CB 89 41 54 8B CE 8B C3 33 48 78 8B C2 33 43 7C 33 CF 33 45 FC 89 4B 78 8B CB 89 41 7C 33 B1 A0 }
		$d12 = { 52 24 0F A4 FE 0E C1 E9 12 0B C6 C1 E7 0E 8B 75 08 0B CF 89 4E 20 8B CA 89 46 24 33 C0 8B 7E 78 8B 76 7C 0F A4 DA 1B C1 E9 05 0B C2 C1 E3 1B 8B 55 08 0B CB 89 4A 78 8B CF 89 42 7C 33 C0 8B 9A }
		$d13 = { F2 8B 43 38 F7 6F 20 03 C8 8B 43 40 13 F2 F7 6F 18 03 C8 8B 43 10 13 F2 F7 6F 48 03 C8 8B 43 28 13 F2 F7 6F 30 03 C8 8B 43 20 13 F2 F7 6F 38 03 C8 8B 43 30 13 F2 F7 6F 28 03 C8 8B 43 48 13 F2 }
		$d14 = { 8B 47 30 13 F2 F7 6F 40 03 C8 13 F2 0F A4 CE 01 89 73 74 03 C9 89 4B 70 8B 47 30 F7 6F 48 8B C8 8B F2 8B 47 38 F7 6F 40 03 C8 13 F2 0F A4 CE 01 89 73 7C 03 C9 89 4B 78 8B 47 38 F7 6F 48 8B C8 }

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Sodinokibi_182B2Cea : BETA FILE MEMORY {
    meta:
		description = "Identifies SODINOKIBI/REvil ransomware"
		author = "Elastic Security"
		id = "182b2cea-5aae-443a-9a2e-b3121a0ac8c7"
		date = "2020-06-18"
		modified = "2021-10-04"
		reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.revil"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Sodinokibi.yar#L36-L62"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "1c23effe5f8b35c5e03ebd5e57664c8937259d464f92dda0a9df344b982e8f8c"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "b71d862f6d45b388a106bf694e2bf5b4e4d78649c396e89bda46eab4206339fe"
		threat_name = "Windows.Ransomware.Sodinokibi"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "expand 32-byte kexpand 16-byte k" ascii fullword
		$b1 = "ServicesActive" wide fullword
		$b2 = "CreateThread" ascii fullword
		$b3 = "GetExitCodeProcess" ascii fullword
		$b4 = "CloseHandle" ascii fullword
		$b5 = "SetErrorMode" ascii fullword
		$b6 = ":!:(:/:6:C:\\:m:" ascii fullword

	condition:
		($a1 and 6 of ($b*))
}
rule ELASTIC_Windows_Ransomware_Sodinokibi_A282Ba44 : BETA FILE MEMORY {
    meta:
		description = "Identifies SODINOKIBI/REvil ransomware"
		author = "Elastic Security"
		id = "a282ba44-b8bf-4fcc-a1c4-795675a928de"
		date = "2020-06-18"
		modified = "2021-08-23"
		reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.revil"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Sodinokibi.yar#L64-L91"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "3a583069c9ab851a90f3a61c9c4fa67f8b918b8d168fcf7f25b2a3ae3465c596"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "07f1feb22f8b9de0ebd5c4649545eb4823a274b49b2c61a44d3eed4739ecd572"
		threat_name = "Windows.Ransomware.Sodinokibi"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$c1 = { 59 59 85 F6 74 25 8B 55 08 83 66 04 00 89 3E 8B 0A 0B 4A 04 }
		$c2 = { 8D 45 F8 89 75 FC 50 8D 45 FC 89 75 F8 50 56 56 6A 01 6A 30 }
		$c3 = { 75 0C 72 D3 33 C0 40 5F 5E 5B 8B E5 5D C3 33 C0 EB F5 55 8B EC 83 }
		$c4 = { 0C 8B 04 B0 83 78 04 05 75 1C FF 70 08 FF 70 0C FF 75 0C FF }
		$c5 = { FB 8B 45 FC 50 8B 08 FF 51 08 5E 8B C7 5F 5B 8B E5 5D C3 55 }
		$c6 = { BC 00 00 00 33 D2 8B 4D F4 8B F1 8B 45 F0 0F A4 C1 01 C1 EE 1F }
		$c7 = { 54 8B CE F7 D1 8B C2 23 4D DC F7 D0 33 4D F4 23 C7 33 45 E8 89 }
		$c8 = { 0C 89 46 0C 85 C0 75 2A 33 C0 EB 6C 8B 46 08 85 C0 74 62 6B }

	condition:
		(6 of ($c*))
}
rule ELASTIC_Windows_Cryptominer_Generic_F53Cfb9B : FILE MEMORY {
    meta:
		description = "Detects Windows Cryptominer Generic (Windows.Cryptominer.Generic)"
		author = "Elastic Security"
		id = "f53cfb9b-0286-4e7e-895e-385b6f64c58a"
		date = "2024-03-05"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Cryptominer_Generic.yar#L21-L39"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a9870a03ddc6543a5a12d50f95934ff49f26b60921096b2c8f2193cb411ed408"
		logic_hash = "b2453862747e251afc34c57e887889b8d3a65a9cc876d4a95ff5ecfcc24e4bd3"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "2b66960ee7d423669d0d9e9dcd22ea6e1c0843893e5e04db92237b67b43d645c"
		severity = 50
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 48 81 EC B8 00 00 00 0F AE 9C 24 10 01 00 00 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 0F AE 94 24 14 01 00 00 4C 8B A9 E0 00 00 00 4C 8B CA 4C 8B 51 20 4C 8B C1 4C 33 11 ?? ?? ?? ?? ?? ?? 4C 8B 59 28 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Carberp_D6De82Ae : FILE MEMORY {
    meta:
		description = "Identifies VNC module from the leaked Carberp source code. This could exist in other malware families."
		author = "Elastic Security"
		id = "d6de82ae-9846-40cb-925d-e0a371e1c44c"
		date = "2021-02-07"
		modified = "2021-08-23"
		reference = "https://github.com/m0n0ph1/malware-1/blob/master/Carberp%20Botnet/source%20-%20absource/pro/all%20source/hvnc_dll/HVNC%20Lib/vnc/xvnc.h#L342"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Carberp.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f98fadb6feab71930bd5c08e85153898d686cc96c84fe349c00bf6d482de9b53"
		logic_hash = "085020755c77b299b2bfd18b34af6c68450c29de67b8ae32ddf2b26299b923ae"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "7ce34f1000749a938b78508c93371d3339cd49f73eeec36b25da13c9d129b85c"
		threat_name = "Windows.Trojan.Carberp"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = ".NET CLR Networking_Perf_Library_Lock_PID_0" ascii wide fullword
		$a2 = "FakeVNCWnd" ascii wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Danabot_6F3Dadb2 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Danabot (Windows.Trojan.Danabot)"
		author = "Elastic Security"
		id = "6f3dadb2-3283-4333-8143-1265721d2221"
		date = "2021-08-15"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Danabot.yar#L1-L26"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "716e5a3d29ff525aed30c18061daff4b496f3f828ba2ac763efd857062a42e96"
		logic_hash = "b9c895be9eab775726abd2c13256d598c5b79bceb2d652c30b1df4cfc37e4b93"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "387e3fb3c3f625c8b5e42052c126ce4dbb7de3a7de6b68addf0a0777b9d3b504"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "%s.dll" ascii fullword
		$a2 = "del_ini://Main|Password|" wide fullword
		$a3 = "S-Password.txt" wide fullword
		$a4 = "BiosTime:" wide fullword
		$a5 = "%lu:%s:%s:%d:%s" ascii fullword
		$a6 = "DNS:%s" ascii fullword
		$a7 = "THttpInject&" ascii fullword
		$a8 = "TCookies&" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Generic_99F5A632 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Generic (Windows.Ransomware.Generic)"
		author = "Elastic Security"
		id = "99f5a632-8562-4321-b707-c5f583b14511"
		date = "2022-02-24"
		modified = "2022-02-24"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Generic.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "4dc13bb83a16d4ff9865a51b3e4d24112327c526c1392e14d56f20d6f4eaf382"
		logic_hash = "2284cfc91d17816f1733e8fe319af52bc66af467364d27f84e213082c216ae8b"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "84ab8d177e50bce1a3eceb99befcf05c7a73ebde2f7ea4010617bf4908257fdb"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "stephanie.jones2024@protonmail.com"
		$a2 = "_/C_/projects/403forBiden/wHiteHousE.init" ascii fullword
		$a3 = "All your files, documents, photoes, videos, databases etc. have been successfully encrypted" ascii fullword
		$a4 = "<p>Do not try to decrypt then by yourself - it's impossible" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Agenttesla_D3Ac2B2F : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Agenttesla (Windows.Trojan.AgentTesla)"
		author = "Elastic Security"
		id = "d3ac2b2f-14fc-4851-8a57-41032e386aeb"
		date = "2021-03-22"
		modified = "2022-06-20"
		reference = "https://www.elastic.co/security-labs/attack-chain-leads-to-xworm-and-agenttesla"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_AgentTesla.yar#L1-L58"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "65463161760af7ab85f5c475a0f7b1581234a1e714a2c5a555783bdd203f85f4"
		logic_hash = "9c13a99107593d476de1522ced10aa43d34535b844e8c3ae871b22358137c926"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "cbbb56fe6cd7277ae9595a10e05e2ce535a4e6bf205810be0bbce3a883b6f8bc"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "GetMozillaFromLogins" ascii fullword
		$a2 = "AccountConfiguration+username" wide fullword
		$a3 = "MailAccountConfiguration" ascii fullword
		$a4 = "KillTorProcess" ascii fullword
		$a5 = "SmtpAccountConfiguration" ascii fullword
		$a6 = "GetMozillaFromSQLite" ascii fullword
		$a7 = "Proxy-Agent: HToS5x" wide fullword
		$a8 = "set_BindingAccountConfiguration" ascii fullword
		$a9 = "doUsernamePasswordAuth" ascii fullword
		$a10 = "SafariDecryptor" ascii fullword
		$a11 = "get_securityProfile" ascii fullword
		$a12 = "get_useSeparateFolderTree" ascii fullword
		$a13 = "get_DnsResolver" ascii fullword
		$a14 = "get_archivingScope" ascii fullword
		$a15 = "get_providerName" ascii fullword
		$a16 = "get_ClipboardHook" ascii fullword
		$a17 = "get_priority" ascii fullword
		$a18 = "get_advancedParameters" ascii fullword
		$a19 = "get_disabledByRestriction" ascii fullword
		$a20 = "get_LastAccessed" ascii fullword
		$a21 = "get_avatarType" ascii fullword
		$a22 = "get_signaturePresets" ascii fullword
		$a23 = "get_enableLog" ascii fullword
		$a24 = "TelegramLog" ascii fullword
		$a25 = "generateKeyV75" ascii fullword
		$a26 = "set_accountName" ascii fullword
		$a27 = "set_InternalServerPort" ascii fullword
		$a28 = "set_bindingConfigurationUID" ascii fullword
		$a29 = "set_IdnAddress" ascii fullword
		$a30 = "set_GuidMasterKey" ascii fullword
		$a31 = "set_username" ascii fullword
		$a32 = "set_version" ascii fullword
		$a33 = "get_Clipboard" ascii fullword
		$a34 = "get_Keyboard" ascii fullword
		$a35 = "get_ShiftKeyDown" ascii fullword
		$a36 = "get_AltKeyDown" ascii fullword
		$a37 = "get_Password" ascii fullword
		$a38 = "get_PasswordHash" ascii fullword
		$a39 = "get_DefaultCredentials" ascii fullword

	condition:
		8 of ($a*)
}
rule ELASTIC_Windows_Trojan_Agenttesla_E577E17E : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Agenttesla (Windows.Trojan.AgentTesla)"
		author = "Elastic Security"
		id = "e577e17e-5c42-4431-8c2d-0c1153128226"
		date = "2022-03-11"
		modified = "2022-04-12"
		reference = "https://www.elastic.co/security-labs/attack-chain-leads-to-xworm-and-agenttesla"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_AgentTesla.yar#L60-L79"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ed43ddb536e6c3f8513213cd6eb2e890b73e26d5543c0ba1deb2690b5c0385b6"
		logic_hash = "84c5f1096735cee0f0f4ad41a81286c0a60dc17c276f23568b855271d996c8a2"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "009cb27295a1aa0dde84d29ee49b8fa2e7a6cec75eccb7534fec3f5c89395a9d"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 20 4D 27 00 00 33 DB 19 0B 00 07 17 FE 01 2C 02 18 0B 00 07 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Agenttesla_F2A90D14 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Agenttesla (Windows.Trojan.AgentTesla)"
		author = "Elastic Security"
		id = "f2a90d14-7212-41a5-a2cd-a6a6dedce96e"
		date = "2022-03-11"
		modified = "2022-04-12"
		reference = "https://www.elastic.co/security-labs/attack-chain-leads-to-xworm-and-agenttesla"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_AgentTesla.yar#L81-L100"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ed43ddb536e6c3f8513213cd6eb2e890b73e26d5543c0ba1deb2690b5c0385b6"
		logic_hash = "3f39b773f2b1524b05d3c1d9aa1fb54594ec9003d2e9da342b6d17ba885f5a03"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "829c827069846ba1e1378aba8ee6cdc801631d769dc3dce15ccaacd4068a88a6"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 0B FE 01 2C 0B 07 16 7E 08 00 00 04 A2 1F 0C 0C 00 08 1F 09 FE 01 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Agenttesla_A2D69E48 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Agenttesla (Windows.Trojan.AgentTesla)"
		author = "Elastic Security"
		id = "a2d69e48-b114-4128-8c2f-6fabee49e152"
		date = "2023-05-01"
		modified = "2023-06-13"
		reference = "https://www.elastic.co/security-labs/attack-chain-leads-to-xworm-and-agenttesla"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_AgentTesla.yar#L102-L122"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "edef51e59d10993155104d90fcd80175daa5ade63fec260e3272f17b237a6f44"
		logic_hash = "1f90be86b7afa7f518a3dcec55028bfc915cf6d4fed1350a56e351946cc55f41"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "bd46dd911aadf8691516a77f3f4f040e6790f36647b5293050ecb8c25da31729"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 00 03 08 08 10 08 10 18 09 00 04 08 18 08 10 08 10 18 0E 00 08 }
		$a2 = { 00 06 17 5F 16 FE 01 16 FE 01 2A 00 03 30 03 00 B1 00 00 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Agenttesla_Ebf431A8 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Agenttesla (Windows.Trojan.AgentTesla)"
		author = "Elastic Security"
		id = "ebf431a8-45e8-416c-a355-4ac1db2d133a"
		date = "2023-12-01"
		modified = "2024-01-12"
		reference = "https://www.elastic.co/security-labs/attack-chain-leads-to-xworm-and-agenttesla"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_AgentTesla.yar#L124-L148"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0cb3051a80a0515ce715b71fdf64abebfb8c71b9814903cb9abcf16c0403f62b"
		logic_hash = "b02d6e2d68b336aaa37336e0c0c3ffa6c7a126bfcdb6cb6ad5a3432004c6030c"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "2d95dbe502421d862eee33ba819b41cb39cf77a44289f4de4a506cad22f3fddb"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "MozillaBrowserList"
		$a2 = "EnableScreenLogger"
		$a3 = "VaultGetItem_WIN7"
		$a4 = "PublicIpAddressGrab"
		$a5 = "EnableTorPanel"
		$a6 = "get_GuidMasterKey"

	condition:
		4 of them
}
rule ELASTIC_Windows_Ransomware_Dharma_Aa5Eefed : BETA FILE MEMORY {
    meta:
		description = "Identifies DHARMA ransomware"
		author = "Elastic Security"
		id = "aa5eefed-7212-42c9-b51d-2c58c65b53e5"
		date = "2020-06-25"
		modified = "2021-08-23"
		reference = "https://blog.malwarebytes.com/threat-analysis/2019/05/threat-spotlight-crysis-aka-dharma-ransomware-causing-a-crisis-for-businesses/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Dharma.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "bbafc2eac17562f315b09fa42eb601d0140152917d7962429df3a378abe67732"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "d3baf3474b450931b594322d190b243bdd813156ad80f04abcadde0db3bfe149"
		threat_name = "Windows.Ransomware.Dharma"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$c1 = { 4D F0 51 8B 55 E8 52 E8 CD 10 00 00 83 C4 08 89 45 E8 8A 45 F9 04 01 88 45 F9 0F B6 4D F9 8B 55 E4 8A 04 0A 88 45 FB 0F B6 4D FB 0F B6 55 FA 03 D1 88 55 FA 0F B6 45 FA 8B 4D E4 8A 14 01 88 55 EF 0F B6 45 F9 8B 4D E4 8A 55 EF 88 14 01 0F B6 45 FA 8B 4D E4 8A 55 FB 88 14 01 8B 45 0C 03 45 F4 0F B6 08 0F B6 55 FB 0F B6 45 EF 03 D0 0F B6 D2 8B 45 E4 0F B6 14 10 33 CA 8B 45 E8 03 45 F4 88 08 }
		$c2 = { 21 0C 7D 01 02 04 08 10 20 40 80 1B 36 6C D8 AB 4D 9A 2F 5E BC 63 C6 97 35 6A D4 B3 7D FA EF C5 91 00 00 A5 63 63 C6 84 7C 7C F8 99 77 77 EE 8D 7B 7B F6 0D F2 F2 FF BD 6B 6B D6 B1 6F 6F DE 54 C5 C5 91 50 30 30 60 03 01 01 02 A9 67 67 CE 7D 2B 2B 56 }

	condition:
		1 of ($c*)
}
rule ELASTIC_Windows_Ransomware_Dharma_B31Cac3F : BETA FILE MEMORY {
    meta:
		description = "Identifies DHARMA ransomware"
		author = "Elastic Security"
		id = "b31cac3f-6e04-48b2-9d16-1a6b66fa8012"
		date = "2020-06-25"
		modified = "2021-08-23"
		reference = "https://blog.malwarebytes.com/threat-analysis/2019/05/threat-spotlight-crysis-aka-dharma-ransomware-causing-a-crisis-for-businesses/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Dharma.yar#L23-L44"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "30500e35721e9db3d63cafa5ca10818557fa9f4e0bda9c0d02283183508cf7b5"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "25d23d045c57758dbb14092cff3cc190755ceb3a21c8a80505bd316a430e21fc"
		threat_name = "Windows.Ransomware.Dharma"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$b1 = "sssssbsss" ascii fullword
		$b2 = "sssssbs" ascii fullword
		$b3 = "RSDS%~m" ascii fullword

	condition:
		3 of ($b*)
}
rule ELASTIC_Windows_Ransomware_Dharma_E9319E4A : BETA FILE MEMORY {
    meta:
		description = "Identifies DHARMA ransomware"
		author = "Elastic Security"
		id = "e9319e4a-3850-4bad-9579-4b73199a0963"
		date = "2020-06-25"
		modified = "2021-08-23"
		reference = "https://blog.malwarebytes.com/threat-analysis/2019/05/threat-spotlight-crysis-aka-dharma-ransomware-causing-a-crisis-for-businesses/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Dharma.yar#L46-L65"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "182ed508d645a0b1fab80fb6f975a05d33b64c43005bd3656df6470934cd71f4"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "4a4f3aebe4c9726cf62dde454f01cbf6dcb09bf3ef1b230d548fe255f01254aa"
		threat_name = "Windows.Ransomware.Dharma"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$d = { 08 8B 51 24 8B 45 08 8B 48 18 0F B7 14 51 85 D2 74 47 8B 45 08 8B }

	condition:
		1 of ($d*)
}
rule ELASTIC_Windows_Ransomware_Dharma_942142E3 : BETA FILE MEMORY {
    meta:
		description = "Identifies DHARMA ransomware"
		author = "Elastic Security"
		id = "942142e3-9197-41c4-86cc-66121c8a9ab5"
		date = "2020-06-25"
		modified = "2021-08-23"
		reference = "https://blog.malwarebytes.com/threat-analysis/2019/05/threat-spotlight-crysis-aka-dharma-ransomware-causing-a-crisis-for-businesses/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Dharma.yar#L67-L86"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "af5068ef3442964e4d1c5e27090fb84eaf762ff23463b7a0c2902e523ae601c1"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "e8ee60d53f92dd1ade8cc956c13a5de38f9be9050131ba727f2fab41dde619a8"
		threat_name = "Windows.Ransomware.Dharma"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "C:\\crysis\\Release\\PDB\\payload.pdb" ascii fullword

	condition:
		1 of ($a*)
}
rule ELASTIC_Windows_Wiper_Isaacwiper_239Cd2Dc : FILE MEMORY {
    meta:
		description = "Detects Windows Wiper Isaacwiper (Windows.Wiper.IsaacWiper)"
		author = "Elastic Security"
		id = "239cd2dc-6f93-43fa-98e8-ad7a0edb8a8a"
		date = "2022-03-04"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Wiper_IsaacWiper.yar#L1-L24"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "13037b749aa4b1eda538fda26d6ac41c8f7b1d02d83f47b0d187dd645154e033"
		logic_hash = "102ffe215b1e1c39e1225cb39dfeb10a20a08c5b10f836490fc1501c6eb9e930"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a9c193d7c60b0c793c299b23f672d6428ceb229f2ceb2acbfc1124387954b244"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "C:\\ProgramData\\log.txt" wide fullword
		$a2 = "system physical drive -- FAILED" wide fullword
		$a3 = "-- system logical drive: " wide fullword
		$a4 = "start erasing system logical drive " wide fullword
		$a5 = "-- logical drive: " wide fullword
		$a6 = "-- start erasing logical drive " wide fullword

	condition:
		5 of them
}
rule ELASTIC_Windows_Trojan_Sliver_46525B49 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Sliver (Windows.Trojan.Sliver)"
		author = "Elastic Security"
		id = "46525b49-f426-4ecb-9bd6-36752f0461e9"
		date = "2023-05-09"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Sliver.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ecce5071c28940a1098aca3124b3f82e0630c4453f4f32e1b91576aac357ac9c"
		logic_hash = "6e61d82b191a740882bcfeac2f2cf337e19ace7b05784ff041b6af2f79ed8809"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "104382f222b754b3de423803ac7be1d6fbdd9cbd11c855774d1ecb1ee73cb6c0"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { B6 54 0C 48 0F B6 74 0C 38 31 D6 40 88 74 0C 38 48 FF C1 48 83 }
		$a2 = { 42 18 4C 8B 4A 20 48 8B 52 28 48 39 D9 73 51 48 89 94 24 C0 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Sliver_C9Cae357 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Sliver (Windows.Trojan.Sliver)"
		author = "Elastic Security"
		id = "c9cae357-9270-4871-8fad-d9c43dcab644"
		date = "2023-05-10"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Sliver.yar#L22-L40"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "27210d8d6e16c492c2ee61a59d39c461312f5563221ad4a0917d4e93b699418e"
		logic_hash = "fea862352981787055961b1171de9b69a9c13d246f434809c8f4416d5c49a0ff"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "5366540c4a4f4a502b550f5397f3b53e3bc909cbc0cb82a2091cabb19bc135aa"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { B1 F9 3C 0A 68 0F B4 B5 B5 B5 21 B2 38 23 29 D8 6F 83 EC 68 51 8E }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Sliver_1Dd6D9C2 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Sliver (Windows.Trojan.Sliver)"
		author = "Elastic Security"
		id = "1dd6d9c2-026e-4140-b804-b56e07c72ac2"
		date = "2023-05-10"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Sliver.yar#L42-L61"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "dc508a3e9ea093200acfc1ceebebb2b56686f4764fd8c94ab8c58eec7ee85c8b"
		logic_hash = "5ef70322a6ee3dec609d2881b7624d25bc0297a2e6f43ac60834745e6a258cf3"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "fb676adf8b9d10d1e151bfb2a6a7e132cff4e55c20f454201a4ece492902fc35"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { B7 11 49 89 DB C1 EB 10 41 01 DA 66 45 89 11 4C 89 DB EB B6 4D 8D }
		$a2 = { 36 2E 33 20 62 75 69 6C 48 39 }

	condition:
		all of them
}
rule ELASTIC_Windows_Infostealer_Generic_Acde9261 : FILE MEMORY {
    meta:
		description = "Observed in Stealc/Vidar samples"
		author = "Elastic Security"
		id = "acde9261-9dcb-4797-a5ae-cc470928622c"
		date = "2024-10-21"
		modified = "2024-10-24"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Infostealer_Generic.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b46239c47a835757bba49078728f693b7273b0e3755e2968deac4aa92e90364d"
		logic_hash = "86897117295bdcf79fad9f2ad939fabe89e3770309122ba142c7a26c926148c5"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b56f87041429209b63bb28513c3cee10e4e088dad43dd2fd2bd90cda0fe91d75"
		threat_name = "Windows.Infostealer.Generic"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$str1 = "ChromeFuckNewCookies" ascii fullword
		$str2 = "/c timeout /t 10 & del /f /q \"" ascii fullword
		$str3 = "56574883EC2889D74889CEE8AAAAFFFF85FF74084889F1E8AAAAAAAA4889F04883C4285F5EC3CCCCCCCCCCCCCCCCCCCC56574883ECAA"
		$seq1 = { 81 FA 6B 03 EE 4C 74 ?? 81 FA 77 03 EE 4C 74 ?? 81 FA 80 68 55 FB 74 ?? 81 FA 92 68 55 FB }

	condition:
		2 of them
}
rule ELASTIC_Windows_Hacktool_Chromekatz_Fa232Bba : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Chromekatz (Windows.Hacktool.ChromeKatz)"
		author = "Elastic Security"
		id = "fa232bba-07dd-45e0-9ca3-b1465eb9616d"
		date = "2024-03-27"
		modified = "2024-05-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_ChromeKatz.yar#L1-L28"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "3f6922049422df14f1a1777001fea54b18fbfb0a4b03c4ee27786bfbc3b8ab87"
		logic_hash = "c86291fadd51845cbd7428b159e401d78ac77090e14e34d06bf7bf2018f4502a"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "bf1da659e0de9c4e22851e77878066ae5f4aca75e61b35392887c12e125c91f8"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$s1 = "CookieKatz.exe"
		$s2 = "Targeting Chrome"
		$s3 = "Targeting Msedgewebview2"
		$s4 = "Failed to find the first pattern"
		$s5 = "WalkCookieMap"
		$s6 = "Found CookieMonster on 0x%p"
		$s7 = "Cookie Key:"
		$s8 = "Failed to read cookie value" wide
		$s9 = "Failed to read cookie struct" wide
		$s10 = "Error reading left node"

	condition:
		5 of them
}
rule ELASTIC_Windows_Trojan_Poshc2_E2D3881E : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Poshc2 (Windows.Trojan.PoshC2)"
		author = "Elastic Security"
		id = "e2d3881e-d849-4ec8-a560-000a9b29814f"
		date = "2023-03-29"
		modified = "2023-04-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_PoshC2.yar#L1-L26"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "7a718a4f74656346bd9a2e29e008705fc2b1c4d167a52bd4f6ff10b3f2cd9395"
		logic_hash = "4f3e2a9f22826a155a3007193a0f75a5fde6e423734a60f30628ea3bb33d3457"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "30a9161077a90068acf756dcc2354bd04186f87717e32cccdcacc9521c41ddde"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Sharp_v4_x64.dll"
		$a2 = "Sharp_v4_x86_dll"
		$a3 = "Posh_v2_x64_Shellcode" wide
		$a4 = "Posh_v2_x86_Shellcode" wide
		$b1 = "kill-implant" wide
		$b2 = "run-dll-background" wide
		$b3 = "run-exe-background" wide
		$b4 = "TVqQAAMAAAAEAAAA"

	condition:
		1 of ($a*) and 1 of ($b*)
}
rule ELASTIC_Windows_Ransomware_Crytox_29859242 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Crytox (Windows.Ransomware.Crytox)"
		author = "Elastic Security"
		id = "29859242-adf4-4d17-afdf-dbc02f5b787b"
		date = "2024-01-18"
		modified = "2024-02-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Crytox.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "55a27cb6280f31c077987d338151b13e9dc0cc1c14d47a32e64de6d6c1a6a742"
		logic_hash = "47ca96e14b2b56bc6ef1ed22b42adac7aa557170632c2dc085fae3baf6198f40"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "999713c1815d61904f13f7f9cbaf34b116f53af223b2aac20bf0d88af107dbae"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 48 83 C7 20 D7 C1 C8 08 D7 C1 C8 08 D7 C1 C8 08 D7 C1 C8 10 33 C2 33 47 E0 D0 E2 }

	condition:
		all of them
}
rule ELASTIC_Windows_Hacktool_Sharpview_2C7603Ad : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Sharpview (Windows.Hacktool.SharpView)"
		author = "Elastic Security"
		id = "2c7603ad-27f4-49fc-9fab-f4284620452f"
		date = "2022-10-20"
		modified = "2022-11-24"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_SharpView.yar#L1-L34"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c0621954bd329b5cabe45e92b31053627c27fa40853beb2cce2734fa677ffd93"
		logic_hash = "1f80b2fd6121c2b36742c819a56626af2e1450dac0f62c67d93f09e4e140b75f"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "379606da5cf6adb58d6a8e693d379252f7987ff295f838df092ce2246da08354"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$guid = "22A156EA-2623-45C7-8E50-E864D9FC44D3" ascii wide nocase
		$print_str0 = "[Add-DomainObjectAcl] Granting principal {0} rights GUID '{1}' on {2}" ascii wide
		$print_str1 = "[Get-NetRDPSession] Error opening the Remote Desktop Session Host (RD Session Host) server for: {0}" ascii wide
		$print_str2 = "[Get-WMIProcess] Error enumerating remote processes on '{0}', access likely denied: {1}" ascii wide
		$print_str3 = "[Get-WMIRegLastLoggedOn] Error opening remote registry on $Computer. Remote registry likely not enabled." ascii wide
		$print_str4 = "[Get-DomainGUIDMap] Error in building GUID map: {e}" ascii wide
		$str0 = "^[0-9A-F]{8}-([0-9A-F]{4}-){3}[0-9A-F]{12}$" ascii wide
		$str1 = "(&(samAccountType=805306368)(!(userAccountControl:1.2.840.113556.1.4.803:=2))(|(homedirectory=*)(scriptpath=*)(profilepath=*)))" ascii wide
		$str2 = "^(CN|OU|DC)=" ascii wide
		$str3 = "(|(samAccountName={0})(name={1})(displayname={2}))" ascii wide
		$str4 = "^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}$" ascii wide
		$str5 = "LDAP://|^CN=.*" ascii wide
		$str6 = "(objectCategory=groupPolicyContainer)" ascii wide
		$str7 = "\\\\{0}\\SysVol\\{1}\\Policies\\{2}" ascii wide
		$str8 = "S-1-5-21-[0-9]+-[0-9]+-[0-9]+-[0-9]+$" ascii wide
		$str9 = "^S-1-5-.*-[1-9]\\d{3,}$" ascii wide

	condition:
		$guid or ( all of ($str*) and 1 of ($print_str*))
}
rule ELASTIC_Windows_Trojan_Microbackdoor_903E33C3 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Microbackdoor (Windows.Trojan.MicroBackdoor)"
		author = "Elastic Security"
		id = "903e33c3-d8f1-4c3b-900b-7503edb11951"
		date = "2022-03-07"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_MicroBackdoor.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "fbbfcc81a976b57739ef13c1545ea4409a1c69720469c05ba249a42d532f9c21"
		logic_hash = "5f96f68df442eb1da21d87c3ae954c4e36cf87db583cbef1775f8ca9e76b776e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "06b3c0164c2d06f50d1e6ae0a9edf823ae1fef53574e0d20020aada8721dfee0"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 55 8B EC 83 EC 1C 56 57 E8 33 01 00 00 8B F8 85 FF 74 48 BA 26 80 AC C8 8B CF E8 E1 01 00 00 BA }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Microbackdoor_46F2E5Fd : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Microbackdoor (Windows.Trojan.MicroBackdoor)"
		author = "Elastic Security"
		id = "46f2e5fd-edea-4321-b38c-7478b47f054b"
		date = "2022-03-07"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_MicroBackdoor.yar#L21-L44"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "fbbfcc81a976b57739ef13c1545ea4409a1c69720469c05ba249a42d532f9c21"
		logic_hash = "580be4c5b058916c2bc67a7964522a7c369bb254394e3cedbf0da025105231c4"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "d4e410b9c36c1d5206f5d17190ef4e5fd4b4e4d40acad703775aed085a08ef7c"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "cmd.exe /C \"%s%s\"" wide fullword
		$a2 = "%s|%s|%d|%s|%d|%d" wide fullword
		$a3 = "{{{$%.8x}}}" ascii fullword
		$a4 = "30D78F9B-C56E-472C-8A29-E9F27FD8C985" ascii fullword
		$a5 = "chcp 65001 > NUL & " wide fullword
		$a6 = "CONNECT %s:%d HTTP/1.0" ascii fullword

	condition:
		5 of them
}
rule ELASTIC_Windows_Trojan_Jesterstealer_B35C6F4B : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Jesterstealer (Windows.Trojan.JesterStealer)"
		author = "Elastic Security"
		id = "b35c6f4b-995f-4336-94bf-fc6dc8c124f4"
		date = "2022-02-28"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_JesterStealer.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "10c3846867f70dd26c5a54332ed22070c9e5e0e4f52f05fdae12ead801f7933b"
		logic_hash = "acc49348267e963af9ff6ba7afa053d4056d4068b4386a872e33e025790ba759"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "d91c26a06ba7c9330e38a4744299223d3b28a96f131bce5198c4ef7c74b7d2ff"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "[Decrypt Chrome Password] {0}" wide fullword
		$a2 = "Passwords.txt" wide fullword
		$a3 = "9Stealer.Recovery.FTP.FileZilla+<EnumerateCredentials>d__0" ascii fullword
		$a4 = "/C chcp 65001 && ping 127.0.0.1 && DEL /F /S /Q /A \"" wide fullword
		$a5 = "citigroup.com" wide fullword
		$a6 = "Password: {1}" wide fullword
		$a7 = "set_steamLogin" ascii fullword

	condition:
		5 of them
}
rule ELASTIC_Windows_Trojan_Jesterstealer_8F657F58 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Jesterstealer (Windows.Trojan.JesterStealer)"
		author = "Elastic Security"
		id = "8f657f58-57e0-4e5f-9223-00bfade16605"
		date = "2022-02-28"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_JesterStealer.yar#L27-L45"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "10c3846867f70dd26c5a54332ed22070c9e5e0e4f52f05fdae12ead801f7933b"
		logic_hash = "20a0d8be9c25d50d4dddd455ecb9739f772f57e988855c7fc2df597b2f67585b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "aabf8633e853f623b75e8a354378d110442e724425f623b8c553d3522ca5dad6"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 27 01 00 00 00 96 08 0B 80 79 01 6C 02 A4 27 01 00 00 00 96 08 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Blister_Cb99A1Df : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Blister (Windows.Trojan.Blister)"
		author = "Elastic Security"
		id = "cb99a1df-756b-46fe-b657-63b4be2c0664"
		date = "2021-12-21"
		modified = "2022-01-13"
		reference = "https://www.elastic.co/security-labs/elastic-security-uncovers-blister-malware-campaign"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Blister.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0a7778cf6f9a1bd894e89f282f2e40f9d6c9cd4b72be97328e681fe32a1b1a00"
		logic_hash = "deb1be5300d8af12dda868dd5f4ccdbb3ec653bd97c33a09e567c13ecafb9e8a"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "7a7e189ed42019636ffccc06d61e18f2aa17bc3d43d08d50bb77c3258bc1a9a4"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 8D 45 DC 89 5D EC 50 6A 04 8D 45 F0 50 8D 45 EC 50 6A FF FF D7 }
		$a2 = { 75 F7 39 4D FC 0F 85 F3 00 00 00 64 A1 30 00 00 00 53 57 89 75 }
		$b1 = { 78 03 C3 8B 48 20 8B 50 1C 03 CB 8B 78 24 03 D3 8B 40 18 03 FB 89 4D F8 89 55 E0 89 45 E4 85 C0 74 3E 8B 09 8B D6 03 CB 8A 01 84 C0 74 17 C1 C2 09 0F BE C0 03 D0 41 8A 01 84 C0 75 F1 81 FA B2 17 EB 41 74 27 8B 4D F8 83 C7 02 8B 45 F4 83 C1 04 40 89 4D F8 89 45 F4 0F B7 C0 3B 45 E4 72 C2 8B FE 8B 45 04 B9 }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Blister_9D757838 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Blister (Windows.Trojan.Blister)"
		author = "Elastic Security"
		id = "9d757838-ebaa-4ecf-b927-ac0f4848c9cb"
		date = "2022-04-26"
		modified = "2022-06-09"
		reference = "https://www.elastic.co/security-labs/elastic-security-uncovers-blister-malware-campaign"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Blister.yar#L24-L44"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "863de84a39c9f741d8103db83b076695d0d10a7384e4e3ba319c05a6018d9737"
		logic_hash = "4d9ce1622d77b2ac8b20b2dfb60ac672752dabab315221a5449ebd3c73a3edca"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "4ef2e22d0006b127b253d02073cde0d805d22d8696562feabc94020e287e2eb2"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 65 48 8B 04 25 60 00 00 00 44 0F B7 DB 48 8B 48 ?? 48 8B 41 ?? C7 45 48 ?? ?? ?? ?? 4C 8B 40 ?? 49 63 40 ?? }
		$a2 = { B9 FF FF FF 7F 89 5D 40 8B C1 44 8D 63 ?? F0 44 01 65 40 49 2B C4 75 ?? 39 4D 40 0F 85 ?? ?? ?? ?? 65 48 8B 04 25 60 00 00 00 44 0F B7 DB }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Blister_68B53E1B : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Blister (Windows.Trojan.Blister)"
		author = "Elastic Security"
		id = "68b53e1b-dbd7-4903-ac10-8336c05f42df"
		date = "2023-08-02"
		modified = "2023-08-08"
		reference = "https://www.elastic.co/security-labs/elastic-security-uncovers-blister-malware-campaign"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Blister.yar#L46-L66"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "5fc79a4499bafa3a881778ef51ce29ef015ee58a587e3614702e69da304395db"
		logic_hash = "6d935461406a6b9b39867d52aa5ecb088945ae0f8c56895a67e8565e5a2a3699"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b46d59117eda3d6a7a6397287c962106719bf338d19814e20bde9deeebfe65c1"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$b_loader_xor = { 48 8B C3 49 03 DC 83 E0 03 8A 44 05 48 [2-3] ?? 03 ?? 4D 2B ?? 75 }
		$b_loader_virtual_protect = { 48 8D 45 50 41 ?? ?? ?? ?? 00 4C 8D ?? 04 4C 89 ?? ?? 41 B9 04 00 00 00 4C 89 ?? F0 4C 8D 45 58 48 89 44 24 20 48 8D 55 F0 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Blister_487B0966 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Blister (Windows.Trojan.Blister)"
		author = "Elastic Security"
		id = "487b0966-fb24-4c41-84cc-f3a389461ddc"
		date = "2023-09-11"
		modified = "2023-09-20"
		reference = "https://www.elastic.co/security-labs/elastic-security-uncovers-blister-malware-campaign"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Blister.yar#L68-L89"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "5fc79a4499bafa3a881778ef51ce29ef015ee58a587e3614702e69da304395db"
		logic_hash = "521409d03335205507cc6894e0de3ca627eb966a95a2f8e7b931e552ad78bbb7"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "7111f2f9746e056f6ac5e08d904f71628a548b4ab2c1181dec0a38f0f8387878"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$b_loader0 = { 65 48 8B 04 25 60 00 00 00 44 8B D3 41 BE ?? ?? ?? ?? 48 8B 50 18 48 83 C2 ?? 48 8B 0A }
		$b_loader1 = { 0F B7 C0 4D 8D 49 02 41 33 C0 44 69 C0 ?? ?? ?? ?? 41 8B C0 C1 E8 0F 44 33 C0 41 0F B7 01 66 85 C0 }
		$b_loader2 = { 66 45 03 DC 49 83 C2 04 41 0F B7 C3 49 83 C0 02 3B C6 }

	condition:
		2 of them
}
rule ELASTIC_Windows_Trojan_Blister_26F8C5F2 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Blister (Windows.Trojan.Blister)"
		author = "Elastic Security"
		id = "26f8c5f2-85db-4fb9-93bc-7d6b28f6f37b"
		date = "2024-09-25"
		modified = "2024-10-24"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Blister.yar#L91-L110"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "cba30fb1731e165acc256d99d32f3c9e5abfa27d152419d24a91d8b79c5c5cb0"
		logic_hash = "dc87a3ae4edf0b8ee18cb7c34f9b4a0305c504b7ef66cb3232c91dc364d3563c"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ebed10e211f6743df6592ecfd6a1c6c878f157fca025928f7999d8fecc546e4b"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 41 0F B7 04 40 4D 85 D8 45 3A D4 66 41 89 04 4A 41 84 DE 66 41 39 1C 50 }
		$b = { 41 FF C1 F9 41 0F B7 04 40 4D 85 D8 45 3A D4 66 41 89 04 4A }

	condition:
		any of them
}
rule ELASTIC_Windows_PUP_Generic_198B73Aa : FILE MEMORY {
    meta:
		description = "Detects Windows Pup Generic (Windows.PUP.Generic)"
		author = "Elastic Security"
		id = "198b73aa-d7dd-4f28-bf1c-02672a03d031"
		date = "2023-07-27"
		modified = "2023-09-20"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_PUP_Generic.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "a584c34b9dfc2d78bf8a1e594a2ed519d20088184ce1df09e679b2400aa396d3"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "23c11df4ce2ec2d30b1916b73fc94a84b6a817c1686905fd69fa7a6528798d5f"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "[%i.%i]av=[error]" fullword
		$a2 = "not_defined" fullword
		$a3 = "osver=%d.%d-ServicePack %d" fullword

	condition:
		all of them
}
rule ELASTIC_Multi_Trojan_Coreimpact_37703Dc3 : FILE MEMORY {
    meta:
		description = "Detects Multi Trojan Coreimpact (Multi.Trojan.Coreimpact)"
		author = "Elastic Security"
		id = "37703dc3-9485-4026-a8b7-82e753993757"
		date = "2022-08-10"
		modified = "2022-09-29"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Trojan_Coreimpact.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "2d954908da9f63cd3942c0df2e8bb5fe861ac5a336ddef2bd0a977cebe030ad7"
		logic_hash = "0695f22d6eb8c1b335c43213087539db419562bebd6f5b948cbb168c454bd37c"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "5a4d7af7d0fecc05f87ba51f976d78e77622f8afb1eafc175444f45839490109"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$str1 = "Uh, oh, exit() failed" fullword
		$str2 = "agent_recv" fullword
		$str3 = "needroot" fullword
		$str4 = "time is running backwards, corrected" fullword
		$str5 = "junk pointer, too low to make sense" fullword

	condition:
		3 of them
}
rule ELASTIC_Windows_Attacksimulation_Hovercraft_F5C7178F : FILE MEMORY {
    meta:
		description = "Detects Windows Attacksimulation Hovercraft (Windows.AttackSimulation.Hovercraft)"
		author = "Elastic Security"
		id = "f5c7178f-9a3f-463d-96a7-0a82cbed9ba2"
		date = "2022-05-23"
		modified = "2022-07-18"
		reference = "046645b2a646c83b4434a893a0876ea9bd51ae05e70d4e72f2ccc648b0f18cb6"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_AttackSimulation_Hovercraft.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "e707e89904a5fa4d30f94bfc625b736a411df6bb055c0e40df18ae65025a3740"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "8965ab173fd09582c9e77e7c54c9722b91b71ecbe42c4f8a8cc87d9a780ffe8c"
		severity = 1
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "MyHovercraftIsFullOfEels" wide fullword
		$a2 = "WinHttp.dll" fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Virus_Floxif_493D1897 : FILE MEMORY {
    meta:
		description = "Detects Windows Virus Floxif (Windows.Virus.Floxif)"
		author = "Elastic Security"
		id = "493d1897-864e-4f18-8511-0c6c9d990990"
		date = "2023-09-26"
		modified = "2023-11-02"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Virus_Floxif.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "e628b7973ee25fdfd8f849fdf5923c6fba48141de802b0b4ce3e9ad2e40fe470"
		logic_hash = "d3f516966bd4423c49771251075a1ea2f725aec91615f7f44dd098da2a4f3574"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "6a043d05ca24846cfba28b5ea603a3e512a5af4f4e15629851a922190245ca1e"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 8B 54 24 04 80 7A 03 01 75 04 8D 42 04 C3 8D 42 04 53 8B C8 8A 5A 02 84 DB 74 02 30 19 8A 19 }

	condition:
		all of them
}
rule ELASTIC_Windows_Vulndriver_Truesight_7429Ac81 : FILE MEMORY {
    meta:
		description = "Detects Windows Vulndriver Truesight (Windows.VulnDriver.TrueSight)"
		author = "Elastic Security"
		id = "7429ac81-04d5-4946-9fff-abe7be98fc4d"
		date = "2024-06-21"
		modified = "2024-09-09"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_VulnDriver_TrueSight.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "bfc2ef3b404294fe2fa05a8b71c7f786b58519175b7202a69fe30f45e607ff1c"
		logic_hash = "8490947a632ca32822231631e19e52380b8b1a26c74c697d36898b0facbfcc9c"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "775137e1f402f347504377eb86aa95a522e50237fa3b09db4f11def2af24b609"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$original_file_name = { 4F 00 72 00 69 00 67 00 69 00 6E 00 61 00 6C 00 46 00 69 00 6C 00 65 00 6E 00 61 00 6D 00 65 00 00 00 54 00 72 00 75 00 65 00 73 00 69 00 67 00 68 00 74 00 00 00 }
		$version = /V\x00S\x00_\x00V\x00E\x00R\x00S\x00I\x00O\x00N\x00_\x00I\x00N\x00F\x00O\x00\x00\x00{0,4}\xbd\x04\xef\xfe[\x00-\xff]{4}(([\x00-\x03][\x00-\x00])([\x00-\x03][\x00-\x00])([\x00-\x00][\x00-\x00])([\x00-\x00][\x00-\x00])|([\x00-\xff][\x00-\xff])([\x00-\x02][\x00-\x00])([\x00-\xff][\x00-\xff])([\x00-\xff][\x00-\xff])|([\x00-\x02][\x00-\x00])([\x00-\x03][\x00-\x00])([\x00-\xff][\x00-\xff])([\x00-\xff][\x00-\xff]))/

	condition:
		int16 ( uint32(0x3C)+0x5c)==0x0001 and int16 ( uint32(0x3C)+0x18)==0x020b and $original_file_name and $version
}
rule ELASTIC_Windows_Hacktool_Edrrecon_69453Aff : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Edrrecon (Windows.Hacktool.EDRrecon)"
		author = "Elastic Security"
		id = "69453aff-1427-4aae-b1f3-7cce9c93342c"
		date = "2024-03-07"
		modified = "2024-06-10"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_EDRrecon.yar#L1-L59"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f62e51b2405c0d42c53ff1f560376ef0530ba2eea1c97e18f2a3cf148346bcd1"
		logic_hash = "3d0f6dc5d47a3c0957a7aa8d2918fee113d079d7d74f37a1c17c5429034ba41f"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "f10758ed032a0f7da0d983839beb12f79fba764aa4ffa0f3716dbfc2e8a3ea82"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$s01 = "WdFilter.sys" ascii wide fullword
		$s02 = "mpFilter.sys" ascii wide fullword
		$s03 = "SRTSP.sys" ascii wide fullword
		$s04 = "eeCtrl.sys" ascii wide fullword
		$s05 = "360AvFlt.sys" ascii wide fullword
		$s06 = "360fsflt.sys" ascii wide fullword
		$s07 = "esensor.sys" ascii wide fullword
		$s09 = "klflt.sys" ascii wide fullword
		$s10 = "klam.sys" ascii wide fullword
		$s11 = "SysmonDrv.sys" ascii wide fullword
		$s12 = "CarbonBlackK.sys" ascii wide fullword
		$s13 = "edrsensor.sys" ascii wide fullword
		$s14 = "naswSP.sys" ascii wide fullword
		$s15 = "symevnt.sys" ascii wide fullword
		$s16 = "symevnt32.sys" ascii wide fullword
		$s17 = "CyProtectDrv" ascii wide fullword
		$s18 = "mfeaskm.sys" ascii wide fullword
		$s19 = "SentinelMonitor.sys" ascii wide fullword
		$s20 = "sentinelelam.sys" ascii wide fullword
		$s21 = "SophosSupport.sys" ascii wide fullword
		$s22 = "CSDeviceControl.sys" ascii wide fullword
		$s23 = "csagent.sys" ascii wide fullword
		$s24 = "avgntflt.sys" ascii wide fullword
		$s25 = "bddevflt.sys" ascii wide fullword
		$s26 = "CiscoAMPHeurDriver.sys" ascii wide fullword
		$s27 = "DeepInsFS.sys" ascii wide fullword
		$s28 = "eamonm.sys" ascii wide fullword
		$s29 = "fortirmon.sys" ascii wide fullword
		$s30 = "FlightRecorder.sys" ascii wide fullword
		$s31 = "TmKmSnsr.sys" ascii wide fullword
		$s32 = "cpepmon.sys" ascii wide fullword
		$s33 = "cposfw.sys" ascii wide fullword
		$s34 = "cyvrmtgn.sys" ascii wide fullword
		$s35 = "elastic-endpoint-driver.sys" ascii wide fullword
		$s36 = "elasticelam.sys" ascii wide fullword
		$37 = "mbamwatchdog.sys" ascii wide fullword
		$38 = "FortiEDRWinDriver" ascii wide fullword
		$39 = "QaxNfDrv.sys" ascii wide fullword
		$40 = "qmnetmonw64.sys" ascii wide fullword
		$s41 = "TFsFlt.sys" ascii wide fullword
		$s42 = "DsArk64.sys" ascii wide fullword

	condition:
		14 of them
}
rule ELASTIC_Windows_Hacktool_Edrrecon_Ca314Aa1 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Edrrecon (Windows.Hacktool.EDRrecon)"
		author = "Elastic Security"
		id = "ca314aa1-3bbe-489c-a77a-fb7a0eca1f67"
		date = "2024-03-07"
		modified = "2024-06-10"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_EDRrecon.yar#L61-L115"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f62e51b2405c0d42c53ff1f560376ef0530ba2eea1c97e18f2a3cf148346bcd1"
		logic_hash = "04b8681b0b6f8fa51eb90488edf35638da3334886c7db5fc22218712b0d23007"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "58c6c2cbb92262098af27f8434863d1ea91c31f02727c5dde72d6ac07b3b872d"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$s01 = "SentinelAgent.exe" ascii wide fullword
		$s02 = "SentinelUI.exe" ascii wide fullword
		$s03 = "MsMpEng.exe" ascii wide fullword
		$s04 = "SenseIR.exe" ascii wide fullword
		$s05 = "elastic-endpoint.exe" ascii wide fullword
		$s06 = "elastic-agent.exe" ascii wide fullword
		$s07 = "CylanceSvc.exe" ascii wide fullword
		$s09 = "CybereasonAV.exe" ascii wide fullword
		$s10 = "Traps.exe" ascii wide fullword
		$s11 = "CyvrFsFlt.exe" ascii wide fullword
		$s12 = "EIConnector.exe" ascii wide fullword
		$s13 = "ekrn.exe" ascii wide fullword
		$s14 = "fortiedr.exe" ascii wide fullword
		$s15 = "RepMgr.exe" ascii wide fullword
		$s16 = "TaniumDetectEngine.exe" ascii wide fullword
		$s17 = "CSFalconService.exe" ascii wide fullword
		$s18 = "CSFalconContainer.exe" ascii wide fullword
		$s19 = "EndpointBasecamp.exe" ascii wide fullword
		$s20 = "hmpalert.exe" ascii wide fullword
		$s21 = "xagt.exe" ascii wide fullword
		$s22 = "TMBMSRV.exe" ascii wide fullword
		$s23 = "EIConnector.exe" ascii wide fullword
		$s25 = "mcsclient.exe" ascii wide fullword
		$s26 = "sophososquery.exe" ascii wide fullword
		$s27 = "TaniumClient.exe" ascii wide fullword
		$s28 = "asdsvc.exe" ascii wide fullword
		$s29 = "avp.exe" ascii wide fullword
		$s30 = "avpui.exe" ascii wide fullword
		$s31 = "mbae-svc.exe" ascii wide fullword
		$s32 = "mbae.exe" ascii wide fullword
		$s33 = "ccSvcHst.exe" ascii wide fullword
		$s35 = "bdagent.exe" ascii wide fullword
		$s36 = "ir_agent.exe" ascii wide fullword
		$s37 = "eguiproxy.exe" ascii wide fullword
		$s38 = "ekrn.exe" ascii wide fullword
		$s39 = "Sysmon64.exe" ascii wide fullword
		$s40 = "Sysmon.exe" ascii wide fullword

	condition:
		14 of them
}
rule ELASTIC_Windows_Trojan_Cryptbot_489A6562 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Cryptbot (Windows.Trojan.Cryptbot)"
		author = "Elastic Security"
		id = "489a6562-870c-4105-9bb7-52ab09e5b09c"
		date = "2021-08-18"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Cryptbot.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "423563995910af04cb2c4136bf50607fc26977dfa043a84433e8bd64b3315110"
		logic_hash = "7fee3cc67419e66de790ba2ad8c3102425b3a45bdfe31801758dd38021a8439b"
		score = 75
		quality = 25
		tags = "FILE, MEMORY"
		fingerprint = "f4578d79f8923706784e9d55a70ec74051273a945d2b277daa6229724defec3f"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "/c rd /s /q %Temp%\\" wide fullword
		$a2 = "\\_Files\\_AllPasswords_list.txt" wide fullword
		$a3 = "\\files_\\cryptocurrency\\log.txt" wide fullword
		$a4 = "%wS\\%wS\\%wS.tmp" wide fullword
		$a5 = "%AppData%\\waves-exchange" wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Pizzapotion_D334C613 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Pizzapotion (Windows.Trojan.PizzaPotion)"
		author = "Elastic Security"
		id = "d334c613-2ef2-4627-b482-cc87589d253a"
		date = "2023-09-13"
		modified = "2023-09-20"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_PizzaPotion.yar#L1-L24"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "37bee101cf34a84cba49adb67a555c6ebd3b8ac7c25d50247b0a014c82630003"
		logic_hash = "de7d395c8a993abf9858858e56ba0ec4acbf0fa1c8bfe4a34ae95be2205967fc"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "4c1ed20b669750f2bc837b184226608e2e8473ac60881fbdd47709e147616889"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "%s%sd.sys" ascii fullword
		$a2 = "curl -v -k -F \"file=@" ascii fullword
		$a3 = "; type=image/jpeg\" --referer drive.google.com --cookie"
		$a4 = "%sd.sys -r -inul"
		$a5 = ".xls d:\\*.xlsx d:\\*.ppt d:\\*.pptx d:\\*.pfx" ascii fullword
		$a6 = "-x\"*.exe\" -x\"*.dll\" -x\"*.jpg\" -x\"*.jpeg\""

	condition:
		4 of them
}
rule ELASTIC_Windows_Ransomware_Mespinoza_3Adb59F5 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Mespinoza (Windows.Ransomware.Mespinoza)"
		author = "Elastic Security"
		id = "3adb59f5-a4af-48f2-8029-874a62b23651"
		date = "2021-08-05"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Mespinoza.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6f3cd5f05ab4f404c78bab92f705c91d967b31a9b06017d910af312fa87ae3d6"
		logic_hash = "28c8ad42a3af70fed274edc9105dae5cef13749d71510561a50428c822464934"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f44a79048427e79d339d3b0ccaeb85ba6731d5548256a2615f32970dcf67578f"
		severity = 90
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Don't try to use backups because it were encrypted too." ascii fullword
		$a2 = "Every byte on any types of your devices was encrypted." ascii fullword
		$a3 = "n.pysa" wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Gh0St_Ee6De6Bc : FILE MEMORY {
    meta:
		description = "Identifies a variant of Gh0st Rat"
		author = "Elastic Security"
		id = "ee6de6bc-1648-4a77-9607-e2a211c7bda4"
		date = "2021-06-10"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Gh0st.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ea1dc816dfc87c2340a8b8a77a4f97618bccf19ad3b006dce4994be02e13245d"
		logic_hash = "3619df974c9f4ec76899afbafdfd6839070714862c7361be476cf8f83e766e2f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "3c529043f34ad8a8692b051ad7c03206ce1aafc3a0eb8fcf7f5bcfdcb8c1b455"
		threat_name = "Windows.Trojan.Gh0st"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = ":]%d-%d-%d  %d:%d:%d" ascii fullword
		$a2 = "[Pause Break]" ascii fullword
		$a3 = "f-secure.exe" ascii fullword
		$a4 = "Accept-Language: zh-cn" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Agenda_D7B1Af3F : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Agenda (Windows.Ransomware.Agenda)"
		author = "Elastic Security"
		id = "d7b1af3f-fde2-437d-93e8-59364bb72c5b"
		date = "2024-09-10"
		modified = "2024-09-30"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Agenda.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "117fc30c25b1f28cd923b530ab9f91a0a818925b0b89b8bc9a7f820a9e630464"
		logic_hash = "a68330bf98ae200ff2d0da51836436f2bdff5c10eb4e0145502f688055980493"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a7d45fc26aa3742daa27a8e20a703f7fda5230391f6c1ed25a4daf05f516d169"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$ = "-RECOVER-README.txt"
		$ = "/c vssadmin.exe delete shadows /all /quiet"
		$ = "directory_black_list"
		$ = "C:\\Users\\Public\\enc.exe"

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Whispergate_C80F3B4B : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Whispergate (Windows.Ransomware.WhisperGate)"
		author = "Elastic Security"
		id = "c80f3b4b-f91b-4b8d-908e-f64c2c5d4b30"
		date = "2022-01-17"
		modified = "2022-01-17"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_WhisperGate.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a196c6b8ffcb97ffb276d04f354696e2391311db3841ae16c8c9f56f36a38e92"
		logic_hash = "04452141a867d4f6fce618c21795cc142a1265b56c62ecb9e579003d36b4b2b9"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e8ad6a7cfabf96387deee56f38b0f0ba6d8fe85e7be9f153ccf72d69ee5db1c9"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$buffer = { E8 ?? ?? ?? ?? BE 20 40 40 00 29 C4 8D BD E8 DF FF FF E8 ?? ?? ?? ?? B9 00 08 00 00 F3 A5 }
		$note = { 59 6F 75 72 20 68 61 72 64 20 64 72 69 76 65 20 68 61 73 20 62 65 65 6E 20 63 6F 72 72 75 70 74 65 64 2E 0D 0A }

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Whispergate_3476008E : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Whispergate (Windows.Ransomware.WhisperGate)"
		author = "Elastic Security"
		id = "3476008e-1c98-4606-b60b-7fef0e360711"
		date = "2022-01-18"
		modified = "2022-01-18"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_WhisperGate.yar#L22-L43"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9ef7dbd3da51332a78eff19146d21c82957821e464e8133e9594a07d716d892d"
		logic_hash = "729818df1b6b82fc00eba0fe1c9139ec4746e1775146ab7fdea9e25dec1cddea"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0b8caff8cf9342bd50053712bf4c9aeab68532e340cc5e6cf400105afc150e39"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "cmd.exe /min /C ping 111.111.111.111 -n 5 -w 10 > Nul & Del /f /q \"%s\"" ascii fullword
		$a2 = "%.*s.%x" wide fullword
		$a3 = "A:\\Windows" wide fullword
		$a4 = ".ONETOC2" wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Hacktool_Dcsyncer_425579C5 : FILE MEMORY {
    meta:
		description = "MGIxY2/05+FBDTur++++0OUs"
		author = "Elastic Security"
		id = "425579c5-496f-4e08-a7e3-bf56e622aa21"
		date = "2021-09-15"
		modified = "2022-01-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_Dcsyncer.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "af7dbc84efeb186006d75d095f54a266f59e6b2348d0c20591da16ae7b7d509a"
		logic_hash = "b0330adf1d4420ddf1f302974d2e4179f52ab1c8dc2f294ddf52286d714e0463"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f6a0c028323be41f6ec90af8a7ea8587fee6985ddefdbcdd24351cb615f756a2"
		threat_name = "Windows.Hacktool.Dcsyncer"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "[x] dcsync: Error in ProcessGetNCChangesReply" wide fullword
		$a2 = "[x] getDCBind: RPC Exception 0x%08x (%u)" wide fullword
		$a3 = "[x] getDomainAndUserInfos: DomainControllerInfo: 0x%08x (%u)" wide fullword
		$a4 = "[x] ProcessGetNCChangesReply_decrypt: Checksums don't match (C:0x%08x - R:0x%08x)" wide fullword

	condition:
		any of them
}
rule ELASTIC_Windows_Hacktool_Winpeas_Ng_66197D54 : FILE MEMORY {
    meta:
		description = "WinPEAS detection based on the dotNet binary, application module"
		author = "Elastic Security"
		id = "66197d54-3cd2-4006-807d-24d0e0d9e25a"
		date = "2022-12-21"
		modified = "2023-02-01"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_WinPEAS_ng.yar#L1-L27"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f3e1e5b6fd2d548dfe0af8730b15eb7ef40e128a0777855f569b2a99d6101195"
		logic_hash = "7bccf37960e2f197bb0021ecb12872f0f715b674d9774d02ec4e396f18963029"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "951f0ca036a0ab0cf2299382049eecb78f35325470f222c6db90a819b9414083"
		threat_name = "Windows.Hacktool.WinPEAS-ng"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$win_0 = "Possible DLL Hijacking, folder is writable" ascii wide
		$win_1 = "FolderPerms:.*" ascii wide
		$win_2 = "interestingFolderRights" ascii wide
		$win_3 = "(Unquoted and Space detected)" ascii wide
		$win_4 = "interestingFolderRights" ascii wide
		$win_5 = "RegPerms: .*" ascii wide
		$win_6 = "Permissions file: {3}" ascii wide
		$win_7 = "Permissions folder(DLL Hijacking):" ascii wide

	condition:
		4 of them
}
rule ELASTIC_Windows_Hacktool_Winpeas_Ng_E8Ed269C : FILE MEMORY {
    meta:
		description = "WinPEAS detection based on the dotNet binary, checks module"
		author = "Elastic Security"
		id = "e8ed269c-3191-44c0-a9c6-55172fb59c8c"
		date = "2022-12-21"
		modified = "2023-02-01"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_WinPEAS_ng.yar#L29-L57"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f3e1e5b6fd2d548dfe0af8730b15eb7ef40e128a0777855f569b2a99d6101195"
		logic_hash = "c56b6dfb2c3ae657615c825a4d5d5640c2204fa4217262e1ccb4359d5a914a63"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "7b6ede4d95b2d6d2a43e729365adb9de3fde74ed731cafdb88916ac3925f9164"
		threat_name = "Windows.Hacktool.WinPEAS-ng"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$win_0 = "systeminfo" ascii wide
		$win_1 = "Please specify a valid log file." ascii wide
		$win_2 = "argument present, redirecting output" ascii wide
		$win_3 = "max-regex-file-size" ascii wide
		$win_4 = "-lolbas" ascii wide
		$win_5 = "[!] the provided linpeas.sh url:" ascii wide
		$win_6 = "sensitive_files yaml" ascii wide
		$win_7 = "Getting Win32_UserAccount" ascii wide
		$win_8 = "(local + domain)" ascii wide
		$win_9 = "Creating AppLocker bypass" ascii wide

	condition:
		5 of them
}
rule ELASTIC_Windows_Hacktool_Winpeas_Ng_413Caa6B : FILE MEMORY {
    meta:
		description = "WinPEAS detection based on the dotNet binary, event module"
		author = "Elastic Security"
		id = "413caa6b-90b7-4763-97b3-49aeb5a97cf6"
		date = "2022-12-21"
		modified = "2023-02-01"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_WinPEAS_ng.yar#L59-L87"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f3e1e5b6fd2d548dfe0af8730b15eb7ef40e128a0777855f569b2a99d6101195"
		logic_hash = "4f2417d61be5e68630408a151cd73372aef9e7f4638acf4e80bfa5b2811119a7"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "80b32022a69be8fc1d7e146c3c03623b51e2ee4206eb5f70be753477d68800d5"
		threat_name = "Windows.Hacktool.WinPEAS-ng"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$win_0 = "Interesting Events information" ascii wide
		$win_1 = "PowerShell events" ascii wide
		$win_2 = "Created (UTC)" ascii wide
		$win_3 = "Printing Account Logon Events" ascii wide
		$win_4 = "Subject User Name" ascii wide
		$win_5 = "Target User Name" ascii wide
		$win_6 = "NTLM relay might be possible" ascii wide
		$win_7 = "You can obtain NetNTLMv2" ascii wide
		$win_8 = "The following users have authenticated" ascii wide
		$win_9 = "You must be an administrator" ascii wide

	condition:
		5 of them
}
rule ELASTIC_Windows_Hacktool_Winpeas_Ng_23Fee092 : FILE MEMORY {
    meta:
		description = "WinPEAS detection based on the dotNet binary, File analysis module"
		author = "Elastic Security"
		id = "23fee092-f1ff-4d9e-9873-0a68360efb42"
		date = "2022-12-21"
		modified = "2023-02-01"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_WinPEAS_ng.yar#L89-L115"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f3e1e5b6fd2d548dfe0af8730b15eb7ef40e128a0777855f569b2a99d6101195"
		logic_hash = "ed019c9198b5d9ff8392bfd7e0b23a7b1383eabce4c71c665a3ca4a943c8b6ee"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "4420faa4da440a9e2b1d8eadef2a1864c078fccf391ac3d7872abe1d738c926e"
		threat_name = "Windows.Hacktool.WinPEAS-ng"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$win_0 = "File Analysis" ascii wide
		$win_1 = "apache*" ascii wide
		$win_2 = "tomcat*" ascii wide
		$win_3 = "had a timeout (ReDoS avoided but regex" ascii wide
		$win_4 = "Error looking for regex" ascii wide
		$win_5 = "Looking for secrets inside" ascii wide
		$win_6 = "files with ext" ascii wide
		$win_7 = "(limited to" ascii wide

	condition:
		4 of them
}
rule ELASTIC_Windows_Hacktool_Winpeas_Ng_861D3264 : FILE MEMORY {
    meta:
		description = "WinPEAS detection based on the dotNet binary, File Info module"
		author = "Elastic Security"
		id = "861d3264-34c3-4ff0-bdd3-44cb5ecce2c8"
		date = "2022-12-21"
		modified = "2023-02-01"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_WinPEAS_ng.yar#L117-L145"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f3e1e5b6fd2d548dfe0af8730b15eb7ef40e128a0777855f569b2a99d6101195"
		logic_hash = "e6a0a0a24c70d69c0aa56063d2db0f5a0fedcda5b96d945ac14520524b1d00fd"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "03803621b6c9856443809889a14f1d2fa217812007878dd6cf9c3dc9e5f78f65"
		threat_name = "Windows.Hacktool.WinPEAS-ng"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$win_0 = "ConsoleHost_history.txt" ascii wide
		$win_1 = "Interesting files and registry" ascii wide
		$win_2 = "Cloud Credentials" ascii wide
		$win_3 = "Accessed:{2} -- Size:{3}" ascii wide
		$win_4 = "Unattend Files" ascii wide
		$win_5 = "Looking for common SAM" ascii wide
		$win_6 = "Found installed WSL distribution" ascii wide
		$win_7 = "Check skipped, if you want to run it" ascii wide
		$win_8 = "Cached GPP Passwords" ascii wide
		$win_9 = "[cC][rR][eE][dD][eE][nN][tT][iI][aA][lL]|[pP][aA][sS][sS][wW][oO]" ascii wide

	condition:
		5 of them
}
rule ELASTIC_Windows_Hacktool_Winpeas_Ng_57587F8C : FILE MEMORY {
    meta:
		description = "WinPEAS detection based on the dotNet binary, Network module"
		author = "Elastic Security"
		id = "57587f8c-8fc6-41cc-bcb3-3d1d77c74222"
		date = "2022-12-21"
		modified = "2023-02-01"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_WinPEAS_ng.yar#L147-L175"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f3e1e5b6fd2d548dfe0af8730b15eb7ef40e128a0777855f569b2a99d6101195"
		logic_hash = "175b8b6f9fca189f2fc41f1029ad512db2c8b0e52ea04bfbc3d410d355928ab9"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "9938c60113963da342dcb7de2252cffbeaa21d36f518e203f19a43da74d85f2d"
		threat_name = "Windows.Hacktool.WinPEAS-ng"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$win_0 = "Network Information" ascii wide
		$win_1 = "Network Shares" ascii wide
		$win_2 = "Permissions.*" ascii wide
		$win_3 = "Network Ifaces and known hosts" ascii wide
		$win_4 = "Enumerating IPv4 connections" ascii wide
		$win_5 = "Showing only DENY rules" ascii wide
		$win_6 = "File Permissions.*|Folder Permissions.*" ascii wide
		$win_7 = "DNS cached --limit" ascii wide
		$win_8 = "SELECT * FROM win32_networkconnection" ascii wide
		$win_9 = "Enumerating Internet settings," ascii wide

	condition:
		5 of them
}
rule ELASTIC_Windows_Hacktool_Winpeas_Ng_Cae025B1 : FILE MEMORY {
    meta:
		description = "WinPEAS detection based on the dotNet binary, Process info module"
		author = "Elastic Security"
		id = "cae025b1-bc2a-4eea-a1c1-c82d6e4fd71f"
		date = "2022-12-21"
		modified = "2023-02-01"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_WinPEAS_ng.yar#L177-L203"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f3e1e5b6fd2d548dfe0af8730b15eb7ef40e128a0777855f569b2a99d6101195"
		logic_hash = "9c34443cffed43513242321e2170484dbb0d41b251aee8ea640d44da76918122"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "3e407824b258ef66ac6883d4c5dd3efeb0f744f8f64b099313cf83e96f9e968a"
		threat_name = "Windows.Hacktool.WinPEAS-ng"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$win_0 = "Processes Information" ascii wide
		$win_1 = "Interesting Processes -non Microsoft-" ascii wide
		$win_2 = "Permissions:.*" ascii wide
		$win_3 = "Possible DLL Hijacking.*" ascii wide
		$win_4 = "ExecutablePath" ascii wide
		$win_5 = "Vulnerable Leaked Handlers" ascii wide
		$win_6 = "Possible DLL Hijacking folder:" ascii wide
		$win_7 = "Command Line:" ascii wide

	condition:
		5 of them
}
rule ELASTIC_Windows_Hacktool_Winpeas_Ng_4A9B9603 : FILE MEMORY {
    meta:
		description = "WinPEAS detection based on the dotNet binary, Services info module"
		author = "Elastic Security"
		id = "4a9b9603-7b42-4a85-b66a-7f4ec0013338"
		date = "2022-12-21"
		modified = "2023-02-01"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_WinPEAS_ng.yar#L205-L231"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f3e1e5b6fd2d548dfe0af8730b15eb7ef40e128a0777855f569b2a99d6101195"
		logic_hash = "8d78483b54d3be6988b1f5df826b8709b7aa2045ff3a3e754c359365d053bb27"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "2a7b0e1d850fa6a24f590755ae5610309741e520e4b2bc067f54a8e086444da2"
		threat_name = "Windows.Hacktool.WinPEAS-ng"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$win_0 = "Services Information" ascii wide
		$win_1 = "Interesting Services -non Microsoft-" ascii wide
		$win_2 = "FilteredPath" ascii wide
		$win_3 = "YOU CAN MODIFY THIS SERVICE:" ascii wide
		$win_4 = "Modifiable Services" ascii wide
		$win_5 = "AccessSystemSecurity" ascii wide
		$win_6 = "Looks like you cannot change the" ascii wide
		$win_7 = "Checking write permissions in" ascii wide

	condition:
		4 of them
}
rule ELASTIC_Windows_Hacktool_Winpeas_Ng_4Db2C852 : FILE MEMORY {
    meta:
		description = "WinPEAS detection based on the dotNet binary, System info module"
		author = "Elastic Security"
		id = "4db2c852-6c03-4672-9250-f80671b93e1b"
		date = "2022-12-21"
		modified = "2023-02-01"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_WinPEAS_ng.yar#L233-L261"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f3e1e5b6fd2d548dfe0af8730b15eb7ef40e128a0777855f569b2a99d6101195"
		logic_hash = "88c88103a055d25ba97f08e2f47881001ad8a2200a33ac04246494963dfe6638"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f05862b7b74cb4741aa953d725336005cdb9b1d50a92ce8bb295114e27f81b2a"
		threat_name = "Windows.Hacktool.WinPEAS-ng"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$win_0 = "No prompting|PromptForNonWindowsBinaries" ascii wide
		$win_1 = "System Information" ascii wide
		$win_2 = "Showing All Microsoft Updates" ascii wide
		$win_3 = "GetTotalHistoryCount" ascii wide
		$win_4 = "PS history size:" ascii wide
		$win_5 = "powershell_transcript*" ascii wide
		$win_6 = "Check what is being logged" ascii wide
		$win_7 = "WEF Settings" ascii wide
		$win_8 = "CredentialGuard is active" ascii wide
		$win_9 = "cachedlogonscount is" ascii wide

	condition:
		5 of them
}
rule ELASTIC_Windows_Hacktool_Winpeas_Ng_Bcedc8B2 : FILE MEMORY {
    meta:
		description = "WinPEAS detection based on the dotNet binary, User info module"
		author = "Elastic Security"
		id = "bcedc8b2-d9e1-45cd-94b4-a19a3ed8c0f9"
		date = "2022-12-21"
		modified = "2023-02-01"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_WinPEAS_ng.yar#L263-L291"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f3e1e5b6fd2d548dfe0af8730b15eb7ef40e128a0777855f569b2a99d6101195"
		logic_hash = "7f0a6a9168b5ff7cc02ccadd211cc8096307651be65c2b3e7cc9fdbbde08ab9f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "039ea2f11596d6a8d5da05944796424ee6be66e16742676bbb2dc3fcf274cf4a"
		threat_name = "Windows.Hacktool.WinPEAS-ng"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$win_0 = "Users Information" ascii wide
		$win_1 = "docker|Remote |DNSAdmins|AD Recycle Bin|" ascii wide
		$win_2 = "NotChange|NotExpi" ascii wide
		$win_3 = "Current Token privileges" ascii wide
		$win_4 = "Clipboard text" ascii wide
		$win_5 = "{0,-10}{1,-15}{2,-15}{3,-25}{4,-10}{5}" ascii wide
		$win_6 = "Ever logged users" ascii wide
		$win_7 = "Some AutoLogon credentials were found" ascii wide
		$win_8 = "Current User Idle Time" ascii wide
		$win_9 = "DsRegCmd.exe /status" ascii wide

	condition:
		5 of them
}
rule ELASTIC_Windows_Hacktool_Winpeas_Ng_B6Bb3E7C : FILE MEMORY {
    meta:
		description = "WinPEAS detection based on the dotNet binary, Windows credentials module"
		author = "Elastic Security"
		id = "b6bb3e7c-29f6-4bc6-8082-558a56512fc3"
		date = "2022-12-21"
		modified = "2023-02-01"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_WinPEAS_ng.yar#L293-L321"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f3e1e5b6fd2d548dfe0af8730b15eb7ef40e128a0777855f569b2a99d6101195"
		logic_hash = "e2eaf91b9c5d3616fb2f6f6bc4b44841b1efa3b4efe7ac72afe225728523af75"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ecc2217349244cd78fa5be040653c02096ee8b6a2f2691309fd7f9f62612fa79"
		threat_name = "Windows.Hacktool.WinPEAS-ng"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$win_0 = "Windows Credentials" ascii wide
		$win_1 = "Checking Windows Vault" ascii wide
		$win_2 = "Identity.*|Credential.*|Resource.*" ascii wide
		$win_3 = "Checking Credential manager" ascii wide
		$win_4 = "Saved RDP connections" ascii wide
		$win_5 = "Recently run commands" ascii wide
		$win_6 = "Checking for DPAPI" ascii wide
		$win_7 = "Checking for RDCMan" ascii wide
		$win_8 = "Looking for saved Wifi credentials" ascii wide
		$win_9 = "Looking AppCmd.exe" ascii wide

	condition:
		5 of them
}
rule ELASTIC_Windows_Hacktool_Winpeas_Ng_94474B0B : FILE MEMORY {
    meta:
		description = "WinPEAS detection based on the bat script"
		author = "Elastic Security"
		id = "94474b0b-c3dc-4585-afb3-3afe4c3ec525"
		date = "2022-12-21"
		modified = "2023-02-01"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_WinPEAS_ng.yar#L323-L351"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "f3e1e5b6fd2d548dfe0af8730b15eb7ef40e128a0777855f569b2a99d6101195"
		logic_hash = "e209c9ce1f4b11c5fdeade3298329d62f5cf561403c87077d94b6921e81ffaea"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "06e184fb837274271711288994a3e6bfcc2a50472ca05c8af9f1e4d8efd9091d"
		threat_name = "Windows.Hacktool.WinPEAS-ng"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$win_0 = "Windows local Privilege Escalation Awesome Script" ascii wide
		$win_1 = "BASIC SYSTEM INFO" ascii wide
		$win_2 = "LAPS installed?" ascii wide
		$win_3 = "Check for services restricted from the outside" ascii wide
		$win_4 = "CURRENT USER" ascii wide
		$win_5 = "hacktricks.xyz" ascii wide
		$win_6 = "SERVICE VULNERABILITIES" ascii wide
		$win_7 = "DPAPI MASTER KEYS" ascii wide
		$win_8 = "Files in registry that may contain credentials" ascii wide
		$win_9 = "SAM and SYSTEM backups" ascii wide

	condition:
		6 of them
}
rule ELASTIC_Windows_Trojan_Guloader_8F10Fa66 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Guloader (Windows.Trojan.Guloader)"
		author = "Elastic Security"
		id = "8f10fa66-a24b-4cc2-b9e0-11be14aba9af"
		date = "2021-08-17"
		modified = "2021-10-04"
		reference = "https://www.elastic.co/security-labs/getting-gooey-with-guloader-downloader"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Guloader.yar#L1-L24"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a3e2d5013b80cd2346e37460753eca4a4fec3a7941586cc26e049a463277562e"
		logic_hash = "f2cd08f6a32c075dc0294a0e26c51e686babc54ced4faa1873368c8821f0bfef"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "5841d70a38d4620c446427c80ca12b5e918f23e90c5288854943b0240958bcfb"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "msvbvm60.dll" wide fullword
		$a2 = "C:\\Program Files\\qga\\qga.exe" ascii fullword
		$a3 = "C:\\Program Files\\Qemu-ga\\qemu-ga.exe" ascii fullword
		$a4 = "USERPROFILE=" wide fullword
		$a5 = "Startup key" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Guloader_C4D9Dd33 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Guloader (Windows.Trojan.Guloader)"
		author = "Elastic Security"
		id = "c4d9dd33-b7e7-4ff4-a2f3-62316d064f5a"
		date = "2021-08-17"
		modified = "2021-10-04"
		reference = "https://www.elastic.co/security-labs/getting-gooey-with-guloader-downloader"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Guloader.yar#L26-L45"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a3e2d5013b80cd2346e37460753eca4a4fec3a7941586cc26e049a463277562e"
		logic_hash = "623ea751fc32648720bda40598024d4d5b6a9a11b3cce3c9427310ba17745643"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "53a2d6f895cdd1a6384a55756711d9d758b3b20dd0b87d62a89111fd1a20d1d6"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "This program cannot be run under virtual environment or debugging software !" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Guloader_2F1E44C8 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Guloader (Windows.Trojan.Guloader)"
		author = "Elastic Security"
		id = "2f1e44c8-f269-4cd6-a516-8d9282ddcfbc"
		date = "2023-10-30"
		modified = "2023-11-02"
		reference = "https://www.elastic.co/security-labs/getting-gooey-with-guloader-downloader"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Guloader.yar#L47-L70"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6ae7089aa6beaa09b1c3aa3ecf28a884d8ca84f780aab39902223721493b1f99"
		logic_hash = "434b33c3fdc6bf4b0f59cd4aba66327d0b7ab524be603b256494d46b609cecd5"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b00255f8d7ce460ffc778e96f6101db753e8992d36ee75a25b48e32ac7817c58"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$djb2_str_compare = { 83 C0 08 83 3C 04 00 0F 84 [4] 39 14 04 75 }
		$check_exception = { 8B 45 ?? 8B 00 38 EC 8B 58 ?? 84 FD 81 38 05 00 00 C0 }
		$parse_mem = { 18 00 10 00 00 83 C0 18 50 83 E8 04 81 00 00 10 00 00 50 }
		$hw_bp = { 39 48 0C 0F 85 [4] 39 48 10 0F 85 [4] 39 48 14 0F 85 [7] 39 48 18 }
		$scan_protection = { 39 ?? 14 8B [5] 0F 84 }

	condition:
		2 of them
}
rule ELASTIC_Windows_Trojan_Glupteba_70557305 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Glupteba (Windows.Trojan.Glupteba)"
		author = "Elastic Security"
		id = "70557305-3d11-4dde-b53b-94f1ecc0380b"
		date = "2021-08-08"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Glupteba.yar#L1-L24"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "3ad13fd7968f9574d2c822e579291c77a0c525991cfb785cbe6cdd500b737218"
		logic_hash = "f3eee9808a1e8a2080116dda7ce795815e1179143c756ea8fdd26070f1f8f74a"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "bac7daa5c491de8f8a75b203cdb1cdab2c10633aa45a82e6b04d2f577e3e8415"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "%TEMP%\\app.exe && %TEMP%\\app.exe"
		$a2 = "is unavailable%d smbtest"
		$a3 = "discovered new server %s"
		$a4 = "uldn't get usernamecouldn't hide servicecouldn't"
		$a5 = "TERMINATE PROCESS: %ws, %d, %d" ascii fullword
		$a6 = "[+] Extracting vulnerable driver as \"%ws\"" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Glupteba_4669Dcd6 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Glupteba (Windows.Trojan.Glupteba)"
		author = "Elastic Security"
		id = "4669dcd6-8e04-416d-91c0-f45816430869"
		date = "2021-08-08"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Glupteba.yar#L26-L44"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1b55042e06f218546db5ddc52d140be4303153d592dcfc1ce90e6077c05e77f7"
		logic_hash = "64b2099f40f94b17bc5860b41773c41322420500696d320399ff1c016cb56e15"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "5b598640f42a99b00d481031f5fcf143ffcc32ef002eac095a14edb18d5b02c9"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 40 C3 8B 44 24 48 8B 4C 24 44 89 81 AC 00 00 00 8B 44 24 4C 89 81 B0 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Hive_55619Cd0 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Hive (Windows.Ransomware.Hive)"
		author = "Elastic Security"
		id = "55619cd0-6013-45e2-b15e-0dceff9571ab"
		date = "2021-08-26"
		modified = "2022-01-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Hive.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "50ad0e6e9dc72d10579c20bb436f09eeaa7bfdbcb5747a2590af667823e85609"
		logic_hash = "51e2b03a9f9b92819bbf05ecbb33a23662a40e7d51f9812aa8243c4506057f1f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "04df3169c50fbab4e2b495de5500c62ddf5e76aa8b4a7fc8435f39526f69c52b"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "google.com/encryptor.(*App).KillProcesses" ascii fullword
		$a2 = "- Do not shutdown or reboot your computers, unmount external storages." ascii fullword
		$a3 = "hive"

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Hive_3Ed67Fe6 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Hive (Windows.Ransomware.Hive)"
		author = "Elastic Security"
		id = "3ed67fe6-6347-4aef-898d-4cb267bcbfc7"
		date = "2021-08-26"
		modified = "2022-01-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Hive.yar#L23-L45"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "50ad0e6e9dc72d10579c20bb436f09eeaa7bfdbcb5747a2590af667823e85609"
		logic_hash = "a599f0d528bdbec00afa7e9a5cddec5e799ee755a7f30af70dde7d2459b70155"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a15acde0841f08fc44fdc1fea01c140e9e8af6275a65bec4a7b762494c9e6185"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "bmr|sql|oracle|postgres|redis|vss|backup|sstp"
		$a2 = "key.hive"
		$a3 = "Killing processes"
		$a4 = "Stopping services"
		$a5 = "Removing itself"

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Hive_B97Ec33B : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Hive (Windows.Ransomware.Hive)"
		author = "Elastic Security"
		id = "b97ec33b-d4cf-4b70-8ce8-8a5d20448643"
		date = "2021-08-26"
		modified = "2022-01-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Hive.yar#L47-L65"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "50ad0e6e9dc72d10579c20bb436f09eeaa7bfdbcb5747a2590af667823e85609"
		logic_hash = "10034d9f53fd5099a423269e0c42c01eac18318f5d11599e1390912c8fd7af25"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "7f2c2d299942390d953599b180ed191d9db999275545a7ba29059fd49b858087"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 74 C3 8B 44 24 78 8B 08 8B 50 04 8B 40 08 89 0C 24 89 54 24 04 89 44 }

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Maze_61254061 : BETA FILE MEMORY {
    meta:
		description = "Identifies MAZE ransomware"
		author = "Elastic Security"
		id = "61254061-e8af-47ab-9cce-96debd99a80a"
		date = "2020-04-18"
		modified = "2021-08-23"
		reference = "https://www.bleepingcomputer.com/news/security/it-services-giant-cognizant-suffers-maze-ransomware-cyber-attack/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Maze.yar#L1-L21"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "b8537add953cdd7bc6adbff97f7f5a94de028709f0bd71102ee96d26d55f4f20"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "670d9abbdea153ca66f24ef6806f97e9af3efb73f621167e95606da285627d1b"
		threat_name = "Windows.Ransomware.Maze"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$c1 = { FC 8B 55 08 8B 44 8A 10 C1 E0 09 8B 4D FC 8B 55 08 8B 4C 8A 10 C1 }
		$c2 = { 72 F0 0C 66 0F 72 D4 14 66 0F EB C4 66 0F 70 E0 39 66 0F FE E6 66 0F 70 }

	condition:
		1 of ($c*)
}
rule ELASTIC_Windows_Ransomware_Maze_46F40C40 : BETA FILE MEMORY {
    meta:
		description = "Identifies MAZE ransomware"
		author = "Elastic Security"
		id = "46f40c40-05a4-4163-a62d-675882149781"
		date = "2020-04-18"
		modified = "2021-10-04"
		reference = "https://www.bleepingcomputer.com/news/security/it-services-giant-cognizant-suffers-maze-ransomware-cyber-attack/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Maze.yar#L23-L44"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "99180f41aaaf1dfb0a8a40709dcc392fdbc2b2d3a4d4b4a1ab160dd5f2b4c703"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "efe1e0d23fbfd72fd2843a9c8d5e62394ef8c75b9a7bd03fdbb36e2cf97bf12e"
		threat_name = "Windows.Ransomware.Maze"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$b1 = "Dear %s, your files have been encrypted by RSA-2048 and ChaCha algorithms" wide fullword
		$b2 = "Maze Ransomware" wide fullword
		$b3 = "%s! Alert! %s! Alert! Dear %s Your files have been encrypted by %s! Attention! %s" wide fullword

	condition:
		2 of ($b*)
}
rule ELASTIC_Windows_Ransomware_Maze_20Caee5B : BETA FILE MEMORY {
    meta:
		description = "Identifies MAZE ransomware"
		author = "Elastic Security"
		id = "20caee5b-cf7f-4db7-8c3b-67baf63bfc32"
		date = "2020-04-18"
		modified = "2021-08-23"
		reference = "https://www.bleepingcomputer.com/news/security/it-services-giant-cognizant-suffers-maze-ransomware-cyber-attack/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Maze.yar#L46-L71"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "e09c059b285d2176aeba1a1f70d39f13cef4e05dc023c7db25fb9d92bd9a67d9"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "47525839e0800f6edec6ad4580682a336e36f7d13bd9e7214eca0f16941016b8"
		threat_name = "Windows.Ransomware.Maze"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Win32_ShadowCopy.id='%s'" wide fullword
		$a2 = "\"%s\" shadowcopy delete" wide fullword
		$a3 = "%spagefile.sys" wide fullword
		$a4 = "%sswapfile.sys" wide fullword
		$a5 = "Global\\%s" wide fullword
		$a6 = "DECRYPT-FILES.txt" wide fullword
		$a7 = "process call create \"cmd /c start %s\"" wide fullword

	condition:
		4 of ($a*)
}
rule ELASTIC_Windows_Ransomware_Maze_F88F136F : BETA FILE MEMORY {
    meta:
		description = "Identifies MAZE ransomware"
		author = "Elastic Security"
		id = "f88f136f-755c-46d6-9dbe-243342ae315a"
		date = "2020-04-18"
		modified = "2021-08-23"
		reference = "https://www.bleepingcomputer.com/news/security/it-services-giant-cognizant-suffers-maze-ransomware-cyber-attack/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Maze.yar#L73-L94"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "5587f332a076650f6ad7b1e3b464ef6085d960e6dacf53607cf75c9f9ad07628"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "3fa065d28d864868e49b394e895207c8be2252a9e211ac4bacce10d9ff04607e"
		threat_name = "Windows.Ransomware.Maze"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$d1 = { 00 67 00 20 00 69 00 6E 00 73 00 74 00 72 00 75 00 63 00 74 00 69 00 6F 00 6E 00 73 00 20 00 69 00 6E 00 20 00 44 00 45 00 43 00 52 00 59 00 50 00 54 00 2D 00 46 00 49 00 4C 00 45 00 53 00 2E }
		$d2 = { 70 C7 8B 75 6D 97 7E FC 19 2A 39 8C A4 AE AD 9C 62 05 B7 68 47 7D 02 F7 D3 0A DA 20 82 AE A8 E7 B2 26 E1 A0 5B 4E 17 09 A6 94 74 CA B6 0B 88 B0 5F 6E 11 E3 B0 EA 2F 40 D7 A2 AB 59 52 E0 F2 C2 19 24 14 95 01 7F CA }
		$d3 = { 77 B3 50 3C B1 9B 5D D4 87 F5 17 DB E1 C7 42 D8 53 24 C2 E2 6A A8 9B 1E FB E5 48 EB 10 48 44 28 64 F8 B6 A1 41 44 D0 42 FA 85 6F 17 57 09 C4 66 93 D2 21 C5 19 71 3A A1 C5 68 2E 67 B1 02 DC D1 }

	condition:
		1 of ($d*)
}
rule ELASTIC_Windows_Hacktool_Safetykatz_072B7370 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Safetykatz (Windows.Hacktool.SafetyKatz)"
		author = "Elastic Security"
		id = "072b7370-517b-45dc-af23-ba3adbd32fbd"
		date = "2022-11-20"
		modified = "2023-01-11"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_SafetyKatz.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "89a456943cf6d2b3cd9cdc44f13a23640575435ed49fa754f7ed358c1a3b6ba9"
		logic_hash = "cedd3ede487371a8e0d29804f2b81ae808c7ad01bd803fa39dc2c50e472cff43"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "f0d11341fc91d2c45c07c6079aad24a11da03320286216be0a68461b6bf55b02"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$guid = "8347E81B-89FC-42A9-B22C-F59A6A572DEC" ascii wide nocase
		$print_str0 = "[X] Not in high integrity, unable to grab a handle to lsass!" ascii wide fullword
		$print_str1 = "[X] Dump directory \"{0}\" doesn't exist!" ascii wide fullword
		$print_str2 = "[X] Process is not 64-bit, this version of Mimikatz won't work yo'!" ascii wide fullword
		$print_str3 = "[+] Dump successful!" ascii wide fullword

	condition:
		$guid or all of ($print_str*)
}
rule ELASTIC_Windows_Trojan_Jupyter_56152E31 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Jupyter (Windows.Trojan.Jupyter)"
		author = "Elastic Security"
		id = "56152e31-77c6-49fa-bbc5-c3630f11e633"
		date = "2021-07-22"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Jupyter.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ce486097ad2491aba8b1c120f6d0aa23eaf59cf698b57d2113faab696d03c601"
		logic_hash = "7b32e9caca744f4f6b48aefa5fda111e6b7ac81a62dd1fb8873d2c800ac3c42b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "9cccc2e3d4cfe9ff090d02b143fa837f4da0c229426435b4e097f902e8c5fb01"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "%appdata%\\solarmarker.dat" ascii fullword
		$a2 = "\\AppData\\Roaming\\solarmarker.dat" wide fullword
		$b1 = "steal_passwords" ascii fullword
		$b2 = "jupyter" ascii fullword

	condition:
		1 of ($a*) or 2 of ($b*)
}
rule ELASTIC_Windows_Trojan_Farfli_85D1Bcc9 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Farfli (Windows.Trojan.Farfli)"
		author = "Elastic Security"
		id = "85d1bcc9-c3c7-454c-a77f-0e0de933c4c3"
		date = "2022-02-17"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Farfli.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "e3e9ea1b547cc235e6f1a78b4ca620c69a54209f84c7de9af17eb5b02e9b58c3"
		logic_hash = "746eb5a2583077189d82d1a96b499ff383f31220845bd8a6df5b7a7ceb11e6fb"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "56a5e4955556d08b80849ea5775f35f5a32999d6b5df92357ab142a4faa74ac3"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { AB 66 AB C6 45 D4 25 C6 45 D5 73 C6 45 D6 5C C6 45 D7 25 C6 45 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Formbook_1112E116 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Formbook (Windows.Trojan.Formbook)"
		author = "Elastic Security"
		id = "1112e116-dee0-4818-a41f-ca5c1c41b4b8"
		date = "2021-06-14"
		modified = "2021-08-23"
		reference = "https://www.elastic.co/security-labs/formbook-adopts-cab-less-approach"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Formbook.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6246f3b89f0e4913abd88ae535ae3597865270f58201dc7f8ec0c87f15ff370a"
		logic_hash = "ec307a8681fa01fc0c7c0579b0e3eff10e7f373159ad58dae0a358ff16fbc10b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b8b88451ad8c66b54e21455d835a5d435e52173c86e9b813ffab09451aff7134"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 3C 30 50 4F 53 54 74 09 40 }
		$a2 = { 74 0A 4E 0F B6 08 8D 44 08 01 75 F6 8D 70 01 0F B6 00 8D 55 }
		$a3 = { 1A D2 80 E2 AF 80 C2 7E EB 2A 80 FA 2F 75 11 8A D0 80 E2 01 }
		$a4 = { 04 83 C4 0C 83 06 07 5B 5F 5E 8B E5 5D C3 8B 17 03 55 0C 6A 01 83 }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Formbook_772Cc62D : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Formbook (Windows.Trojan.Formbook)"
		author = "Elastic Security"
		id = "772cc62d-345c-42d8-97ab-f67e447ddca4"
		date = "2022-05-23"
		modified = "2022-07-18"
		reference = "https://www.elastic.co/security-labs/formbook-adopts-cab-less-approach"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Formbook.yar#L25-L46"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "db9ab8df029856fc1c210499ed8e1b92c9722f7aa2264363670c47b51ec8fa83"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "3d732c989df085aefa1a93b38a3c078f9f0c3ee214292f6c1e31a9fc1c9ae50e"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; Trident/7.0; rv:11.0) like Gecko"
		$a2 = "signin"
		$a3 = "persistent"
		$r1 = /.\:\\Users\\[^\\]{1,50}\\AppData\\Roaming\\[a-zA-Z0-9]{8}\\[a-zA-Z0-9]{3}log\.ini/ wide

	condition:
		2 of ($a*) and $r1
}
rule ELASTIC_Windows_Trojan_Formbook_5799D1F2 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Formbook (Windows.Trojan.Formbook)"
		author = "Elastic Security"
		id = "5799d1f2-4d4f-49d6-b010-67d2fbc04824"
		date = "2022-06-08"
		modified = "2022-09-29"
		reference = "https://www.elastic.co/security-labs/formbook-adopts-cab-less-approach"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Formbook.yar#L48-L67"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "8555a6d313cb17f958fc2e08d6c042aaff9ceda967f8598ac65ab6333d14efd9"
		logic_hash = "8e61eabd11beb9fb35c016983cfb3085f5ceddfc8268522f3b48d20be5b5df6a"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b262c4223e90c539c73831f7f833d25fe938eaecb77ca6d2e93add6f93e7d75d"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { E9 C5 9C FF FF C3 E8 00 00 00 00 58 C3 68 }

	condition:
		all of them
}
rule ELASTIC_Multi_Ransomware_Blackcat_Aaf312C3 : FILE MEMORY {
    meta:
		description = "Detects Multi Ransomware Blackcat (Multi.Ransomware.BlackCat)"
		author = "Elastic Security"
		id = "aaf312c3-47b4-4dab-b7fc-8a2ac9883772"
		date = "2022-02-02"
		modified = "2023-09-20"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Ransomware_BlackCat.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0c6f444c6940a3688ffc6f8b9d5774c032e3551ebbccb64e4280ae7fc1fac479"
		logic_hash = "0771ab5a795af164a568bda036cccf08afeb33458f2cd5a7240349fca9b60ead"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "577c7f24a7ecf89a542e9a63a1744a129c96c32e8dccfbf779dd9fc6c0194930"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$chacha20_enc = { EF D9 F3 0F 7F 14 3B F3 0F 7F 5C 3B 10 83 C7 20 39 F8 75 D0 8B }
		$crc32_imp = { F3 0F 6F 02 66 0F 6F D1 66 0F 3A 44 CD 11 83 C0 F0 83 C2 10 66 0F 3A 44 D4 00 83 F8 0F 66 0F EF C8 66 0F EF CA }

	condition:
		all of them
}
rule ELASTIC_Multi_Ransomware_Blackcat_00E525D7 : FILE MEMORY {
    meta:
		description = "Detects Multi Ransomware Blackcat (Multi.Ransomware.BlackCat)"
		author = "Elastic Security"
		id = "00e525d7-a8a6-475f-89ad-607c452aea1e"
		date = "2022-02-02"
		modified = "2022-08-16"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Ransomware_BlackCat.yar#L22-L43"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0c6f444c6940a3688ffc6f8b9d5774c032e3551ebbccb64e4280ae7fc1fac479"
		logic_hash = "e44625d0fa8308b9d4d63a9e6920b4da4a2ce124437f122b2c8fe5cf0ab85a6b"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "631e30b8b51a5c0a0e91e8c09968663192569005b8bffff9f0474749788e9d57"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$a1 = "ata\",\"boot\",\"config.msi\",\"google\",\"perflogs\",\"appdata\",\"windows.old\"],\"exclude_file_names\":[\"desktop.ini\",\"aut"
		$a2 = "locker::core::windows::processvssadmin.exe delete shadows /all /quietshadow_copy::remove_all=" ascii fullword
		$a3 = "\\\\.\\pipe\\__rust_anonymous_pipe1__." ascii fullword
		$a4 = "--bypass-p-p--bypass-path-path --no-prop-servers \\\\" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Multi_Ransomware_Blackcat_C4B043E6 : FILE MEMORY {
    meta:
		description = "Detects Multi Ransomware Blackcat (Multi.Ransomware.BlackCat)"
		author = "Elastic Security"
		id = "c4b043e6-ff5f-4492-94e3-fd688d690738"
		date = "2022-09-12"
		modified = "2022-09-29"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Ransomware_BlackCat.yar#L45-L63"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "45b8678f74d29c87e2d06410245ab6c2762b76190594cafc9543fb9db90f3d4f"
		logic_hash = "1262ca76581920f08a6482ead68023fdfff08a9ddd19e00230054e3167dc184c"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "3e89858e90632ad5f4831427bd630252113b735c51f7a1aa1eab8ba6e4c16f18"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$a = { 28 4C 8B 60 08 4C 8B 68 10 0F 10 40 28 0F 29 44 24 10 0F 10 }

	condition:
		all of them
}
rule ELASTIC_Multi_Ransomware_Blackcat_70171625 : FILE MEMORY {
    meta:
		description = "Detects Multi Ransomware Blackcat (Multi.Ransomware.BlackCat)"
		author = "Elastic Security"
		id = "70171625-c29b-47c1-b572-2e6dc846a907"
		date = "2023-01-05"
		modified = "2023-09-20"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Ransomware_BlackCat.yar#L65-L91"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0c6f444c6940a3688ffc6f8b9d5774c032e3551ebbccb64e4280ae7fc1fac479"
		logic_hash = "fd07acd7c8627754f000c44827848bf65bcaa96f2dfb46e41542f3c9b40eee78"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f3f70f92fe9c044f4565fca519cb04a3a54536985c2614077ef92c3193fff9c1"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$str0 = "}RECOVER-${EXTENSION}-FILES.txt"
		$str1 = "?access-key=${ACCESS_KEY}"
		$str2 = "${NOTE_FILE_NAME}"
		$str3 = "enable_network_discovery"
		$str4 = "enable_set_wallpaper"
		$str5 = "enable_esxi_vm_kill"
		$str6 = "strict_include_paths"
		$str7 = "exclude_file_path_wildcard"
		$str8 = "${ACCESS_KEY}${EXTENSION}"

	condition:
		all of them
}
rule ELASTIC_Multi_Ransomware_Blackcat_E066D802 : FILE MEMORY {
    meta:
		description = "Detects Multi Ransomware Blackcat (Multi.Ransomware.BlackCat)"
		author = "Elastic Security"
		id = "e066d802-b803-4e35-9b53-ae1823662483"
		date = "2023-07-27"
		modified = "2023-09-20"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Ransomware_BlackCat.yar#L93-L113"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "00360830bf5886288f23784b8df82804bf6f22258e410740db481df8a7701525"
		logic_hash = "00fbb8013faf26c35b6cd8a72ebc246444c37c5ec7a0df2295830e96c01c8720"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "05037af3395b682d1831443757376064c873815ac4b6d1c09116715570f51f5d"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$a1 = "esxcli vm process kill --type=force --world-id=Killing"
		$a2 = "vim-cmd vmsvc/snapshot.removeall $i"
		$a3 = "File already has encrypted extension"

	condition:
		2 of them
}
rule ELASTIC_Multi_Ransomware_Blackcat_0Ffb0A37 : FILE MEMORY {
    meta:
		description = "Detects Multi Ransomware Blackcat (Multi.Ransomware.BlackCat)"
		author = "Elastic Security"
		id = "0ffb0a37-e4c3-45be-bd4d-7033e88635aa"
		date = "2023-07-29"
		modified = "2024-06-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Ransomware_BlackCat.yar#L115-L134"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "57136b118a0d6d3c71e522ea53e3305dae58b51f06c29cd01c0c28fa0fa34287"
		logic_hash = "4f28281e4b23868c63438d4800b9e5978426e7c98b6142ef8082cfd251cafe57"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "319b956ddd57bea22cbee7e521649969c5b1f42ee4af49ad6f25847fb8ee9559"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$a1 = { C8 C8 00 00 00 89 20 00 00 45 01 00 00 32 22 08 0A 20 64 85 }
		$a2 = { 67 69 74 68 75 62 2E 63 6F 6D 2D 31 65 63 63 36 32 39 39 64 62 39 65 63 38 32 33 2F 73 69 6D 70 6C 65 6C 6F 67 2D }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Stormkitty_6256031A : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Stormkitty (Windows.Trojan.StormKitty)"
		author = "Elastic Security"
		id = "6256031a-e7dd-423b-a83f-4db428cb3d1b"
		date = "2022-03-21"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_StormKitty.yar#L1-L24"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0c69015f534d1da3770dbc14183474a643c4332de6a599278832abd2b15ba027"
		logic_hash = "a797e87eaf5b173da9dd43fcff03b3d26198dcafa29c3f2ca369773c73001234"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "6f0463de42c97701b0f3b8172e7e461501357921a3d11e6ca467bd1ca397d0b6"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "https://github.com/LimerBoy/StormKitty" ascii fullword
		$a2 = "127.0.0.1 www.malwarebytes.com" wide fullword
		$a3 = "KillDefender"
		$a4 = "Username: {1}" wide fullword
		$a5 = "# End of Cookies" wide fullword
		$a6 = "# End of Passwords" wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Doorme_246Eda61 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Doorme (Windows.Trojan.DoorMe)"
		author = "Elastic Security"
		id = "246eda61-23b5-49b8-8409-623f2722c289"
		date = "2022-12-09"
		modified = "2022-12-15"
		reference = "https://www.elastic.co/security-labs/update-to-the-REF2924-intrusion-set-and-related-campaigns"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_DoorMe.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "96b226e1dcfb8ea2155c2fa508125472c8c767569d009a881ab4c39453e4fe7f"
		logic_hash = "01240f2e23904498c34ec805cc8bc3e9ac7b76c6519685ef6b367066f1a0bc5b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "aa8c2ae2e966bf4e0c79faa90b14fd77d07b7c68076f39c56b384dada9dd0e96"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$seq_aes_crypto = { 8B 6C 24 ?? C1 E5 ?? 8B 5C 24 ?? 8D 34 9D ?? ?? ?? ?? 0F B6 04 31 32 44 24 ?? 88 04 29 8D 04 9D ?? ?? ?? ?? 0F B6 04 01 32 44 24 ?? 88 44 29 ?? 8D 04 9D ?? ?? ?? ?? 0F B6 04 01 44 30 F8 88 44 29 ?? 8D 04 9D ?? ?? ?? ?? 0F B6 04 01 44 30 E0 88 44 29 ?? 8B 74 24 ?? }
		$seq_copy_str = { 48 8B 44 24 ?? 48 89 58 ?? 48 89 F1 4C 89 F2 49 89 D8 E8 ?? ?? ?? ?? C6 04 1E ?? }
		$seq_md5 = { 89 F8 44 21 C8 44 89 C9 F7 D1 21 F1 44 01 C0 01 C8 44 8B AC 24 ?? ?? ?? ?? 8B 9C 24 ?? ?? ?? ?? 48 89 B4 24 ?? ?? ?? ?? 44 89 44 24 ?? 46 8D 04 28 41 81 C0 ?? ?? ?? ?? 4C 89 AC 24 ?? ?? ?? ?? 41 C1 C0 ?? 45 01 C8 44 89 C1 44 21 C9 44 89 C2 F7 D2 21 FA 48 89 BC 24 ?? ?? ?? ?? 8D 2C 1E 49 89 DC 01 D5 01 E9 81 C1 ?? ?? ?? ?? C1 C1 ?? 44 01 C1 89 CA 44 21 C2 89 CD F7 D5 44 21 CD 8B 84 24 ?? ?? ?? ?? 48 89 44 24 ?? 8D 1C 07 01 EB 01 DA 81 C2 ?? ?? ?? ?? C1 C2 ?? }
		$seq_calc_key = { 31 FF 48 8D 1D ?? ?? ?? ?? 48 83 FF ?? 4C 89 F8 77 ?? 41 0F B6 34 3E 48 89 F1 48 C1 E9 ?? 44 0F B6 04 19 BA ?? ?? ?? ?? 48 89 C1 E8 ?? ?? ?? ?? 83 E6 ?? 44 0F B6 04 1E BA ?? ?? ?? ?? 48 8B 4D ?? E8 ?? ?? ?? ?? 48 83 C7 ?? }
		$seq_base64 = { 8A 45 ?? 8A 4D ?? C0 E0 ?? 89 CA C0 EA ?? 80 E2 ?? 08 C2 88 55 ?? C0 E1 ?? 8A 45 ?? C0 E8 ?? 24 ?? 08 C8 88 45 ?? 41 83 C4 ?? 31 F6 44 39 E6 7D ?? 66 90 }
		$str_0 = ".?AVDoorme@@" ascii fullword

	condition:
		3 of ($seq*) or 1 of ($str*)
}
rule ELASTIC_Windows_Trojan_Qbot_D91C1384 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Qbot (Windows.Trojan.Qbot)"
		author = "Elastic Security"
		id = "d91c1384-839f-4062-8a8d-5cda931029ae"
		date = "2021-07-08"
		modified = "2021-08-23"
		reference = "https://www.elastic.co/security-labs/exploring-the-qbot-attack-pattern"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Qbot.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "18ac3870aaa9aaaf6f4a5c0118daa4b43ad93d71c38bf42cb600db3d786c6dda"
		logic_hash = "8fd8249a2af236c92ccbc20b2a8380f69ca75976bd64bad167828e9ab4c6ed90"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "1b47ede902b6abfd356236e91ed3e741cf1744c68b6bb566f0d346ea07fee49a"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { FE 8A 14 06 88 50 FF 8A 54 BC 11 88 10 8A 54 BC 10 88 50 01 47 83 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Qbot_7D5Dc64A : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Qbot (Windows.Trojan.Qbot)"
		author = "Elastic Security"
		id = "7d5dc64a-a597-44ac-a0fd-cefffc5e9cff"
		date = "2021-10-04"
		modified = "2022-01-13"
		reference = "https://www.elastic.co/security-labs/exploring-the-qbot-attack-pattern"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Qbot.yar#L22-L42"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a2bacde7210d88675564106406d9c2f3b738e2b1993737cb8bf621b78a9ebf56"
		logic_hash = "5c8858502050494ab20a230f04c2c1cb4bfcd80f4a248dad82787d7ce67c741d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ab80d96a454e0aad56621e70be4d55f099c41b538a380feb09192d252b4db5aa"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "%u.%u.%u.%u.%u.%u.%04x" ascii fullword
		$a2 = "stager_1.dll" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Qbot_6Fd34691 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Qbot (Windows.Trojan.Qbot)"
		author = "Elastic Security"
		id = "6fd34691-10e4-4a66-85ff-1b67ed3da4dd"
		date = "2022-03-07"
		modified = "2022-04-12"
		reference = "https://www.elastic.co/security-labs/exploring-the-qbot-attack-pattern"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Qbot.yar#L44-L64"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0838cd11d6f504203ea98f78cac8f066eb2096a2af16d27fb9903484e7e6a689"
		logic_hash = "9422d9f276f0c8c2990ece3282d918abc6fcce7eeb6809d46ae6b768a501a877"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "187fc04abcba81a2cbbe839adf99b8ab823cbf65993c8780d25e7874ac185695"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 75 C9 8B 45 1C 89 45 A4 8B 45 18 89 45 A8 8B 45 14 89 45 AC 8B }
		$a2 = "\\stager_1.obf\\Benign\\mfc\\" wide

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Qbot_3074A8D4 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Qbot (Windows.Trojan.Qbot)"
		author = "Elastic Security"
		id = "3074a8d4-d93c-4987-9031-9ecd3881730d"
		date = "2022-06-07"
		modified = "2022-07-18"
		reference = "https://www.elastic.co/security-labs/exploring-the-qbot-attack-pattern"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Qbot.yar#L66-L97"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c2ba065654f13612ae63bca7f972ea91c6fe97291caeaaa3a28a180fb1912b3a"
		logic_hash = "90c06bd09fe640bb5a6be8e4f2384fb15c7501674d57db005e790ed336740c99"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "c233a0c24576450ce286d96126379b6b28d537619e853d860e2812f521b810ac"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "qbot" wide
		$a2 = "stager_1.obf\\Benign\\mfc" wide
		$a3 = "common.obf\\Benign\\mfc" wide
		$a4 = "%u;%u;%u;"
		$a5 = "%u.%u.%u.%u.%u.%u.%04x"
		$a6 = "%u&%s&%u"
		$get_string1 = { 33 D2 8B ?? 6A 5A 5? F7 ?? 8B ?? 08 8A 04 ?? 8B 55 ?? 8B ?? 10 3A 04 ?? }
		$get_string2 = { 33 D2 8B ?? F7 75 F4 8B 45 08 8A 04 02 32 04 ?? 88 04 ?? ?? 83 ?? 01 }
		$set_key = { 8D 87 00 04 00 00 50 56 E8 ?? ?? ?? ?? 59 8B D0 8B CE E8 }
		$do_computer_use_russian_like_keyboard = { B9 FF 03 00 00 66 23 C1 33 C9 0F B7 F8 66 3B 7C 4D }
		$execute_each_tasks = { 8B 44 0E ?? 85 C0 74 ?? FF D0 EB ?? 6A 00 6A 00 6A 00 FF 74 0E ?? E8 ?? ?? ?? ?? 83 C4 10 }
		$generate_random_alpha_num_string = { 57 E8 ?? ?? ?? ?? 48 50 8D 85 ?? ?? ?? ?? 6A 00 50 E8 ?? ?? ?? ?? 8B 4D ?? 83 C4 10 8A 04 38 88 04 0E 46 83 FE 0C }
		$load_base64_dll_from_file_and_inject_into_targets = { 10 C7 45 F0 50 00 00 00 83 65 E8 00 83 7D F0 0B 73 08 8B 45 F0 89 }

	condition:
		6 of them
}
rule ELASTIC_Windows_Trojan_Qbot_1Ac22A26 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Qbot (Windows.Trojan.Qbot)"
		author = "Elastic Security"
		id = "1ac22a26-ec88-4e88-8fe6-a092bbb61904"
		date = "2022-12-29"
		modified = "2023-02-01"
		reference = "https://www.elastic.co/security-labs/exploring-the-qbot-attack-pattern"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Qbot.yar#L99-L136"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "c2ba065654f13612ae63bca7f972ea91c6fe97291caeaaa3a28a180fb1912b3a"
		logic_hash = "d9beaf4a8c28a0b3c38dda6bf22a96b8c96ef715bd36de880504a9f970338fe2"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "22436c48bc775284d1f682eaeb650fd998302021342efc322c4ca40dd30f1a0d"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "qbot" wide
		$a2 = "stager_1.obf\\Benign\\mfc" wide
		$a3 = "common.obf\\Benign\\mfc" wide
		$a4 = "%u;%u;%u"
		$a5 = "%u.%u.%u.%u.%u.%u.%04x"
		$a6 = "%u&%s&%u"
		$a7 = "mnjhuiv40"
		$a8 = "\\u%04X"
		$get_string1 = { 33 D2 8B ?? 6A ?? 5? F7 ?? 8B ?? 08 8A 04 ?? 8B 55 ?? 8B ?? 10 3A 04 }
		$get_string2 = { 8B C6 83 E0 ?? 8A 04 08 3A 04 1E 74 ?? 46 3B F2 72 }
		$get_string3 = { 8A 04 ?? 32 04 ?? 88 04 ?? 4? 83 ?? 01 }
		$set_key_1 = { 8D 87 00 04 00 00 50 56 E8 [4] 59 8B D0 8B CE E8 }
		$set_key_2 = { 59 6A 14 58 6A 0B 66 89 87 [0-1] 20 04 00 00 }
		$cccp_keyboard_0 = { 6A ?? 66 89 45 E? 58 6A ?? 66 89 45 E? 58 }
		$cccp_keyboard_1 = { 66 8B 84 9? ?? FE FF FF B9 FF 03 00 00 66 23 C1 33 ?? 0F B7 }
		$execute_each_tasks = { 8B 0D [4] 83 7C 0E 04 00 74 ?? 83 7C 0E 1C 00 74 ?? 8B 04 0E 85 C0 7E ?? 6B C0 3C }
		$generate_random_alpha_num_string = { 57 E8 [4] 48 50 8D 85 [4] 6A 00 50 E8 [4] 8B 4D ?? 83 C4 10 8A 04 38 88 04 0E 46 83 FE 0C }
		$load_and_inject_b64_dll_from_file = { 6B 45 FC 18 8B 4D F8 83 7C 01 04 00 76 ?? 6A 00 6B 45 FC 18 8B 4D F8 FF 74 01 10 6B 45 FC 18 }
		$decipher_rsrc_data = { F6 86 38 04 00 00 04 89 BE 2C 04 00 00 89 BE 28 04 00 00 [2-6] 8B 0B 8D 45 F? 83 65 F? 00 8B D7 50 E8 }

	condition:
		6 of them
}
rule ELASTIC_Multi_Trojan_Merlin_32643F4C : FILE MEMORY {
    meta:
		description = "Detects Multi Trojan Merlin (Multi.Trojan.Merlin)"
		author = "Elastic Security"
		id = "32643f4c-ee47-4ed2-9807-7b85d3f4e095"
		date = "2024-03-01"
		modified = "2024-05-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Trojan_Merlin.yar#L1-L28"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "84b988c4656677bc021e23df2a81258212d9ceba13be204867ac1d9d706404e2"
		logic_hash = "7de2deec0e2c7fd3ce2b42762f88bfe87cb4ffb02b697953aa1716425d6f1612"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "bce277ef43c67be52b67c4495652e99d4707975c79cb30b54283db56545278ae"
		severity = 100
		arch_context = "x86, arm64"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$a1 = "json:\"killdate,omitempty\""
		$a2 = "json:\"maxretry,omitempty\""
		$a3 = "json:\"waittime,omitempty\""
		$a4 = "json:\"payload,omitempty\""
		$a5 = "json:\"skew,omitempty\""
		$a6 = "json:\"command\""
		$a7 = "json:\"pid,omitempty\""
		$b1 = "/merlin-agent/commands"
		$b2 = "/merlin/pkg/jobs"
		$b3 = "github.com/Ne0nd0g/merlin"

	condition:
		all of ($a*) or all of ($b*)
}
rule ELASTIC_Windows_Hacktool_Sharprdp_80895Fcb : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Sharprdp (Windows.Hacktool.SharpRDP)"
		author = "Elastic Security"
		id = "80895fcb-b98e-4865-a1f6-87cbea327cea"
		date = "2022-11-20"
		modified = "2023-01-11"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_SharpRDP.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6e909861781a8812ee01bc59435fd73fd34da23fa9ad6d699eefbf9f84629876"
		logic_hash = "ef9a92f2ed29f508dca591e9c65a6ce0013ccdfd0c62770e8840be2f3ee5982e"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "a7eb084004fce79efc39781044bad501a731163fa3ad6f9b8b334611d03f5379"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$guid = "F1DF1D0F-FF86-4106-97A8-F95AAF525C54" ascii wide nocase
		$print_str0 = "[+] Another user is logged on, asking to take over session" ascii wide fullword
		$print_str1 = "[+] Execution priv type   :  {0}" ascii wide fullword
		$print_str2 = "[+] Sleeping for 30 seconds" ascii wide fullword
		$print_str3 = "[X] Error: A password is required" ascii wide fullword

	condition:
		$guid or all of ($print_str*)
}
rule ELASTIC_Windows_Trojan_Diceloader_B32C6B99 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Diceloader (Windows.Trojan.Diceloader)"
		author = "Elastic Security"
		id = "b32c6b99-f634-4c6f-98f4-39954ef15afa"
		date = "2021-04-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Diceloader.yar#L1-L25"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a3b3f56a61c6dc8ba2aa25bdd9bd7dc2c5a4602c2670431c5cbc59a76e2b4c54"
		logic_hash = "f9e023f340edc4c46b2926e750c2ad3a3798e34415e43c0ea2d83073e3dc526a"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "15d4bc57c03a560608ae69551aa46d1786072b3d78d747512f8ac3e6822a7b93"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "D$0GET " ascii fullword
		$a2 = "D$THostf" ascii fullword
		$a3 = "D$,POST" ascii fullword
		$a4 = "namef" ascii fullword
		$a5 = "send" ascii fullword
		$a6 = "log.ini" wide
		$a7 = { 70 61 73 73 00 00 65 6D 61 69 6C 00 00 6C 6F 67 69 6E 00 00 73 69 67 6E 69 6E 00 00 61 63 63 6F 75 6E 74 00 00 70 65 72 73 69 73 74 65 6E 74 00 00 48 6F 73 74 3A 20 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Diceloader_15Eeb7B9 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Diceloader (Windows.Trojan.Diceloader)"
		author = "Elastic Security"
		id = "15eeb7b9-311f-477b-8ae1-b8f689a154b7"
		date = "2021-04-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Diceloader.yar#L27-L46"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "a1202df600d11ad2c61050e7ba33701c22c2771b676f54edd1846ef418bea746"
		logic_hash = "f1ab9ad69f9ea75343c7404b82a3f7a4976a442b980a98fe5b95c55d4f9cb34e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "4cc70bec5d241c6f84010fbfe2eafbc6ec6d753df2bb3f52d9498b54b11fc8cb"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { E9 92 9D FF FF C3 E8 }
		$a2 = { E9 E8 61 FF FF C3 E8 }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Gozi_Fd494041 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Gozi (Windows.Trojan.Gozi)"
		author = "Elastic Security"
		id = "fd494041-3fe8-4ffa-9ab8-6798032f1d66"
		date = "2021-03-22"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Gozi.yar#L1-L32"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0a1c1557bdb8c1b99e2b764fc6b21a07e33dc777b492a25a55cbd8737031e237"
		logic_hash = "fdd18817e7377f1b4006d3bf135d924b8ead62a461ea56f57157b2856ba6846b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "faabcdfb3402a5951ff1fde4f994dcb00ec9a71fb815b80dc1da9b577bf92ec2"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "/C ping localhost -n %u && del \"%s\"" wide fullword
		$a2 = "/C \"copy \"%s\" \"%s\" /y && \"%s\" \"%s\"" wide fullword
		$a3 = "/C \"copy \"%s\" \"%s\" /y && rundll32 \"%s\",%S\"" wide fullword
		$a4 = "ASCII.GetString(( gp \"%S:\\%S\").%s))',0,0)" wide
		$a5 = "filename=\"%.4u.%lu\""
		$a6 = "Urundll32 \"%s\",%S" wide fullword
		$a7 = "version=%u&soft=%u&user=%08x%08x%08x%08x&server=%u&id=%u&type=%u&name=%s" ascii fullword
		$a8 = "%08X-%04X-%04X-%04X-%08X%04X" ascii fullword
		$a9 = "&whoami=%s" ascii fullword
		$a10 = "%u.%u_%u_%u_x%u" ascii fullword
		$a11 = "size=%u&hash=0x%08x" ascii fullword
		$a12 = "&uptime=%u" ascii fullword
		$a13 = "%systemroot%\\system32\\c_1252.nls" ascii fullword
		$a14 = "IE10RunOnceLastShown_TIMESTAMP" ascii fullword

	condition:
		8 of ($a*)
}
rule ELASTIC_Windows_Trojan_Gozi_261F5Ac5 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Gozi (Windows.Trojan.Gozi)"
		author = "Elastic Security"
		id = "261f5ac5-7800-4580-ac37-80b71c47c270"
		date = "2019-08-02"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Gozi.yar#L34-L60"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "31835c6350177eff88265e81335a50fcbe0dc46771bf031c836947851dcebb4f"
		logic_hash = "23a7427e162e2f77ee0a281fe4bc54eab29a3bdca8e51015147e8eb223e7e2f7"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "cbc8fec8fbaa809cfc7da7db72aeda43d4270f907e675016cbbc2e28e7b8553c"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "soft=%u&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x"
		$a2 = "version=%u&soft=%u&user=%08x%08x%08x%08x&server=%u&id=%u&type=%u&name=%s"
		$a3 = "Content-Disposition: form-data; name=\"upload_file\"; filename=\"%.4u.%lu\""
		$a4 = "&tor=1"
		$a5 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT %u.%u%s)"
		$a6 = "http://constitution.org/usdeclar.txt"
		$a7 = "grabs="
		$a8 = "CHROME.DLL"
		$a9 = "Software\\AppDataLow\\Software\\Microsoft\\"

	condition:
		4 of ($a*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_C851687A : FILE MEMORY {
    meta:
		description = "Identifies UAC Bypass module from Cobalt Strike"
		author = "Elastic Security"
		id = "c851687a-aac6-43e7-a0b6-6aed36dcf12e"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L1-L37"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "7fac6fb24ac18bd69dd9f8f4090c4a77d1cc6554b6ae5c846e32d7666e5a1971"
		score = 75
		quality = 25
		tags = "FILE, MEMORY"
		fingerprint = "70224e28a223d09f2211048936beb9e2d31c0312c97a80e22c85e445f1937c10"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "bypassuac.dll" ascii fullword
		$a2 = "bypassuac.x64.dll" ascii fullword
		$a3 = "\\\\.\\pipe\\bypassuac" ascii fullword
		$b1 = "\\System32\\sysprep\\sysprep.exe" wide fullword
		$b2 = "[-] Could not write temp DLL to '%S'" ascii fullword
		$b3 = "[*] Cleanup successful" ascii fullword
		$b4 = "\\System32\\cliconfg.exe" wide fullword
		$b5 = "\\System32\\eventvwr.exe" wide fullword
		$b6 = "[-] %S ran too long. Could not terminate the process." ascii fullword
		$b7 = "[*] Wrote hijack DLL to '%S'" ascii fullword
		$b8 = "\\System32\\sysprep\\" wide fullword
		$b9 = "[-] COM initialization failed." ascii fullword
		$b10 = "[-] Privileged file copy failed: %S" ascii fullword
		$b11 = "[-] Failed to start %S: %d" ascii fullword
		$b12 = "ReflectiveLoader"
		$b13 = "[-] '%S' exists in DLL hijack location." ascii fullword
		$b14 = "[-] Cleanup failed. Remove: %S" ascii fullword
		$b15 = "[+] %S ran and exited." ascii fullword
		$b16 = "[+] Privileged file copy success! %S" ascii fullword

	condition:
		2 of ($a*) or 10 of ($b*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_0B58325E : FILE MEMORY {
    meta:
		description = "Identifies Keylogger module from Cobalt Strike"
		author = "Elastic Security"
		id = "0b58325e-2538-434d-9a2c-26e2c32db039"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L39-L77"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "3822431e946fcc38c700cc8ce213e95f33a155d7f38b6ab2a24cb998d42c8521"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "8ecd5bdce925ae5d4f90cecb9bc8c3901b54ba1c899a33354bcf529eeb2485d4"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "keylogger.dll" ascii fullword
		$a2 = "keylogger.x64.dll" ascii fullword
		$a3 = "\\\\.\\pipe\\keylogger" ascii fullword
		$a4 = "%cE=======%c" ascii fullword
		$a5 = "[unknown: %02X]" ascii fullword
		$b1 = "ReflectiveLoader"
		$b2 = "%c2%s%c" ascii fullword
		$b3 = "[numlock]" ascii fullword
		$b4 = "%cC%s" ascii fullword
		$b5 = "[backspace]" ascii fullword
		$b6 = "[scroll lock]" ascii fullword
		$b7 = "[control]" ascii fullword
		$b8 = "[left]" ascii fullword
		$b9 = "[page up]" ascii fullword
		$b10 = "[page down]" ascii fullword
		$b11 = "[prtscr]" ascii fullword
		$b12 = "ZRich9" ascii fullword
		$b13 = "[ctrl]" ascii fullword
		$b14 = "[home]" ascii fullword
		$b15 = "[pause]" ascii fullword
		$b16 = "[clear]" ascii fullword

	condition:
		1 of ($a*) and 14 of ($b*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_2B8Cddf8 : FILE MEMORY {
    meta:
		description = "Identifies dll load module from Cobalt Strike"
		author = "Elastic Security"
		id = "2b8cddf8-ca7a-4f85-be9d-6d8534d0482e"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L79-L114"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "5502c06d33b93bae3bc25ba7dd6a5a9a3b0b2b43bb7e867e601ecb206bf503ed"
		score = 75
		quality = 43
		tags = "FILE, MEMORY"
		fingerprint = "0d7d28d79004ca61b0cfdcda29bd95e3333e6fc6e6646a3f6ba058aa01bee188"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\dllload.x64.o" ascii fullword
		$a2 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\dllload.x86.o" ascii fullword
		$b1 = "__imp_BeaconErrorDD" ascii fullword
		$b2 = "__imp_BeaconErrorNA" ascii fullword
		$b3 = "__imp_BeaconErrorD" ascii fullword
		$b4 = "__imp_BeaconDataInt" ascii fullword
		$b5 = "__imp_KERNEL32$WriteProcessMemory" ascii fullword
		$b6 = "__imp_KERNEL32$OpenProcess" ascii fullword
		$b7 = "__imp_KERNEL32$CreateRemoteThread" ascii fullword
		$b8 = "__imp_KERNEL32$VirtualAllocEx" ascii fullword
		$c1 = "__imp__BeaconErrorDD" ascii fullword
		$c2 = "__imp__BeaconErrorNA" ascii fullword
		$c3 = "__imp__BeaconErrorD" ascii fullword
		$c4 = "__imp__BeaconDataInt" ascii fullword
		$c5 = "__imp__KERNEL32$WriteProcessMemory" ascii fullword
		$c6 = "__imp__KERNEL32$OpenProcess" ascii fullword
		$c7 = "__imp__KERNEL32$CreateRemoteThread" ascii fullword
		$c8 = "__imp__KERNEL32$VirtualAllocEx" ascii fullword

	condition:
		1 of ($a*) or 5 of ($b*) or 5 of ($c*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_59B44767 : FILE MEMORY {
    meta:
		description = "Identifies getsystem module from Cobalt Strike"
		author = "Elastic Security"
		id = "59b44767-c9a5-42c0-b177-7fe49afd7dfb"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L116-L142"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "7027d0dcbdb1961d2604f29392a923957d298a047c268553599ea8c881f76a98"
		score = 75
		quality = 69
		tags = "FILE, MEMORY"
		fingerprint = "882886a282ec78623a0d3096be3d324a8a1b8a23bcb88ea0548df2fae5e27aa5"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\getsystem.x86.o" ascii fullword
		$a2 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\getsystem.x64.o" ascii fullword
		$b1 = "getsystem failed." ascii fullword
		$b2 = "_isSystemSID" ascii fullword
		$b3 = "__imp__NTDLL$NtQuerySystemInformation@16" ascii fullword
		$c1 = "getsystem failed." ascii fullword
		$c2 = "$pdata$isSystemSID" ascii fullword
		$c3 = "$unwind$isSystemSID" ascii fullword
		$c4 = "__imp_NTDLL$NtQuerySystemInformation" ascii fullword

	condition:
		1 of ($a*) or 3 of ($b*) or 3 of ($c*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_7Efd3C3F : FILE MEMORY {
    meta:
		description = "Identifies Hashdump module from Cobalt Strike"
		author = "Elastic Security"
		id = "7efd3c3f-1104-4b46-9d1e-dc2c62381b8c"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L144-L168"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "45a0aaba6c1be016fc5f4051680ee7e3aa62e8a5d9730b7adab08c14ae37da24"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "9e7c7c9a7436f5ee4c27fd46d6f06e7c88f4e4d1166759573cedc3ed666e1838"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 70
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "hashdump.dll" ascii fullword
		$a2 = "hashdump.x64.dll" ascii fullword
		$a3 = "\\\\.\\pipe\\hashdump" ascii fullword
		$a4 = "ReflectiveLoader"
		$a5 = "Global\\SAM" ascii fullword
		$a6 = "Global\\FREE" ascii fullword
		$a7 = "[-] no results." ascii fullword

	condition:
		4 of ($a*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_6E971281 : FILE MEMORY {
    meta:
		description = "Identifies Interfaces module from Cobalt Strike"
		author = "Elastic Security"
		id = "6e971281-3ee3-402f-8a72-745ec8fb91fb"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L170-L201"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "f204965c0118dbdfe7e134d319c92b30d22585e888609ff31df90643116a2c38"
		score = 75
		quality = 51
		tags = "FILE, MEMORY"
		fingerprint = "62d97cf73618a1b4d773d5494b2761714be53d5cda774f9a96eaa512c8d5da12"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\interfaces.x64.o" ascii fullword
		$a2 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\interfaces.x86.o" ascii fullword
		$b1 = "__imp_BeaconFormatAlloc" ascii fullword
		$b2 = "__imp_BeaconFormatPrintf" ascii fullword
		$b3 = "__imp_BeaconOutput" ascii fullword
		$b4 = "__imp_KERNEL32$LocalAlloc" ascii fullword
		$b5 = "__imp_KERNEL32$LocalFree" ascii fullword
		$b6 = "__imp_LoadLibraryA" ascii fullword
		$c1 = "__imp__BeaconFormatAlloc" ascii fullword
		$c2 = "__imp__BeaconFormatPrintf" ascii fullword
		$c3 = "__imp__BeaconOutput" ascii fullword
		$c4 = "__imp__KERNEL32$LocalAlloc" ascii fullword
		$c5 = "__imp__KERNEL32$LocalFree" ascii fullword
		$c6 = "__imp__LoadLibraryA" ascii fullword

	condition:
		1 of ($a*) or 4 of ($b*) or 4 of ($c*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_09B79Efa : FILE MEMORY {
    meta:
		description = "Identifies Invoke Assembly module from Cobalt Strike"
		author = "Elastic Security"
		id = "09b79efa-55d7-481d-9ee0-74ac5f787cef"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L203-L232"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "75fd003b9adf03aff8479b1b10da9c94955870b5fa4f1958f870e14acb2793c7"
		score = 75
		quality = 48
		tags = "FILE, MEMORY"
		fingerprint = "04ef6555e8668c56c528dc62184331a6562f47652c73de732e5f7c82779f2fd8"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "invokeassembly.x64.dll" ascii fullword
		$a2 = "invokeassembly.dll" ascii fullword
		$b1 = "[-] Failed to get default AppDomain w/hr 0x%08lx" ascii fullword
		$b2 = "[-] Failed to load the assembly w/hr 0x%08lx" ascii fullword
		$b3 = "[-] Failed to create the runtime host" ascii fullword
		$b4 = "[-] Invoke_3 on EntryPoint failed." ascii fullword
		$b5 = "[-] CLR failed to start w/hr 0x%08lx" ascii fullword
		$b6 = "ReflectiveLoader"
		$b7 = ".NET runtime [ver %S] cannot be loaded" ascii fullword
		$b8 = "[-] No .NET runtime found. :(" ascii fullword
		$b9 = "[-] ICorRuntimeHost::GetDefaultDomain failed w/hr 0x%08lx" ascii fullword
		$c1 = { FF 57 0C 85 C0 78 40 8B 45 F8 8D 55 F4 8B 08 52 50 }

	condition:
		1 of ($a*) or 3 of ($b*) or 1 of ($c*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_6E77233E : FILE MEMORY {
    meta:
		description = "Identifies Kerberos module from Cobalt Strike"
		author = "Elastic Security"
		id = "6e77233e-7fb4-4295-823d-f97786c5d9c4"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L234-L269"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "93aa11523b794402b257d02d4f9edc5ad320bfdb5b8b0f671ff08f399ef9e674"
		score = 75
		quality = 63
		tags = "FILE, MEMORY"
		fingerprint = "cef2949eae78b1c321c2ec4010749a5ac0551d680bd5eb85493fc88c5227d285"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\kerberos.x64.o" ascii fullword
		$a2 = "$unwind$command_kerberos_ticket_use" ascii fullword
		$a3 = "$pdata$command_kerberos_ticket_use" ascii fullword
		$a4 = "command_kerberos_ticket_use" ascii fullword
		$a5 = "$pdata$command_kerberos_ticket_purge" ascii fullword
		$a6 = "command_kerberos_ticket_purge" ascii fullword
		$a7 = "$unwind$command_kerberos_ticket_purge" ascii fullword
		$a8 = "$unwind$kerberos_init" ascii fullword
		$a9 = "$unwind$KerberosTicketUse" ascii fullword
		$a10 = "KerberosTicketUse" ascii fullword
		$a11 = "$unwind$KerberosTicketPurge" ascii fullword
		$b1 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\kerberos.x86.o" ascii fullword
		$b2 = "_command_kerberos_ticket_use" ascii fullword
		$b3 = "_command_kerberos_ticket_purge" ascii fullword
		$b4 = "_kerberos_init" ascii fullword
		$b5 = "_KerberosTicketUse" ascii fullword
		$b6 = "_KerberosTicketPurge" ascii fullword
		$b7 = "_LsaCallKerberosPackage" ascii fullword

	condition:
		5 of ($a*) or 3 of ($b*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_De42495A : FILE MEMORY {
    meta:
		description = "Identifies Mimikatz module from Cobalt Strike"
		author = "Elastic Security"
		id = "de42495a-0002-466e-98b9-19c9ebb9240e"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L271-L301"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "2a13c73d221d80d25a432f9e0a1387153a78f58719066586e9d80d17613293ef"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "dab3c25809ec3af70df5a8a04a2efd4e8ecb13a4c87001ea699e7a1512973b82"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "\\\\.\\pipe\\mimikatz" ascii fullword
		$b1 = "ERROR kuhl_m_dpapi_chrome ; Input 'Login Data' file needed (/in:\"%%localappdata%%\\Google\\Chrome\\User Data\\Default\\Login Da" wide
		$b2 = "ERROR kuhl_m_lsadump_getUsersAndSamKey ; kull_m_registry_RegOpenKeyEx SAM Accounts (0x%08x)" wide fullword
		$b3 = "ERROR kuhl_m_lsadump_getUsersAndSamKey ; kuhl_m_lsadump_getSamKey KO" wide fullword
		$b4 = "ERROR kuhl_m_lsadump_getComputerAndSyskey ; kull_m_registry_RegOpenKeyEx LSA KO" wide fullword
		$b5 = "ERROR kuhl_m_lsadump_lsa_getHandle ; OpenProcess (0x%08x)" wide fullword
		$b6 = "ERROR kuhl_m_lsadump_enumdomains_users ; SamLookupNamesInDomain: %08x" wide fullword
		$b7 = "mimikatz(powershell) # %s" wide fullword
		$b8 = "powershell_reflective_mimikatz" ascii fullword
		$b9 = "mimikatz_dpapi_cache.ndr" wide fullword
		$b10 = "mimikatz.log" wide fullword
		$b11 = "ERROR mimikatz_doLocal" wide
		$b12 = "mimikatz_x64.compressed" wide

	condition:
		1 of ($a*) and 7 of ($b*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_72F68375 : FILE MEMORY {
    meta:
		description = "Identifies Netdomain module from Cobalt Strike"
		author = "Elastic Security"
		id = "72f68375-35ab-49cc-905d-15302389a236"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L303-L328"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "912e37829a9f99e00326745343c9e4593cd7cfb8d4dfafc66027cddcb4d883be"
		score = 75
		quality = 63
		tags = "FILE, MEMORY"
		fingerprint = "ecc28f414b2c347722b681589da8529c6f3af0491845453874f8fd87c2ae86d7"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\net_domain.x64.o" ascii fullword
		$a2 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\net_domain.x86.o" ascii fullword
		$b1 = "__imp_BeaconPrintf" ascii fullword
		$b2 = "__imp_NETAPI32$NetApiBufferFree" ascii fullword
		$b3 = "__imp_NETAPI32$DsGetDcNameA" ascii fullword
		$c1 = "__imp__BeaconPrintf" ascii fullword
		$c2 = "__imp__NETAPI32$NetApiBufferFree" ascii fullword
		$c3 = "__imp__NETAPI32$DsGetDcNameA" ascii fullword

	condition:
		1 of ($a*) or 2 of ($b*) or 2 of ($c*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_15F680Fb : FILE MEMORY {
    meta:
		description = "Identifies Netview module from Cobalt Strike"
		author = "Elastic Security"
		id = "15f680fb-a04f-472d-a182-0b9bee111351"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L330-L360"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "0efe368ad82f5b0f6301121bfda9fd049b008ac246368bfa22bd976fa2c56b79"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0ecb8e41c01bf97d6dea4cf6456b769c6dd2a037b37d754f38580bcf561e1d2c"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "netview.x64.dll" ascii fullword
		$a2 = "netview.dll" ascii fullword
		$a3 = "\\\\.\\pipe\\netview" ascii fullword
		$b1 = "Sessions for \\\\%s:" ascii fullword
		$b2 = "Account information for %s on \\\\%s:" ascii fullword
		$b3 = "Users for \\\\%s:" ascii fullword
		$b4 = "Shares at \\\\%s:" ascii fullword
		$b5 = "ReflectiveLoader" ascii fullword
		$b6 = "Password changeable" ascii fullword
		$b7 = "User's Comment" wide fullword
		$b8 = "List of hosts for domain '%s':" ascii fullword
		$b9 = "Password changeable" ascii fullword
		$b10 = "Logged on users at \\\\%s:" ascii fullword

	condition:
		2 of ($a*) or 6 of ($b*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_5B4383Ec : FILE MEMORY {
    meta:
		description = "Identifies Portscan module from Cobalt Strike"
		author = "Elastic Security"
		id = "5b4383ec-3c93-4e91-850e-d43cc3a86710"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L362-L392"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "033bd831209958674f6309739d65c58d05acb9d17e53cede1cf171c6d6e84efa"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "283d3d2924e92b31f26ec4fc6b79c51bd652fb1377b6985b003f09f8c3dba66c"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "portscan.x64.dll" ascii fullword
		$a2 = "portscan.dll" ascii fullword
		$a3 = "\\\\.\\pipe\\portscan" ascii fullword
		$b1 = "(ICMP) Target '%s' is alive. [read %d bytes]" ascii fullword
		$b2 = "(ARP) Target '%s' is alive. " ascii fullword
		$b3 = "TARGETS!12345" ascii fullword
		$b4 = "ReflectiveLoader" ascii fullword
		$b5 = "%s:%d (platform: %d version: %d.%d name: %S domain: %S)" ascii fullword
		$b6 = "Scanner module is complete" ascii fullword
		$b7 = "pingpong" ascii fullword
		$b8 = "PORTS!12345" ascii fullword
		$b9 = "%s:%d (%s)" ascii fullword
		$b10 = "PREFERENCES!12345" ascii fullword

	condition:
		2 of ($a*) or 6 of ($b*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_91E08059 : FILE MEMORY {
    meta:
		description = "Identifies Post Ex module from Cobalt Strike"
		author = "Elastic Security"
		id = "91e08059-46a8-47d0-91c9-e86874951a4a"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L394-L421"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "d5a8c1a0baa5e915cff29bcac33e30a7d7260f938ecaa6171d3aa88425a69266"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "d8baacb58a3db00489827275ad6a2d007c018eaecbce469356b068d8a758634b"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "postex.x64.dll" ascii fullword
		$a2 = "postex.dll" ascii fullword
		$a3 = "RunAsAdminCMSTP" ascii fullword
		$a4 = "KerberosTicketPurge" ascii fullword
		$b1 = "GetSystem" ascii fullword
		$b2 = "HelloWorld" ascii fullword
		$b3 = "KerberosTicketUse" ascii fullword
		$b4 = "SpawnAsAdmin" ascii fullword
		$b5 = "RunAsAdmin" ascii fullword
		$b6 = "NetDomain" ascii fullword

	condition:
		2 of ($a*) or 4 of ($b*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_Ee756Db7 : FILE MEMORY {
    meta:
		description = "Attempts to detect Cobalt Strike based on strings found in BEACON"
		author = "Elastic Security"
		id = "ee756db7-e177-41f0-af99-c44646d334f7"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L423-L491"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "8d594aa1b889e80000cfcedbfc470a1b768bdcc2a9c436cd449b495c91011918"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "e589cc259644bc75d6c4db02a624c978e855201cf851c0d87f0d54685ce68f71"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "%s.4%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%x%x.%s" ascii fullword
		$a2 = "%s.3%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%x%x.%s" ascii fullword
		$a3 = "ppid %d is in a different desktop session (spawned jobs may fail). Use 'ppid' to reset." ascii fullword
		$a4 = "IEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:%u/'); %s" ascii fullword
		$a5 = "IEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:%u/')" ascii fullword
		$a6 = "%s.2%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%x%x.%s" ascii fullword
		$a7 = "could not run command (w/ token) because of its length of %d bytes!" ascii fullword
		$a8 = "%s.2%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x.%x%x.%s" ascii fullword
		$a9 = "%s.2%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x.%x%x.%s" ascii fullword
		$a10 = "powershell -nop -exec bypass -EncodedCommand \"%s\"" ascii fullword
		$a11 = "Could not open service control manager on %s: %d" ascii fullword
		$a12 = "%d is an x64 process (can't inject x86 content)" ascii fullword
		$a13 = "%d is an x86 process (can't inject x64 content)" ascii fullword
		$a14 = "Failed to impersonate logged on user %d (%u)" ascii fullword
		$a15 = "could not create remote thread in %d: %d" ascii fullword
		$a16 = "%s.1%08x%08x%08x%08x%08x%08x%08x.%x%x.%s" ascii fullword
		$a17 = "could not write to process memory: %d" ascii fullword
		$a18 = "Could not create service %s on %s: %d" ascii fullword
		$a19 = "Could not delete service %s on %s: %d" ascii fullword
		$a20 = "Could not open process token: %d (%u)" ascii fullword
		$a21 = "%s.1%08x%08x%08x%08x%08x%08x.%x%x.%s" ascii fullword
		$a22 = "Could not start service %s on %s: %d" ascii fullword
		$a23 = "Could not query service %s on %s: %d" ascii fullword
		$a24 = "Could not connect to pipe (%s): %d" ascii fullword
		$a25 = "%s.1%08x%08x%08x%08x%08x.%x%x.%s" ascii fullword
		$a26 = "could not spawn %s (token): %d" ascii fullword
		$a27 = "could not open process %d: %d" ascii fullword
		$a28 = "could not run %s as %s\\%s: %d" ascii fullword
		$a29 = "%s.1%08x%08x%08x%08x.%x%x.%s" ascii fullword
		$a30 = "kerberos ticket use failed:" ascii fullword
		$a31 = "Started service %s on %s" ascii fullword
		$a32 = "%s.1%08x%08x%08x.%x%x.%s" ascii fullword
		$a33 = "I'm already in SMB mode" ascii fullword
		$a34 = "could not spawn %s: %d" ascii fullword
		$a35 = "could not open %s: %d" ascii fullword
		$a36 = "%s.1%08x%08x.%x%x.%s" ascii fullword
		$a37 = "Could not open '%s'" ascii fullword
		$a38 = "%s.1%08x.%x%x.%s" ascii fullword
		$a39 = "%s as %s\\%s: %d" ascii fullword
		$a40 = "%s.1%x.%x%x.%s" ascii fullword
		$a41 = "beacon.x64.dll" ascii fullword
		$a42 = "%s on %s: %d" ascii fullword
		$a43 = "www6.%x%x.%s" ascii fullword
		$a44 = "cdn.%x%x.%s" ascii fullword
		$a45 = "api.%x%x.%s" ascii fullword
		$a46 = "%s (admin)" ascii fullword
		$a47 = "beacon.dll" ascii fullword
		$a48 = "%s%s: %s" ascii fullword
		$a49 = "@%d.%s" ascii fullword
		$a50 = "%02d/%02d/%02d %02d:%02d:%02d" ascii fullword
		$a51 = "Content-Length: %d" ascii fullword

	condition:
		6 of ($a*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_9C0D5561 : FILE MEMORY {
    meta:
		description = "Identifies PowerShell Runner module from Cobalt Strike"
		author = "Elastic Security"
		id = "9c0d5561-5b09-44ae-8e8c-336dee606199"
		date = "2021-03-23"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L493-L523"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "a8929266950e0f540a68c4fedf708e8ddc27f208f9f2866245ad7bb7f6d87913"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "01d53fcdb320f0cd468a2521c3e96dcb0b9aa00e7a7a9442069773c6b3759059"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "PowerShellRunner.dll" wide fullword
		$a2 = "powershell.x64.dll" ascii fullword
		$a3 = "powershell.dll" ascii fullword
		$a4 = "\\\\.\\pipe\\powershell" ascii fullword
		$b1 = "PowerShellRunner.PowerShellRunner" ascii fullword
		$b2 = "Failed to invoke GetOutput w/hr 0x%08lx" ascii fullword
		$b3 = "Failed to get default AppDomain w/hr 0x%08lx" ascii fullword
		$b4 = "ICLRMetaHost::GetRuntime (v4.0.30319) failed w/hr 0x%08lx" ascii fullword
		$b5 = "CustomPSHostUserInterface" ascii fullword
		$b6 = "RuntimeClrHost::GetCurrentAppDomainId failed w/hr 0x%08lx" ascii fullword
		$b7 = "ICorRuntimeHost::GetDefaultDomain failed w/hr 0x%08lx" ascii fullword
		$c1 = { 8B 08 50 FF 51 08 8B 7C 24 1C 8D 4C 24 10 51 C7 }
		$c2 = "z:\\devcenter\\aggressor\\external\\PowerShellRunner\\obj\\Release\\PowerShellRunner.pdb" ascii fullword

	condition:
		(1 of ($a*) and 4 of ($b*)) or 1 of ($c*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_59Ed9124 : FILE MEMORY {
    meta:
		description = "Identifies PsExec module from Cobalt Strike"
		author = "Elastic Security"
		id = "59ed9124-bc20-4ea6-b0a7-63ee3359e69c"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L525-L560"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "a50fd291f5f1bf7ec41b1938a32473a23c3c082018b86eab87aff0d95b26ba06"
		score = 75
		quality = 43
		tags = "FILE, MEMORY"
		fingerprint = "7823e3b98e55a83bf94b0f07e4c116dbbda35adc09fa0b367f8a978a80c2efff"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\psexec_command.x64.o" ascii fullword
		$a2 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\psexec_command.x86.o" ascii fullword
		$b1 = "__imp_BeaconDataExtract" ascii fullword
		$b2 = "__imp_BeaconDataParse" ascii fullword
		$b3 = "__imp_BeaconDataParse" ascii fullword
		$b4 = "__imp_BeaconDataParse" ascii fullword
		$b5 = "__imp_ADVAPI32$StartServiceA" ascii fullword
		$b6 = "__imp_ADVAPI32$DeleteService" ascii fullword
		$b7 = "__imp_ADVAPI32$QueryServiceStatus" ascii fullword
		$b8 = "__imp_ADVAPI32$CloseServiceHandle" ascii fullword
		$c1 = "__imp__BeaconDataExtract" ascii fullword
		$c2 = "__imp__BeaconDataParse" ascii fullword
		$c3 = "__imp__BeaconDataParse" ascii fullword
		$c4 = "__imp__BeaconDataParse" ascii fullword
		$c5 = "__imp__ADVAPI32$StartServiceA" ascii fullword
		$c6 = "__imp__ADVAPI32$DeleteService" ascii fullword
		$c7 = "__imp__ADVAPI32$QueryServiceStatus" ascii fullword
		$c8 = "__imp__ADVAPI32$CloseServiceHandle" ascii fullword

	condition:
		1 of ($a*) or 5 of ($b*) or 5 of ($c*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_8A791Eb7 : FILE MEMORY {
    meta:
		description = "Identifies Registry module from Cobalt Strike"
		author = "Elastic Security"
		id = "8a791eb7-dc0c-4150-9e5b-2dc21af0c77d"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L562-L597"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "d1765e6cac9b1560d6484baa1fa5a1bc0b768a72b389c7c6a60e34115669933e"
		score = 75
		quality = 43
		tags = "FILE, MEMORY"
		fingerprint = "4967886ba5e663f2e2dc0631939308d7d8f2194a30590a230973e1b91bd625e1"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\registry.x64.o" ascii fullword
		$a2 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\registry.x86.o" ascii fullword
		$b1 = "__imp_ADVAPI32$RegOpenKeyExA" ascii fullword
		$b2 = "__imp_ADVAPI32$RegEnumKeyA" ascii fullword
		$b3 = "__imp_ADVAPI32$RegOpenCurrentUser" ascii fullword
		$b4 = "__imp_ADVAPI32$RegCloseKey" ascii fullword
		$b5 = "__imp_BeaconFormatAlloc" ascii fullword
		$b6 = "__imp_BeaconOutput" ascii fullword
		$b7 = "__imp_BeaconFormatFree" ascii fullword
		$b8 = "__imp_BeaconDataPtr" ascii fullword
		$c1 = "__imp__ADVAPI32$RegOpenKeyExA" ascii fullword
		$c2 = "__imp__ADVAPI32$RegEnumKeyA" ascii fullword
		$c3 = "__imp__ADVAPI32$RegOpenCurrentUser" ascii fullword
		$c4 = "__imp__ADVAPI32$RegCloseKey" ascii fullword
		$c5 = "__imp__BeaconFormatAlloc" ascii fullword
		$c6 = "__imp__BeaconOutput" ascii fullword
		$c7 = "__imp__BeaconFormatFree" ascii fullword
		$c8 = "__imp__BeaconDataPtr" ascii fullword

	condition:
		1 of ($a*) or 5 of ($b*) or 5 of ($c*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_D00573A3 : FILE MEMORY {
    meta:
		description = "Identifies Screenshot module from Cobalt Strike"
		author = "Elastic Security"
		id = "d00573a3-db26-4e6b-aabf-7af4a818f383"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L599-L625"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "e458d41d28b76c989af6385f183f33aa9e11b93e529f032e95bd75433b80bd69"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b6fa0792b99ea55f359858d225685647f54b55caabe53f58b413083b8ad60e79"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "screenshot.x64.dll" ascii fullword
		$a2 = "screenshot.dll" ascii fullword
		$a3 = "\\\\.\\pipe\\screenshot" ascii fullword
		$b1 = "1I1n1Q3M5Q5U5Y5]5a5e5i5u5{5" ascii fullword
		$b2 = "GetDesktopWindow" ascii fullword
		$b3 = "CreateCompatibleBitmap" ascii fullword
		$b4 = "GDI32.dll" ascii fullword
		$b5 = "ReflectiveLoader"
		$b6 = "Adobe APP14 marker: version %d, flags 0x%04x 0x%04x, transform %d" ascii fullword

	condition:
		2 of ($a*) or 5 of ($b*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_7Bcd759C : FILE MEMORY {
    meta:
		description = "Identifies SSH Agent module from Cobalt Strike"
		author = "Elastic Security"
		id = "7bcd759c-8e3d-4559-9381-1f4fe8b3dd95"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L627-L648"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "bfbb8e8009182e87c49242ec3da6e98b23447b646f5c7ea5f97196ae929d7c5f"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "553085f1d1ca8dcd797360b287951845753eee7370610a1223c815a200a5ed20"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "sshagent.x64.dll" ascii fullword
		$a2 = "sshagent.dll" ascii fullword
		$b1 = "\\\\.\\pipe\\sshagent" ascii fullword
		$b2 = "\\\\.\\pipe\\PIPEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii fullword

	condition:
		1 of ($a*) and 1 of ($b*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_A56B820F : FILE MEMORY {
    meta:
		description = "Identifies Timestomp module from Cobalt Strike"
		author = "Elastic Security"
		id = "a56b820f-0a20-4054-9c2d-008862646a78"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L650-L685"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "52de8110727c29b0f5c75cd470ce6b80ba7821d0ba78ad074536323e2e80b460"
		score = 75
		quality = 43
		tags = "FILE, MEMORY"
		fingerprint = "5418e695bcb1c37e72a7ff24a39219dc12b3fe06c29cedefd500c5e82c362b6d"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\timestomp.x64.o" ascii fullword
		$a2 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\timestomp.x86.o" ascii fullword
		$b1 = "__imp_KERNEL32$GetFileTime" ascii fullword
		$b2 = "__imp_KERNEL32$SetFileTime" ascii fullword
		$b3 = "__imp_KERNEL32$CloseHandle" ascii fullword
		$b4 = "__imp_KERNEL32$CreateFileA" ascii fullword
		$b5 = "__imp_BeaconDataExtract" ascii fullword
		$b6 = "__imp_BeaconPrintf" ascii fullword
		$b7 = "__imp_BeaconDataParse" ascii fullword
		$b8 = "__imp_BeaconDataExtract" ascii fullword
		$c1 = "__imp__KERNEL32$GetFileTime" ascii fullword
		$c2 = "__imp__KERNEL32$SetFileTime" ascii fullword
		$c3 = "__imp__KERNEL32$CloseHandle" ascii fullword
		$c4 = "__imp__KERNEL32$CreateFileA" ascii fullword
		$c5 = "__imp__BeaconDataExtract" ascii fullword
		$c6 = "__imp__BeaconPrintf" ascii fullword
		$c7 = "__imp__BeaconDataParse" ascii fullword
		$c8 = "__imp__BeaconDataExtract" ascii fullword

	condition:
		1 of ($a*) or 5 of ($b*) or 5 of ($c*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_92F05172 : FILE MEMORY {
    meta:
		description = "Identifies UAC cmstp module from Cobalt Strike"
		author = "Elastic Security"
		id = "92f05172-f15c-4077-a958-b8490378bf08"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L687-L716"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "7f0ff4ee14a043d72810826ab9d2b90b0f66724550ba9d3cdd2abe749f4874d0"
		score = 75
		quality = 63
		tags = "FILE, MEMORY"
		fingerprint = "09b1f7087d45fb4247a33ae3112910bf5426ed750e1e8fe7ba24a9047b76cc82"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\uaccmstp.x64.o" ascii fullword
		$a2 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\uaccmstp.x86.o" ascii fullword
		$b1 = "elevate_cmstp" ascii fullword
		$b2 = "$pdata$elevate_cmstp" ascii fullword
		$b3 = "$unwind$elevate_cmstp" ascii fullword
		$c1 = "_elevate_cmstp" ascii fullword
		$c2 = "__imp__OLE32$CoGetObject@16" ascii fullword
		$c3 = "__imp__KERNEL32$GetModuleFileNameA@12" ascii fullword
		$c4 = "__imp__KERNEL32$GetSystemWindowsDirectoryA@8" ascii fullword
		$c5 = "OLDNAMES"
		$c6 = "__imp__BeaconDataParse" ascii fullword
		$c7 = "_willAutoElevate" ascii fullword

	condition:
		1 of ($a*) or 3 of ($b*) or 4 of ($c*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_417239B5 : FILE MEMORY {
    meta:
		description = "Identifies UAC token module from Cobalt Strike"
		author = "Elastic Security"
		id = "417239b5-cf2d-4c85-a022-7a8459c26793"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L718-L764"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "fda252747359e677459d82d65c4c9c8f2ff80bc8fd6a38712f858039f3cb8dd1"
		score = 75
		quality = 51
		tags = "FILE, MEMORY"
		fingerprint = "292afee829e838f9623547f94d0561e8a9115ce7f4c40ae96c6493f3cc5ffa9b"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\uactoken.x64.o" ascii fullword
		$a2 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\uactoken.x86.o" ascii fullword
		$a3 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\uactoken2.x64.o" ascii fullword
		$a4 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\uactoken2.x86.o" ascii fullword
		$b1 = "$pdata$is_admin_already" ascii fullword
		$b2 = "$unwind$is_admin" ascii fullword
		$b3 = "$pdata$is_admin" ascii fullword
		$b4 = "$unwind$is_admin_already" ascii fullword
		$b5 = "$pdata$RunAsAdmin" ascii fullword
		$b6 = "$unwind$RunAsAdmin" ascii fullword
		$b7 = "is_admin_already" ascii fullword
		$b8 = "is_admin" ascii fullword
		$b9 = "process_walk" ascii fullword
		$b10 = "get_current_sess" ascii fullword
		$b11 = "elevate_try" ascii fullword
		$b12 = "RunAsAdmin" ascii fullword
		$b13 = "is_ctfmon" ascii fullword
		$c1 = "_is_admin_already" ascii fullword
		$c2 = "_is_admin" ascii fullword
		$c3 = "_process_walk" ascii fullword
		$c4 = "_get_current_sess" ascii fullword
		$c5 = "_elevate_try" ascii fullword
		$c6 = "_RunAsAdmin" ascii fullword
		$c7 = "_is_ctfmon" ascii fullword
		$c8 = "_reg_query_dword" ascii fullword
		$c9 = ".drectve" ascii fullword
		$c10 = "_is_candidate" ascii fullword
		$c11 = "_SpawnAsAdmin" ascii fullword
		$c12 = "_SpawnAsAdminX64" ascii fullword

	condition:
		1 of ($a*) or 9 of ($b*) or 7 of ($c*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_29374056 : FILE MEMORY {
    meta:
		description = "Identifies Cobalt Strike MZ Reflective Loader."
		author = "Elastic Security"
		id = "29374056-03ce-484b-8b2d-fbf75be86e27"
		date = "2021-03-23"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L766-L785"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "09755b23a7057c70f3ea242ec48549de65ebc6f13bdc38cbe22d6d758c3718cf"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "4cd7552a499687ac0279fb2e25722f979fc5a22afd1ea4abba14a2ef2002dd0f"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 4D 5A 41 52 55 48 89 E5 48 81 EC 20 00 00 00 48 8D 1D ?? FF FF FF 48 81 C3 ?? ?? 00 00 FF D3 }
		$a2 = { 4D 5A E8 00 00 00 00 5B 89 DF 52 45 55 89 E5 }

	condition:
		1 of ($a*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_949F10E3 : FILE MEMORY {
    meta:
		description = "Identifies the API address lookup function used by Cobalt Strike along with XOR implementation by Cobalt Strike."
		author = "Elastic Security"
		id = "949f10e3-68c9-4600-a620-ed3119e09257"
		date = "2021-03-25"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L787-L806"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "e4b726c83013f4b9c9d61683f78a4a91935225e9ed3de0ce164b96b5a6719579"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "34e04901126a91c866ebf61a61ccbc3ce0477d9614479c42d8ce97a98f2ce2a7"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 89 E5 31 D2 64 8B 52 30 8B 52 0C 8B 52 14 8B 72 28 0F B7 4A 26 31 FF 31 C0 AC 3C 61 }
		$a2 = { 8B 07 01 C3 85 C0 75 E5 58 C3 E8 [2] FF FF 31 39 32 2E 31 36 38 2E ?? 2E }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_8751Cdf9 : FILE MEMORY {
    meta:
		description = "Identifies Cobalt Strike wininet reverse shellcode along with XOR implementation by Cobalt Strike."
		author = "Elastic Security"
		id = "8751cdf9-4038-42ba-a6eb-f8ac579a4fbb"
		date = "2021-03-25"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L808-L827"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "64fae95fd89ad46a50a00c943cf98a997a0842a83be64b3728b25151867b75a8"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0988386ef4ba54dd90b0cf6d6a600b38db434e00e569d69d081919cdd3ea4d3f"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 99
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 68 6E 65 74 00 68 77 69 6E 69 54 68 4C 77 26 07 }
		$a2 = { 8B 07 01 C3 85 C0 75 E5 58 C3 E8 [2] FF FF 31 39 32 2E 31 36 38 2E ?? 2E }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_663Fc95D : FILE MEMORY {
    meta:
		description = "Identifies CobaltStrike via unidentified function code"
		author = "Elastic Security"
		id = "663fc95d-2472-4d52-ad75-c5d86cfc885f"
		date = "2021-04-01"
		modified = "2021-12-17"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L829-L847"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "842a0a372cfb2316293f4a08e1690194fa98368a9f6ffe9c63222b2c4ab6532c"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "d0f781d7e485a7ecfbbfd068601e72430d57ef80fc92a993033deb1ddcee5c48"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 48 89 5C 24 08 57 48 83 EC 20 48 8B 59 10 48 8B F9 48 8B 49 08 FF 17 33 D2 41 B8 00 80 00 00 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_B54B94Ac : FILE MEMORY {
    meta:
		description = "Rule for beacon sleep obfuscation routine"
		author = "Elastic Security"
		id = "b54b94ac-6ef8-4ee9-a8a6-f7324c1974ca"
		date = "2021-10-21"
		modified = "2022-01-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L849-L872"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "36d32b1ed967f07a4bd19f5e671294d5359009c04835601f2cc40fb8b54f6a2a"
		logic_hash = "6f63e4c31e55da2008f95e9d05391e40d44e2757c511e666032563ab798e274c"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "2344dd7820656f18cfb774a89d89f5ab65d46cc7761c1f16b7e768df66aa41c8"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a_x64 = { 4C 8B 53 08 45 8B 0A 45 8B 5A 04 4D 8D 52 08 45 85 C9 75 05 45 85 DB 74 33 45 3B CB 73 E6 49 8B F9 4C 8B 03 }
		$a_x64_smbtcp = { 4C 8B 07 B8 4F EC C4 4E 41 F7 E1 41 8B C1 C1 EA 02 41 FF C1 6B D2 0D 2B C2 8A 4C 38 10 42 30 0C 06 48 }
		$a_x86 = { 8B 46 04 8B 08 8B 50 04 83 C0 08 89 55 08 89 45 0C 85 C9 75 04 85 D2 74 23 3B CA 73 E6 8B 06 8D 3C 08 33 D2 }
		$a_x86_2 = { 8B 06 8D 3C 08 33 D2 6A 0D 8B C1 5B F7 F3 8A 44 32 08 30 07 41 3B 4D 08 72 E6 8B 45 FC EB C7 }
		$a_x86_smbtcp = { 8B 07 8D 34 08 33 D2 6A 0D 8B C1 5B F7 F3 8A 44 3A 08 30 06 41 3B 4D 08 72 E6 8B 45 FC EB }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_F0B627Fc : FILE MEMORY {
    meta:
		description = "Rule for beacon reflective loader"
		author = "Elastic Security"
		id = "f0b627fc-97cd-42cb-9eae-1efb0672762d"
		date = "2021-10-21"
		modified = "2022-01-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L874-L897"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "b362951abd9d96d5ec15d281682fa1c8fe8f8e4e2f264ca86f6b061af607f79b"
		logic_hash = "1087294af3a9ef59c00098f5fd7adfe0b335525e135d95e45ac30e44c6739a72"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "fbc94bedd50b5b943553dd438a183a1e763c098a385ac3a4fc9ff24ee30f91e1"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$beacon_loader_x64 = { 25 FF FF FF 00 3D 41 41 41 00 75 [5-10] 25 FF FF FF 00 3D 42 42 42 00 75 }
		$beacon_loader_x86 = { 25 FF FF FF 00 3D 41 41 41 00 75 [4-8] 81 E1 FF FF FF 00 81 F9 42 42 42 00 75 }
		$beacon_loader_x86_2 = { 81 E1 FF FF FF 00 81 F9 41 41 41 00 75 [4-8] 81 E2 FF FF FF 00 81 FA 42 42 42 00 75 }
		$generic_loader_x64 = { 89 44 24 20 48 8B 44 24 40 0F BE 00 8B 4C 24 20 03 C8 8B C1 89 44 24 20 48 8B 44 24 40 48 FF C0 }
		$generic_loader_x86 = { 83 C4 04 89 45 FC 8B 4D 08 0F BE 11 03 55 FC 89 55 FC 8B 45 08 83 C0 01 89 45 08 8B 4D 08 0F BE }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_Dcdcdd8C : FILE MEMORY {
    meta:
		description = "Rule for beacon sleep PDB"
		author = "Elastic Security"
		id = "dcdcdd8c-7395-4453-a74a-60ab8e251a5a"
		date = "2021-10-21"
		modified = "2022-01-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L899-L923"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "36d32b1ed967f07a4bd19f5e671294d5359009c04835601f2cc40fb8b54f6a2a"
		logic_hash = "f3ae07282b763d3720e45a84878cc457f65041f381951cdc9affd5e3ce67e6cc"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "8aed1ae470d06a7aac37896df22b2f915c36845099839a85009212d9051f71e9"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Z:\\devcenter\\aggressor\\external\\sleepmask\\bin\\sleepmask.x64.o" ascii fullword
		$a2 = "Z:\\devcenter\\aggressor\\external\\sleepmask\\bin\\sleepmask.x86.o" ascii fullword
		$a3 = "Z:\\devcenter\\aggressor\\external\\sleepmask\\bin\\sleepmask_smb.x64.o" ascii fullword
		$a4 = "Z:\\devcenter\\aggressor\\external\\sleepmask\\bin\\sleepmask_smb.x86.o" ascii fullword
		$a5 = "Z:\\devcenter\\aggressor\\external\\sleepmask\\bin\\sleepmask_tcp.x64.o" ascii fullword
		$a6 = "Z:\\devcenter\\aggressor\\external\\sleepmask\\bin\\sleepmask_tcp.x86.o" ascii fullword

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_A3Fb2616 : FILE MEMORY {
    meta:
		description = "Rule for browser pivot "
		author = "Elastic Security"
		id = "a3fb2616-b03d-4399-9342-0fc684fb472e"
		date = "2021-10-21"
		modified = "2022-01-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L925-L947"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "36d32b1ed967f07a4bd19f5e671294d5359009c04835601f2cc40fb8b54f6a2a"
		logic_hash = "a3c36326ccc2bc828f6654ccaba507a283f92146fdc52f71d7d934f6908793e2"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "c15cf6aa7719dac6ed21c10117f28eb4ec56335f80a811b11ab2901ad36f8cf0"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "browserpivot.dll" ascii fullword
		$a2 = "browserpivot.x64.dll" ascii fullword
		$b1 = "$$$THREAD.C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$" ascii fullword
		$b2 = "COBALTSTRIKE" ascii fullword

	condition:
		1 of ($a*) and 2 of ($b*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_8Ee55Ee5 : FILE MEMORY {
    meta:
		description = "Rule for wmi exec module"
		author = "Elastic Security"
		id = "8ee55ee5-67f1-4f94-ab93-62bb5cfbeee9"
		date = "2021-10-21"
		modified = "2022-01-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L949-L969"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "36d32b1ed967f07a4bd19f5e671294d5359009c04835601f2cc40fb8b54f6a2a"
		logic_hash = "d0cc321e15660311ae0b8e3261abe716a50a2455f82635c1b02d0a5444c8a89a"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "7e7ed4f00d0914ce0b9f77b6362742a9c8b93a16a6b2a62b70f0f7e15ba3a72b"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Z:\\devcenter\\aggressor\\external\\pxlib\\bin\\wmiexec.x64.o" ascii fullword
		$a2 = "z:\\devcenter\\aggressor\\external\\pxlib\\bin\\wmiexec.x86.o" ascii fullword

	condition:
		1 of ($a*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_8D5963A2 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Cobaltstrike (Windows.Trojan.CobaltStrike)"
		author = "Elastic Security"
		id = "8d5963a2-54a9-4705-9f34-0d5f8e6345a2"
		date = "2022-08-10"
		modified = "2022-09-29"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L971-L989"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "9fe43996a5c4e99aff6e2a1be743fedec35e96d1e6670579beb4f7e7ad591af9"
		logic_hash = "f4f8fba807256bd885ccf4946eec8c2fb76eb04f86ed76d015178fe512a3c091"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "228cd65380cf4b04f9fd78e8c30c3352f649ce726202e2dac9f1a96211925e1c"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 40 55 53 56 57 41 54 41 55 41 56 41 57 48 8D 6C 24 D8 48 81 EC 28 01 00 00 45 33 F6 48 8B D9 48 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_1787Eef5 : FILE MEMORY {
    meta:
		description = "CS shellcode variants"
		author = "Elastic Security"
		id = "1787eef5-ff00-4e19-bd22-c5dfc9488c7b"
		date = "2022-08-29"
		modified = "2022-09-29"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L991-L1014"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "36d32b1ed967f07a4bd19f5e671294d5359009c04835601f2cc40fb8b54f6a2a"
		logic_hash = "0b70c61e986dee3126fec6eea127e01fce4b647aff8e2d2d5072eb8328549225"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "292f15bdc978fc29670126f1bdc72ade1e7faaf1948653f70b6789a82dbee67f"
		threat_name = "Windows.Trojan.CobaltStrike"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 55 89 E5 83 EC ?? A1 ?? ?? ?? ?? C7 04 24 ?? ?? ?? ?? 89 44 24 ?? E8 ?? ?? ?? ?? 31 C0 C9 C3 55 }
		$a2 = { 55 89 E5 83 EC ?? A1 ?? ?? ?? ?? 89 04 24 E8 ?? ?? ?? ?? 31 C0 C9 C3 55 89 E5 83 EC ?? 83 7D ?? ?? }
		$a3 = { 55 89 E5 8B 45 ?? 5D FF E0 55 8B 15 ?? ?? ?? ?? 89 E5 8B 45 ?? 85 D2 7E ?? 83 3D ?? ?? ?? ?? ?? }
		$a4 = { 55 89 E5 8B 45 ?? 5D FF E0 55 89 E5 83 EC ?? 8B 15 ?? ?? ?? ?? 8B 45 ?? 85 D2 7E ?? 83 3D ?? ?? ?? ?? ?? }
		$a5 = { 4D 5A 41 52 55 48 89 E5 48 81 EC ?? ?? ?? ?? 48 8D 1D ?? ?? ?? ?? 48 89 DF 48 81 C3 ?? ?? ?? ?? }

	condition:
		1 of ($a*)
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_4106070A : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Cobaltstrike (Windows.Trojan.CobaltStrike)"
		author = "Elastic Security"
		id = "4106070a-24e2-421b-ab83-67b817a9f019"
		date = "2023-05-09"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L1016-L1035"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "98789a11c06c1dfff7e02f66146afca597233c17e0d4900d6a683a150f16b3a4"
		logic_hash = "90f0209a55ca381ca58264664e04c007c799cf558f143d0c02983d4caf47bfb8"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "c12b919064a9cd2a603c134c5f73f6d05ffbf4cbed1e5b5246687378102e4338"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 48 8B 44 24 48 0F B7 00 66 C1 E8 0C 66 83 E0 0F 0F B7 C0 83 }
		$a2 = { 44 24 48 0F B7 00 66 C1 E8 0C 66 83 E0 0F 0F B7 C0 83 F8 0A }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_3Dc22D14 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Cobaltstrike (Windows.Trojan.CobaltStrike)"
		author = "Elastic Security"
		id = "3dc22d14-a2f4-49cd-a3a8-3f071eddf028"
		date = "2023-05-09"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L1037-L1056"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "7898194ae0244611117ec948eb0b0a5acbc15cd1419b1ecc553404e63bc519f9"
		logic_hash = "2f52cd5f3b782c28e372c3daa9b7ddc4d2b9f68832f5250983412c2e7a755e73"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0e029fac50ffe8ea3fc5bc22290af69e672895eaa8a1b9f3e9953094c133392c"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "%02d/%02d/%02d %02d:%02d:%02d" fullword
		$a2 = "%s as %s\\%s: %d" fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Cobaltstrike_7F8Da98A : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Cobaltstrike (Windows.Trojan.CobaltStrike)"
		author = "Elastic Security"
		id = "7f8da98a-3336-482b-91da-82c7cef34c62"
		date = "2023-05-09"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_CobaltStrike.yar#L1058-L1076"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "e3bc2bec4a55ad6cfdf49e5dbd4657fc704af1758ca1d6e31b83dcfb8bf0f89d"
		logic_hash = "6c8698d65cbbf893f79ca1de5273535891418c87c234a2542f5f8079e56d9507"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "c375492960a6277bf665bea86302cec774c0d79506e5cb2e456ce59f5e68aa2e"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 25 63 25 63 25 63 25 63 25 63 25 63 25 63 25 63 25 63 4D 53 53 45 2D 25 64 2D 73 65 72 76 65 72 }

	condition:
		all of them
}
rule ELASTIC_Windows_Exploit_Perfusion_5Ab5Ddee : FILE MEMORY {
    meta:
		description = "Detects Windows Exploit Perfusion (Windows.Exploit.Perfusion)"
		author = "Elastic Security"
		id = "5ab5ddee-e79b-4f1c-bd60-92793f14e490"
		date = "2024-02-28"
		modified = "2024-03-21"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Exploit_Perfusion.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "7fdef25acb0d1447203b9768ae58a8e21db24816c602b160d105dab86ae34728"
		logic_hash = "490f3fc89cf78dbe82f1feb012a147a8d187612720efb6e1eb4e97720b26ee59"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "c8d13213b20fc99dd71034ddae986c71f6e89f632655e88d5f9c8be1d72c6231"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$s1 = "SYSTEM\\CurrentControlSet\\Services\\%ws\\Performance" wide
		$s2 = "Win32_Perf" wide
		$s3 = "CollectPerfData" wide
		$s4 = "%wsperformance_%d_%d_%d.dll" wide

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Svcready_Af498D39 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Svcready (Windows.Trojan.SVCReady)"
		author = "Elastic Security"
		id = "af498d39-6ae8-46de-ad6c-81b346d80139"
		date = "2022-06-12"
		modified = "2022-07-18"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_SVCReady.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "08e427c92010a8a282c894cf5a77a874e09c08e283a66f1905c131871cc4d273"
		logic_hash = "e3520103064cf82cd1747f8889667929d23466c9febfda7e4968a3679db97d71"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "6e30d9977698c7864a8c264a7fe8c9a558f6e51dda9c887bda94261ce187645f"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "RunPEDllNative::HookNtCreateUserProcess fail: targetMapping.valid" ascii fullword
		$a2 = "Section Mapping error:Process=0x%x Section [%s] res[0x%x] != va[0x%x] Status:%u" ascii fullword
		$a3 = "%s - %I64d < %I64d > %I64d clicks, %I64d pixels, ready=%i" ascii fullword
		$a4 = "Svc:windowThreadRunner done" ascii fullword
		$a5 = "svc commonMain" ascii fullword

	condition:
		4 of them
}
rule ELASTIC_Windows_Ransomware_Phobos_A5420148 : BETA FILE MEMORY {
    meta:
		description = "Identifies Phobos ransomware"
		author = "Elastic Security"
		id = "a5420148-2f80-4a14-8a0d-98943fcbe784"
		date = "2020-06-25"
		modified = "2021-08-23"
		reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.phobos"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Phobos.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "9fcfe41102bee4f8ecf19f30d0bbb2de50e1a1aff4e17c587b5d9adb417527c5"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "2b3937dbecb9a12e5e276c681eb40cb3884411a048175fcfe1bd4be3f7611aca"
		threat_name = "Windows.Ransomware.Phobos"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 61 00 63 00 75 00 74 00 65 00 00 00 61 00 63 00 74 00 69 00 6E 00 00 00 61 00 63 00 74 00 6F 00 6E 00 00 00 61 00 63 00 74 00 6F 00 72 00 00 00 61 00 63 00 75 00 66 00 66 00 00 }
		$a2 = { 0C 6D 00 73 00 66 00 74 00 65 00 73 00 71 00 6C 00 2E 00 65 00 78 00 65 00 00 00 73 00 71 00 6C 00 61 00 67 00 65 00 6E 00 74 00 2E 00 65 00 78 00 65 00 00 00 73 00 71 00 6C 00 62 00 72 00 6F 00 77 00 73 00 65 00 72 00 2E 00 65 00 78 00 65 00 00 00 73 00 71 00 6C 00 73 00 65 00 72 00 76 00 72 00 2E 00 65 00 78 00 65 00 00 00 73 00 71 00 6C 00 77 00 72 00 69 00 74 00 65 00 72 00 2E 00 65 00 78 00 65 00 00 00 6F 00 72 00 61 00 63 00 6C 00 65 00 2E 00 65 00 78 00 }
		$a3 = { 31 00 63 00 64 00 00 00 33 00 64 00 73 00 00 00 33 00 66 00 72 00 00 00 33 00 67 00 32 00 00 00 33 00 67 00 70 00 00 00 37 00 7A 00 00 00 61 00 63 00 63 00 64 00 61 00 00 00 61 00 63 00 63 00 64 00 62 00 00 00 61 00 63 00 63 00 64 00 63 00 00 00 61 00 63 00 63 00 64 00 65 00 00 00 61 00 63 00 63 00 64 00 74 00 00 00 61 00 63 00 63 00 64 00 77 00 00 00 61 00 64 00 62 00 00 00 61 00 64 00 70 00 00 00 61 00 69 00 00 00 61 00 69 00 33 00 00 00 61 00 69 00 34 00 00 00 61 00 69 00 35 00 00 00 61 00 69 00 36 00 00 00 61 00 69 00 37 00 00 00 61 00 69 00 38 00 00 00 61 00 6E 00 69 00 6D 00 00 00 61 00 72 00 77 00 00 00 61 00 73 00 00 00 61 00 73 00 61 00 00 00 61 00 73 00 63 00 00 00 61 00 73 00 63 00 78 00 00 00 61 00 73 00 6D 00 00 00 61 00 73 00 6D 00 78 00 00 00 61 00 73 00 70 00 00 00 61 00 73 00 70 00 78 00 00 00 61 00 73 00 72 00 00 00 61 00 73 00 78 00 00 00 61 00 76 00 69 00 00 00 61 00 76 00 73 00 00 00 62 00 61 00 63 00 6B 00 75 00 70 00 00 00 62 00 61 00 6B 00 00 00 62 00 61 00 79 00 00 00 62 00 64 00 00 00 62 00 69 00 6E 00 00 00 62 00 6D 00 70 00 00 00 }

	condition:
		2 of ($a*)
}
rule ELASTIC_Windows_Ransomware_Phobos_Ff55774D : BETA FILE MEMORY {
    meta:
		description = "Identifies Phobos ransomware"
		author = "Elastic Security"
		id = "ff55774d-4425-4243-8156-ce029c1d5860"
		date = "2020-06-25"
		modified = "2021-08-23"
		reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.phobos"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Phobos.yar#L24-L43"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "9ee41b9638a8cc1d9f9b254878c935c531b2f599be59550b3617b1de8cba2ba5"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "d8016c9be4a8e5b5ac32b7108542fee8426d65b4d37e2a9c5ad57284abb3781e"
		threat_name = "Windows.Ransomware.Phobos"
		severity = 90
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$c1 = { 24 18 83 C4 0C 8B 4F 0C 03 C6 50 8D 54 24 18 52 51 6A 00 6A 00 89 44 }

	condition:
		1 of ($c*)
}
rule ELASTIC_Windows_Ransomware_Phobos_11Ea7Be5 : BETA FILE MEMORY {
    meta:
		description = "Identifies Phobos ransomware"
		author = "Elastic Security"
		id = "11ea7be5-7aac-41d7-8d09-45131a9c656e"
		date = "2020-06-25"
		modified = "2021-08-23"
		reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.phobos"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Phobos.yar#L45-L64"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "1f86695f316200c92d0d02f5f3ba9f68854978f98db5d4291a81c06c9f0b8d28"
		score = 75
		quality = 75
		tags = "BETA, FILE, MEMORY"
		fingerprint = "a264f93e085134e5114c5d72e1bf93e70935e33756a79f1021e9c1e71d6c8697"
		threat_name = "Windows.Ransomware.Phobos"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$b1 = { C0 74 30 33 C0 40 8B CE D3 E0 85 C7 74 19 66 8B 04 73 66 89 }

	condition:
		1 of ($b*)
}
rule ELASTIC_Windows_Hacktool_Sharpapplocker_9645Cf22 : FILE MEMORY {
    meta:
		description = "Detects Windows Hacktool Sharpapplocker (Windows.Hacktool.SharpAppLocker)"
		author = "Elastic Security"
		id = "9645cf22-f9b3-45ff-a5d8-513c59ad3d53"
		date = "2022-11-20"
		modified = "2023-01-11"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Hacktool_SharpAppLocker.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0f7390905abc132889f7b9a6d5b42701173aafbff5b8f8882397af35d8c10965"
		logic_hash = "cb72ecf7715b288acddac51dab091d84c64e3bd30276cba38a0d773e6693875c"
		score = 75
		quality = 73
		tags = "FILE, MEMORY"
		fingerprint = "720a96f7baa8af4e6189709ee906350c291e175ac861c83d425b235d9217bb32"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$guid = "FE102D27-DEC4-42E2-BF69-86C79E08B67D" ascii wide nocase
		$print_str0 = "[+] Output written to:" ascii wide fullword
		$print_str1 = "[!] You can only select one Policy at the time." ascii wide fullword
		$print_str2 = "SharpAppLocker.exe --effective --allow --rules=\"FileHashRule,FilePathRule\" --outfile=\"C:\\Windows\\Tasks\\Rules.json\"" ascii wide fullword

	condition:
		$guid or all of ($print_str*)
}
rule ELASTIC_Windows_Trojan_Ghostengine_8Ea2Aa65 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Ghostengine (Windows.Trojan.GhostEngine)"
		author = "Elastic Security"
		id = "8ea2aa65-d7e2-4c58-9f95-3194cd8b6990"
		date = "2024-05-07"
		modified = "2024-05-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_GhostEngine.yar#L1-L26"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "2fe78941d74d35f721556697491a438bf3573094d7ac091b42e4f59ecbd25753"
		logic_hash = "3bddd2ac79d92d34df5d2df4a11cf96cc44ca39c3baece1b5c67b75a682778ff"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "17c4c2fa2d412b79ee197de1e6bd6a4c882ad894be54a780e540627a570756e5"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$str0 = "\\\\.\\IOBitUnlockerDevice"
		$str1 = "C:\\Windows\\Fonts\\taskhostw.exe"
		$str2 = "C:\\Windows\\Fonts\\config.json"
		$str3 = "/drives/kill.png"
		$str4 = "C:\\Windows\\Fonts\\WinRing0x64.sys"
		$str5 = "C:\\Windows\\Fonts\\smartsscreen.exe"
		$binary0 = { 89 C2 C1 E8 1F C1 E0 1F 85 C0 0F 84 74 01 00 00 D1 E2 89 CB C1 E9 1F 09 D1 D1 E3 C1 EB 1F 89 CA D1 E1 09 D9 89 CB 81 C1 80 7F B1 D7 C1 EA 1F 81 C3 80 7F B1 D7 83 D2 0D 81 C1 00 09 6E 88 89 4C 24 20 83 D2 F1 89 54 24 24 }
		$binary1 = { 83 F9 06 0F ?? ?? ?? ?? ?? 8B 10 81 FA 78 38 36 5F 0F 85 ?? ?? ?? ?? 0F B7 50 04 66 81 FA 36 34 74 ?? E9 ?? ?? 00 00 C7 04 24 00 E4 0B 54 C7 44 24 04 02 00 00 00 }

	condition:
		3 of ($str*) or 1 of ($binary*)
}
rule ELASTIC_Windows_Trojan_Azorult_38Fce9Ea : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Azorult (Windows.Trojan.Azorult)"
		author = "Elastic Security"
		id = "38fce9ea-a94e-49d3-8eef-96fe06ad27f8"
		date = "2021-08-05"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Azorult.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "405d1e6196dc5be1f46a1bd07c655d1d4b36c32f965d9a1b6d4859d3f9b84491"
		logic_hash = "e23b21992b7ff577d4521c733929638522f4bf57b54c72e5e46196d028d6be26"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0655018fc803469c6d89193b75b4967fd02400fae07364ffcd11d1bc6cbbe74a"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "/c %WINDIR%\\system32\\timeout.exe 3 & del \"" wide fullword
		$a2 = "%APPDATA%\\.purple\\accounts.xml" wide fullword
		$a3 = "%TEMP%\\curbuf.dat" wide fullword
		$a4 = "PasswordsList.txt" ascii fullword
		$a5 = "Software\\Valve\\Steam" wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Exploit_Fakepipe_6Bc93551 : FILE MEMORY {
    meta:
		description = "Detects Windows Exploit Fakepipe (Windows.Exploit.FakePipe)"
		author = "Elastic Security"
		id = "6bc93551-b528-464b-8f1f-06db58c1cb01"
		date = "2024-02-28"
		modified = "2024-03-21"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Exploit_FakePipe.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "545a41ccfcd0a4f09c1c62bef2dde61b52fa92abada71ab72b3f4febb9265f75"
		logic_hash = "daf78c4a2db337f51054e108b5b54c8aa32300eae3bd39c5fc2d4769221c8aea"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "e2e31171486ee71bff9450966ba7b68dd0013856f1bda9ff7a30270855332c44"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$api = "ImpersonateNamedPipeClient"
		$s1 = "\\\\.\\pipe\\%ws\\pipe\\" wide nocase
		$s2 = "\\\\.\\pipe\\%s\\pipe\\" wide nocase
		$s3 = { 5C 00 5C 00 2E 00 5C 00 70 00 69 00 70 00 65 00 5C 00 00 19 5C 00 70 00 69 00 70 00 65 00 5C }

	condition:
		$api and any of ($s*)
}
rule ELASTIC_Windows_Ransomware_Cicada3301_99Fee259 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Cicada3301 (Windows.Ransomware.Cicada3301)"
		author = "Elastic Security"
		id = "99fee259-6633-40f9-824b-49a7aa692753"
		date = "2024-09-05"
		modified = "2024-09-30"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Cicada3301.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "7b3022437b637c44f42741a92c7f7ed251845fd02dda642c0a47fde179bd984e"
		logic_hash = "18996d70192b0e997eba70c22ed70a2611a7e038a8825308f4d3d002b681939b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "d1bf61f2bf824f8620db6862efa45a0b32266da6de658fad8c81cba347cb2080"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "sqldocrtfxlsjpgjpegpnggifwebptiffpsdrawbmppdfdocxdocmdotxdotmodtxlsxxlsmxltxxltmxlsbx"
		$a2 = "keypathhelpsleepno_implno_localno_netno_notesno_iconno_desktop" ascii fullword
		$a3 = "RECOVER--DATA.txt" ascii fullword
		$a4 = "CMD_BCDEDIT_SET_RECOVERY_DISABLED"
		$a5 = "CMD_WMIC_SHADOWCOPY_DELETE"

	condition:
		2 of them
}
rule ELASTIC_Windows_Ransomware_Blackbasta_494D3C54 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Blackbasta (Windows.Ransomware.BlackBasta)"
		author = "Elastic Security"
		id = "494d3c54-4690-4334-b64d-ebeeb305de0e"
		date = "2022-08-06"
		modified = "2022-08-16"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_BlackBasta.yar#L1-L27"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "357fe8c56e246ffacd54d12f4deb9f1adb25cb772b5cd2436246da3f2d01c222"
		logic_hash = "1ecb3c95a2d3f91d267f0b625fffc8477612fde9de3942eff8eb13115c0af6b8"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "27602cb05c054a1aa9e27b91675d57707f4a63fa91badc83ad86229839778f4e"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Done time: %.4f seconds, encrypted: %.4f gb" ascii fullword
		$a2 = "Creating readme at %s" wide fullword
		$a3 = "All of your files are currently encrypted by no_name_software." ascii fullword
		$a4 = "DON'T move or rename your files. These parameters can be used for encryption/decryption process." ascii fullword
		$b1 = "Your data are stolen and encrypted" ascii fullword
		$b2 = "bcdedit /deletevalue safeboot" ascii fullword
		$b3 = "Your company id for log in:"
		$byte_seq = { 0F AF 45 DC 8B CB 0F AF 4D DC 0F AF 5D D8 0F AF 55 D8 8B F9 }
		$byte_seq2 = { 18 FF 24 1E 18 FF 64 61 5D FF CF CF CF FF D0 D0 D0 FF D0 D0 D0 FF }

	condition:
		4 of them
}
rule ELASTIC_Windows_Trojan_Parallax_D72Ec0E2 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Parallax (Windows.Trojan.Parallax)"
		author = "Elastic Security"
		id = "d72ec0e2-cf33-4ed8-8d3f-66bc93e11f26"
		date = "2022-09-05"
		modified = "2022-09-29"
		reference = "https://www.elastic.co/security-labs/exploring-the-ref2731-intrusion-set"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Parallax.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "6c2c84624912f3b612ae435cf3e8000192a1b168b30205ed4a93b7fab7e336ad"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "897117bf47d993f5cb360a0c65b1bb3df72b594334c896c1d5e7e858df202d49"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$COM_png = { B9 01 00 00 00 6B D1 00 C6 44 15 D4 83 B8 01 00 00 00 C1 E0 00 C6 44 05 D4 B6 B9 01 00 00 00 D1 E1 C6 44 0D D4 33 BA 01 00 00 00 6B C2 03 C6 44 05 D4 28 B9 01 00 00 00 C1 E1 02 C6 44 0D D4 36 BA 01 00 00 00 6B C2 05 C6 44 05 D4 6B B9 01 00 00 00 6B D1 06 C6 44 15 D4 90 B8 01 00 00 00 6B C8 07 C6 44 0D D4 97 }
		$png_parse = { 8B 4D ?? 8B 04 B8 85 C9 74 ?? 8B F1 90 8A 08 8D 40 ?? 88 0C 1A 42 83 EE ?? 75 ?? 8B 4D ?? 8B 45 ?? 47 3B 7D ?? 72 ?? }
		$config_func = { C7 45 F8 68 74 74 70 8B ?? ?? 8B 02 89 ?? ?? 6A 08 8D ?? ?? 51 E8 ?? ?? ?? ?? 83 C4 08 8B ?? ?? 52 8D ?? ?? 50 8B ?? ?? 8B 51 0C FF D2 }
		$winnet_function = { B8 77 00 00 00 66 89 ?? ?? B9 69 00 00 00 66 89 ?? ?? BA 6E 00 00 00 66 89 ?? ?? B8 69 00 00 00 66 89 ?? ?? B9 6E 00 00 00 66 89 ?? ?? BA 65 00 00 00 66 89 ?? ?? B8 74 00 00 00 66 89 ?? ?? 33 C9 66 89 ?? ?? 8D ?? ?? 52 8B ?? ?? 8B 48 1C FF D1 }

	condition:
		$config_func or $winnet_function or $COM_png or $png_parse
}
rule ELASTIC_Windows_Trojan_Parallax_B4Ea4F1A : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Parallax (Windows.Trojan.Parallax)"
		author = "Elastic Security"
		id = "b4ea4f1a-4b78-4bb8-878e-40fe753018e9"
		date = "2022-09-08"
		modified = "2022-09-29"
		reference = "https://www.elastic.co/security-labs/exploring-the-ref2731-intrusion-set"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Parallax.yar#L24-L55"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "731fe7bd339ec6b0372b4809004a21f53537bd82f084960b8d018f994dcdc06a"
		score = 75
		quality = 42
		tags = "FILE, MEMORY"
		fingerprint = "5c695f6b1bb0e72a070e076402cd94a77b178809617223b6caac6f6ec46f2ea1"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$parallax_payload_strings_0 = "[Ctrl +" ascii wide fullword
		$parallax_payload_strings_1 = "[Ctrl]" ascii wide fullword
		$parallax_payload_strings_2 = "Clipboard Start" ascii wide fullword
		$parallax_payload_strings_3 = "[Clipboard End]" ascii wide fullword
		$parallax_payload_strings_4 = "UN.vbs" ascii wide fullword
		$parallax_payload_strings_5 = "lt +" ascii wide fullword
		$parallax_payload_strings_6 = "lt]" ascii wide fullword
		$parallax_payload_strings_7 = ".DeleteFile(Wscript.ScriptFullName)" ascii wide fullword
		$parallax_payload_strings_8 = ".DeleteFolder" ascii wide fullword
		$parallax_payload_strings_9 = ".DeleteFile " ascii wide fullword
		$parallax_payload_strings_10 = "Scripting.FileSystemObject" ascii wide fullword
		$parallax_payload_strings_11 = "On Error Resume Next" ascii wide fullword
		$parallax_payload_strings_12 = "= CreateObject" ascii wide fullword
		$parallax_payload_strings_13 = ".FileExists" ascii wide fullword

	condition:
		7 of ($parallax_payload_strings_*)
}
rule ELASTIC_Windows_Packer_Scrubcrypt_6A75A4Bb : FILE MEMORY {
    meta:
		description = "Detects Windows Packer Scrubcrypt (Windows.Packer.ScrubCrypt)"
		author = "Elastic Security"
		id = "6a75a4bb-8026-4c33-af39-621d76f3baba"
		date = "2023-04-18"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Packer_ScrubCrypt.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "05c1eea2ff8c31aa5baf1dfd8015988f7e737753275ed1c8c29013a3a7414b50"
		logic_hash = "edcaa6f1cc85ef084ae5bf2524f39869a90b008dce85e72bca4835565f067ca7"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "263175cbdc74502a595664833c90bf0a27f2bf20c227775658d552e29d98620e"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 43 68 65 63 6B 52 65 6D 6F 74 65 44 65 62 75 67 67 65 72 50 72 65 73 65 6E 74 00 49 73 44 65 62 75 67 67 65 72 50 72 65 73 65 6E 74 }
		$b = { 53 63 72 75 62 43 72 79 70 74 00 53 74 61 72 74 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Clipbanker_7Efaef9F : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Clipbanker (Windows.Trojan.Clipbanker)"
		author = "Elastic Security"
		id = "7efaef9f-51cd-4fea-a48d-fa9d39cb735e"
		date = "2022-02-28"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Clipbanker.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "02b06acb113c31f5a2ac9c99f9614e0fab0f78afc5ae872e46bae139c2c9b1f6"
		logic_hash = "fa547d7c1623b332ef306672dd2293b44016d9974c1a3ec4b15e5ae0483ff879"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "fe0ec44f8707cd03f845dbea4ff5bb1b699db1b69b75f0365168a75cc8bb68a3"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "C:\\Users\\youar\\Desktop\\Allcome\\Source code\\Build\\Release\\Build.pdb" ascii fullword
		$b1 = "https://steamcommunity.com/tradeoffer" ascii fullword
		$b2 = "/Create /tn NvTmRep_CrashReport3_{B2FE1952-0186} /sc MINUTE /tr %s" ascii fullword
		$b3 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:93.0) Gecko/20100101 Firefox/93.0" ascii fullword
		$b4 = "ProcessHacker.exe" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Clipbanker_B60A50B8 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Clipbanker (Windows.Trojan.Clipbanker)"
		author = "Elastic Security"
		id = "b60a50b8-91a4-49a7-bd05-fa4cc1dee1ac"
		date = "2022-02-28"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Clipbanker.yar#L25-L43"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "02b06acb113c31f5a2ac9c99f9614e0fab0f78afc5ae872e46bae139c2c9b1f6"
		logic_hash = "fe585ab7efbc3b500ea23d1c164bc79ded658001e53fc71721e435ed7579182a"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "097bb88d8482a4915c19affc82750c7ee225b89f2611ea654cfc3c044aae0738"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 40 66 0F F8 C1 0F 11 40 A0 0F 10 84 15 08 FF FF FF 83 C2 40 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Clipbanker_F9F9E79D : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Clipbanker (Windows.Trojan.Clipbanker)"
		author = "Elastic Security"
		id = "f9f9e79d-ce71-4b6c-83e0-ac6e06252c25"
		date = "2022-04-23"
		modified = "2022-06-09"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Clipbanker.yar#L45-L63"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0407e8f54490b2a24e1834d99ec0452f217499f1e5a64de3d28439d71d16d43c"
		logic_hash = "a71d75719133e8b84956ec002cb31f82386ef711fa2af79d204d176492cd354b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ec985e1273d8ff52ea7f86271a96db01633402facf8d140d11b82e5539e4b5fd"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 7E 7E 0F B7 04 77 83 F8 41 74 69 83 F8 42 74 64 83 F8 43 74 5F 83 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Clipbanker_787B130B : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Clipbanker (Windows.Trojan.Clipbanker)"
		author = "Elastic Security"
		id = "787b130b-6382-42f0-8822-fce457fa940d"
		date = "2022-04-24"
		modified = "2022-06-09"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Clipbanker.yar#L65-L87"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0407e8f54490b2a24e1834d99ec0452f217499f1e5a64de3d28439d71d16d43c"
		logic_hash = "88783bde7014853f6556c6e7ee2dfd5cd5fcbfb4523ed158b4287e2bfba409f1"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "15f3c7d5f25982a02a6bca0b550b3b65e1e21efa5717a1ea0c13dfe46b8f2699"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$mutex_setup = { 55 8B EC 83 EC ?? 53 56 57 E8 ?? ?? ?? ?? 68 ?? ?? ?? ?? 6A ?? 6A ?? FF 15 ?? ?? ?? ?? FF 15 ?? ?? ?? ?? 3D ?? ?? ?? ?? 75 ?? 6A ?? FF 15 ?? ?? ?? ?? }
		$new_line_check = { 0F B7 C2 89 45 ?? 0F B7 C2 83 F8 0A 74 ?? BA 0D 0A 00 00 66 3B C2 74 ?? 83 F8 0D 74 ?? 83 F8 20 74 ?? 83 F8 09 74 ?? }
		$regex1 = { 0F B7 C2 89 45 ?? 0F B7 C2 83 F8 0A 74 ?? BA 0D 0A 00 00 66 3B C2 74 ?? 83 F8 0D 74 ?? 83 F8 20 74 ?? 83 F8 09 74 ?? }
		$regex2 = { 6A 34 59 66 39 0E 75 ?? 0F B7 46 ?? 6A 30 5A 83 F8 41 74 ?? 83 F8 42 74 ?? 66 3B C2 74 ?? 83 F8 31 74 ?? 83 F8 32 74 ?? 83 F8 33 74 ?? 66 3B C1 74 ?? 83 F8 35 74 ?? 83 F8 36 74 ?? 83 F8 37 74 ?? 83 F8 38 74 ?? 83 F8 39 75 ?? }
		$regex3 = { 56 8B F1 56 FF 15 ?? ?? ?? ?? 83 F8 5F 0F 85 ?? ?? ?? ?? 6A 38 59 66 39 0E 75 ?? 0F B7 46 ?? 6A 30 5A 83 F8 41 74 ?? 83 F8 42 74 ?? 66 3B C2 74 ?? 83 F8 31 74 ?? 83 F8 32 74 ?? 83 F8 33 74 ?? 83 F8 34 74 ?? 83 F8 35 74 ?? 83 F8 36 74 ?? 83 F8 37 74 ?? 66 3B C1 74 ?? 83 F8 39 75 ?? }

	condition:
		any of them
}
rule ELASTIC_Windows_Trojan_Revengerat_Db91Bcc6 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Revengerat (Windows.Trojan.Revengerat)"
		author = "Elastic Security"
		id = "db91bcc6-024d-42da-8d0a-bd69374bf622"
		date = "2021-09-02"
		modified = "2022-01-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Revengerat.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "30d8f81a19976d67b495eb1324372598cc25e1e69179c11efa22025341e455bd"
		logic_hash = "1e33cb1d614aae0b2181ebaca694c69e7fc849b3a3b7ffff7059e8c43553f8cc"
		score = 75
		quality = 50
		tags = "FILE, MEMORY"
		fingerprint = "9c322655f50c32b9be23accd2b38fbda43c280284fbf05a5a5c98458c2bab666"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "Revenge-RAT" wide fullword
		$a2 = "SELECT * FROM FirewallProduct" wide fullword
		$a3 = "HKEY_CURRENT_USER\\SOFTWARE\\" wide fullword
		$a4 = "get_MachineName" ascii fullword

	condition:
		all of them
}
rule ELASTIC_Multi_Ransomware_Ransomhub_4A8A07Cd : FILE MEMORY {
    meta:
		description = "Detects Multi Ransomware Ransomhub (Multi.Ransomware.RansomHub)"
		author = "Elastic Security"
		id = "4a8a07cd-700b-4514-a808-334c0a7641de"
		date = "2024-09-05"
		modified = "2024-09-30"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Multi_Ransomware_RansomHub.yar#L1-L26"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "bfbbba7d18be1aa2e85390fa69a761302756ee9348b7343af6f42f3b5d0a939c"
		logic_hash = "8e2d062e890cf66418c18ce8988c0ac4744c9f00fdc296e8dd91df39ec240abe"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "c66b9c6889d0c4598bf2baa99a5d137a2e2ffd06dcd2141b08a6c1eec772a87c"
		severity = 100
		arch_context = "x86, arm64"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "multi"

	strings:
		$a1 = "white_files" ascii fullword
		$a2 = "note_file_name" ascii fullword
		$a3 = "note_short_text" ascii fullword
		$a4 = "set_wallpaper" ascii fullword
		$a5 = "local_disks" ascii fullword
		$a6 = "running_one" ascii fullword
		$a7 = "net_spread" ascii fullword
		$a8 = "kill_processes" ascii fullword

	condition:
		5 of them
}
rule ELASTIC_Windows_Trojan_Bruteratel_1916686D : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bruteratel (Windows.Trojan.BruteRatel)"
		author = "Elastic Security"
		id = "1916686d-4821-4e5a-8290-58336d01997f"
		date = "2022-06-23"
		modified = "2022-12-01"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_BruteRatel.yar#L1-L31"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "e0e7b8ba2865fc76845b21aa3e075ceab98888635a60bd722c0c81e0f4fcf58c"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "86304082d3eda2f160465f0af0a3feae1aa9695727520e51f139d951e50d6efc"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "[+] Spoofed PPID => %lu" wide fullword
		$a2 = "[-] Child process not set" wide fullword
		$a3 = "[+] Crisis Monitor: Already Running" wide fullword
		$a4 = "[+] Screenshot downloaded: %S" wide fullword
		$a5 = "s[-] Duplicate listener: %S" wide fullword
		$a6 = "%02d%02d%d_%02d%02d%2d%02d.png" wide fullword
		$a7 = "[+] Added Socks Profile" wide fullword
		$a8 = "[+] Dump Size: %d Mb" wide fullword
		$a9 = "[+] Enumerating PID: %lu [%ls]" wide fullword
		$a10 = "[+] Dump Size: %d Mb" wide fullword
		$a11 = "[+] SAM key: " wide fullword
		$a12 = "[+] Token removed: '%ls'" wide fullword
		$a13 = "[Tasks] %02d => 0x%02X 0x%02X" wide fullword
		$b1 = { 48 83 EC ?? 48 8D 35 ?? ?? ?? ?? 4C 63 E2 31 D2 48 8D 7C 24 ?? 48 89 CB 4D 89 E0 4C 89 E5 E8 ?? ?? ?? ?? B9 ?? ?? ?? ?? F3 A4 31 F6 BF ?? ?? ?? ?? 39 F5 7E ?? E8 ?? ?? ?? ?? 99 F7 FF 48 63 D2 8A 44 14 ?? 88 04 33 48 FF C6 EB ?? }

	condition:
		4 of ($a*) or 1 of ($b*)
}
rule ELASTIC_Windows_Trojan_Bruteratel_9B267F96 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bruteratel (Windows.Trojan.BruteRatel)"
		author = "Elastic Security"
		id = "9b267f96-11b3-48e6-9d38-ecfd72cb7e3e"
		date = "2022-06-23"
		modified = "2022-07-18"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_BruteRatel.yar#L33-L57"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		logic_hash = "fbaaf4bf2462119b39a5df90b91fb831be3e602b926cd893374a5dddf48f029d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f20cbaf39dc68460a2612298a5df9efdf5bdb152159d38f4696aedf35862bbb6"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "calAllocPH" ascii fullword
		$a2 = "lizeCritPH" ascii fullword
		$a3 = "BadgerPH" ascii fullword
		$a4 = "VirtualPPH" ascii fullword
		$a5 = "TerminatPH" ascii fullword
		$a6 = "ickCountPH" ascii fullword
		$a7 = "SeDebugPH" ascii fullword
		$b1 = { 50 48 B8 E2 6A 15 64 56 22 0D 7E 50 48 B8 18 2C 05 7F BB 78 D7 27 50 48 B8 C9 EC BC 3D 84 54 9A 62 50 48 B8 A1 E1 3C 4E AF 2B F6 B1 50 48 B8 2E E6 7B A0 94 CA 9D F0 50 48 B8 61 52 80 AA 1A B6 4B 0E 50 48 B8 B2 13 11 5A 28 81 ED 60 50 48 B8 20 DE A9 34 89 08 C8 32 50 48 B8 9B DC C1 FF 79 CE 5B F5 50 48 B8 FD 57 3F 4C C7 D3 7A 21 50 48 B8 70 B8 63 0F AB 19 BF 1C 50 48 B8 48 F2 1B 72 1E 2A C6 8A 50 48 B8 E3 FA 38 E9 1D 76 E0 6F 50 48 B8 97 AD 75 }

	condition:
		3 of ($a*) or 1 of ($b*)
}
rule ELASTIC_Windows_Trojan_Bruteratel_684A39F2 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bruteratel (Windows.Trojan.BruteRatel)"
		author = "Elastic Security"
		id = "684a39f2-a110-4553-8d29-9f742e0ca3dc"
		date = "2023-01-24"
		modified = "2023-02-01"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_BruteRatel.yar#L59-L84"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "5f4782a34368bb661f413f33e2d1fb9f237b7f9637f2c0c21dc752316b02350c"
		logic_hash = "7cb74176e1dbdd248295649568d29c9d88841fcd0c16479b6b7efc71c4a1d706"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "fef288db141810b01f248a476368946c478a395b1709a982e2f740dd011c6328"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$seq1 = { 39 DA 0F 82 61 02 00 00 45 8D 48 14 44 39 CA 0F 82 54 02 00 00 41 8D 40 07 46 0F B6 0C 09 44 0F B6 1C 01 42 0F B6 04 11 41 C1 E3 08 41 09 C3 }
		$seq2 = { 45 8A 44 13 F0 44 32 04 01 48 FF C0 45 88 04 13 48 FF C2 48 83 F8 04 75 E7 49 83 C2 04 48 83 C6 04 49 81 FA B0 00 00 00 75 AA 48 83 C4 38 5B 5E C3 }
		$seq3 = { 48 83 EC 18 8A 01 88 04 24 8A 41 05 88 44 24 01 8A 41 0A 88 44 24 02 8A 41 0F 88 44 24 03 8A 41 04 88 44 24 04 8A 41 09 88 44 24 05 8A 41 0E 88 44 24 06 8A 41 03 88 44 24 07 }
		$seq4 = { 42 8A 0C 22 8D 42 ?? 80 F9 ?? 75 ?? 48 98 4C 89 E9 48 29 C1 42 8A 14 20 80 FA ?? 74 ?? 88 14 01 48 FF C0 EB ?? }
		$cfg1 = { 22 00 2C 00 22 00 61 00 72 00 63 00 68 00 22 00 3A 00 22 00 78 00 36 00 34 00 22 00 2C 00 22 00 62 00 6C 00 64 00 22 00 3A 00 22 00 }
		$cfg2 = { 22 00 2C 00 22 00 77 00 76 00 65 00 72 00 22 00 3A 00 22 00 }
		$cfg3 = { 22 00 2C 00 22 00 70 00 69 00 64 00 22 00 3A 00 22 00 }
		$cfg4 = { 22 00 7D 00 2C 00 22 00 6D 00 74 00 64 00 74 00 22 00 3A 00 7B 00 22 00 68 00 5F 00 6E 00 61 00 6D 00 65 00 22 00 3A 00 22 00 }

	condition:
		any of ($seq*) and all of ($cfg*)
}
rule ELASTIC_Windows_Trojan_Bruteratel_Ade6C9D5 : FILE MEMORY {
    meta:
		description = "Targets API hashes used by BruteRatel"
		author = "Elastic Security"
		id = "ade6c9d5-e9b5-4ef8-bacd-2f050c25f7f6"
		date = "2023-01-24"
		modified = "2023-02-01"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_BruteRatel.yar#L86-L109"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "dc9757c9aa3aff76d86f9f23a3d20a817e48ca3d7294307cc67477177af5c0d4"
		logic_hash = "8ff8ed1e2b909606fe6aae3f43ad02898d7b3906c3d329a508f6d40490ec75a0"
		score = 60
		quality = 45
		tags = "FILE, MEMORY"
		fingerprint = "9a4c5660eeb9158652561cf120e91ea5887841ed71f69e7cf4bfe4cfb11fe74a"
		threat_name = "Windows.Trojan.BruteRatel"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$c1_NtReadVirtualMemory = { AA A5 EF 3A }
		$c2_NtQuerySystemInformation = { D6 CA E1 E4 }
		$c3_NtCreateFile = { 9D 8F 88 03 }
		$c4_RtlSetCurrentTranscation = { 90 85 A3 99 }
		$c5_LoadLibrary = { 8E 4E 0E EC }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Bruteratel_4110D879 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bruteratel (Windows.Trojan.BruteRatel)"
		author = "Elastic Security"
		id = "4110d879-8d36-4004-858d-e62400948920"
		date = "2023-05-10"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_BruteRatel.yar#L111-L130"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "e0fbbc548fdb9da83a72ddc1040463e37ab6b8b544bf0d2b206bfff352175afe"
		logic_hash = "22c27523ddd8183c41da40f7ff908ae5bdee3b482c8a3f70aaa63a4c419e515b"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "64d7a121961108d17e03fa767bd5bc194c8654dfa18b3b2f38cf6c95a711f794"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = { 04 01 75 E2 48 83 C0 01 44 0F B6 04 02 45 84 C0 75 EC 48 89 }
		$a2 = { C8 48 83 E9 20 44 0F B6 40 E0 41 80 F8 E9 74 0B 44 0F B6 49 03 41 80 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Bruteratel_5B12Cbab : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bruteratel (Windows.Trojan.BruteRatel)"
		author = "Elastic Security"
		id = "5b12cbab-c64c-4895-a186-b940bf4a8620"
		date = "2024-02-21"
		modified = "2024-03-21"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_BruteRatel.yar#L132-L150"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "8165798fec8294523f25aedfc6699faad0c5d75f60bc7cefcbb2fa13dbc656e3"
		logic_hash = "b86296dafaef1dfa0a41704cafa351694abb0e453e104dfe06836ed599338f38"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "33e4c8fa032f33bec4719707d3ddcfa5103b747d9be70fa41848fdafd254c0ac"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 48 81 EC 00 01 00 00 31 C0 41 89 D3 48 89 E3 88 04 18 48 FF C0 48 3D 00 01 00 00 75 F2 45 31 D2 31 FF 44 89 D0 42 8A 34 13 99 41 F7 FB 48 63 D2 8A 04 11 01 F0 01 F8 0F B6 F8 0F B6 C0 8A 14 04 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Bruteratel_5E383Ae0 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bruteratel (Windows.Trojan.BruteRatel)"
		author = "Elastic Security"
		id = "5e383ae0-c379-4a8b-938e-943fb1f3fd06"
		date = "2024-03-27"
		modified = "2024-05-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_BruteRatel.yar#L152-L184"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "0b506ef32f58ee2b1e5701ca8e13c67584739ab1d00ee4a0c2f532c09a15836f"
		logic_hash = "5d87ada1c609e23742c389f8153a9266c4db95be4a5e10b50979aebc993a45e0"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "4a32b644ae97dfefa8766aa86cd519733ca2827a4a24d6ba5d9ac650a3559abc"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "_imp_BadgerWcslen"
		$a2 = "_imp_BadgerStrcmp"
		$a3 = "_imp_BadgerDispatch"
		$a4 = "_imp_BadgerStrlen"
		$a5 = "_imp_BadgerMemset"
		$a6 = "_imp_BadgerMemcpy"
		$a7 = "_imp_BadgerWcscmp"
		$a8 = "_imp_BadgerAlloc"
		$a9 = "_imp_BadgerFree"
		$a10 = "_imp_BadgerSetdebug"
		$a11 = "_imp_BadgerGetBufferSize"
		$b1 = "__imp_Kernel32$"
		$b2 = "__imp_Ntdll$Nt"
		$b3 = "__imp_Advapi32$"
		$b4 = "__imp_NETAPI32$"

	condition:
		1 of ($a*) and 1 of ($b*)
}
rule ELASTIC_Windows_Trojan_Bruteratel_644Ac114 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Bruteratel (Windows.Trojan.BruteRatel)"
		author = "Elastic Security"
		id = "644ac114-cc66-443e-9dd0-a591be99a86c"
		date = "2024-04-17"
		modified = "2024-05-08"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_BruteRatel.yar#L186-L205"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ace6a99d95ef859d4ab74db6900753e754273a12a34721f1aa8f1a9df3d8ec35"
		logic_hash = "06ffea16a0348f2276f379db150b5f9d2dbdffbcb2eee83c55c27c837ecb1e69"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "471b2e5f0ae2a08accb90c602af5e892afc1f2a140b25db977df610123cf60be"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 80 39 0F 75 ?? 80 79 01 05 75 ?? 80 79 02 C3 75 ?? 48 89 C8 C3 }
		$b = { 80 79 01 8B 75 ?? 80 79 02 D1 75 ?? 41 80 F9 B8 75 ?? 80 79 06 00 75 ?? 0F B6 41 05 C1 E0 08 41 89 C0 0F B6 41 04 }

	condition:
		all of them
}
rule ELASTIC_Windows_Ransomware_Avoslocker_7Ae4D4F2 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Avoslocker (Windows.Ransomware.Avoslocker)"
		author = "Elastic Security"
		id = "7ae4d4f2-be5f-4aad-baaa-4182ff9cf996"
		date = "2021-07-28"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Avoslocker.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "43b7a60c0ef8b4af001f45a0c57410b7374b1d75a6811e0dfc86e4d60f503856"
		logic_hash = "c87faf6f128fd6a8cabd68ec8de72fb10e6be42bdbe23ece374dd8f3cf0c1b15"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0e5ff268ed2b62f9d31df41192135145094849a4e6891407568c3ea27ebf66bb"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "drive %s took %f seconds" ascii fullword
		$a2 = "client_rsa_priv: %s" ascii fullword
		$a3 = "drive: %s" ascii fullword
		$a4 = "Map: %s" ascii fullword
		$a5 = "encrypting %ls failed" wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Kronos_Cdd2E2C5 : FILE MEMORY {
    meta:
		description = "Strings used by the Kronos banking trojan and variants."
		author = "Elastic Security"
		id = "cdd2e2c5-17fc-4cec-aece-0b19c54faccf"
		date = "2021-02-07"
		modified = "2021-08-23"
		reference = "https://www.virusbulletin.com/virusbulletin/2014/10/paper-evolution-webinjects"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Kronos.yar#L1-L27"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "baa9cedbbe0f5689be8f8028a6537c39e9ea8b0815ad76cb98f365ca5a41653f"
		logic_hash = "a8943c5ef166446629cb46517d35db39c97a1e3efa3a7a0b5cb3d3ee9d1e6e9c"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "0e124d42a6741a095b66928303731e7060788bc1035b98b729ca91e4f7b6bc44"
		threat_name = "Windows.Trojan.Kronos"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "data_inject" ascii wide fullword
		$a2 = "set_filter" ascii wide fullword
		$a3 = "set_url" ascii wide fullword
		$a4 = "%ws\\%ws.cfg" ascii wide fullword
		$a5 = "D7T1H5F0F5A4C6S3" ascii wide fullword
		$a6 = "[DELETE]" ascii wide fullword
		$a7 = "Kronos" ascii wide fullword

	condition:
		4 of them
}
rule ELASTIC_Windows_Ransomware_Mountlocker_126A76E2 : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Mountlocker (Windows.Ransomware.Mountlocker)"
		author = "Elastic Security"
		id = "126a76e2-8a97-4347-ac36-9437a512e16c"
		date = "2021-06-10"
		modified = "2021-08-23"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Mountlocker.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "4a5ac3c6f8383cc33c795804ba5f7f5553c029bbb4a6d28f1e4d8fb5107902c1"
		logic_hash = "5a5e157a245a75033abbe6bc7aa66fe6af6d91dc30abe1fdadce85f8f3905b1e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "08213f4474c7c8fd7a6e59c9ff139fb45f224109ad4e6162c12cff5ac85cb10c"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "[SKIP] locker.dir.check > black_list name=%s" wide fullword
		$a2 = "[OK] locker.dir.check > name=%s" wide fullword
		$a3 = "[ERROR] locker.worm > execute pcname=%s" wide fullword
		$a4 = "[INFO] locker.work.enum.net_drive > enum finish name=%s" wide fullword
		$a5 = "[WARN] locker.work.enum.server_shares > logon on server error=%u pcname=%s" wide fullword

	condition:
		any of them
}
rule ELASTIC_Windows_Vulndriver_Zam_7C86D260 : FILE MEMORY {
    meta:
		description = "Detects Windows Vulndriver Zam (Windows.VulnDriver.Zam)"
		author = "Elastic Security"
		id = "7c86d260-c571-4e99-83f9-5cd259e5c32e"
		date = "2024-07-16"
		modified = "2024-09-30"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_VulnDriver_Zam.yar#L22-L42"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "6f55c148bb27c14408cf0f16f344abcd63539174ac855e510a42d78cfaec451c"
		logic_hash = "cc29f26c222825eb5262d91065a00243bc913fe2071d8ad6b0dc61dd22798f1e"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "d1477b02d821893a5871c59a3c6c2c91e226daed9aa7f04a2c6f893fac05d419"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$original_file_name = { 4F 00 72 00 69 00 67 00 69 00 6E 00 61 00 6C 00 46 00 69 00 6C 00 65 00 6E 00 61 00 6D 00 65 00 00 00 5A 00 41 00 4D 00 2E 00 65 00 78 00 65 00 00 00 }
		$version = /V\x00S\x00_\x00V\x00E\x00R\x00S\x00I\x00O\x00N\x00_\x00I\x00N\x00F\x00O\x00\x00\x00{0,4}\xbd\x04\xef\xfe[\x00-\xff]{4}(([\x00-\x00][\x00-\x00])([\x00-\x03][\x00-\x00])([\x00-\x00][\x00-\x00])([\x00-\x00][\x00-\x00])|([\x00-\xff][\x00-\xff])([\x00-\x02][\x00-\x00])([\x00-\xff][\x00-\xff])([\x00-\xff][\x00-\xff]))/
		$s1 = "Advanced Malware Protection" wide fullword

	condition:
		int16 ( uint32(0x3C)+0x5c)==0x0001 and int16 ( uint32(0x3C)+0x18)==0x020b and $original_file_name and $version and $s1
}
rule ELASTIC_Windows_Trojan_Emotet_18379A8D : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Emotet (Windows.Trojan.Emotet)"
		author = "Elastic Security"
		id = "18379a8d-f1f2-49cc-8edf-58a3ba77efe7"
		date = "2021-11-17"
		modified = "2022-01-13"
		reference = "https://www.elastic.co/security-labs/emotet-dynamic-configuration-extraction"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Emotet.yar#L1-L20"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "eeb13cd51faa7c23d9a40241d03beb239626fbf3efe1dbbfa3994fc10dea0827"
		logic_hash = "2ad72ce2a352b91a4fa597ee9e796035298cfcee6fdc13dd3f64579d8da96b97"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "b7650b902a1a02029e28c88dd7ff91d841136005b0246ef4a08aaf70e57df9cc"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 04 33 CB 88 0A 8B C1 C1 E8 08 8D 52 04 C1 E9 10 88 42 FD 88 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Emotet_5528B3B0 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Emotet (Windows.Trojan.Emotet)"
		author = "Elastic Security"
		id = "5528b3b0-d4cb-485e-bc0c-96415ec3a795"
		date = "2021-11-17"
		modified = "2022-01-13"
		reference = "https://www.elastic.co/security-labs/emotet-dynamic-configuration-extraction"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Emotet.yar#L22-L41"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "eeb13cd51faa7c23d9a40241d03beb239626fbf3efe1dbbfa3994fc10dea0827"
		logic_hash = "bb784ab0e064bafa8450b6bb15ef534af38254ea3c096807571c2c27f7cdfd76"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "717ed656d1bd4ba0e4dae8e47268e2c068dad3e3e883ff6da2f951d61f1be642"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 20 89 44 24 10 83 C2 02 01 74 24 10 01 7C 24 10 29 5C 24 10 66 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Emotet_1943Bbf2 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Emotet (Windows.Trojan.Emotet)"
		author = "Elastic Security"
		id = "1943bbf2-56c0-443e-9208-cd8fc3b02d79"
		date = "2021-11-18"
		modified = "2022-01-13"
		reference = "https://www.elastic.co/security-labs/emotet-dynamic-configuration-extraction"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Emotet.yar#L43-L62"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "5abec3cd6aa066b1ddc0149a911645049ea1da66b656c563f9a384e821c5db38"
		logic_hash = "41838e335b9314b8759922f23ec8709f46e6a26633f3685ac98ada5828191d35"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "df8b73d83a50a58ed8332b7580c970c2994aa31d2ac1756cff8e0cd1777fb8fa"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 66 83 38 5C 74 0A 83 C0 02 66 39 30 75 F2 EB 06 33 C9 66 89 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Emotet_Db7D33Fa : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Emotet (Windows.Trojan.Emotet)"
		author = "Elastic Security"
		id = "db7d33fa-e50c-4c59-ab92-edb74aac87c9"
		date = "2022-05-09"
		modified = "2022-06-09"
		reference = "https://www.elastic.co/security-labs/emotet-dynamic-configuration-extraction"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Emotet.yar#L64-L90"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "08c23400ff546db41f9ddbbb19fa75519826744dde3b3afb38f3985266577afc"
		logic_hash = "e220c112c15f384fde6fc2286b01c7eb9bedcf4817d02645d0fa7afb05e7b593"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "eac196154ab1ad636654c966e860dcd5763c50d7b8221dbbc7769c879daf02fd"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$chunk_0 = { 4C 8D 9C 24 ?? ?? ?? ?? 8B C3 49 8B 5B ?? 49 8B 73 ?? 49 8B 7B ?? 49 8B E3 5D C3 }
		$chunk_1 = { 8B C7 41 0F B7 4C 45 ?? 41 8B 1C 8C 48 03 DD 48 3B DE 72 ?? }
		$chunk_2 = { 48 8B C4 48 89 48 ?? 48 89 50 ?? 4C 89 40 ?? 4C 89 48 ?? C3 }
		$chunk_3 = { 48 8B 45 ?? BB 01 00 00 00 48 89 07 8B 45 ?? 89 47 ?? 4C 8D 9C 24 ?? ?? ?? ?? 8B C3 49 8B 5B ?? 49 8B 73 ?? 49 8B 7B ?? 49 8B E3 5D C3 }
		$chunk_4 = { 48 39 3B 4C 8D 9C 24 ?? ?? ?? ?? 49 8B 5B ?? 49 8B 73 ?? 40 0F 95 C7 8B C7 49 8B 7B ?? 49 8B E3 5D C3 }
		$chunk_5 = { BE 02 00 00 00 4C 8D 9C 24 ?? ?? ?? ?? 8B C6 49 8B 5B ?? 49 8B 73 ?? 49 8B 7B ?? 49 8B E3 41 5F 41 5E 41 5D 41 5C 5D C3 }
		$chunk_6 = { 43 8B 84 FE ?? ?? ?? ?? 48 03 C6 48 3B D8 73 ?? }
		$chunk_7 = { 88 02 48 FF C2 48 FF C3 8A 03 84 C0 75 ?? EB ?? }

	condition:
		4 of them
}
rule ELASTIC_Windows_Trojan_Emotet_D6Ac1Ea4 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Emotet (Windows.Trojan.Emotet)"
		author = "Elastic Security"
		id = "d6ac1ea4-b0a8-4023-b712-9f4f2c7146a3"
		date = "2022-05-24"
		modified = "2022-06-09"
		reference = "https://www.elastic.co/security-labs/emotet-dynamic-configuration-extraction"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Emotet.yar#L92-L114"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "2c6709d5d2e891d1ce26fdb4021599ac10fea93c7773f5c00bea8e5e90404b71"
		logic_hash = "9b37940ea8752c6db52d4f09225de0389438c41468a11a7cda8f28b191192ef9"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "7e6224c58c283765b5e819eb46814c556ae6b7b5931cd1e3e19ca3ec8fa31aa2"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$calc1 = { C7 44 24 ?? ?? ?? ?? ?? C7 04 24 ?? ?? ?? ?? C7 44 24 ?? ?? ?? ?? ?? C7 44 24 ?? ?? ?? ?? ?? C7 44 24 ?? ?? ?? ?? ?? }
		$pre = { 48 83 EC ( 18 | 28 ) C7 44 24 ?? ?? ?? ?? ?? }
		$setup = { 48 8D 05 ?? ?? ?? ?? 48 89 81 ?? ?? ?? ?? }
		$post = { 8B 44 24 ?? 89 44 24 ?? 48 83 C4 18 C3 }

	condition:
		#calc1>=10 and #pre>=5 and #setup>=5 and #post>=5
}
rule ELASTIC_Windows_Trojan_Emotet_77C667B9 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Emotet (Windows.Trojan.Emotet)"
		author = "Elastic Security"
		id = "77c667b9-6895-428f-8735-ba5853d9484d"
		date = "2022-11-07"
		modified = "2022-12-20"
		reference = "https://www.elastic.co/security-labs/emotet-dynamic-configuration-extraction"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Emotet.yar#L116-L144"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ffac0120c3ae022b807559e8ed7902fde0fa5f7cb9c5c8d612754fa498288572"
		logic_hash = "f11769fe5e9789b451e8826c5fd22bde5b3eb9f7af1d5fec7eec71700fc1f482"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f8fac966f77cd8d6654b8abffbf63d884bd9f0b5d51bfc252004a0d9bd569068"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$c2_list_1 = { 8B 4B ?? 8B 85 ?? ?? ?? ?? 48 FF C1 48 C1 E1 ?? 89 04 19 8B 43 ?? 8B 8D ?? ?? ?? ?? 48 C1 E0 ?? C1 E9 ?? 66 89 4C 18 ?? }
		$c2_list_2 = { 8B 43 ?? 48 8D 0C 80 8B 44 24 ?? 89 44 CB ?? 8B 43 ?? 8B 54 24 ?? 48 8D 0C 80 C1 EA ?? 66 89 54 CB ?? 8B 43 ?? 0F B7 54 24 ?? 48 8D 0C 80 89 54 CB ?? FF 43 ?? }
		$c2_list_3 = { 8B 43 ?? 48 FF C0 48 8D 0C 40 8B 85 ?? ?? ?? ?? 48 03 C9 89 04 CB 8B 43 ?? 8B 95 ?? ?? ?? ?? 48 8D 0C 40 C1 EA ?? 48 03 C9 66 89 54 CB ?? 8B 43 ?? 0F B7 95 ?? ?? ?? ?? 48 8D 0C 40 B8 ?? ?? ?? ?? 48 03 C9 89 54 CB ?? FF 43 ?? }
		$c2_list_4 = { 8B 43 ?? 48 FF C0 48 8D 0C 40 8B 44 24 ?? 89 04 CB 8B 43 ?? 8B 54 24 ?? 48 8D 0C 40 C1 EA ?? 66 89 54 CB ?? 8B 43 ?? 0F B7 54 24 ?? 48 8D 0C 40 89 54 CB ?? FF 43 ?? }
		$c2_list_5 = { 8B 83 ?? ?? ?? ?? 48 8D 0C 80 8B 44 24 ?? 89 44 CB ?? 8B 83 ?? ?? ?? ?? 8B 54 24 ?? 48 8D 0C 80 C1 EA ?? 66 89 54 CB ?? 8B 83 ?? ?? ?? ?? 0F B7 54 24 ?? 48 8D 0C 80 89 14 CB FF 83 ?? ?? ?? ?? }
		$c2_list_a = { 8B 83 ?? ?? ?? ?? 83 F8 ?? 73 ?? 48 8D 4C 24 ?? FF 54 C4 ?? 83 7C 24 ?? ?? 74 ?? 83 7C 24 ?? ?? 74 ?? B8 ?? ?? ?? ?? E9 ?? ?? ?? ?? }
		$string_w_1 = { 8B 0B 49 FF C3 48 8D 5B ?? 33 CD 0F B6 C1 66 41 89 00 0F B7 C1 C1 E9 ?? 66 C1 E8 ?? 4D 8D 40 ?? 66 41 89 40 ?? 0F B6 C1 66 C1 E9 ?? 66 41 89 40 ?? 66 41 89 48 ?? 4D 3B D9 72 ?? }
		$string_w_2 = { 8B CD 49 FF C3 33 0B 48 8D 5B ?? 0F B6 C1 66 41 89 00 0F B7 C1 C1 E9 ?? 66 C1 E8 ?? 4D 8D 40 ?? 66 41 89 40 ?? 0F B6 C1 66 C1 E9 ?? 66 41 89 40 ?? 66 41 89 48 ?? 4D 3B D9 72 ?? }
		$string_a_1 = { 8B 0B 49 FF C3 48 8D 5B ?? 33 CD 41 88 08 0F B7 C1 C1 E9 ?? 66 C1 E8 ?? 4D 8D 40 ?? 41 88 40 ?? 41 88 48 ?? 66 C1 E9 ?? 41 88 48 ?? 4D 3B D9 72 ?? }
		$key_1 = { 45 33 C9 4C 8B D0 48 85 C0 74 ?? 48 8D ?? ?? 4C 8B ?? 48 8B ?? 48 2B ?? 48 83 ?? ?? 48 C1 ?? ?? 48 3B ?? 49 0F 47 ?? 48 85 ?? 74 ?? 48 2B D8 42 8B 04 03 }

	condition:
		(1 of ($string_*)) and (($key_1 or (1 of ($c2_list*))) or (1 of ($c2_list*)))
}
rule ELASTIC_Windows_Trojan_Emotet_8B9449C1 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Emotet (Windows.Trojan.Emotet)"
		author = "Elastic Security"
		id = "8b9449c1-41a3-4f4d-b654-6921f2742b9a"
		date = "2022-11-09"
		modified = "2022-12-20"
		reference = "https://www.elastic.co/security-labs/emotet-dynamic-configuration-extraction"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Emotet.yar#L146-L166"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "ffac0120c3ae022b807559e8ed7902fde0fa5f7cb9c5c8d612754fa498288572"
		logic_hash = "5501354ebc1d97fe5ce894d5907adb29440f557f2dd235e1e983ae2d109199a2"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ff15cec5eb41bb9637b570d717151cdc076e88a7b4c3d1c31157d41fe7569318"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$hash_1 = { 8B CB 41 8B D0 D3 E2 41 8B CB D3 E0 03 D0 41 0F BE ?? 03 D0 41 2B D0 49 FF ( C1 | C2 ) }
		$hash_2 = { 44 8B ?? 44 8B ?? 41 8B CB 41 D3 ?? 8B CB D3 E0 8B C8 8D 42 ?? 66 83 F8 ?? 0F B7 C2 77 ?? 83 C0 ?? 41 2B ?? 41 03 ?? 03 C1 49 83 ?? ?? 41 0F B7 }

	condition:
		any of them
}
rule ELASTIC_Windows_Ransomware_Ransomexx_Fabff49C : FILE MEMORY {
    meta:
		description = "Detects Windows Ransomware Ransomexx (Windows.Ransomware.Ransomexx)"
		author = "Elastic Security"
		id = "fabff49c-8e1a-4020-b081-2f432532e529"
		date = "2021-08-07"
		modified = "2021-10-04"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Ransomware_Ransomexx.yar#L1-L22"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "480af18104198ad3db1518501ee58f9c4aecd19dbbf2c5dd7694d1d87e9aeac7"
		logic_hash = "67d5123b706685ea5ab939aec31cb1549297778d91dd38b14e109945c52da71a"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "a7a1e6d5fafdddc7d4699710edf407653968ffd40747c50f26ef63a6cb623bbe"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a1 = "ransom.exx" ascii fullword
		$a2 = "Infrastructure rebuild will cost you MUCH more." wide fullword
		$a3 = "Your files are securely ENCRYPTED." wide fullword
		$a4 = "delete catalog -quiet" wide fullword

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Zloader_5Dd0A0Bf : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Zloader (Windows.Trojan.Zloader)"
		author = "Elastic Security"
		id = "5dd0a0bf-20e4-4c52-b9d9-c157e871b06b"
		date = "2022-03-03"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Zloader.yar#L1-L19"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "161e657587361b29cdb883a6836566a946d9d3e5175e166a9fe54981d0c667fa"
		logic_hash = "1446a4147e1b06fa66907de857011079c55a8e6bf84276eb8518d33468ba1f83"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "06545df6c556adf8a6844724e77d005c0299b544f21df2ea44bb9679964dbb9f"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { B6 08 89 CA 80 C2 F7 80 FA 05 72 F2 80 F9 20 74 ED 03 5D 0C 8D }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Zloader_4Fe0F7F1 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Zloader (Windows.Trojan.Zloader)"
		author = "Elastic Security"
		id = "4fe0f7f1-93c6-4397-acd5-1557608efaf4"
		date = "2022-03-03"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Zloader.yar#L21-L39"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "161e657587361b29cdb883a6836566a946d9d3e5175e166a9fe54981d0c667fa"
		logic_hash = "b20fafc9db08c7668b49e18f45632594c3a69ec65fe865e79379c544fc424f8d"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "f340f41cc69930d24ffdae484d1080cd9ce5cb5e7720868c956923a5b8e6c9b1"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 08 8B 75 F0 85 DB 8D 7D 94 89 45 E8 0F 45 FB 31 DB 85 F6 0F }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Zloader_363C65Ed : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Zloader (Windows.Trojan.Zloader)"
		author = "Elastic Security"
		id = "363c65ed-e394-4a40-9c2a-a6f6fd284ed3"
		date = "2022-03-03"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Zloader.yar#L41-L59"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "161e657587361b29cdb883a6836566a946d9d3e5175e166a9fe54981d0c667fa"
		logic_hash = "d3c530f9929db709067a9e1cc59b9cda9dcd8e19352c79ddaf7af6c91b242afd"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "33ae4cee122269f4342a3fd829236cbd303d8821b548ab93bbebc9dee3eb67f2"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 04 8D 4D E4 8D 55 E8 6A 00 6A 00 51 6A 00 6A 00 50 52 57 53 }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Zloader_79535191 : FILE MEMORY {
    meta:
		description = "Detects Windows Trojan Zloader (Windows.Trojan.Zloader)"
		author = "Elastic Security"
		id = "79535191-59df-4c78-9f62-b8614ef992d3"
		date = "2022-03-03"
		modified = "2022-04-12"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Zloader.yar#L61-L79"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "161e657587361b29cdb883a6836566a946d9d3e5175e166a9fe54981d0c667fa"
		logic_hash = "c398a8ca46c6fe3e59481a092867be77a94809b1568cea918aa6450374063857"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "ee3c4cf0d694119acfdc945a964e4fc0f51355eabca900ffbcc21aec0b3e1e3c"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$a = { 28 4B 74 26 8B 46 FC 85 C0 74 F3 8B 4E F4 8B 16 39 C8 0F 47 C1 8B }

	condition:
		all of them
}
rule ELASTIC_Windows_Trojan_Grandoreiro_51236Ba2 : FILE MEMORY {
    meta:
		description = "Grandoreiro rule, target loader and payload"
		author = "Elastic Security"
		id = "51236ba2-fdbc-4c46-b57b-27fc1e135486"
		date = "2022-08-23"
		modified = "2023-06-13"
		reference = "https://github.com/elastic/protections-artifacts/"
		source_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/yara/rules/Windows_Trojan_Grandoreiro.yar#L1-L23"
		license_url = "https://github.com/elastic/protections-artifacts//blob/28336769b72540c8b02aa04e1b47dfc093f3ea03/LICENSE.txt"
		hash = "1bdf381e7080d9bed3f52f4b3db1991a80d3e58120a5790c3d1609617d1f439e"
		logic_hash = "9a8549a1dd82f56458ea8aee5c30243ac073d15c820de28d78a58d2c067b10d6"
		score = 75
		quality = 75
		tags = "FILE, MEMORY"
		fingerprint = "c3082cc865fc177d8cbabcfcf9fb67317af5f2d28e8eeb95eb04108a558d80d4"
		threat_name = "Windows.Trojan.Grandoreiro"
		severity = 100
		arch_context = "x86"
		scan_context = "file, memory"
		license = "Elastic License v2"
		os = "windows"

	strings:
		$antivm0 = { B8 68 58 4D 56 BB 12 F7 6C 3C B9 0A 00 00 00 66 BA 58 56 ED B8 01 00 00 00 }
		$antivm1 = { B9 [4] 89 E5 53 51 64 FF 35 00 00 00 00 64 89 25 00 00 00 00 BB 00 00 00 00 B8 01 00 00 00 0F 3F 07 0B }
		$xor0 = { 0F B7 44 70 ?? 33 D8 8D 45 ?? 50 89 5D ?? }
		$xor1 = { 8B 45 ?? 0F B7 44 70 ?? 33 C3 89 45 ?? }

	condition:
		all of them
}
rule FIREEYE_RT_APT_Backdoor_Win_Gorat_Memory {
    meta:
		description = "Identifies GoRat malware in memory based on strings."
		author = "FireEye"
		id = "16fb1db7-711c-5d8d-9203-738c94f253fe"
		date = "2020-12-09"
		modified = "2020-12-09"
		reference = "https://github.com/mandiant/red_team_tool_countermeasures/"
		source_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/rules/REDFLARE (Gorat)/production/yara/APT_Backdoor_Win_GoRat_Memory.yar#L4-L27"
		license_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/LICENSE.txt"
		hash = "3b926b5762e13ceec7ac3a61e85c93bb"
		logic_hash = "88272e59325d106f96d6b6f1d57daf968823c1e760067dee0334c66c521ce8c2"
		score = 75
		quality = 75
		tags = ""
		rev = 1

	strings:
		$murica = "murica" fullword
		$rat1 = "rat/modules/socks.(*HTTPProxyClient).beacon" fullword
		$rat2 = "rat.(*Core).generateBeacon" fullword
		$rat3 = "rat.gJitter" fullword
		$rat4 = "rat/comms.(*protectedChannel).SendCmdResponse" fullword
		$rat5 = "rat/modules/filemgmt.(*acquire).NewCommandExecution" fullword
		$rat6 = "rat/modules/latlisten.(*latlistensrv).handleCmd" fullword
		$rat7 = "rat/modules/netsweeper.(*netsweeperRunner).runSweep" fullword
		$rat8 = "rat/modules/netsweeper.(*Pinger).listen" fullword
		$rat9 = "rat/modules/socks.(*HTTPProxyClient).beacon" fullword
		$rat10 = "rat/platforms/win/dyloader.(*memoryLoader).ExecutePluginFunction" fullword
		$rat11 = "rat/platforms/win/modules/namedpipe.(*dummy).Open" fullword
		$winblows = "rat/platforms/win.(*winblows).GetStage" fullword

	condition:
		$winblows or #murica>10 or 3 of ($rat*)
}
rule TRELLIX_ARC_Sodinokobi : RANSOMWARE {
    meta:
		description = "This rule detect Sodinokobi Ransomware in memory in old samples and perhaps future."
		author = "McAfee ATR team"
		id = "dd05ce31-9699-50a9-944c-5883340791af"
		date = "2024-12-01"
		modified = "2020-08-14"
		reference = "https://github.com/advanced-threat-research/Yara-Rules/"
		source_url = "https://github.com/advanced-threat-research/Yara-Rules//blob/fc51a3fe3b450838614a5a5aa327c6bd8689cbb2/ransomware/RANSOM_Sodinokibi.yar#L33-L54"
		license_url = "https://github.com/advanced-threat-research/Yara-Rules//blob/fc51a3fe3b450838614a5a5aa327c6bd8689cbb2/LICENSE"
		logic_hash = "f25039ac743223756461bbeeb349c674473608f9959bf3c79ce4a7587fde3ab2"
		score = 75
		quality = 70
		tags = "RANSOMWARE"
		malware_type = "ransomware"
		malware_family = "Ransom:W32/Sodinokibi"
		actor_type = "Cybercrime"
		actor_group = "Unknown"
		version = "1.0"

	strings:
		$a = { 40 0F B6 C8 89 4D FC 8A 94 0D FC FE FF FF 0F B6 C2 03 C6 0F B6 F0 8A 84 35 FC FE FF FF 88 84 0D FC FE FF FF 88 94 35 FC FE FF FF 0F B6 8C 0D FC FE FF FF }
		$b = { 0F B6 C2 03 C8 8B 45 14 0F B6 C9 8A 8C 0D FC FE FF FF 32 0C 07 88 08 40 89 45 14 8B 45 FC 83 EB 01 75 AA }

	condition:
		all of them
}
rule VOLEXITY_Apt_Malware_Py_Upstyle : UTA0218 FILE MEMORY {
    meta:
		description = "Detect the UPSTYLE webshell."
		author = "threatintel@volexity.com"
		id = "45726f35-8b3e-5095-b145-9e7f6da6838b"
		date = "2024-04-11"
		modified = "2024-04-12"
		reference = "TIB-20240412"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-04-12 Palo Alto Networks GlobalProtect/indicators/rules.yar#L1-L33"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "51923600b23d23f4ce29eac7f5ab9f7e1ddb45bed5f6727ddec4dcb75872e473"
		score = 75
		quality = 80
		tags = "UTA0218, FILE, MEMORY"
		hash1 = "3de2a4392b8715bad070b2ae12243f166ead37830f7c6d24e778985927f9caac"
		hash2 = "0d59d7bddac6c22230187ef6cf7fa22bca93759edc6f9127c41dc28a2cea19d8"
		hash3 = "4dd4bd027f060f325bf6a90d01bfcf4e7751a3775ad0246beacc6eb2bad5ec6f"
		os = "linux"
		os_arch = "all"
		scan_context = "file,memory"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		rule_id = 10429
		version = 2

	strings:
		$stage1_str1 = "/opt/pancfg/mgmt/licenses/PA_VM"
		$stage1_str2 = "exec(base64."
		$stage2_str1 = "signal.signal(signal.SIGTERM,stop)"
		$stage2_str2 = "exec(base64."
		$stage3_str1 = "write(\"/*\"+output+\"*/\")"
		$stage3_str2 = "SHELL_PATTERN"

	condition:
		all of ($stage1*) or all of ($stage2*) or all of ($stage3*)
}
rule VOLEXITY_Susp_Any_Jarischf_User_Path : FILE MEMORY {
    meta:
		description = "Detects paths embedded in samples in released projects written by Ferdinand Jarisch, a pentester in AISEC. These tools are sometimes used by attackers in real world intrusions."
		author = "threatintel@volexity.com"
		id = "062a6fdb-c516-5643-9c7c-deff32eeb95e"
		date = "2024-04-10"
		modified = "2024-04-12"
		reference = "TIB-20240412"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-04-12 Palo Alto Networks GlobalProtect/indicators/rules.yar#L57-L78"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "574d5b1fadb91c39251600e7d73d4993d4b16565bd1427a0e8d6ed4e7905ab54"
		score = 50
		quality = 80
		tags = "FILE, MEMORY"
		hash1 = "161fd76c83e557269bee39a57baa2ccbbac679f59d9adff1e1b73b0f4bb277a6"
		os = "all"
		os_arch = "all"
		scan_context = "file,memory"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		rule_id = 10424
		version = 4

	strings:
		$proj_1 = "/home/jarischf/"

	condition:
		any of ($proj_*)
}
rule VOLEXITY_Hacktool_Golang_Reversessh_Fahrj : FILE MEMORY {
    meta:
		description = "Detects a reverse SSH utility available on GitHub. Attackers may use this tool or similar tools in post-exploitation activity."
		author = "threatintel@volexity.com"
		id = "332e323f-cb16-5aa2-8b66-f3d6d50d94f2"
		date = "2024-04-10"
		modified = "2024-04-12"
		reference = "TIB-20240412"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-04-12 Palo Alto Networks GlobalProtect/indicators/rules.yar#L79-L112"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "38b40cc7fc1e601da2c7a825f1c2eff209093875a5829ddd2f4c5ad438d660f8"
		score = 75
		quality = 80
		tags = "FILE, MEMORY"
		hash1 = "161fd76c83e557269bee39a57baa2ccbbac679f59d9adff1e1b73b0f4bb277a6"
		os = "all"
		os_arch = "all"
		scan_context = "file,memory"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		rule_id = 10423
		version = 5

	strings:
		$fun_1 = "createLocalPortForwardingCallback"
		$fun_2 = "createReversePortForwardingCallback"
		$fun_3 = "createPasswordHandler"
		$fun_4 = "createPublicKeyHandler"
		$fun_5 = "createSFTPHandler"
		$fun_6 = "dialHomeAndListen"
		$fun_7 = "createExtraInfoHandler"
		$fun_8 = "createSSHSessionHandler"
		$fun_9 = "createReversePortForwardingCallback"
		$proj_1 = "github.com/Fahrj/reverse-ssh"

	condition:
		any of ($proj_*) or 4 of ($fun_*)
}
rule VOLEXITY_Apt_Malware_Any_Reloadext_Plugin : STORMBAMBOO FILE MEMORY {
    meta:
		description = "Detection for RELOADEXT, a Google Chrome extension malware."
		author = "threatintel@volexity.com"
		id = "6c6c8bee-2a13-5645-89ef-779f00264fd9"
		date = "2024-02-23"
		modified = "2024-08-02"
		reference = "TIB-20240227"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-08-02 StormBamboo/rules.yar#L4-L36"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "2b11f8fc5b6260ebf00bde83585cd7469709a4979ca579cdf065724bc15052fc"
		score = 75
		quality = 80
		tags = "STORMBAMBOO, FILE, MEMORY"
		hash1 = "9d0928b3cc21ee5e1f2868f692421165f46b5014a901636c2a2b32a4c500f761"
		os = "all"
		os_arch = "all"
		scan_context = "file,memory"
		severity = "critical"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		rule_id = 10282
		version = 4

	strings:
		$man1 = "Reload page with Internet Explorer compatible mode."
		$man2 = "\"http://*/*\""
		$code1 = ";chrome["
		$code2 = "XMLHttpRequest(),_"
		$code3 = "0x400*0x400"

	condition:
		all of ($man*) or (#code1>8 and #code2>=2 and #code3>=2)
}
rule VOLEXITY_Apt_Malware_Any_Macma_A : STORMBAMBOO FILE MEMORY {
    meta:
		description = "Detects variants of the MACMA backdoor, variants of MACMA have been discovered for Windows, macOS and android."
		author = "threatintel@volexity.com"
		id = "6ab45af1-41e5-53fc-9297-e2bc07ebf797"
		date = "2021-11-12"
		modified = "2024-08-02"
		reference = "https://blog.google/threat-analysis-group/analyzing-watering-hole-campaign-using-macos-exploits/"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-08-02 StormBamboo/rules.yar#L64-L112"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "7ebaff9fddf6491d6b1ed9ab14c1b87dc8df850536e55aa723d625a593b33ed7"
		score = 75
		quality = 53
		tags = "STORMBAMBOO, FILE, MEMORY"
		hash1 = "cf5edcff4053e29cb236d3ed1fe06ca93ae6f64f26e25117d68ee130b9bc60c8"
		hash2 = "9b71fad3280cf36501fe110e022845b29c1fb1343d5250769eada7c36bc45f70"
		hash3 = "623f99cbe20af8b79cbfea7f485d47d3462d927153d24cac4745d7043c15619a"
		hash4 = "d599d7814adbab0f1442f5a10074e00f3a776ce183ea924abcd6154f0d068bb4"
		os = "all"
		os_arch = "all"
		report1 = "TIB-20231221"
		report2 = "TIB-20240227"
		scan_context = "file,memory"
		severity = "critical"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		rule_id = 6114
		version = 8

	strings:
		$magic1 = "curl -o %s http://cgi1.apnic.net/cgi-bin/my-ip.php" fullword ascii
		$magic2 = "[FST%d]: WhyUserCancel UNKNOW: %d" fullword ascii
		$magic3 = "[FST%d]: wait C2 prepare ready TIMEOUT, fd: %d" fullword ascii
		$magic4 = "[FST%d]: wait C2 ack file content TIMEOUT, fd: %d" fullword ascii
		$magic5 = "[FST%d]: TIMER_CHECK_CANCEL WhyUserCancel UNKNOW: %d" fullword ascii
		$magic6 = "[FST%d]: encrypt file info key=%s, crc v1=0x%p, v2=0x%p" fullword ascii
		$s1 = "auto bbbbbaaend:%d path %s" fullword ascii
		$s2 = "0keyboardRecirderStopv" fullword ascii
		$s3 = "curl begin..." fullword ascii
		$s4 = "curl over!" fullword ascii
		$s5 = "kAgent fail" fullword ascii
		$s6 = "put !!!!" fullword ascii
		$s7 = "vret!!!!!! %d" fullword ascii
		$s8 = "save Setting Success" fullword ascii
		$s9 = "Start Filesyste Search." fullword ascii
		$s10 = "./SearchFileTool" fullword ascii
		$s11 = "put unknow exception in MonitorQueue" fullword ascii
		$s12 = "./netcfg2.ini" fullword ascii
		$s13 = ".killchecker_" fullword ascii
		$s14 = "./param.ini" fullword ascii

	condition:
		any of ($magic*) or 7 of ($s*)
}
rule VOLEXITY_Apt_Malware_Win_Pocostick_Jul23 : STORMBAMBOO FILE MEMORY {
    meta:
		description = "Detects the July 2023 POCOSTICK variant. These strings are only visible in memory after several rounds of shellcode decryption."
		author = "threatintel@volexity.com"
		id = "9632a7fc-06da-58b4-b95c-b46aeb9dd41d"
		date = "2023-07-24"
		modified = "2024-08-02"
		reference = "TIB-20231221"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-08-02 StormBamboo/rules.yar#L212-L241"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "19487db733c7f793be2a1287df32a165e46f6af0e940b13b389f4d675b5100c4"
		score = 75
		quality = 80
		tags = "STORMBAMBOO, FILE, MEMORY"
		hash1 = "ec3e787c369ac4b28447e7cacc44d70a595e39d47f842bacb07d19b12cab6aad"
		os = "win"
		os_arch = "all"
		scan_context = "file,memory"
		severity = "critical"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		rule_id = 9542
		version = 3

	strings:
		$str1 = "Folder PATH listing form volume" wide
		$str2 = "Volume serial number is 0000-1111" wide
		$str3 = "Type:Error" wide
		$str4 = "Type:Desktop" wide
		$str5 = "Type:Laptop" wide
		$str6 = "Type:Vitual" wide
		$str7 = ".unicode.tmp" wide
		$str8 = "EveryOne" wide

	condition:
		6 of them
}
rule VOLEXITY_Apt_Malware_Py_Dustpan_Pyloader : STORMBAMBOO FILE MEMORY {
    meta:
		description = "Detects Python script used by KPlayer to update, modified by attackers to download a malicious payload."
		author = "threatintel@volexity.com"
		id = "446d2eef-c60a-50ed-9ff1-df86b6210dff"
		date = "2023-07-21"
		modified = "2024-08-02"
		reference = "TIB-20231221"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-08-02 StormBamboo/rules.yar#L243-L279"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "bb3a70dad28181534e27abbbd618165652c137264bfd3726ae4480c642493a3b"
		score = 75
		quality = 80
		tags = "STORMBAMBOO, FILE, MEMORY"
		os = "all"
		os_arch = "all"
		scan_context = "file,memory"
		severity = "critical"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		rule_id = 9530
		version = 4

	strings:
		$s_1 = "def count_md5(src)"
		$s_2 = "urllib.request.urlretrieve(image_url,main)"
		$s_3 = "m1 != '4c8a326899272d2fe30e818181f6f67f'"
		$s_4 = "os.path.split(os.path.realpath(__file__))[0]"
		$s_5 = "r_v = os.system('curl '+ini_url+cc)"
		$s_6 = "b41ef5f591226a0d5adce99cb2e629d8"
		$s_7 = "1df495e7c85e59ad0de1b9e50912f8d0"
		$s_8 = "tasklist | findstr mediainfo.exe"
		$url_1 = "http://dl1.5kplayer.com/youtube/youtube_dl.png"
		$url_2 = "http://dl1.5kplayer.com/youtube/youtube.ini?fire="
		$path_1 = "C:\\\\ProgramData\\\\Digiarty\\\\mediainfo.exe"

	condition:
		3 of ($s_*) or any of ($url_*) or $path_1
}
rule VOLEXITY_Apt_Webshell_Pl_Complyshell : UTA0178 FILE MEMORY {
    meta:
		description = "Detection for the COMPLYSHELL webshell."
		author = "threatintel@volexity.com"
		id = "6b44b5bc-a75f-573c-b9c3-562b7874e408"
		date = "2023-12-13"
		modified = "2024-01-09"
		reference = "TIB-20231215"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-01-10 Ivanti Connect Secure/indicators/yara.yar#L1-L22"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "ff46691f1add20cff30fe996e2fb199ce42408e86d5642a8a43c430f2245b1f5"
		score = 75
		quality = 80
		tags = "UTA0178, FILE, MEMORY"
		hash1 = "8bc8f4da98ee05c9d403d2cb76097818de0b524d90bea8ed846615e42cb031d2"
		os = "linux"
		os_arch = "all"
		scan_context = "file,memory"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		rule_id = 9995
		version = 4

	strings:
		$s = "eval{my $c=Crypt::RC4->new("

	condition:
		$s
}
rule VOLEXITY_Apt_Webshell_Aspx_Glasstoken : UTA0178 FILE MEMORY {
    meta:
		description = "Detection for a custom webshell seen on external facing server. The webshell contains two functions, the first is to act as a Tunnel, using code borrowed from reGeorg, the second is custom code to execute arbitrary .NET code."
		author = "threatintel@volexity.com"
		id = "5d96294c-aa61-5752-ab06-d5b27f6ac3a1"
		date = "2023-12-12"
		modified = "2024-01-09"
		reference = "TIB-20231215"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-01-10 Ivanti Connect Secure/indicators/yara.yar#L24-L49"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "34844dc2ba4b18b25dcb5b14b7b80ec655595c9638600a0f2a6367610c542dd1"
		score = 75
		quality = 80
		tags = "UTA0178, FILE, MEMORY"
		hash1 = "26cbb54b1feb75fe008e36285334d747428f80aacdb57badf294e597f3e9430d"
		os = "win"
		os_arch = "all"
		scan_context = "file,memory"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		rule_id = 9994
		version = 5

	strings:
		$s1 = "=Convert.FromBase64String(System.Text.Encoding.Default.GetString(" ascii
		$re = /Assembly\.Load\(errors\)\.CreateInstance\("[a-z0-9A-Z]{4,12}"\).GetHashCode\(\);/

	condition:
		for any i in (0..#s1) : ($re in (@s1[i]..@s1[i]+512))
}
rule VOLEXITY_Webshell_Aspx_Regeorg : FILE MEMORY {
    meta:
		description = "Detects the reGeorg webshell based on common strings in the webshell. May also detect other webshells which borrow code from ReGeorg."
		author = "threatintel@volexity.com"
		id = "02365a30-769e-5c47-8d36-a79608ffd121"
		date = "2018-08-29"
		modified = "2024-01-09"
		reference = "TIB-20231215"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-01-10 Ivanti Connect Secure/indicators/yara.yar#L51-L83"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		hash = "9d901f1a494ffa98d967ee6ee30a46402c12a807ce425d5f51252eb69941d988"
		logic_hash = "4fed023e85a32052917f6db1e2e155c91586538938c03acc59f200a8264888ca"
		score = 75
		quality = 80
		tags = "FILE, MEMORY"
		os = "win"
		os_arch = "all"
		scan_context = "file,memory"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		rule_id = 410
		version = 7

	strings:
		$a1 = "every office needs a tool like Georg" ascii
		$a2 = "cmd = Request.QueryString.Get(\"cmd\")" ascii
		$a3 = "exKak.Message" ascii
		$proxy1 = "if (rkey != \"Content-Length\" && rkey != \"Transfer-Encoding\")"
		$proxy_b1 = "StreamReader repBody = new StreamReader(response.GetResponseStream(), Encoding.GetEncoding(\"UTF-8\"));" ascii
		$proxy_b2 = "string rbody = repBody.ReadToEnd();" ascii
		$proxy_b3 = "Response.AddHeader(\"Content-Length\", rbody.Length.ToString());" ascii

	condition:
		any of ($a*) or $proxy1 or all of ($proxy_b*)
}
rule VOLEXITY_Hacktool_Py_Pysoxy : FILE MEMORY {
    meta:
		description = "SOCKS5 proxy tool used to relay connections."
		author = "threatintel@volexity.com"
		id = "88094b55-784d-5245-9c40-b1eebf0e6e72"
		date = "2024-01-09"
		modified = "2024-01-09"
		reference = "TIB-20240109"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-01-10 Ivanti Connect Secure/indicators/yara.yar#L85-L111"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "f73e9d3c2f64c013218469209f3b69fc868efafc151a7de979dde089bfdb24b2"
		score = 75
		quality = 80
		tags = "FILE, MEMORY"
		hash1 = "e192932d834292478c9b1032543c53edfc2b252fdf7e27e4c438f4b249544eeb"
		os = "all"
		os_arch = "all"
		scan_context = "file,memory"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		rule_id = 10065
		version = 3

	strings:
		$s1 = "proxy_loop" ascii
		$s2 = "connect_to_dst" ascii
		$s3 = "request_client" ascii
		$s4 = "subnegotiation_client" ascii
		$s5 = "bind_port" ascii

	condition:
		all of them
}
rule VOLEXITY_Apt_Malware_Vbs_Basicstar : CHARMINGCYPRESS FILE MEMORY {
    meta:
		description = "VBS backdoor which bares architectural similarity to the POWERSTAR malware family."
		author = "threatintel@volexity.com"
		id = "e790defe-2bd5-5629-8420-ce8091483589"
		date = "2024-01-04"
		modified = "2024-01-11"
		reference = "TIB-20240111"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-02-13 CharmingCypress/rules.yar#L64-L92"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "977bb42553bb6585c8d0e1e89675644720ca9abf294eccd797e20d4bca516810"
		score = 75
		quality = 80
		tags = "CHARMINGCYPRESS, FILE, MEMORY"
		hash1 = "c6f91e5585c2cbbb8d06b7f239e30b271f04393df4fb81815f6556fa4c793bb0"
		os = "win"
		os_arch = "all"
		scan_context = "file,memory"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		rule_id = 10037
		version = 4

	strings:
		$s1 = "Base64Encode(EncSess)" ascii wide
		$s2 = "StrReverse(PlainSess)" ascii wide
		$s3 = "ComDecode, \"Module\"" ascii wide
		$s4 = "ComDecode, \"SetNewConfig\"" ascii wide
		$s5 = "ComDecode, \"kill\"" ascii wide
		$magic = "cmd /C start /MIN curl --ssl-no-revoke -s -d " ascii wide

	condition:
		3 of ($s*) or $magic
}
rule VOLEXITY_Apt_Malware_Ps1_Powerless_B : CHARMINGCYPRESS FILE MEMORY {
    meta:
		description = "Detects POWERLESS malware."
		author = "threatintel@volexity.com"
		id = "74dd8412-c099-5ecb-af97-c22fede14252"
		date = "2023-10-25"
		modified = "2023-11-03"
		reference = "TIB-20231027"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-02-13 CharmingCypress/rules.yar#L93-L150"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "a95fe2c8d09d66e07a999eef3a5666cc622bbc063d747626c48b26cfecf35849"
		score = 75
		quality = 78
		tags = "CHARMINGCYPRESS, FILE, MEMORY"
		hash1 = "62de7abb39cf4c47ff120c7d765749696a03f4fa4e3e84c08712bb0484306ae1"
		os = "win"
		os_arch = "all"
		scan_context = "file,memory"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		rule_id = 9794
		version = 4

	strings:
		$fun_1 = "function verifyClickStorke"
		$fun_2 = "function ConvertTo-SHA256"
		$fun_3 = "function Convert-Tobase" fullword
		$fun_4 = "function Convert-Frombase" fullword
		$fun_5 = "function Send-Httppacket"
		$fun_6 = "function Generat-FetchCommand"
		$fun_7 = "function Create-Fetchkey"
		$fun_8 = "function Run-Uploader"
		$fun_9 = "function Run-Shot" fullword
		$fun_10 = "function ShotThis("
		$fun_11 = "function File-Manager"
		$fun_12 = "function zip-files"
		$fun_13 = "function Run-Stealer"
		$fun_14 = "function Run-Downloader"
		$fun_15 = "function Run-Stro" fullword
		$fun_16 = "function Run-Tele" fullword
		$fun_17 = "function Run-Voice"
		$s_1 = "if($commandtype -eq \"klg\")"
		$s_2 = "$desrilizedrecievedcommand"
		$s_3 = "$getAsyncKeyProto = @"
		$s_4 = "$Global:BotId ="
		$s_5 = "$targetCLSID = (Get-ScheduledTask | Where-Object TaskName -eq"
		$s_6 = "$burl = \"$Global:HostAddress/"
		$s_7 = "$hashString = [System.BitConverter]::ToString($hash).Replace('-','').ToLower()"
		$s_8 = "$Global:UID = ((gwmi win32_computersystemproduct).uuid -replace '[^0-9a-z]').substring("
		$s_9 = "$rawpacket = \"{`\"MId`\":`\"$Global:MachineID`\",`\"BotId`\":`\"$basebotid`\"}\""
		$s_10 = "$bitmap = New-Object System.Drawing.Bitmap $bounds.Width, $bounds.Height"
		$s_12 = "Runned Without any Error"
		$s_13 = "$commandresponse = (Invoke-Expression $instruction -ErrorAction Stop) | Out-String"
		$s_14 = "Operation started successfuly"
		$s_15 = "$t_path = (Get-WmiObject Win32_Process -Filter \"name = '$process'\" | Select-Object CommandLine).CommandLine"
		$s_16 = "?{ $_.DisplayName -match \"Telegram Desktop\" } | %{$app_path += $_.InstallLocation }"
		$s_17 = "$chlids = get-ChildItem $t -Recurse -Exclude \"$t\\tdata\\user_data\""
		$s_18 = "if($FirsttimeFlag -eq $True)"
		$s_19 = "Update-Conf -interval $inter -url $url -next_url $next -conf_path $conf_path -key $config_key"

	condition:
		3 of ($fun_*) or any of ($s_*)
}
rule VOLEXITY_Apt_Malware_Ps1_Powerstar_Generic : CHARMINGCYPRESS FILE MEMORY {
    meta:
		description = "Detects POWERSTAR modules based on common HTTP functions used across modules."
		author = "threatintel@volexity.com"
		id = "71a3e99d-e1c8-5ac1-abbc-2ba5cba80799"
		date = "2023-06-02"
		modified = "2023-06-28"
		reference = "https://github.com/volexity/threat-intel"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-02-13 CharmingCypress/rules.yar#L311-L335"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "4da02190ffd16304eccbc0d12dfcc5637a6b785af0e3dc3dfcafcfe114597eb2"
		score = 75
		quality = 80
		tags = "CHARMINGCYPRESS, FILE, MEMORY"
		scan_context = "file,memory"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		rule_id = 9356
		version = 2

	strings:
		$http1 = "Send_Upload" ascii wide
		$http2 = "Send_Post_Data" ascii wide
		$json1 = "{\"OS\":\"" ascii wide
		$json2 = "{\"ComputerName\":\"' + $env:COMPUTERNAME + '\"}" ascii wide
		$json3 = "{\"Token\"" ascii wide
		$json4 = "{\"num\":\"" ascii wide

	condition:
		all of ($http*) or all of ($json*)
}
rule VOLEXITY_Apt_Malware_Win_Deepdata_Module : BRAZENBAMBOO FILE MEMORY {
    meta:
		description = "Detects modules used by DEEPDATA based on the required export names used by those modules."
		author = "threatintel@volexity.com"
		id = "1287f5dd-9229-57ce-a91a-73d61041df80"
		date = "2024-07-30"
		modified = "2024-11-14"
		reference = "https://github.com/volexity/threat-intel"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-11-15 BrazenBamboo/rules.yar#L1-L25"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "d36f34343826daf7f7368118c7127c7181a54c99a01803016c9a6965abb309cb"
		score = 75
		quality = 80
		tags = "BRAZENBAMBOO, FILE, MEMORY"
		hash1 = "c782346bf9e5c08a0c43a85d4991f26b0b3c99c054fa83beb4a9e406906f011e"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		os = "win"
		os_arch = "all"
		scan_context = "file,memory"
		severity = "critical"
		rule_id = 10868
		version = 2

	strings:
		$str1 = "ExecuteCommand"
		$str2 = "GetPluginCommandID"
		$str3 = "GetPluginName"
		$str4 = "GetPluginVersion"

	condition:
		all of them
}
rule VOLEXITY_Apt_Malware_Win_Lightspy_Orchestrator_Decoded_Core : BRAZENBAMBOO FILE MEMORY {
    meta:
		description = "Detects the decoded orchestrator for the Windows variant of the LightSpy malware family. This file is normally stored in an encoded state on the C2 server and is used as the core component of this malware family, loading additional plugins from the C2 whilst managing all the C2 communication etc."
		author = "threatintel@volexity.com"
		id = "44f8d7a4-7f48-5960-91a7-baf475f7d291"
		date = "2024-02-15"
		modified = "2024-07-03"
		reference = "https://github.com/volexity/threat-intel"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-11-15 BrazenBamboo/rules.yar#L247-L290"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "f0189c0a84c53e365130e9683f2f2b2f73c14412d8e4d0251a4780d0e80162d8"
		score = 75
		quality = 78
		tags = "BRAZENBAMBOO, FILE, MEMORY"
		hash1 = "80c0cdb1db961c76de7e4efb6aced8a52cd0e34178660ef34c128be5f0d587df"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		os = "win"
		os_arch = "all"
		scan_context = "file,memory"
		severity = "critical"
		rule_id = 10246
		version = 2

	strings:
		$s1 = "Enter RunWork......."
		$s2 = "it's running......."
		$s3 = "select ret = socket_error."
		$s4 = "%s\\\\account.bin"
		$s5 = "[CtrlLink]: get machine sn err:%d"
		$s6 = "wmic path Win32_VideoController get CurrentHorizontalResolution,CurrentVerticalResolution /format:list | findstr /v \\\"^$\\\""
		$s7 = "wmic csproduct get vendor,version /format:list | findstr /v \\\"^$\\\""
		$s8 = "local ip get sockname error=%d"
		$s9 = "connect goole dns error=%d"
		$s10 = "%s/api/terminal/upsert/"
		$s11 = "/963852741/windows/plugin/manifest"
		$s12 = "Hello deepdata."
		$s13 = "Start Light."
		$s14 = "InitialPluginManager Error."
		$s15 = "InitialCommandExe Error."
		$s16 = "ws open, and send logon info."
		$s17 = "plugin_replay_handler"
		$s18 = "light_x86.dll"
		$pdb1 = "\\light\\bin\\light_x86.pdb"
		$pdb2 = "\\light\\bin\\plugin"
		$pdb3 = "D:\\tmpWork\\"

	condition:
		1 of ($pdb*) or 5 of ($s*)
}
rule VOLEXITY_Apt_Malware_Win_Lightspy_Orchestrator_Decoded_C2_Strings : BRAZENBAMBOO FILE MEMORY {
    meta:
		description = "Detects the decoded orchestrator for the Windows variant of the LightSpy malware family. This file is normally stored in an encoded state on the C2 server and is used as the core component of this malware family, loading additional plugins from the C2 whilst managing all the C2 communication etc."
		author = "threatintel@volexity.com"
		id = "a0af8fb7-13a3-54e8-8569-e8622fa80d89"
		date = "2024-02-15"
		modified = "2024-07-03"
		reference = "https://github.com/volexity/threat-intel"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-11-15 BrazenBamboo/rules.yar#L291-L339"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "eeaaf6e16d4854a2279bd62596f75cb8b8ec1b05f3b050f5dac97254704b9005"
		score = 75
		quality = 78
		tags = "BRAZENBAMBOO, FILE, MEMORY"
		hash1 = "80c0cdb1db961c76de7e4efb6aced8a52cd0e34178660ef34c128be5f0d587df"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		os = "win"
		os_arch = "all"
		scan_context = "file,memory"
		severity = "critical"
		rule_id = 10245
		version = 2

	strings:
		$s1 = "[WsClient][Error]:"
		$s2 = "[WsClient][Info]:"
		$s3 = "[WsClient]:WsClient"
		$s4 = "[WsClient][Info]:Ws"
		$s5 = "WsClient Worker Thread ID=%d"
		$s6 = "[LightWebClient]:"
		$s7 = "LightHttpGet err:%s"
		$s8 = "User-Agent: Mozilla/5.0 AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.145 Safari/537.36"
		$s9 = "KvList Err:%s"
		$s10 = "dataMultiPart malloc err:%d"
		$ctrl1 = "CTRL_HEART_BEAT"
		$ctrl2 = "CTRL_NET_CONFIG"
		$ctrl3 = "CTRL_COMMAND_PLAN"
		$ctrl4 = "CTRL_MODIFY_NET_CONFIG"
		$ctrl5 = "CTRL_UPLOAD_PLUGIN_STATUS"
		$ctrl6 = "CTRL_PLUGIN_EXECUTE_COMMAND"
		$ctrl7 = "CTRL_PLUGIN_COMMAND_STATUS"
		$ctrl8 = "CTRL_PLUGIN_STOP_COMMAND"
		$ctrl9 = "CTRL_GET_SLEEP_CONFIG"
		$ctrl10 = "CTRL_MODIFY_SLEEP_CONFIG"
		$ctrl11 = "CTRL_SLEEP_STATUS"
		$ctrl12 = "CTRL_UPDATE_PLUGIN"
		$ctrl13 = "CTRL_DESTROY"
		$ctrl14 = "CTRL_RECONFIG_REBOUNT_ADDRESS"
		$ctrl15 = "CTRL_AUTO_UPLOUD_FILE_CONFIG"
		$ctrl16 = "CTRL_UPLOUD_DEVICE_INFO"
		$ctrl17 = "CTRL_TEST_VPDN_ACCOUNT"

	condition:
		3 of ($s*) or 5 of ($ctrl*)
}
rule VOLEXITY_Malware_Golang_Discordc2_Bmdyy_1 : FILE MEMORY {
    meta:
		description = "Detects a opensource malware available on github using strings in the ELF. DISGOMOJI used by UTA0137 is based on this malware."
		author = "threatintel@volexity.com"
		id = "6816d264-4311-5e90-948b-2e27cdf0b720"
		date = "2024-03-28"
		modified = "2024-03-28"
		reference = "TIB-20240229"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-06-13 DISGOMOJI/indicators/rules.yar#L215-L241"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "22b3e5109d0738552fbc310344b2651ab3297e324bc883d5332c1e8a7a1df29b"
		score = 75
		quality = 80
		tags = "FILE, MEMORY"
		hash1 = "de32e96d1f151cc787841c12fad88d0a2276a93d202fc19f93631462512fffaf"
		os = "all"
		os_arch = "all"
		scan_context = "file,memory"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		rule_id = 10390
		version = 2

	strings:
		$s1 = "File is bigger than 8MB" wide ascii
		$s2 = "Uploaded file to" wide ascii
		$s3 = "sess-%d" wide ascii
		$s4 = "Session *%s* opened" wide ascii
		$s5 = "%s%d_%dx%d.png" wide ascii

	condition:
		4 of them
}
rule VOLEXITY_Malware_Golang_Discordc2_Bmdyy : FILE MEMORY {
    meta:
		description = "Detects a opensource malware available on github using strings in the ELF. DISGOMOJI used by UTA0137 is based on this malware."
		author = "threatintel@volexity.com"
		id = "1ddbf476-ba2d-5cbb-ad95-38e0ae8db71b"
		date = "2024-02-22"
		modified = "2024-03-28"
		reference = "https://github.com/bmdyy/discord-c2"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2024/2024-06-13 DISGOMOJI/indicators/rules.yar#L243-L265"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "38b860a43b9937351f74b01983888f18ad101cbe66560feb7455d46b713eba0f"
		score = 75
		quality = 80
		tags = "FILE, MEMORY"
		hash1 = "d9f29a626857fa251393f056e454dfc02de53288ebe89a282bad38d03f614529"
		os = "all"
		os_arch = "all"
		scan_context = "file,memory"
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"
		rule_id = 10264
		version = 10

	strings:
		$s1 = "**IP**: %s\n**User**: %s\n**Hostname**: %s\n**OS**: %s\n**CWD**" wide ascii

	condition:
		$s1
}
rule VOLEXITY_Trojan_Win_Iis_Shellsave : XEGROUP {
    meta:
		description = "Detects an AutoIT backdoor designed to run on IIS servers and to install a webshell. This rule will only work against memory samples."
		author = "threatintel@volexity.com"
		id = "a89defa5-4b22-5650-a0c0-f4b3cf3377a7"
		date = "2021-11-17"
		modified = "2021-12-07"
		reference = "https://github.com/volexity/threat-intel"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2021/2021-12-06 - XEGroup/indicators/yara.yar#L22-L40"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "f34d6f4ecaa4cde5965f6b0deac55c7133a2be96f5c466f34775be6e7f730493"
		score = 75
		quality = 80
		tags = "XEGROUP"
		hash1 = "21683e02e11c166d0cf616ff9a1a4405598db7f4adfc87b205082ae94f83c742"
		memory_suitable = 1
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"

	strings:
		$s1 = "getdownloadshell" ascii
		$s2 = "deleteisme" ascii
		$s3 = "sitepapplication" ascii
		$s4 = "getapplicationpool" ascii

	condition:
		all of them
}
rule VOLEXITY_Apt_Win_Powerstar_Memonly : CHARMINGKITTEN {
    meta:
		description = "Detects the initial stage of the memory only variant of PowerStar."
		author = "threatintel@volexity.com"
		id = "469fc433-da9e-55ed-99fb-9560ec86a179"
		date = "2023-05-16"
		modified = "2023-09-20"
		reference = "https://github.com/volexity/threat-intel"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2023/2023-06-28 POWERSTAR/indicators/rules.yar#L20-L65"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "d790ff204e4e8adeb3e887d9ebce743e958b523c48317d017487b1b0c6aebc11"
		score = 75
		quality = 78
		tags = "CHARMINGKITTEN"
		hash1 = "977cf5cc1d0c61b7364edcf397e5c67d910fac628c6c9a41cf9c73b3720ce67f"
		memory_suitable = 1
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"

	strings:
		$s_1 = "[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($in.substring(3)))"
		$s_2 = "[Convert]::ToByte(([Convert]::ToString(-bnot ($text_bytes[$i])"
		$s_3 = "$Exec=[System.Text.Encoding]::UTF8.GetString($text_bytes)"
		$s_4 = "((65..90) + (97..122) | Get-Random -Count 16 | % {[char]$_})"
		$f_1 = "function Gorjol{"
		$f_2 = "Borjol \"$"
		$f_3 = "Gorjol -text"
		$f_4 = "function Borjoly{"
		$f_6 = "$filename = $env:APPDATA+\"\\Microsoft\\Windows\\DocumentPreview.pdf\";"
		$f_7 = "$env:APPDATA+\"\\Microsoft\\Windows\\npv.txt\""
		$f_8 = "\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\brt8ts74e.bat"
		$f_9 = "\\Microsoft\\Windows\\s7qe52.txt"
		$f_10 = "$yeolsoe2 = $yeolsoe"
		$f_11 = "setRequestHeader(\"Content-DPR\""
		$f_12 = "getResponseHeader(\"Content-DPR\")"
		$f_13 = {24 43 6f 6d 6d 61 6e 64 50 61 72 74 73 20 3d 24 53 65 73 73 69 6f 6e 52 65 73 70 6f 6e 73 65 2e 53 70 6c 69 74 28 22 b6 22 29}
		$f_14 = "$language -like \"*shar*\""
		$f_15 = "$language -like \"*owers*\""
		$alias_1 = "(gcm *v????E?P?e*)"
		$alias_2 = "&(gcm *ke-e*) $Command"
		$key = "T2r0y1M1e1n1o0w1"
		$args_1 = "$sem.Close()"
		$args_2 = "$cem.Close()"
		$args_3 = "$mem.Close()"
		$command_1 = "_____numone_____"
		$command_2 = "_____mac2_____"
		$command_3 = "_____yeolsoe_____"

	condition:
		2 of ($s_*) or any of ($f_*) or 2 of ($alias_*) or $key or all of ($args_*) or any of ($command_*)
}
rule VOLEXITY_Apt_Win_Powerstar_Logmessage : CHARMINGKITTEN {
    meta:
		description = "Detects interesting log message embedded in memory only version of PowerStar."
		author = "threatintel@volexity.com"
		id = "5979c776-5138-50e2-adab-0793ad86ba76"
		date = "2023-05-16"
		modified = "2023-09-20"
		reference = "https://github.com/volexity/threat-intel"
		source_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/2023/2023-06-28 POWERSTAR/indicators/rules.yar#L66-L79"
		license_url = "https://github.com/volexity/threat-intel/blob/ab1416212928e91caf94866c151e05f481bb4c06/LICENSE.txt"
		logic_hash = "539c9a8b3de24f2c8058d204900344756a8031822ebebc312612b8fb8422e341"
		score = 75
		quality = 80
		tags = "CHARMINGKITTEN"
		memory_suitable = 1
		license = "See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"

	strings:
		$s_1 = "wau, ije ulineun mueos-eul halkkayo?"

	condition:
		all of them
}
rule JPCERTCC_Tscookie_1 {
    meta:
		description = "detect TSCookie in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "5407a5c9-2fc5-5b9b-977f-81384a343d15"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://blogs.jpcert.or.jp/en/2018/03/malware-tscooki-7aa0.html"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L8-L21"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "71e51ceb51cff25abefd698ce33f32388cc28ad5936f30fbbb9925d9af79ad85"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "6d2f5675630d0dae65a796ac624fb90f42f35fbe5dec2ec8f4adce5ebfaabf75"

	strings:
		$v1 = "Mozilla/4.0 (compatible; MSIE 8.0; Win32)" wide
		$b1 = { 68 D4 08 00 00 }

	condition:
		all of them
}
rule JPCERTCC_TSC_Loader {
    meta:
		description = "detect TSCookie Loader in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "378cc8a3-6a76-50d1-b1d2-1a6ca1a75a46"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L23-L35"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "c825253ba897f0f7310162d0473e645dc40b421e9251977384cca2fdc735f7a8"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$v1 = "Mozilla/4.0 (compatible; MSIE 8.0; Win32)" wide
		$b1 = { 68 78 0B 00 00 }

	condition:
		all of them
}
rule JPCERTCC_Redleaves {
    meta:
		description = "detect RedLeaves in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "e17a85de-6a15-5de5-ba9e-03ac6d896d7d"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://blogs.jpcert.or.jp/en/2017/05/volatility-plugin-for-detecting-redleaves-malware.html"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L53-L66"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "c79815dd26070184688d43b336dc2be07df5e2236e60c8ecc42f5efec2cab190"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory block scan"
		hash1 = "5262cb9791df50fafcb2fbd5f93226050b51efe400c2924eecba97b7ce437481"

	strings:
		$v1 = "red_autumnal_leaves_dllmain.dll"
		$b1 = { FF FF 90 00 }

	condition:
		$v1 and $b1 at 0
}
rule JPCERTCC_Himawari {
    meta:
		description = "detect Himawari(a variant of RedLeaves) in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "85c33dc6-0f9b-5645-b236-f416df16b4a4"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://www.jpcert.or.jp/present/2018/JSAC2018_01_nakatsuru.pdf"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L68-L82"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "9014e6e02fb9d8fa0f646c61647ab28c3cb08f10f8f584ddd11eba27211307f5"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "3938436ab73dcd10c495354546265d5498013a6d17d9c4f842507be26ea8fafb"

	strings:
		$h1 = "himawariA"
		$h2 = "himawariB"
		$h3 = "HimawariDemo"

	condition:
		all of them
}
rule JPCERTCC_Lavender {
    meta:
		description = "detect Lavender(a variant of RedLeaves) in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "8c30ae73-161f-5117-a1f9-fad0bd5278de"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L84-L97"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "bf64f927e2c8e9be0f11497f94357de8e3fadcf09ba224d6fec92841c89c1dc5"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "db7c1534dede15be08e651784d3a5d2ae41963d192b0f8776701b4b72240c38d"

	strings:
		$a1 = { C7 ?? ?? 4C 41 56 45 }
		$a2 = { C7 ?? ?? 4E 44 45 52 }

	condition:
		all of them
}
rule JPCERTCC_Armadill {
    meta:
		description = "detect Armadill(a variant of RedLeaves) in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "0e6fb091-5c26-5419-ac99-5ddc9db29fc0"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L99-L111"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "a76d434469a45e1c48b8ec3dc9622017c78ea52824006ddfcf3c368fbda7c912"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$a1 = { C7 ?? ?? 41 72 6D 61 }
		$a2 = { C7 ?? ?? 64 69 6C 6C }

	condition:
		all of them
}
rule JPCERTCC_Zark20Rk {
    meta:
		description = "detect zark20rk(a variant of RedLeaves) in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "baf3ebfe-80dd-5601-9ba9-8866b6ab6f14"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L113-L126"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "07c5c97916bd9ec19591d90f8b7d872fca571f3479148157cf1ee9e05c272e5c"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "d95ad7bbc15fdd112594584d92f0bff2c348f48c748c07930a2c4cc6502cd4b0"

	strings:
		$a1 = { C7 ?? ?? 7A 61 72 6B }
		$a2 = { C7 ?? ?? 32 30 72 6B }

	condition:
		all of them
}
rule JPCERTCC_Ursnif_1 {
    meta:
		description = "detect Ursnif(a.k.a. Dreambot, Gozi, ISFB) in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "e93bc13b-33a9-5d9a-92a9-52f16a97fb16"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L128-L158"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "6c224b43e8ec0fa9540a1fdedce7ce4b97f8ab7196a9619594b7dcb9c2dc5169"
		score = 60
		quality = 60
		tags = ""
		rule_usage = "memory scan"
		hash1 = "0207c06879fb4a2ddaffecc3a6713f2605cbdd90fc238da9845e88ff6aef3f85"
		hash2 = "ff2aa9bd3b9b3525bae0832d1e2b7c6dfb988dc7add310088609872ad9a7e714"
		hash3 = "1eca399763808be89d2e58e1b5e242324d60e16c0f3b5012b0070499ab482510"

	strings:
		$a1 = "soft=%u&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x"
		$b1 = "client.dll" fullword
		$c1 = "version=%u"
		$c2 = "user=%08x%08x%08x%08x"
		$c3 = "server=%u"
		$c4 = "id=%u"
		$c5 = "crc=%u"
		$c6 = "guid=%08x%08x%08x%08x"
		$c7 = "name=%s"
		$c8 = "soft=%u"
		$d1 = "%s://%s%s"
		$d2 = "PRI \x2A HTTP/2.0"
		$e1 = { A1 ?? ?? ?? 00 35 E7 F7 8A 40 50 }
		$e2 = { 56 56 56 6A 06 5? FF ?? ?? ?? ?? 00 }
		$f1 = { 56 57 BE ?? ?? ?? ?? 8D ?? ?? A5 A5 A5 }
		$f2 = { 35 8F E3 B7 3F }
		$f3 = { 35 0A 60 2E 51 }

	condition:
		$a1 or ($b1 and 3 of ($c*)) or (5 of ($c*)) or ($b1 and all of ($d*)) or all of ($e*) or all of ($f*)
}
rule JPCERTCC_Emotet_1 {
    meta:
		description = "detect Emotet in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "f1cb5e3e-069d-54bb-829d-2ff4aa80e2bb"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L160-L176"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "32f6c25f324eb9f79b8f0b4bc37d648ed95d6347712208f13f74584ee164dc4f"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$v4a = { BB 00 C3 4C 84 }
		$v4b = { B8 00 C3 CC 84 }
		$v5a = { 6D 4E C6 41 33 D2 81 C1 39 30 00 00 }
		$v6a = { C7 40 20 ?? ?? ?? 00 C7 40 10 ?? ?? ?? 00 C7 40 0C 00 00 00 00 83 3C CD ?? ?? ?? ?? 00 74 0E 41 89 48 ?? 83 3C CD ?? ?? ?? ?? 00 75 F2 }
		$v7a = { 6A 06 33 D2 ?? F7 ?? 8B DA 43 74 }
		$v7b = { 83 E6 0F 8B CF 83 C6 04 50 8B D6 E8 ?? ?? ?? ?? 59 6A 2F 8D 3C 77 58 66 89 07 83 C7 02 4B 75 }

	condition:
		all of ($v4*) or $v5a or $v6a or all of ($v7*)
}
rule JPCERTCC_Smokeloader_1 {
    meta:
		description = "detect SmokeLoader in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "19666821-1fe9-50e7-958e-22f2260099aa"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://www.cert.pl/en/news/single/dissecting-smoke-loader/"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L178-L191"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "11b7a297d3dcacba57de9b04a6d126970c2be9d5551f7976ac8129b0afbc9bfd"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$a1 = { B8 25 30 38 58 }
		$b1 = { 81 3D ?? ?? ?? ?? 25 00 41 00 }
		$c1 = { C7 ?? ?? ?? 25 73 25 73 }

	condition:
		$a1 and $b1 and $c1
}
rule JPCERTCC_Hawkeye {
    meta:
		description = "detect HawkEye in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "fc988aaf-bdac-5a53-a90c-d35d86285cd6"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L259-L272"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "45256e1e56de3934d2e57a7c036d49a0f56c25538ed7ad3eb7ee8efa7f549e98"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$hawkstr1 = "HawkEye Keylogger" wide
		$hawkstr2 = "Dear HawkEye Customers!" wide
		$hawkstr3 = "HawkEye Logger Details:" wide

	condition:
		all of them
}
rule JPCERTCC_Lokibot {
    meta:
		description = "detect Lokibot in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "12e8469b-83e9-5f93-a543-1c2efb4d303a"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L274-L288"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "3d2db6acb565d705ba26acb7f75be24096ab619a03726f4898391bfe5944bc46"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "6f12da360ee637a8eb075fb314e002e3833b52b155ad550811ee698b49f37e8c"

	strings:
		$des3 = { 68 03 66 00 00 }
		$param = "MAC=%02X%02X%02XINSTALL=%08X%08X"
		$string = { 2d 00 75 00 00 00 46 75 63 6b 61 76 2e 72 75 00 00}

	condition:
		all of them
}
rule JPCERTCC_Bebloh {
    meta:
		description = "detect Bebloh(a.k.a. URLZone) in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "7c3decb2-9cb5-5569-bab2-982c769ee233"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L290-L304"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "22b8ae9d40d34f83d8cc6c2dab56a866c8de8c9cc38b5da962c7071302f91f03"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$crc32f = { b8 EE 56 0b ca }
		$dga = "qwertyuiopasdfghjklzxcvbnm123945678"
		$post1 = "&vcmd="
		$post2 = "?tver="

	condition:
		all of them
}
rule JPCERTCC_Xxmm {
    meta:
		description = "detect xxmm in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "be459cbf-84a1-539e-b0b5-b7a00b6d278d"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L306-L319"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "4a860ac3efb97ce03fa906c2d0e7cd08654f6e82531d9449af7891be83a036d5"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$v1 = "setupParameter:"
		$v2 = "loaderParameter:"
		$v3 = "parameter:"

	condition:
		all of them
}
rule JPCERTCC_Azorult_1 {
    meta:
		description = "detect Azorult in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "c73a007c-4d5f-5504-9635-9bffe1282aef"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L321-L334"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "158d65dcd8f3ce8fe4ab2d9bcc97edf585c1d665cc54e1e4969ef83c8103a149"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$v1 = "Mozilla/4.0 (compatible; MSIE 6.0b; Windows NT 5.1)"
		$v2 = "http://ip-api.com/json"
		$v3 = { c6 07 1e c6 47 01 15 c6 47 02 34 }

	condition:
		all of them
}
rule JPCERTCC_Poisonivy {
    meta:
		description = "detect PoisonIvy in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "e7b27a88-490f-5f79-9e8c-65b8f7505a72"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L336-L349"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "dec7a95c877078f77cbcdcf8646680f6f1d55d438af98e519d13461a7854b095"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$a1 = { 0E 89 02 44 }
		$b1 = { AD D1 34 41 }
		$c1 = { 66 35 20 83 66 81 F3 B8 ED }

	condition:
		all of them
}
rule JPCERTCC_Netwire {
    meta:
		description = "detect netwire in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "cf71b80f-2618-5209-bb49-fefea9e0a7f3"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L351-L367"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "fa6ec967b6b3de226dcdb06d6b8f684800331a2420f038dd6274a8b9c3d8be78"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$v1 = "HostId-%Rand%"
		$v2 = "mozsqlite3"
		$v3 = "[Scroll Lock]"
		$v4 = "GetRawInputData"
		$ping = "ping 192.0.2.2"
		$log = "[Log Started] - [%.2d/%.2d/%d %.2d:%.2d:%.2d]"

	condition:
		($v1) or ($v2 and $v3 and $v4) or ($ping and $log)
}
rule JPCERTCC_Nanocore {
    meta:
		description = "detect Nanocore in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "0b12ad94-99c2-5d48-a860-ff75b82971af"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L369-L382"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "471dcda6f5fb9c30e3a1df7171fdba889114d54166d038d18c7910e2765d5250"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$v1 = "NanoCore Client"
		$v2 = "PluginCommand"
		$v3 = "CommandType"

	condition:
		all of them
}
rule JPCERTCC_Formbook_1 {
    meta:
		description = "detect Formbook in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "71291f9b-eb8e-55e5-a499-df54c35efdbf"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L384-L397"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "62bd3717af8970f67f28d923ce2483ff55a5ef4585a183d4d510e3a2c45fcc8c"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$sqlite3step = { 68 34 1c 7b e1 }
		$sqlite3text = { 68 38 2a 90 c5 }
		$sqlite3blob = { 68 53 d8 7f 8c }

	condition:
		all of them
}
rule JPCERTCC_Agenttesla_Type1 {
    meta:
		description = "detect Agenttesla in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "92bfb3ab-d8d0-50ec-8ab8-ad34f1edb906"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L399-L411"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "24b9b815400967a9086048527f7aa1fce08bcd94a16aec8080aeac97045b297a"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$iestr = "C:\\\\Users\\\\Admin\\\\Desktop\\\\IELibrary\\\\IELibrary\\\\obj\\\\Debug\\\\IELibrary.pdb"
		$atstr = "C:\\\\Users\\\\Admin\\\\Desktop\\\\ConsoleApp1\\\\ConsoleApp1\\\\obj\\\\Debug\\\\ConsoleApp1.pdb"
		$sqlitestr = "Not a valid SQLite 3 Database File" wide

	condition:
		all of them
}
rule JPCERTCC_Noderat {
    meta:
		description = "detect Noderat in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "9c2c4b0f-0f45-54f6-a98c-b592af882eef"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://blogs.jpcert.or.jp/ja/2019/02/tick-activity.html"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L429-L442"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "e1254b6cf28161943db202ea0a6ff2d86aa7975d4a3ecc0f26eed58101e54960"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$config = "/config/app.json"
		$key = "/config/.regeditKey.rc"
		$message = "uninstall error when readFileSync: "

	condition:
		all of them
}
rule JPCERTCC_Njrat {
    meta:
		description = "detect njRAT in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "96b35796-3e1d-5721-998a-e678612e4de7"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://github.com/JPCERTCC/MalConfScan/"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L444-L456"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "398614ff5ea37dfaf6c36f60702cb7cdfe66b4569c698e9c3ea29563e4031856"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "d5f63213ce11798879520b0e9b0d1b68d55f7727758ec8c120e370699a41379d"

	strings:
		$reg = "SEE_MASK_NOZONECHECKS" wide fullword
		$msg = "Execute ERROR" wide fullword
		$ping = "cmd.exe /c ping 0 -n 2 & del" wide fullword

	condition:
		all of them
}
rule JPCERTCC_Trickbot {
    meta:
		description = "detect TrickBot in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "1a3c5193-bea1-5f64-be40-47bd22c09772"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://github.com/JPCERTCC/MalConfScan/"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L458-L478"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "b0c3437bc4b4f9e7b2a1562e2d514b7aad398d5e387bb79829757b5772a1ebc3"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "2153be5c6f73f4816d90809febf4122a7b065cbfddaa4e2bf5935277341af34c"

	strings:
		$tagm1 = "<mcconf><ver>" wide
		$tagm2 = "</autorun></mcconf>" wide
		$tagc1 = "<moduleconfig><autostart>" wide
		$tagc2 = "</autoconf></moduleconfig>" wide
		$tagi1 = "<igroup><dinj>" wide
		$tagi2 = "</dinj></igroup>" wide
		$tags1 = "<servconf><expir>" wide
		$tags2 = "</plugins></servconf>" wide
		$tagl1 = "<slist><sinj>" wide
		$tagl2 = "</sinj></slist>" wide
		$dllname = { 6C 00 00 00 CC 00 00 00 19 01 00 00 00 00 00 00 1A 01 }

	condition:
		all of ($tagm*) or all of ($tagc*) or all of ($tagi*) or all of ($tags*) or all of ($tagl*) or $dllname
}
rule JPCERTCC_Remcos_1 {
    meta:
		description = "detect Remcos in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "4a27a16a-2669-5009-bc82-082ec0c9b2c1"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://github.com/JPCERTCC/MalConfScan/"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L480-L493"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "1b4b9f7a88f33faeda71ea9a354eeccba8889800f48a6280c4ec533bb1b3ef3d"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "7d5efb7e8b8947e5fe1fa12843a2faa0ebdfd7137582e5925a0b9c6a9350b0a5"

	strings:
		$remcos = "Remcos" ascii fullword
		$url1 = "Breaking-Security.Net" ascii fullword
		$url2 = "BreakingSecurity.Net" ascii fullword
		$resource = "SETTINGS" ascii wide fullword

	condition:
		1 of ($url*) and $remcos and $resource
}
rule JPCERTCC_Quasar {
    meta:
		description = "detect QuasarRAT in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "f0a81a46-c19b-5012-a1a2-f2f4310fcde3"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://github.com/JPCERTCC/MalConfScan/"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L495-L513"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "a3bb45f2ea217ae1825d80e1ead9c3e47ca88575c960ce1f9feb2db09f489e08"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "390c1530ff62d8f4eddff0ac13bc264cbf4183e7e3d6accf8f721ffc5250e724"

	strings:
		$quasarstr1 = "Client.exe" wide
		$quasarstr2 = "({0}:{1}:{2})" wide
		$sql1 = "SELECT * FROM Win32_DisplayConfiguration" wide
		$sql2 = "{0}d : {1}h : {2}m : {3}s" wide
		$sql3 = "SELECT * FROM FirewallProduct" wide
		$net1 = "echo DONT CLOSE THIS WINDOW!" wide
		$net2 = "freegeoip.net/xml/" wide
		$net3 = "http://api.ipify.org/" wide
		$resource = { 52 00 65 00 73 00 6F 00 75 00 72 00 63 00 65 00 73 00 00 17 69 00 6E 00 66 00 6F 00 72 00 6D 00 61 00 74 00 69 00 6F 00 6E 00 00 }

	condition:
		(( all of ($quasarstr*) or all of ($sql*)) and $resource) or all of ($net*)
}
rule JPCERTCC_Asyncrat {
    meta:
		description = "detect AsyncRat in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "758614e8-df93-54ff-9f06-0020b54fbf88"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L531-L548"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "0a60718ea3412129c40e2eee53591dbf094a6b914502242b5ab9b54f8fd95da0"
		score = 75
		quality = 76
		tags = ""
		rule_usage = "memory scan"
		hash1 = "1167207bfa1fed44e120dc2c298bd25b7137563fdc9853e8403027b645e52c19"
		hash2 = "588c77a3907163c3c6de0e59f4805df41001098a428c226f102ed3b74b14b3cc"

	strings:
		$salt = {BF EB 1E 56 FB CD 97 3B B2 19 02 24 30 A5 78 43 00 3D 56 44 D2 1E 62 B9 D4 F1 80 E7 E6 C3 39 41}
		$b1 = {00 00 00 0D 53 00 48 00 41 00 32 00 35 00 36 00 00}
		$b2 = {09 50 00 6F 00 6E 00 67 00 00}
		$s1 = "pastebin" ascii wide nocase
		$s2 = "pong" wide
		$s3 = "Stub.exe" ascii wide

	condition:
		($salt and (2 of ($s*) or 1 of ($b*))) or ( all of ($b*) and 2 of ($s*))
}
rule CHECK_POINT_Malware_Bumblebee_Packed {
    meta:
		description = "Detects the packer used by bumblebee, the rule is based on the code responsible for allocating memory for a critical structure in its logic."
		author = "Marc Salinas @ CheckPoint Research"
		id = "35f00c87-c26e-5189-b66d-15d5a1b1dd20"
		date = "2022-07-13"
		modified = "2023-04-10"
		reference = "https://research.checkpoint.com/2022/bumblebee-increasing-its-capacity-and-evolving-its-ttps/"
		source_url = "https://github.com/mikesxrs/Open-Source-YARA-rules/blob/ec0056f767db98bf6d5fd63877ad51fb54d350e9/Checkpoint/malware_bumblebee_packed.yar#L1-L31"
		license_url = "N/A"
		logic_hash = "063209aad7ab8a0be46fd578a16b04afc086f930cbdb6c2f7b02824f704d7330"
		score = 75
		quality = 85
		tags = ""
		malware_family = "BumbleBee"
		dll_jul = "6bc2ab410376c1587717b2293f2f3ce47cb341f4c527a729da28ce00adaaa8db"
		dll_jun = "82aab01a3776e83695437f63dacda88a7e382af65af4af1306b5dbddbf34f9eb"
		dll_may = "a5bcb48c0d29fbe956236107b074e66ffc61900bc5abfb127087bb1f4928615c"
		iso_jul = "ca9da17b4b24bb5b24cc4274cc7040525092dffdaa5922f4a381e5e21ebf33aa"
		iso_jun = "13c573cad2740d61e676440657b09033a5bec1e96aa1f404eed62ba819858d78"
		iso_may = "b2c28cdc4468f65e6fe2f5ef3691fa682057ed51c4347ad6b9672a9e19b5565e"
		zip_jun = "7024ec02c9670d02462764dcf99b9a66b29907eae5462edb7ae974fe2efeebad"
		zip_may = "68ac44d1a9d77c25a97d2c443435459d757136f0d447bfe79027f7ef23a89fce"

	strings:
		$heapalloc = {  
            48 8? EC [1-6]           // sub     rsp, 80h 
            FF 15 ?? ?? 0? 00 [0-5]  // call    cs:GetProcessHeap 
            33 D2                    // xor     edx, edx        ; dwFlags 
            4? [2-5]                 // mov     rcx, rax        ; hHeap 
            4? ?? ??                 // mov     r8d, ebx        ; dwBytes 
            FF 15 ?? ?? 0? 00        // call    cs:HeapAlloc 
            [8 - 11]                 // (load params) 
            48 89 05 ?? ?? ?? 00     // mov     cs:HeapBufferPtr, rax 
            E8 ?? ?? ?? ??           // call    memset 
            4? 8B ?? ?? ?? ?? 00     // mov     r14, cs:HeapBufferPtr 
        }

	condition:
		$heapalloc
}
rule DRAGON_THREAT_LABS_Apt_C16_Win_Swisyn : MEMORY FILE {
    meta:
		description = "File matching the md5 above tends to only live in memory, hence the lack of MZ header check."
		author = "@dragonthreatlab"
		id = "af369075-aca3-576d-a10b-849703ffb4f1"
		date = "2015-01-11"
		modified = "2016-09-27"
		reference = "http://blog.dragonthreatlabs.com/2015/01/dtl-12012015-01-hong-kong-swc-attack.html"
		source_url = "https://github.com/mikesxrs/Open-Source-YARA-rules/blob/ec0056f767db98bf6d5fd63877ad51fb54d350e9/Dragonthreatlabs/apt_c16_win_swisyn.yar#L1-L17"
		license_url = "N/A"
		hash = "a6a18c846e5179259eba9de238f67e41"
		logic_hash = "2fa29d3b17aa37501131132640953645d0089c9bc5ec13ffed7a498ad89c1558"
		score = 75
		quality = 28
		tags = "MEMORY, FILE"

	strings:
		$mz = {4D 5A}
		$str1 = "/ShowWU" ascii
		$str2 = "IsWow64Process"
		$str3 = "regsvr32 "
		$str4 = {8A 11 2A 55 FC 8B 45 08 88 10 8B 4D 08 8A 11 32 55 FC 8B 45 08 88 10}

	condition:
		$mz at 0 and all of ($str*)
}
rule DRAGON_THREAT_LABS_Apt_C16_Win_Memory_Pcclient : MEMORY APT {
    meta:
		description = "File matching the md5 above tends to only live in memory, hence the lack of MZ header check."
		author = "@dragonthreatlab"
		id = "59333cd4-b532-510e-afe5-fc3b2e96698f"
		date = "2015-01-11"
		modified = "2016-09-27"
		reference = "http://blog.dragonthreatlabs.com/2015/01/dtl-12012015-01-hong-kong-swc-attack.html"
		source_url = "https://github.com/mikesxrs/Open-Source-YARA-rules/blob/ec0056f767db98bf6d5fd63877ad51fb54d350e9/Dragonthreatlabs/dragonthreatlabs_index.yara#L4-L19"
		license_url = "N/A"
		hash = "ec532bbe9d0882d403473102e9724557"
		logic_hash = "e863fcbcbde61db569a34509061732371143f38734a0213dc856dc3c9188b042"
		score = 75
		quality = 80
		tags = "MEMORY, APT"

	strings:
		$str1 = "Kill You" ascii
		$str2 = "%4d-%02d-%02d %02d:%02d:%02d" ascii
		$str3 = "%4.2f  KB" ascii
		$encodefunc = {8A 08 32 CA 02 CA 88 08 40 4E 75 F4}

	condition:
		all of them
}
rule NCSC_Sparrowdoor_Apipatch {
    meta:
		description = "Identifies code segments in SparrowDoor responsible for patching APIs. No MZ/PE match as the backdoor has no header. Targeting in memory."
		author = "NCSC"
		id = "119b7f3a-1850-53ab-a5d1-8882e34a34b4"
		date = "2022-02-28"
		modified = "2022-07-06"
		reference = "https://www.ncsc.gov.uk/files/NCSC-MAR-SparrowDoor.pdf"
		source_url = "https://github.com/mikesxrs/Open-Source-YARA-rules/blob/ec0056f767db98bf6d5fd63877ad51fb54d350e9/NCSC/SparrowDoor_apipatch.yar#L1-L17"
		license_url = "N/A"
		logic_hash = "302ad7fc0354636c57e6ec86876c7d4a5baaa784f5ecf0f2d51ce47631b8542a"
		score = 75
		quality = 80
		tags = ""
		hash1 = "c1890a6447c991880467b86a013dbeaa66cc615f"

	strings:
		$save = {8B 06 89 07 8A 4E 04}
		$vp_1 = {89 10 8A 4E 04 8B D6 2B D0 88 48 04 83 EA 05 C6 40 05 E9 89 50 06}
		$vp_2 = {50 8B D6 6A 40 2B D7 88 4F 04 83 EA 05 6A 05 C6 47 05 E9 89 57 06 56}
		$vp_3 = {51 52 2B DE 6A 05 83 EB 05 56 C6 06 E9 89 5E 01}
		$va = {6A 40 68 00 10 00 00 68 00 10 00 00 6A 00}
		$s_patch = {50 68 7F FF FF FF 68 FF FF 00 00 56}

	condition:
		3 of them
}
rule NCSC_Sparrowdoor_Shellcode {
    meta:
		description = "Targets code features of the reflective loader for SparrowDoor. Targeting in memory."
		author = "NCSC"
		id = "572187fb-1a11-54f2-9fe7-2b7468b56556"
		date = "2022-02-28"
		modified = "2022-07-06"
		reference = "https://www.ncsc.gov.uk/files/NCSC-MAR-SparrowDoor.pdf"
		source_url = "https://github.com/mikesxrs/Open-Source-YARA-rules/blob/ec0056f767db98bf6d5fd63877ad51fb54d350e9/NCSC/SparrowDoor_shellcode.yar#L1-L15"
		license_url = "N/A"
		logic_hash = "7186bab23114b4825161f58fb02ff397ec8278385482232a4086c86c6fc47082"
		score = 75
		quality = 80
		tags = ""
		hash1 = "c1890a6447c991880467b86a013dbeaa66cc615f"

	strings:
		$peb = {8B 48 08 89 4D FC 8B 51 3C 8B 54 0A 78 8B 74 0A 20 03 D1 03 F1 B3 64}
		$getp_match = {8B 06 03 C1 80 38 47 75 34 80 78 01 65 75 2E 80 78 02 74 75 28 80 78 03 50 75 22 80 78 04 72 75 1C 80 78 06 63 75 16 80 78 05 6F 75 10 80 78 07 41 75 0A}
		$k_check = {8B 48 20 8A 09 80 F9 6B 74 05 80 F9 4B 75 05}
		$resolve_load_lib = {C7 45 C4 4C 6F 61 64 C7 45 C8 4C 69 62 72 C7 45 CC 61 72 79 41 C7 45 D0 00 00 00 00 FF 75 FC FF 55 E4}

	condition:
		3 of them
}
rule NCSC_Sparrowdoor_Strings {
    meta:
		description = "Strings that appear in SparrowDoors backdoor. Targeting in memory."
		author = "NCSC"
		id = "6f96a577-fb59-57db-a66a-f514ecfbf982"
		date = "2022-02-28"
		modified = "2022-07-06"
		reference = "https://www.ncsc.gov.uk/files/NCSC-MAR-SparrowDoor.pdf"
		source_url = "https://github.com/mikesxrs/Open-Source-YARA-rules/blob/ec0056f767db98bf6d5fd63877ad51fb54d350e9/NCSC/SparrowDoor_strings.yar#L1-L23"
		license_url = "N/A"
		logic_hash = "65ec5d266ecd81ab8e4cfbcb352173f825bdae92fd4737b577cb209bace2a943"
		score = 75
		quality = 80
		tags = ""
		hash1 = "c1890a6447c991880467b86a013dbeaa66cc615f"

	strings:
		$reg = "Software\\Microsoft\\Windows\\CurrentVersion\\Run" ascii
		$http_headers = {55 73 65 72 2D 41 67 65 6E 74 3A 20 4D 6F 7A 69 6C 6C 61 2F 34 2E 30 20 28 63 6F 6D 70 61 74 69 62 6C 65 3B 20 4D 53 49 45 20 35 2E 30 3B 20 57 69 6E 64 6F 77 73 20 4E 54 20 35 2E 30 29 0D 0A 41 63 63 65 70 74 2D 4C 61 6E 67 75 61 67 65 3A 20 65 6E 2D 55 53 0D 0A 41 63 63 65 70 74 3A 20 2A 2F 2A 0D 0A}
		$http_proxy = "HTTPS=HTTPS://%s:%d" ascii
		$debug = "SeDebugPrivilege" ascii
		$av1 = "avp.exe" ascii
		$av2 = "ZhuDongFangYu.exe" ascii
		$av3 = "egui.exe" ascii
		$av4 = "TMBMSRV.exe" ascii
		$av5 = "ccSetMgr.exe" ascii
		$clipshot = "clipshot" ascii
		$ComSpec = "ComSpec" ascii
		$export = "curl_easy_init" ascii

	condition:
		10 of them
}
rule NCSC_Sparrowdoor_Xor {
    meta:
		description = "Highlights XOR routines in SparrowDoor. No MZ/PE match as the backdoor has no header. Targeting in memory."
		author = "NCSC"
		id = "9c07feea-91fc-528e-91ac-14d09fa1fc10"
		date = "2022-02-28"
		modified = "2022-07-06"
		reference = "https://www.ncsc.gov.uk/files/NCSC-MAR-SparrowDoor.pdf"
		source_url = "https://github.com/mikesxrs/Open-Source-YARA-rules/blob/ec0056f767db98bf6d5fd63877ad51fb54d350e9/NCSC/SparrowDoor_xor.yar#L1-L14"
		license_url = "N/A"
		logic_hash = "3244e9017e5a0bf1c54e03b3191a5c695b2c1586b3ed4c529742f9b48903a348"
		score = 75
		quality = 80
		tags = ""
		hash1 = "c1890a6447c991880467b86a013dbeaa66cc615f"

	strings:
		$xor_routine_outbound = {B8 39 8E E3 38 F7 E1 D1 EA 8D 14 D2 8B C1 2B C2 8A [4] 00 30 14 39 41 3B CE}
		$xor_routine_inbound = {B8 25 49 92 24 F7 E1 8B C1 2B C2 D1 E8 03 C2 C1 E8 02 8D 14 C5 [4] 2B D0 8B C1 2B C2}
		$xor_routine_config = {8B D9 83 E3 07 0F [6] 30 18 8D 1C 07 83 E3 07 0F [6] 30 58 01 8D 1C 28 83 E3 07 0F [6] 30 58 02 8D 1C 02 83 E3 07 0F [6] 30 58 03 8B DE 83 E3 07 0F [6] 30 58 04 83 C6 05 83 C1 05}

	condition:
		2 of them
}
rule SBOUSSEADEN_Hunt_Evtmutehook_Memory {
    meta:
		description = "memory hunt for default wevtsv EtwEventCallback hook pattern to apply to eventlog svchost memory dump"
		author = "SBousseaden"
		id = "5326581e-90d9-59b9-8dc5-74df97571600"
		date = "2020-09-05"
		modified = "2020-09-05"
		reference = "https://blog.dylan.codes/pwning-windows-event-logging/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_memory_evtmutehook.yara#L1-L11"
		license_url = "N/A"
		logic_hash = "3db66069ed67d90031a6fe071dad4d0200ddd661b263dd2860df026673031e48"
		score = 50
		quality = 75
		tags = ""

	strings:
		$a = {49 BB ?? ?? ?? ?? ?? ?? ?? ?? 41 FF E3 54 24 20 4C 8B 05 61 CB 1A 00 0F 57 C0 66 0F 7F 44 24 20 E8 5B 0A 00 00 48 83 C4 38 C3}
		$b = {48 83 EC 38 4C 8B 0D 65 CB 1A 00 48 8D 54 24 20 4C 8B 05 61 CB 1A 00 0F 57 C0 66 0F 7F 44 24 20 E8 5B 0A 00 00 48 83 C4 38 C3}

	condition:
		$a and not $b
}
rule DITEKSHEN_MALWARE_Win_Quilclipper {
    meta:
		description = "Detects QuilClipper variants mostly in memory or extracted AutoIt script"
		author = "ditekSHen"
		id = "bd23ec5a-f21a-5133-a77a-de2615933b82"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L4076-L4094"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "dcac93806a438b188ae70a679301cb6630b9eb6849bf8fbbb1cea5fed5e7cf75"
		score = 75
		quality = 75
		tags = ""

	strings:
		$cnc1 = "QUILCLIPPER by" ascii
		$cnc2 = "/ UserName:" ascii
		$cnc3 = "/ System:" ascii
		$s1 = "DLLCALL ( \"kernel32.dll\" , \"handle\" , \"CreateMutexW\" , \"struct*\"" ascii
		$s2 = "SHELLEXECUTE ( @SCRIPTFULLPATH , \"\" , \"\" , FUNC_" ascii
		$s3 = "CASE BITROTATE" ascii
		$s4 = "CASE BITXOR" ascii
		$s5 = "CLIP( FUNC_" ascii
		$s6 = "CLIPPUT (" ascii
		$s7 = "FUNC _CLIPPUTFILE(" ascii
		$s8 = "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Schedule" ascii

	condition:
		all of ($cnc*) or all of ($s*)
}
rule DITEKSHEN_MALWARE_Win_Scouteliteps {
    meta:
		description = "Detects actor PowerShell tool designed to steal browsers session cookie and passwords on-disk and in-memory"
		author = "ditekshen"
		id = "d2c04d55-9bf7-54f5-8053-835fa60f19cb"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/back-in-2017"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L11534-L11569"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "9b1047b8b485fcfa29225f53674050703d32498cfa99654c8ac5f8bfac29878e"
		score = 75
		quality = 37
		tags = ""

	strings:
		$cnc1 = "http://beginpassport.com" ascii wide nocase
		$cnc2 = "f_dump.php" ascii wide nocase
		$cnc3 = "c_dump.php" ascii wide nocase
		$cnc4 = "o_dump.php" ascii wide nocase
		$db1 = "\\Google\\Chrome\\User Data\\Default\\Cookies" ascii wide nocase
		$db2 = "\\Mozilla\\Firefox\\Profiles\\*.default" ascii wide nocase
		$db3 = "\\Opera Software\\Opera Stable\\Cookies" ascii wide nocase
		$db4 = "$($env:LOCALAPPDATA)\\Google\\Chrome\\User Data\\Default" ascii nocase
		$db5 = "$($env:APPDATA)\\Mozilla\\Firefox\\Profiles\\*.default" ascii nocase
		$db6 = "$($env:APPDATA)\\Opera Software\\Opera Stable" ascii nocase
		$cond1 = "SSID" ascii wide
		$cond2 = "MSPAuth" ascii wide
		$cond3 = "\"'T'\"" ascii wide
		$cond4 = "SNS_AA" ascii wide
		$cond5 = "X-APPLE-WEBAUTH-TOKEN" ascii wide
		$sql1 = "SELECT * FROM 'cookies' WHERE host_key LIKE $" ascii wide nocase
		$sql2 = "SELECT * FROM 'moz_cookies' WHERE host LIKE $" ascii wide nocase
		$sql3 = "SELECT origin_url, username_value ,password_value FROM 'logins'" ascii nocase
		$def1 = "Add-Type -AssemblyName System.Security" ascii wide nocase
		$def2 = "System.Security.SecureString" ascii wide nocase
		$def3 = "ConvertFrom-SecureString" ascii wide nocase
		$def4 = "[System.Security.Cryptography.ProtectedData]::Unprotect(" ascii wide nocase
		$def5 = "[Security.Cryptography.DataProtectionScope]::LocalMachine" ascii wide nocase
		$def6 = "[Security.Cryptography.DataProtectionScope]::CurrentUser" ascii wide nocase
		$def7 = "System.Data.SQLite.SQLiteConnection" ascii wide nocase
		$def8 = "[Environment]::OSVersion.ToString().Replace(\"Microsoft Windows \"," ascii wide nocase
		$def9 = "Start-Sleep" ascii wide nocase

	condition:
		(1 of ($cnc*) and any of ($db*) and any of ($cond*) and any of ($sql*) and 7 of ($def*)) or ( all of them )
}
rule HARFANGLAB_Allasenhamaycampaign_Executorloader {
    meta:
		description = "Detects Delphi ExecutorLoader DLLs and executables."
		author = "HarfangLab"
		id = "0a09414d-cd86-54a4-99e4-121a7df7624b"
		date = "2024-05-28"
		modified = "2024-09-05"
		reference = "TRR240501"
		source_url = "https://github.com/HarfangLab/iocs/blob/8dd8e9296b110ce3fb13bc557a0295dff8c4c357/hl_public_reports_master.yar#L96-L114"
		license_url = "N/A"
		logic_hash = "61aa0bf180574856e57d0b26442bfa6f4b1e25844611d6eadaed529e1bb86625"
		score = 75
		quality = 55
		tags = ""
		context = "file,memory"

	strings:
		$delphi = "Embarcadero Delphi" ascii fullword
		$s1 = "\\SysWOW64\\mshta.exe" wide fullword
		$s2 = "\\System32\\mshta.exe" wide fullword
		$s3 = "RcDll" wide fullword
		$default1 = "Default_" wide fullword
		$default2 = "Default~" wide fullword

	condition:
		$delphi and all of ($s*) and any of ($default*)
}
rule HARFANGLAB_Allasenhamaycampaign_Allasenha {
    meta:
		description = "Detects AllaSenha banking trojan DLLs."
		author = "HarfangLab"
		id = "787c4e66-2053-5f14-a52e-6b0415700e8c"
		date = "2024-05-28"
		modified = "2024-09-05"
		reference = "TRR240501"
		source_url = "https://github.com/HarfangLab/iocs/blob/8dd8e9296b110ce3fb13bc557a0295dff8c4c357/hl_public_reports_master.yar#L115-L137"
		license_url = "N/A"
		logic_hash = "affe75ade6c8d9eeba00006f78678a48b1cfc5ffa9f9675fdea6ffd6cb3a02bd"
		score = 75
		quality = 80
		tags = ""
		context = "file,memory"

	strings:
		$a1 = "<|NOSenha|>" wide fullword
		$a2 = "<|SENHA|>QrCode: " wide fullword
		$a3 = "<|SENHA|>Senha 6 : " wide fullword
		$a4 = "<|SENHA|>Snh: " wide fullword
		$a5 = "<|SENHA|>Token: " wide fullword
		$a6 = "<|BB-AMARELO|>" wide fullword
		$a7 = "<|BB-AZUL|>" wide fullword
		$a8 = "<|BB-PROCURADOR|>" wide fullword
		$a9 = "<|ITAU-SNH-CARTAO|>" wide fullword
		$a10 = "<|ITAU-TK-APP|>" wide fullword
		$dga = { 76 00 00 00 B0 04 02 00 FF FF FF FF 01 00 00 00 78 00 00 00 B0 04 02 00 FF FF FF FF 01 00 00 00 7A 00 00 00 B0 04 02 00 FF FF FF FF 01 00 00 00 77 00 00 00 B0 04 02 00 FF FF FF FF 01 00 00 00 6B 00 00 00 B0 04 02 00 FF FF FF FF 01 00 00 00 79 00 00 00 }

	condition:
		$dga and (4 of ($a*))
}
rule SIGNATURE_BASE_Hvs_APT27_Hyperbro_Stage3_C2 {
    meta:
		description = "HyperBro Stage 3 C2 path and user agent detection - also tested in memory"
		author = "Marc Stroebel"
		id = "d1fe03b9-440c-5127-9572-dddcd5c9966b"
		date = "2022-02-07"
		modified = "2023-12-05"
		reference = "https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_apt27_hyperbro.yar#L86-L100"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "676df1eaa782c6b876df138a0ddddc3c63e277b84d4414b044314ee219674420"
		score = 50
		quality = 81
		tags = ""
		hash1 = "624e85bd669b97bc55ed5c5ea5f6082a1d4900d235a5d2e2a5683a04e36213e8"

	strings:
		$s1 = "api/v2/ajax" ascii wide nocase
		$s2 = "Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.116 Safari/537.36" ascii wide nocase

	condition:
		all of them
}
rule SIGNATURE_BASE_Opcloudhopper_Wmidll_Inmemory {
    meta:
		description = "Malware related to Operation Cloud Hopper - Page 25"
		author = "Florian Roth (Nextron Systems)"
		id = "0afb6e52-bc9a-5a68-890b-79a017e5d554"
		date = "2017-04-07"
		modified = "2023-12-05"
		reference = "https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_op_cloudhopper.yar#L281-L293"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "6dddda4e519eeaa67eb4c21151cab10553420a23a077751e0fc45fcae0bf6e69"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "wmi.dll 2>&1" ascii

	condition:
		all of them
}
rule SIGNATURE_BASE_Malware_Sakula_Memory {
    meta:
		description = "Sakula malware - strings after unpacking (memory rule)"
		author = "David Cannings"
		id = "328e3707-d11d-5b7f-bec4-18a42a2c658b"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_sakula.yar#L20-L45"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "b3852b9e7f2b8954be447121bb6b65c3"
		logic_hash = "ba6d93a1fc5fd81748eb462fc55b681987126ba853ddb677a5f1f9b74ba5cde8"
		score = 75
		quality = 85
		tags = ""

	strings:
		$str01 = "cmd.exe /c ping 127.0.0.1 & del \"%s\""
		$str02 = "cmd.exe /c rundll32 \"%s\" Play \"%s\""
		$str03 = "Mozilla/4.0+(compatible;+MSIE+8.0;+Windows+NT+5.1;+SV1)"
		$str04 = "cmd.exe /c cmd.exe /c cmd.exe /c cmd.exe /c cmd.exe /c cmd.exe /c \"%s\""
		$str05 = "Self Process Id:%d"
		$str06 = "%d_%d_%d_%s"
		$str07 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0)"
		$str08 = "cmd.exe /c rundll32 \"%s\" ActiveQvaw \"%s\""
		$opcodes01 = { 83 F9 00 74 0E 31 C0 8A 03 D0 C0 34 ?? 88 03 49 43 EB ED }
		$opcodes02 = { 31 C0 8A 04 13 32 01 83 F8 00 75 0E 83 FA 00 74 04 49 4A }

	condition:
		4 of them
}
rule SIGNATURE_BASE_HKTL_Cobaltstrike_Beacon_Strings {
    meta:
		description = "Identifies strings used in Cobalt Strike Beacon DLL"
		author = "Elastic"
		id = "af558aa2-a3dc-5a7a-bc74-42bb2246091c"
		date = "2021-03-16"
		modified = "2023-12-05"
		reference = "https://www.elastic.co/blog/detecting-cobalt-strike-with-memory-signatures"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_cobaltstrike.yar#L54-L67"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "4349a7ad94df2269217b55c2aef9628c4eef078566c276936accdd4f996ba2cf"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "%02d/%02d/%02d %02d:%02d:%02d"
		$s2 = "Started service %s on %s"
		$s3 = "%s as %s\\%s: %d"

	condition:
		2 of them
}
rule SIGNATURE_BASE_HKTL_Cobaltstrike_Beacon_XOR_Strings {
    meta:
		description = "Identifies XOR'd strings used in Cobalt Strike Beacon DLL"
		author = "Elastic"
		id = "359160a8-cf1c-58a8-bf7f-c09a8d661308"
		date = "2021-03-16"
		modified = "2023-12-05"
		reference = "https://www.elastic.co/blog/detecting-cobalt-strike-with-memory-signatures"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_cobaltstrike.yar#L69-L88"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "b5009c29055784ce6371100417b862f723d7e3c1b4081c563fcd8770db48051f"
		score = 75
		quality = 85
		tags = ""
		xor_s1 = "%02d/%02d/%02d %02d:%02d:%02d"
		xor_s2 = "Started service %s on %s"
		xor_s3 = "%s as %s\\%s: %d"

	strings:
		$s1 = "%02d/%02d/%02d %02d:%02d:%02d" xor(0x01-0xff)
		$s2 = "Started service %s on %s" xor(0x01-0xff)
		$s3 = "%s as %s\\%s: %d" xor(0x01-0xff)
		$fp1 = "MalwareRemovalTool"

	condition:
		2 of ($s*) and not 1 of ($fp*)
}
rule SIGNATURE_BASE_HKTL_Cobaltstrike_Beacon_4_2_Decrypt {
    meta:
		description = "Identifies deobfuscation routine used in Cobalt Strike Beacon DLL version 4.2"
		author = "Elastic"
		id = "63b71eef-0af5-5765-b957-ccdc9dde053b"
		date = "2021-03-16"
		modified = "2023-12-05"
		reference = "https://www.elastic.co/blog/detecting-cobalt-strike-with-memory-signatures"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_cobaltstrike.yar#L90-L102"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "8685b1626c8d263f49ccf129dcd4fe1b42482fcdb37c2e109cedcecaed8c2407"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a_x64 = {4C 8B 53 08 45 8B 0A 45 8B 5A 04 4D 8D 52 08 45 85 C9 75 05 45 85 DB 74 33 45 3B CB 73 E6 49 8B F9 4C 8B 03}
		$a_x86 = {8B 46 04 8B 08 8B 50 04 83 C0 08 89 55 08 89 45 0C 85 C9 75 04 85 D2 74 23 3B CA 73 E6 8B 06 8D 3C 08 33 D2}

	condition:
		any of them
}
rule SIGNATURE_BASE_APT_MAL_RU_WIN_Snake_Malware_May23_1 : MEMORY {
    meta:
		description = "Hunting Russian Intelligence Snake Malware"
		author = "Matt Suiche (Magnet Forensics)"
		id = "53d2de3c-350c-5090-84bb-b6cde16a80ad"
		date = "2023-05-10"
		modified = "2023-12-05"
		reference = "https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_mal_ru_snake_may23.yar#L17-L41"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "7cff7152259bb17a9b72b91f0fbef220aad2f35a1d2758d7225316a9896bf845"
		score = 75
		quality = 71
		tags = "MEMORY"
		threat_name = "Windows.Malware.Snake"
		scan_context = "memory"
		license = "MIT"

	strings:
		$a = { 25 73 23 31 }
		$b = { 25 73 23 32 }
		$c = { 25 73 23 33 }
		$d = { 25 73 23 34 }
		$e = { 2e 74 6d 70 }
		$g = { 2e 73 61 76 }
		$h = { 2e 75 70 64 }

	condition:
		all of them
}
rule SIGNATURE_BASE_APT_Dropper_Raw64_TEARDROP_1 {
    meta:
		description = "This rule looks for portions of the TEARDROP backdoor that are vital to how it functions. TEARDROP is a memory only dropper that can read files and registry keys, XOR decode an embedded payload, and load the payload into memory. TEARDROP persists as a Windows service and has been observed dropping Cobalt Strike BEACON into memory."
		author = "FireEye"
		id = "88adad58-ba16-5996-9ea8-ea356c3ed5b2"
		date = "2020-12-14"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_solarwinds_sunburst.yar#L141-L156"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "6ab5197e7a1a123055b361a2ef79f8a77a7935606fccc8f163ea5914c94cd14d"
		score = 85
		quality = 85
		tags = ""

	strings:
		$sb1 = { C7 44 24 ?? 80 00 00 00 [0-64] BA 00 00 00 80 [0-32] 48 8D 0D [4-32] FF 15 [4] 48 83 F8 FF [2-64] 41 B8 40 00 00 00 [0-64] FF 15 [4-5] 85 C0 7? ?? 80 3D [4] FF }
		$sb2 = { 80 3D [4] D8 [2-32] 41 B8 04 00 00 00 [0-32] C7 44 24 ?? 4A 46 49 46 [0-32] E8 [4-5] 85 C0 [2-32] C6 05 [4] 6A C6 05 [4] 70 C6 05 [4] 65 C6 05 [4] 67 }
		$sb3 = { BA [4] 48 89 ?? E8 [4] 41 B8 [4] 48 89 ?? 48 89 ?? E8 [4] 85 C0 7? [1-32] 8B 44 24 ?? 48 8B ?? 24 [1-16] 48 01 C8 [0-32] FF D0 }

	condition:
		all of them
}
rule SIGNATURE_BASE_HKTL_Meterpreter_Inmemory {
    meta:
		description = "Detects Meterpreter in-memory"
		author = "netbiosX, Florian Roth"
		id = "29c3bb7e-4da8-5924-ada7-2f28d9352009"
		date = "2020-06-29"
		modified = "2023-04-21"
		reference = "https://www.reddit.com/r/purpleteamsec/comments/hjux11/meterpreter_memory_indicators_detection_tooling/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_metasploit_payloads.yar#L341-L363"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "4b39dbcb276842a1306205cf2e51ce86b6d2aa21353d277df15f4ea3b3d97678"
		score = 85
		quality = 85
		tags = ""

	strings:
		$sxc1 = { 6D 65 74 73 72 76 2E 64 6C 6C 00 00 52 65 66 6C 
               65 63 74 69 76 65 4C 6F 61 64 65 72 }
		$sxs1 = "metsrv.x64.dll" ascii fullword
		$ss1 = "WS2_32.dll" ascii fullword
		$ss2 = "ReflectiveLoader" ascii fullword
		$fp1 = "SentinelOne" ascii wide
		$fp2 = "fortiESNAC" ascii wide
		$fp3 = "PSNMVHookMS" ascii wide

	condition:
		(1 of ($sx*) or 2 of ($s*)) and not 1 of ($fp*)
}
rule SIGNATURE_BASE_APT_Backdoor_Win_Gorat_Memory_1 {
    meta:
		description = "Identifies GoRat malware in memory based on strings."
		author = "FireEye"
		id = "4fcdd98f-1873-58e1-a9f5-73ee0aa5a69f"
		date = "2024-05-25"
		modified = "2024-05-25"
		reference = "https://www.fireeye.com/blog/products-and-services/2020/12/fireeye-shares-details-of-recent-cyber-attack-actions-to-protect-community.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_fireeye_redteam_tools.yar#L1013-L1039"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		hash = "3b926b5762e13ceec7ac3a61e85c93bb"
		logic_hash = "bf8d80b7a7d35c1bcb353ff66d10bc95c2e6502043acc6554887465a467cdcf7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$rat1 = "rat/modules/socks.(*HTTPProxyClient).beacon" fullword
		$rat2 = "rat.(*Core).generateBeacon" fullword
		$rat3 = "rat.gJitter" fullword
		$rat4 = "rat/comms.(*protectedChannel).SendCmdResponse" fullword
		$rat5 = "rat/modules/filemgmt.(*acquire).NewCommandExecution" fullword
		$rat6 = "rat/modules/latlisten.(*latlistensrv).handleCmd" fullword
		$rat7 = "rat/modules/netsweeper.(*netsweeperRunner).runSweep" fullword
		$rat8 = "rat/modules/netsweeper.(*Pinger).listen" fullword
		$rat9 = "rat/modules/socks.(*HTTPProxyClient).beacon" fullword
		$rat10 = "rat/platforms/win/dyloader.(*memoryLoader).ExecutePluginFunction" fullword
		$rat11 = "rat/platforms/win/modules/namedpipe.(*dummy).Open" fullword
		$winblows = "rat/platforms/win.(*winblows).GetStage" fullword

	condition:
		$winblows or 3 of ($rat*)
}
rule SIGNATURE_BASE_WCE_In_Memory {
    meta:
		description = "Detects Windows Credential Editor (WCE) in memory (and also on disk)"
		author = "Florian Roth (Nextron Systems)"
		id = "90c90ca5-e3be-5035-b35c-c2e7faec43a5"
		date = "2016-08-28"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/thor-hacktools.yar#L3265-L3279"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "74ab7772db5b1de8a4eae03370e2be3cd35004730f84d472677688109a1d6d88"
		score = 80
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "wkKUSvflehHr::o:t:s:c:i:d:a:g:" fullword ascii
		$s2 = "wceaux.dll" fullword ascii

	condition:
		all of them
}
rule SIGNATURE_BASE_Fidelis_Advisory_Cedt370 {
    meta:
		description = "Detects a string found in memory of malware cedt370r(3).exe"
		author = "Florian Roth (Nextron Systems)"
		id = "b5ebf2d7-e3e4-5b3b-a082-417da9c7fda6"
		date = "2015-06-09"
		modified = "2023-12-05"
		reference = "http://goo.gl/ZjJyti"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/apt_fidelis_phishing_plain_sight.yar#L16-L30"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "1070d3c63a7091c0982e67134f9dc3cd790bb0b5c2ac08f3a00e3b97ef53d64b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "PO.exe" ascii fullword
		$s1 = "Important.exe" ascii fullword
		$s2 = "&username=" ascii fullword
		$s3 = "Browsers.txt" ascii fullword

	condition:
		all of them
}
rule SIGNATURE_BASE_Pos_Malware_Malumpos {
    meta:
		description = "Used to detect MalumPOS memory dumper"
		author = "Trend Micro, Inc."
		id = "6d85c7fe-bf1b-53fb-b618-4b0f8b63cae4"
		date = "2015-05-25"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/crime_malumpos.yar#L1-L17"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "ece32e51a12adf0d68420c8d98efbe7df27b9061ddfe4dcedf151f9f06287eee"
		score = 75
		quality = 85
		tags = ""
		sample_filtype = "exe"

	strings:
		$string1 = "SOFTWARE\\Borland\\Delphi\\RTL"
		$string2 = "B)[0-9]{13,19}\\"
		$string3 = "[A-Za-z\\s]{0,30}\\/[A-Za-z\\s]{0,30}\\"
		$string4 = "TRegExpr(exec): ExecNext Without Exec[Pos]"
		$string5 = /Y:\\PROGRAMS\\.{20,300}\.pas/

	condition:
		all of ($string*)
}
rule SIGNATURE_BASE_Mimikatz_Memory_Rule_1 : APT {
    meta:
		description = "Detects password dumper mimikatz in memory (False Positives: an service that could have copied a Mimikatz executable, AV signatures)"
		author = "Florian Roth"
		id = "55cc7129-5ea0-5545-a8f6-b5306a014dd0"
		date = "2014-12-22"
		modified = "2023-07-04"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_mimikatz.yar#L5-L26"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "22064af570b8e0a93ca0d45484848eda3fbecfd27c88247ef0897fe53be4b7fc"
		score = 70
		quality = 85
		tags = "APT"
		nodeepdive = 1

	strings:
		$s1 = "sekurlsa::wdigest" fullword ascii
		$s2 = "sekurlsa::logonPasswords" fullword ascii
		$s3 = "sekurlsa::minidump" fullword ascii
		$s4 = "sekurlsa::credman" fullword ascii
		$fp1 = "\"x_mitre_version\": " ascii
		$fp2 = "{\"type\":\"bundle\","
		$fp3 = "use strict" ascii fullword
		$fp4 = "\"url\":\"https://attack.mitre.org/" ascii

	condition:
		1 of ($s*) and not 1 of ($fp*)
}
rule SIGNATURE_BASE_HKTL_Mimikatz_Skeletonkey_In_Memory_Aug20_1 {
    meta:
		description = "Detects Mimikatz SkeletonKey in Memory"
		author = "Florian Roth (Nextron Systems)"
		id = "e7c1c512-e944-5d87-ac57-cdc9ab7cf660"
		date = "2020-08-09"
		modified = "2023-12-05"
		reference = "https://twitter.com/sbousseaden/status/1292143504131600384?s=12"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_mimikatz.yar#L178-L190"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "0cc9a4d3b63e07a695df342bd2c96a55570502d6fd0ab9a1b61d63e28e1c3e05"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = { 60 ba 4f ca c7 44 24 34 dc 46 6c 7a c7 44 24 38 
              03 3c 17 81 c7 44 24 3c 94 c0 3d f6 }

	condition:
		1 of them
}
rule SIGNATURE_BASE_HKTL_Mimikatz_Memssp_Hookfn {
    meta:
		description = "Detects Default Mimikatz memssp module in-memory"
		author = "SBousseaden"
		id = "89940110-8a5e-5a28-bf64-3b568f8ef1f8"
		date = "2020-08-26"
		modified = "2023-12-05"
		reference = "https://github.com/sbousseaden/YaraHunts/blob/master/mimikatz_memssp_hookfn.yara"
		source_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/yara/gen_mimikatz.yar#L192-L216"
		license_url = "https://github.com/Neo23x0/signature-base/blob/c60c8e3408dce1c9597259b8816f7526df9ac778/LICENSE"
		logic_hash = "27cf87f801111f17af76ab4c4f8329b73165f24f755d33edbb22d845bba6d3ff"
		score = 70
		quality = 85
		tags = ""

	strings:
		$xc1 = { 48 81 EC A8 00 00 00 C7 84 24 88 00 00 00 ?? ?? 
               ?? ?? C7 84 24 8C 00 00 00 ?? ?? ?? ?? C7 84 24 
               90 00 00 00 ?? ?? ?? 00 C7 84 24 80 00 00 00 61 
               00 00 00 C7 44 24 40 5B 00 25 00 C7 44 24 44 30 
               00 38 00 C7 44 24 48 78 00 3A 00 C7 44 24 4C 25 
               00 30 00 C7 44 24 50 38 00 78 00 C7 44 24 54 5D 
               00 20 00 C7 44 24 58 25 00 77 00 C7 44 24 5C 5A 
               00 5C 00 C7 44 24 60 25 00 77 00 C7 44 24 64 5A 
               00 09 00 C7 44 24 68 25 00 77 00 C7 44 24 6C 5A 
               00 0A 00 C7 44 24 70 00 00 00 00 48 8D 94 24 80 
               00 00 00 48 8D 8C 24 88 00 00 00 48 B8 A0 7D ?? 
               ?? ?? ?? 00 00 FF D0 }

	condition:
		$xc1
}
